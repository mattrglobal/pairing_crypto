use core::convert::TryFrom;
use digest::{ExtendableOutput, XofReader};
use pairing_crypto::bbs::ciphersuites::bls12_381::{
    verify_proof,
    BbsVerifyProofRequest,
    Challenge,
    Generators,
    HiddenMessage,
    Message,
    PokSignature,
    PresentationMessage,
    ProofMessage,
    PublicKey,
    SecretKey,
    Signature,
    APP_MESSAGE_DST,
    GLOBAL_BLIND_VALUE_GENERATOR_SEED,
    GLOBAL_MESSAGE_GENERATOR_SEED,
    GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
};

mod common;

use common::mock::MockRng;

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const PRESENTATION_MESSAGE: &[u8; 20] = b"e8gxekZpmeZTU0VDL9MV";

const EXPECTED_SIGS: [&str; 7] = [
"84bc8e5b17b3ed1b0d76b0083cd6dfa0f01f84db5d03307143639e184de9cea7c86f1719086749eb11b1b70557da85a6176e6cb6bdbf852269c6d4fa122c35c9cacc0341aac22713dc0d4210d7b10eb46255953409b334b3f0c898469a13db31a1367617c89be913d5b052d26188d71e",
"ab5b8b49e21ec9c821eefd670d88010d831c8f42fff38f2c2567e7e85e0423296e583649850f23bf2820a1bd3fbc45f372e47f42ad03ec3c34e2c41cfbffb06a782370537c95778267ad65d4fdc367870b6c9ce7e4a2a0cb7b84e678c5d33c771f49b0435a7417a3ccd88eeeabdbd4ef",
"8c1af141fbdaf2086eca30407104b8badbd471d79fc19e6c9bb651386296ce857f04d45d40be389fabdca9f79e5dc0f62682b229b30f4273c0b326ea336ae0cbba6604b3051f9dcdbaaaa13ae16e75a90cd30d2d9a1fe9c5d8a0eecbd1860c62ac3c525f04e95c5427f6fcc4ba905258",
"8856fc5e8e1ed868d76652d2bbffc129b90ad13f987c6171c9edd742ac39cb33e4c9f344b478fea3bf588c6a5d3fa8901ba72266e8dc4be06337f451e0bb0510ba788f4f118c00ffcd29e2d2f24de78930ff38d3cb25d5886d8cbcafbc49754ad3c80f515643526761322dc77fb7c00c",
"8829a1a3313e0086540da93ee1f3af85e1539c785479eca13f58bd19718c84085cd0d04f81a49d9ba4075f0b73009fca2dd33bacf4e242626bfcb25bb5aad498ffa5d15a0a92777cc95ae84bf36a0c1e4a93d052a4f0087b5bf346ea927e48a3754a61e73432391073560f27aef9978b",
"a6c5f92986e34ad7cdcfd3474d764705b71f40d31bad67bba18b3877144a596bc688c92e2adb45ee62503aa2a1ba413b3d6a73db9bafa89d9c1da822970236ecc51bcd9f88099d52aa21f5501d6a7b5759b23a7d0fba88d3fa7a9af6c150c1bc06afea073c74878cad449b8a8477d75b",
"843de65a6b1187d537050ac966a49cd3129460053cfeb494f9ec63ce7041636fbbcd1ad9adaec7fe12e411f758b6d457730a03eb2b881327cfa821f43b998e06d1b9befd12f8923b63a232470372775e5491d407272a369dbc6ef40d547e9bbdf4f29c1588e04ddeb60c48270ecaa013",
];

const HEADER: &[u8; 16] = b"some_app_context";

#[test]
fn signing() {
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b.as_ref(), APP_MESSAGE_DST.as_ref()))
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    for i in 0..TEST_KEY_INFOS.len() {
        let sk =
            SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed");
        let pk = PublicKey::from(&sk);
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        );
        let signature =
            Signature::new(&sk, &pk, Some(&HEADER), &gens, &test_atts)
                .expect("signing failed");
        //         println!(
        // "sig {:?} = {:?}",
        // i,
        // hex::encode(signature.signature_to_octets())
        // );

        assert_eq!(
            signature
                .verify(&pk, Some(&HEADER), &gens, &test_atts)
                .unwrap(),
            true
        );
        let expected_signature = Signature::octets_to_signature(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(signature, expected_signature);
    }
}

#[test]
fn proofs() {
    use rand::SeedableRng;
    let mut rng = MockRng::from_seed([1u8; 16]);
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b.as_ref(), APP_MESSAGE_DST.as_ref()))
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    let expected_proofs = [
            ["9117369db7a8bbe41518473761e9c85fc5c3edf2b589cf1552f4447df6e4cef2097a126d1b8ef800436b3677a60fc6eb9268c6f4af635dd0610a0856f7cb47f5a7ac199c08fbb4081a77f978e9ea6a50fdbd84069474ad82fca37636579b895da7201f907b68b2f2ffd69355d6254e557f13dab6aeb2be4ece080ad8a3d51c67d3fc585bd1ce6f0685097f50e9e19b4827e929fe6aab21c3ba0e38379467fc66702e13e1738fbde7373e802c80504b2755b24d8f99e577990aa6253fb299e15e974e416784a2ea1d21ce1f98ee01f736469bb5692bef0a3bfcdbdd7271d6ad56fca72d810077d769bdb234a407f566fd29c2b514bcd807511159f92925d04fa293ed8cf81dddd8bb3065de8dc05ffbe32f6172608324ce92cb83d3e5ce676aea4cbb48d720fbc8f2b4b0f66bafc60018013fe95ae840435f420f08a9cc7cf291da486d8989cd354526f41380e258bd36733de05c280089665487c44e0a54342fe4b9e50d1e0aad95dbd8652f042c16ab53ee5a951af6c5d480d906743c7b793b7c53e99fb366360d9ed78f5151b448862fc51ed5291d88d457e1323fa2c135a7530cb50119c6bbbe0a9e725613cccbd856c089f6e1254cd522d6835055000325874f8bdcb0505c6769e62c1b827f334821d2359ac1c875a1281bcf2bb465c2f18961de200ab33b9436e34f55bd7f514c", "8749e42358c134a278aefc2c0dcc4e6530e670ee625774d7b88b69ae83a567dc508e06d81a25dc91f3841a8638bb620bb2a04491d220c3482bfd32accc671db5605cf0c9b23c6ac18f973b397c19eb76568303a8ed598e1f78c56c1c0f25dcdb92453c00529161cd6a1078d8c2894bf0909ca27721138363780e1891a97e8bba034d1c344e909778c84c0e1e676905c96927295b3b6b7ff456f71e9953095620b458117c14b70b666db0b7aae02bb6715d9ee39c8a0afe90a5b8f60d69ee1f4f740c78d91992183bd4ac9d09ad9ffad2111b655a0aaf310dca599e68f37bedf7821a1047dbf57382ef477203533a02795fc05ac324f5217a94b50ef989407a3e5b3a8009f972dbf22b815380de6292b3597b55fa30bfc535a71ee70896cd2086465c54a7a559da8caebcf8b9ba908fdd019519e18da9f8794b207977af77ed0e4a86f3c98493ea79efa70cade1bf02340d19d7bd89f0fd3431631d8021f55b82a7b0356f6d678871943eb84fd72f428e37ab2265b43f785e9f62782c539bd6990890bf899664a48bb55b6183602b8ed13b08850a142cab0a864876b454d6ff37868034314e6aec102ae39293ca7fe098561c2498fff664a753145f468a5db512bd660f457ab29c04f46d8bc9f6a54d37", "8bcae5f898c375d6b97928f8b66c24a440f1c01d0f312fea166fcece3c1203e5fda57d80609c8f4376ed6fc0100ee681afb081098e593cf331fa0bcd57f0829d195b2ca7ab2033575e008199d0988152fb872b2aa3036a24a37b4885a74cdce7a2914249476f5fb375b88b1dde2ed0057a84310031c4d4f0cdb369780a3a15e50c9d5fd106ff1fc35cd0c5a6d5154f006c9706e68f12bbd75cd4e56ffb7717935954494e49a38f5d09d54dd47c0337384a708fb9b148d7996e1a7bdaf0d5502db5d289d2e40035b5a19bc3afca0be3783fe1db705949adce8995b5d797c9607c61894d1f50492ea11cbe87edc8bd285050337068003736a35b132241fa55fd46963aea1348f5ebef36fbdadc55c2fc326d9907ba34fecb760cf98efe50dcb69b46f25c61b027937369da99dc6090ae5d452c4a5bfda8412c59e678b83bd477a82b57ef3cae1a2cd18f91df150ccbdad735edb36b3973b0112a5bb67b17a1b75f7a568df0da764b5f1df3655f5577b13b72267f3adab5f0b8685cb7b168d02002d01109aceadb1c83064aee2d40d9a4eb397b667b13fc6b83c223243db7fe15e02a99779ef13b3e4559d5045dcbfd4c21", "ae9c6824a2d6867acf01439218b41d9446720d341d558c9912d0330bdf2338860784339b801277125eab8b9fba605f69b8280d8fc4d65952510f03cd2d0db14009d68b4f80c04e6c9322c9a6f71390f97ec607afdb5bd7691f5d6670d5b646baa6b6464eb01dda3cafaced5333fe7714e24b12fc46ced8e0e02f2b51c935d4a7b1988ccc87d5b00c3f4c129cd2d0d4b9087d058304e49d63fdf3294827c590ec57f8bcaf32269983a5122fe714d4dd5a32d6c82f35b98ade6cb8dcf98be5cbcf202c52a8c0d05cff4b926d606bd47a7243b3489e28df5c147fb759840018ca6ba483b818c3867e9827173a96c6e8398a12d6e0ad4da377ae0e4b1ccac3372601d255ef20e15776cc62a6a7a17567bb3631beec18a6165cf11667a394b9721857aabe741077b6c9423c7fdfeffab8325f083fab3c89a16b801b229289271cbafad23ddf72a112e48828ac8dabbbb91c9c6fff3405970201a4718182eefcddd01b019ee797170438d5a7b5e09981201be01e79df54728ace26aaafb48f3c684a853c591578e7ef123a71b58ce992106694", "80643ec7ebf8ed78f46af6f4a7901f3f7c574559056cbbf16f6d67f1dce4f352bf0784371bc9b6d48af4fcc502a49ceda27a93b3080f9d62841caa5c1c65342a449e7d89531353ebd445d0e9b65f0eaf8c33e1595d902d284557b2da3ed1cdd9b498eee4685958a2d3f2df41c5b945f4d2e2ca2c9c98ecdb6907fd174edb6e0f0c6f8896e25d0810dab659060633699549b0586b8c4c781a3f4ea5f1ba72a0af408e428e2f7df0837bb45fb9a572e81e66901fa4bfcd5b0cea3f0a3dbdabc619af48234ea83852429ea502ef6b802b9656dad0c11b46bead73ca216529fd4100a6dd0926f4307affe57619fc0b76218753afbfda59a044f068203818fb016f322c2777233b5717adf208837ec4199d5a1f06a0637adb5073b557c21fac2ea3eeefe9e892f7458fc3fce77a20657b643668bc4eb0aeb1e8fe05d47334903b3b28595e3a1e29eaf5f8fb2f394bc3c721bf1ec98b20238ed47364e5c7632ec48b80268bdcd3e5e1e70dda2460d51a01e9d3", "b10764462a781f615d65f06129c05cc7263d04b9999ec85c953bc5100aad01393c9dbf4caa73bde393efe37e1b697719a31f3cf886b93cda56f2430281dadcba01c683e00fc61bf05bf6e13219f4b8818eaa784b2bda2a05b0679651a48580c6b9ed17e8f8ba8f71c27ef69696b9e5015156f624cf6cd6ccd03c34ca247716a5c9695a042195de755956c4707000009e34d3f6f1bbedff664e232a9a5219c91e1f20d3d64b3ee8f989caed0b54dfae654b4c1678eced3884b35cb2a31c9ffae5050356f0259b257828abd7c6eda4b4d772b666010f113a8b7c2af1b619d79c655d1f7909a2b54c97f9db22aaf04dd5de3131c6d8bb40089a93f5e088a102167472d41430be4ce5171c64c777c94eabc56dda83ce8ddcdc61bab08c66e318ccdb4c8b36718491e4a3f3f4ad51a1290fd5580bb13690355d68110693a40db07413c9bffd97928521b87aae7a6442783c2d"],
            ["a574c830d6e775bd87885b58536b58dfa445804231a5d2874ec48bfdf8587fb110625b64bca30acaf47bf312115219db8e2cbc483e596f8b5ec31258ba209c2d0e99a2266020fdabef926a13c8b8b73c0806957bcc312c92943be74348225185835423665e74a49b8e315d06ded3168a45b83b3d27dbf439d273760bf833dbc7c34aa5583ed39813763fa62e9e354e98104063306b7a45189677b400caff7e993aa14384a809e03e64d8d79d411b94130cc2ec60f63fc8eac4ab5149b10c70ae1d83acd9737775510ed0f9667d660ff144ae3d22610b06f357baca438be39c6678778e617baceb7351a7357d6b2b46a828af9d6f3bb77d87a82ffdcf90a5505c7cdd6a460dc1e9ba0872c1411e03ea9645de82e2dce39a7bf274d8b2f871d25991b8e1dc07da365de10efc746849da564d0e81389ff8c068e50560ecaff5115cc42a0bfdcf76837e4101e1f4954fb549169c623f90ebe023d932277ff07e2d2aa4847c0c0afc7c255c98e8a4482c49f54b304fc87cdfdda324ddd4a3fd6661f829b8a288db62e82e530fc72390f0039413f8eb49819781a8e03731cb677c04cf2a287a6928b39e4c58ec35da7d1741594c38f39ec09ccdad1d877ffbe4cd2e612c1823a2d08aa24d0d61ead6f97feeec58be9311e8949ec7fe1b2b390eb214958525534edf03de130e8f3b9c60761eb4", "a414bae09651aa557532e2642bc67f02504b6471b9615feb07d97e6c56c8e8286142d66f13e4691b5e746e05eac7cd63a5f5d4e7e3b75017189ed001b7ca3fde01d7c9d522702d8d149df91f38a51c1c068a9ee7a6d1fc96050dee63ee9a8b7fa9c81f48d653ef36807a5b02b8046b5c78c1f0d1c1bd71d66c9f6364c09644db4d68aadcc70514e32b2c000f43380b3d35ced2d29ad3e3fbcf701ca2d129f3ced4e6ed4f4898d4c1568a78caf55b309c3b2980241e95c2ffff0455ebd2c827d2cfc713ae43476af32541f6d1c4c1b7836f01d27a6d93e6966dafcdc44f3c31bd072f493fd650ba77d84487e44ad17828467f585c7eda8b1c06818d4606ee3e2e0e48db3358f28319e4143f6e56efb4cd132968365024eb3fff5ac380c528f7bed2cc042f967aa1ab2cd765e29378b659035e9d6d2daf25b2ff3dbbea1440b767f03d40c8169990af87e0fde2f74a2bea62730641de8cf1c6df9f5239280aac48d7983fbfcfb68b6fcef2748de4dfc8c943570e4590b8c3509efa8577892dad5a5d26061340b84b4abbb78eb6089d02365f0ab4b524aaff3e33e15d7c74d32c7e7db81e980788d4fb72b379218ac7764004b0314c2527006dc153df9bdedbab0ec8fb33154ef20367117d89d8e65e873d", "8fd493f3d3afd0d8ef07a292de5aa390e4f5c184513daefa4e9fdb34f05ca7ea1c3633c34b620536d655c6494a7b4568978f6bf2e33947f88fa49740e203b0d51f5a274854a73bbeda0a6664bd27b8338d2ffa3bb94ca310477654ec53008fa58bf38fc44889a344d079eb8fb552e73dd09b9ee5b6be4708ec73d57c6654a1540c061a72b4ca4097d8cc16a0effeb4822714bd1b4948bd8cab04bfb210fbf5f20e4808536fcccc0dc8d03efb7f63fe8f0c4c1f348d4fda5e484b8f00ef404bd405d195b298a746767805627ec78a72ad500ff040828c5e38dbcb861d1be80e2bf386ab885e0b69ceeaa202293e307c9e30e7101d8d5b027a90013b22846868ac354aa15c2e43f781a199f1e21ce268c21795612e78187c3bad7a2d114a31ebdd5ec8a1b6c7a278cf8f00ad214287f1ea69cdf408f508056604974bc66f9018a50cf10c5cb81fd47827ff3cd096f193ad0950f8183e609376c56ff13516960da9ddb3bc7b060fe47c8573c8132f754b2e414b8ff0dca7a93af145f8372421877d0376fb26235b2e258ab1d984138eaa7813b096f672221e7aa5134bd6be73d6e1d62ab6d50f435ee139edf7eab45c4d85", "afb339fdc59584d4ce9514baec36c3de76fe8ed4d5f4ed7c3aa92e81a76f6f2206ff8a1c0a54f162ddf876de79e5dbc1b95c6763b10b3b6e8f444b723fce73e06962d41c178f5546c16f03e68edfe2212c15252a083e8cc0ce968e9c49cf8f88b10a226a25d50e79b32404606cec522108686b4602728e723a6dd636ea63ee6291c5ea018583fe4069cf568e4eda34f73876e3d2079dff61c6942850cf0bcc0a4779bf3539b6de151b91a3ba90d10e673cf92e55c4d2ca35013224098cc766d83b414cdf11df6cbfc26c5b2e262950a00e2af4880c1791d210d25c7a2139be7da7fbaf60221d50d41053dc1b616e986728f8b45e1d518e6e570f5650c2c072d22c0b8c1ae68d2909944b92eb9178a9ca2352556430a03fae2eb1e9cda69103355dcb8b7adc5d2f1bd3d60f85f5be9e8c40f6169207d92ede6209d8f0e3081f4df244ab9833765fbc83342afdcef4ca92486dc0a5303dc7e96e73003dcc16e515f2ef01ea4c7d3acaecbf2f4f12cab1ce1e1283c458efcf49650022ab85557e39cadd6c320cf9c506686c4e62435ae232", "ab352d50f4e47be1af08353a65fba6c9cdb34535070b46561acecedb2d4ba7bf49ad4a9c57e529254d7b5752fe279dea8a972a12bc90a9ba6280912591bcd5ecef38b97af242c4ff544c0045b1d317e92fff71dabb6f7ac55d31876af05896148dd611c900a442cfaf4324aa7aa51d9b4d4fe7b476b731a0d6b9706f0955580005f74962431146e406ad0119fdf2389129603fd515d8d4be33b1ab24cebd54e9cf14300ccd78d411a4dd0fb748427d040716763843462b36caee3b923882e979d8a613cceae5bc0490115d5daa46986a012901d756c378bda8f080dcfaa4b3d415409b80eb6a2254ecb9b551669d1fb6109695add3be3c16417597e6415b2266269909a20b5296dbef7dcd1459f893e318e8825ef00a8d4d33df7df5db0c301e4d965d1b128be6901d9a93b00aa3bf66695fe03b80a94ee7460b19ec748f48e8951912c2edd900d948bde8cc350553502d35569ee1872db5e2bc6596b0d7cf76abb3a29e909c3bcc69817ec6f5c09a64", "8cf011649331951f4ddca523dfbb2312cc469de9b5e36daaa706cee3ecc4caee0e95f6e70f988cdece83bf200cb28d1083e19c16f54bdb9f68de439b559c25965e3405b574d5797668608eb3dae289c0e84ab94b193c126e032389fbaaca3b19a2ad7f15137e3714a56e8d083661efe26e1f97e59b39938104f809cf97f58dc17af9d1cacc53f1f564d8f9b3b8bb36a751e9ab9119cd53de49b56606f933cfc8c1af7ba8b27ee8b8d595585588ffa67e5cccdc7fa548672c18236f2bdf0cedae6f0f8f7b972820f0f108d7b57f2615dd3c8fe0d287da43c728a7831205465f1b889f3d1de48b765fb10331123fff5a1635552a54e784a2c7484a9aa1022b3a58c42c783faff45fa903307b2b4d4f6175076f9ecd53d9956d878971e02597b9d610370f881995e7dc9acf33d97805d1d86edd2b73dc8f924b859e9f9b75491c28019bdd3215fc8e531577175b5a1e5a6f"],
            ["8cf9b658af7e59c4cd5e54c287b8087eab52d3d50cee52481cc18de6e5476a7b91f17dfb9389b43714b7d3c599f0a4818b875056322132a5d46879b871ae603f4581533cddf358e8fc9876c042c8a28fb93f0a2bcda4b5f947aec559fae49278b3e64adec3c128f89fa52028ebe54d2c1f08e36b228a9a78b02e32cb69c950d7ae1d0256d90e2c7bc0d194d261708666111b112d0864880eb90a8656d0f3ad67aa737f7bf416e3ab52a06c5f96d152b06099de761a538a29ada0e08f02e9ec7c3c8bafd2a8766a0520a1a25c8103cdd90fac6492b494d27531e916602951292b1abe7f3f8dac6ef92e5f3579c6fb03d24256cd84e32aeac86f510201455f2cd10d9644b748b49906afce9cbaafffa5ac314b8525cdc640fb07552d730db9e25cc568e390d9576bd842288a2f5197e6d472f693f952dca79603f7df62eabc9c0f2f3d551d45789745f353bb0e2a6972cf4da67acf2e4c95d663328b89e4aceb2de53a6ff4a0582ad186781e640b2021432702d43f8695e95c60082eb1ec80c4680c0078bfea4d3cce477615dd14c906be40cf7bbe9d02b5cea32e4815d6acc4213ee729c4c2c0113c13d5e7a71dbf71a016affcfa1eb4d663ad436678fa94b8f4d8e0615d965f913e63c0bfea978909ca5931b5b3f81abcaf3d981a70246bbcea8b392beb57245577d3d7207c0c7f42ad", "ac1c800c79f2809c9ff5d25964811f8922fde7686470138eee3a5407b4b32c3b4ab1759e88a4247c2a1a637b67dec1d586e95fdc1b27d173595bfc47cbb70cb293370381c6c33813ab7deca0c3a040b932c69e2b5be79e103e168895e96f455babe25dd6f6492956bf8a842c1355e700ea0dc97e70dde7cbc3df59dbf51f70481d50131601a83a8ff7ba75d55863d70f5e815faabaef81835b7026172742ec34f8534cf23f3b17b0a3a616ec519f657d502e7bbe0df9f45b6b3ead3047984d51be1e00bc7b5c460ab513d84be9cc435b2484a597aa0f93965c5ff5c4636b19cb62ffec5188123254692608097a9845be68faaaaec0b0c3b649e4c0a0a59c41e8959af4bab159771def4f4d5872ca26fa0dc8ce53f821f757a1646a9fcccc1315286018e8d4d64cbcf804163622f2b8fa5081cd5a44fee9b7d77125f2be5f2e93ce028cfec726976313dae447003e94bf243a34103a82355da0c83084c0eb4448ed683df730a7c7045bedef43a49dd28b30463b64769e0ad356cf0aea37998f81e4151cfb6efc97eeee355c63610a2b91704394fe47b6d316ce1c6bccf682806bb6c9188b8aa5fec884e7923e16278ac52708196190374cbf88e233034a0886ecabea70d1ae98b369259e1d0c3f513a22", "8de283bbf80ced6cf7d837154c6a110c2a18c19c59a0c2ef79ac78ea4ea6e515e7a54fdd9fe77b59e9f7dcfa77a0c0b789bbedae3f592c1c345c03d1254566d45d93852b764050035c8f7615b3f477757fdc3e2003553781b7b1a45b9c12c2588b88f685987a4bf72839112a81c67b32fbd5911e96a28b86fd2d3361e8306a4a4f1388e58c1ccb47d1159dc7cafe41d3606dd4c24c6321939daf14921a8fa0208fe051d511d2b36f1363146c43f2be2945b4eccef961dcb31166c93a14da1ddd40fc45606af2baa17a565f0087fa360d736e440a4a045a20dc827ca100da61d8e9ae55d3c5590cc5ac3cba1316211fc06dca2988d34f4170643ae19987fe8c8cd9edddea0decede9eaa582fe534bdef64e4a556df6934521402b303564bd12355cc93c0e71887154767ef1a8386245051d3c8020a06c8243b3dbb5c8555746cc40b097e8e6ab0c2106927647a2402a2a0a615e0d6d5ab6d6fe9923cd0fcf6e11a06c598f1abdbc1fb7466f8fdab5641d186794857b641bdfb000292c89bc681feba08b52c02665238e9d323c051523573618ced0c5b3c95bb580a2d9312258bf2bf173233f132c7bfebdb179a525ebea", "90eae3c99214ce9a175db7ef0b48080c4742b3804b74f5f65665434fa4c19bae283435679eca619bc85bc13bf1f03969808683a03370f31986d15a28fb3a90728228541912a691e3bf90cb8ef1bea1e4edc447303c93969f799b2eeeff7e2066aacad899105577ca7e8fd64918ab38470d9d3f4cbeec50a7efa01ddde8217b7222270a3cd2b27c5f02550b0dab72ff12719a0c67f1b892280b780230c761ed1965ce4a65be48f23fdc97d037e8799b96358b08af680bf77f87b74244cff0885f11241713c6d5867eb8b8418dc5f6dcdb32e48605fbbc99926af505aa6d6a49f8566587bacb5e13763561ff9191687d0b104d4a240d59c88abf07bc3390cc2dfdfa201a72bfa2d6d5578212ebe2e50291530be83bde323bb69c6c6212c93b4741a107c906a1a0b81a71be586a3412b6f23ef25bff1599c311923642fcfd5f8a6260d95b3591b39aa0ffd2f808f13357e30924c71c278aaec02b6e3a6a0da486653155fecf758e0757f6b8ac0dea7ffd3e5aeaea19d13b7c478f3ebc16a511731bebbc30368119fb8c83ea9a468b29ffeb", "9785f30d0f0c81e33beb4f4e506a19c6536cf7cb61d42ba16deae2e64eddf5b17a92ee8cedc656f028424a95c1e1865197d9fff22446622a56202bdada28554189b16a5ae93e06a541a563fd66f1cbe6cadc99c0b2bd9b88467654c26be3725799b9ca1208b195c895e58414e788e22cd3e4ac41472950171dc13a9d99979c99ab0f3f5f5d670df12e248d3da2db50d74a7d796fb0bf21da353e9cdd14b38f1a986fed5c15692da818ae5b6e991b6aad13884b80760c207d928fa209dc80b112084817a923edad9750622d71e993f63b1ae2c4507eb2d5cb85159051ad51c04bfe7145f65dd24c8a8f0d40ffa9a52f28154535000cceb1aa60b26d54346122524e601550737804202bbb0861d0555985512cb204e35fefb94f7c1a1259481505ef2a6d791836b9cf884a433f5124628829a922bfb67ef7a326f6dc11e78b295b79c93e319152ec5cbbc7f2747281fe3950f19294b5bca3c5a77c0548a7d460ec608af7177134b0eafd8b1e31a1cfef65", "b316f932891926fcacd1459dcfbb9b222afabc9d24fc80da2518553e866b2cd8b4974a1922ee0f22fdbfd0e1d31f25679406e06d7f513081b790db6b043bc41319f36cb218de92bc31b966cf06d65bf5c1e21c8f11e8eeb48a6ee55b24b2684ea832963edf92f2c456e0404b6699d6b3c7998419eaaf9f9ab246e241d2a1609c396510dd8447a68efcf97ff6e6b951c717b93340cd91551cbc94613d09a335abfcef35c96cfd1651bc122af40b6c927748096f7f768295a471148e94d81b361cff7b45507bf141cf7902f837503f2f77298216a286ddb4dbb484066762491a1f30ae50b7ec075b7af1402a9a8e66b10124be630047a7ad2e628e3afca56296db2a1488ab9f0d3877993f75e6ecc4c9404437a7bffb30714da012b5fe21039b763604f8f4fdd2771d514b221bd5a9abae12842a43211a5160129a3ffdd95e9e5faa01b7dc5c42344e18d00ce915b5f66c"],
            ["ae8db11c89357e902b7f36b0835e083a30885b767aa904ce9116c1c9ebfa06f1def206513faba436ea6929352983db02b8cb1f5cafe8c7c31fddef1154eecc0c5c3fd5718aad5af44b52105482608ccfa598ce2d0ad697518db16cf54231c27c87743b8986b4bd7406d16022a94bbdd7885b3e5129bf423c3187fec3693f8b006f0196b44c0ffdae42e0d26eb4fdb05b3b0581403618108326a3fd5812e45c5d4f1f85619081241e016004c865fa3d7a5ff6cb60598ec5b7fd485f0e5895ac1ef982ea8b79c4e03b3427efee4a1c42e04735b2d2ce20ea8463d32b062105817a15ef5e50ec43ccc9e26c36ec1eb746eb5069b19cc048bb27af09a8ee08da34b754d772d12b95ee316738820fb9d1c4f814c7454ba190f2912f73f5837785c8fbca5107f3437da97231380f1cd108f8e4331ade80bb1567cad113f390cba2ffb96062bff58815cf5ea497d314e85092f269dcede61a9c078bd7749d4ff611f42b981a3ceffc3cfb45e710f9488489401d4d09f509adc7d17c24f55afcdb3d137272ea393aa0ef76799582c87149564e8a3d43adb65c8b2243f9ddd4e0e993624c13d1d0ef134811dbedeee5d3089ccd6928276e64d4ff27a5ec6a46926ca7448635407c3270e3f3625fa82fb51559e18e06c27d68508b0bfe6a7b918605363a2950378ec4b0e34a13f13af6091d63c11b", "9219b6349c9d980d1b2a373b86795f67efdc1d45e781309a41853f90323e518d898282025fc5033df249cc4a3d67ed0ba9c0aebbb6bf4fa4209e1c1d3d69de6c59864ca3eeaaa28131b881e95af8ae76a370cae336a671e8d64e6fc1ffe45cc5857ab090c2367cec17a8b2fd5edf71d0bbbd7d44511707fb771620f2fc4302a2f75aa8376eaaaa9c57ecd7c2b61de28906ff1cd2c68dbbe91cdd3ae75ed3d4e1b5f773bab3d859a810030c287601604c1322f57e872f993b97ae27546c07a42a62fe0c2db60840c484e35aa43d52d0f02a86f6da48505c74a618217811ca184e5ba9072e935455f7c436392387cfd9c338d259f375665be27c699b89b5af91a954381a91d2dcccebdf7565f094f7307d49d2f1dfc52acf4bc31ba7685198932edec2ec383990dfe172e01e9b336b5a3c3209afb3034c3dc9ae0b2b31581b1c75d7e6a7e809862ad4982dbe9b888954a55024f49b1fb0fab7d461d47fa2a28e895d7384bab8b37b8e0e0561c054560bb9228e9d0d55b1faedf04899ab815f86185de4289fd9735780f8d73356e87b80ee041f5a778853f061341a085cdc75c09de57b7d564aa2155fbab669730183a492703c960c5acd144e050256ad40b81edcf681eecb207f580924ec5a8257963ebe", "8a2227ee207dad59704c84a155277c78c78b5ce3415f54ae4215b5b82361952f02493f4d7c71cc032f26e30535d1e3aba55b134dc7d029a8d3973d312bf6486369a89d648a5ed176687857c692df4de9a80f9d99c1c41b3baa4acf38e329895b8d81e8767a0cedb6ab829acc8a938da1cfdf708ffef69c58653ee55af3b96a30caac1a98c2d36d708668d27d91607e7d731b82fa2ba24a80b3354b3821ba1e0ec389059e479099692c3bcc8a111fa67c5d778438fdb242247be84ea16e991b1ef261b3b16b41b3878815cc1039495a8356c39422af87da7391e9af3d66b70240933c3f063c34bcdf8e849b84077623f53d057f1157404b374224b81fb41c1f7a79766670f2c77429b494adf500878fff0044e3cdfdfdb9865549ebac44a6f3b25ae6a3969d6acedc165d3e7d694433b0188b7552dd3295392088d574dd81dba75607495ead331a50a27583a3a57d35182029ed37b0193cbf3ec150f718cbcdbd838b00bf01a12b0ac6adab3e204ef1d0199af3f665adc6f7d09bf13d769bce85cfd83cd359666ec7f7f5d7d5921dfdcb66ec4fb0fd3fb842e83ea8145653519cd5e153784f838f8bd8daa84b76cbeecd", "b20b453bbb8b57265890ba783af7676242cda2e57dee3554bbb07171612066068a6e8061102202e7301a3daf9451f203a1ff1eab9d59405c5ef1ac3924a7aaadcad0d8bf6e1d810f9baec11b8079875e8e654b03fec6fa658db76dcd11e19db4af55d9242b2b60f77eda4dd051f1d0b55828c722765f998ee64e44e27658f5afd46950278ed034cdd5c45744f47a237606fa2bffeb6f69c05330e9b61f39a2f0ee1fd0aa528010d6653b886b114b282a52c0d1bffe64d22aa34ceb4137e6c1a8711b1a5e6f4b6604fc3ef4e1ad34c0441c53efe11abd281f2ce84e362bca244296687052ed6df97312483b789917e38b137c5cc28aa9ec69bb4ada90c0ef8add33852919356399e693aa1720c5f7cab07175fac6bd60bf9514f20ba682e1c2c521e6856c4d38409adeabf704a82bc3c3385305f66a6bf01d00272bec36beefed77ef10ee9a4d5fb66847374601ea616c3c665c2b72a70333f09604f87a605c6456ec5c1f53822a01eb96fb4824f93eda2bdb7510304fc375e0018522b61379a9d1f32a551613fbabb0088899d29fb132", "92506bf068b3d5ffa6f0e6193b56ed1bee5210b5406c98d07af591466b36f46afc46c27a41057a338de522deb987446a89e8766d49aea23747203dd732e30b2e601650ae8b33e9d82540bb5237c3cb5c1778a5b0198485d0d55323fce2844ffa8cb65032bc5bcf210366c35e8ca8105ddc4d9ad0ec9c07bc8f812c7cd62ad00d60d8271e2fd2f9d20aed871e388e705b00f297db8cf0874e47ab633458d4e82aa7a9709a9bbf4b29530b672f435acfe2007c553582601027744e3b8866cc56e8069d9d6cb54992bdb14d6479eed036da1cf47b0d3dca090805dc25d63b6fdd0ed15cac57eb81e0f7435c54dc9c87963e008b12afa364706db73fd4ce0440083049a291867a7859a29906b5ef222a3c0a3772cf287572e118a0bfcc0e44933fb22203fb3aa549e423d6cf4f9ef6d15a7d335f954a6cefacebab177c1ec60538f3f7809c0e3f5732cb5edc7b0ccea7bc9e54b32181de73e73b4aee262093f61fe3e9a8638d9aa56b7dbfab16097ace21bb", "a0ece0b39b65e3f7b3da71cc91dafc23d582f30068a16de817787908faa35f331bc69e607b0a4ab344c94ad399febc18b7d347ba97557788db3b3ca3ea034e13076af9b13b216302b72cff1c2464945b991318b794cf320aed99439dcad2f079895f2b60c6311a29dc0a1cd70e37d2cc522966496edc668c8f9b7d533197206bd5970fa6eb7c60d4310b347f5cf7f0882507428b3c6093a6bc06c3ad630858ac401bc11c08256deb2cffbea61452f19c6a77e7fb2e055e8af58dca69a6e80a60f3d914739f2d77d303c25fdc222dedd549d736ba75897be709909a9dc8ad8fc2e954cba3400d83404112a26153e31e944bea322059a3ab2c6b2eb82692210af726d6757e917bf7faf5f5f39f1a62c3ce6210382e23db7d4c7e9e08d6682029a06b82e7dc7d2e486d5bbd1da7700b405d6fd4776990e8d7b7b362db8812571d20dbd30d7c30c97a83b08a09dfa8f1b96e"],
            ["90973e730f3221d58a1fff8d25ecda65ef624c3a7768a34adac22ec610371c5b29d6ba5089f135765bd24fe0a5d1b4bd8563e97339f487fda96b9b388e28baec02afb1b96874621c876b926b05bd2db8e33f20acba453dd7a18504e59d7bdd1e98bb8ecf99d854c31d69bbb7379d5b67da1c2853b3ed87a937b3d62c4583e891d031aeb587801e75744e780e81a3fdc402a9f79b4e12c51c90918658155fdf2c0f898fc7cd27fe5d4d88ec5e991c08c528f9638f9b52419c9b985073421fc6aa1d4beb51e9e985b153f87ef924b038e771f32e44c792024bf581561ad53ee5eda88a7aa30fc36cf7895ab2e68d665a282aacea317bf3bf087ca9052616a5eb518e5b7d61dcf90b7d1d5ea3ef11a2a7706c1ef94b8f1b5159cfd2868dd712f68a2387109dadfeddcd686d3366c17a08c972840d791dcf0ce42bb2a2409d1f66927b5650318588b810be4365db98b8422641324b8d4cbbdbb7b25c51ee3c2ed959702a8e9a8a95dcd26d79d109a529a2ef6b76d21e425874fec77f51db878a4a5300eb9d3b3ae26758ad21db5ee01be0d456104ee8928bd8ae155f61b8f0b3de212724200d12c84c19993e3b2f661844e432226b30b05814b9d5fdb1ef07a138ef13969bf145387a10ea1dbed3b2b92cdb67bb8be944c07cbd5a6a0df3fac6866378bd51765e1fc0d47783911b9434dabf", "b62e08291bd35abb3eeaf4c92e0e0f6a7e813eda714d75df319851b675914f58c4bae818434a7a9c40db12fba5952333a94bb3984718bc8921fbdb105b6289c4f89ca93a4b6a79fbcce0a866a9e0ea63a7a2602f9c9dda12d4ab67ee10640701a8368cbf3726ce8b2abaa6905e96e49c43cd30ab616e373dff478a360a87492e4b16e9f8ff9d5a8e89c7ff75139eccc0529f30f06aca729a5eb4774519ec6c25c29c1061ef5e80abdd93065e0226853d56552d3e4db0c56b0663bc9e2c10a76d03b01cc2ac4e797a384d277f7aa5704f56f0d4b14e166fa927c3fea4ab8a7122c6ae6f8529d0082b7405cdc2998df31230ad4f92aa2a34e9a9f2768185f24e4c45328af6e6d404a4278198e4b88063566688844ec77d948b0b1e6e4744d8236db1f474cd181804d1350ff56e457e75285ed3b97e51e970b1654bfef8bc4088bd245fc3bb3f766469c4df505b57b61b50189d4ad75a24eada3cb6a3667e569fa597f084abeb7c4d3a7d724273056d896143a8e20856bd619244fe35ff866921b4eada468af5f5efc6324c6f94bf510b43018954763e060d72ea7249542703b104d702938579d7a5543e97e17c5036ee9c72e20fde2f27e75220f9617fe5612a4635ede11c4f83bd4a398422c2020f51e6", "98a2e4b16c5f8e86c47b2b8d6e283ea7c09292d5f2c5df141a1dc905d53378a869bcd7d9255f4f90d7bd092606d17786ad18bd946763a38198f6df5efe70be3d8b413d1808e0292c16b25f3e8fe7b6276d0355a228a8a50af843e490fd906fdb82e6a3a98b5a2c5264509dbd1e5cffdaa52e7ca627bc6d0b300c80a2e7ebb394bb7521fa673d16c2a80a0ef629e0c68301e513e7b3da2039040b746786078f2ddddc552030796b98a485a7dda9de81da3f69023452c464b8e4ea639b00ac6fe1752dcf4a00ff3089a1e105434d9e9ffd15a37cd27e9605c15fdc58eb3e402bb077a6397ca9ba2b39d3f8629237559b4c2483209a39c44c229989ffc02d58c34c167f4600ea9cc1cad199b36deaede3134acbea7aa0a41bac85de8d7b18f6bee03a6e9a8593462e4f00dfac658bf838905c6218f62e913c08fc0886132a566b6fbc67327b329a0217d9539feace9b1d825a383db6ef447c5eca68c307c6d4e6d0e77ee4fe108b571c8cb1ebf7bf2ac33408ffb8a0150bf12c629bb2ff8efbd11293bfe77faa63b23a1f40091ef6438141574ea289579e7d604cc918ebec45acf8f0e6c116188fb0b9c42b3f7e32a76051", "82665cda16ad117f5acd35240eb4e6cc06108d9270d94f6b5b1e08b840dbe6a18ca2737825ce148357870d5c5a7d9380ade1fa358760172504ed16017d140a0169903276dda0ce7a0db5bc380eb5cf6e836510eafe6e72732b360251eb6581788ccf83bb40762492d93eb594c37fbe94c4bb7115ffbfa7e4a3c16941d6ca7139d9da855a9988e42fb81d66b77cfacf2d4f2a83878dcbf0e2e42672dd28f64f5e44f28b4ffc913263b269e6f58f7590571d73b8490cac114a6116771f0fdbc3bdb01df9e9d11edfda26b6a11aa731adec3772f3c7bc256bd1ac662223a28b1f70160c3c5da25500656701d7382f6ef1cb02ae86ed70607106fa3168477360d957718426e8e40a1b8f2aef100224d6e22b142a8a39f0d6f4010e75f1f8a89a4a6f94cd654db64dffebfbea1d8f3a915d635eaa2ea087733f6210e69523f060b8d3d1905f66330aebae7a715e500f67835b72dbafd20e3755a7cd88248fd1bbac577a668b9d8284c61b1e7eb8e41d80e8d767914e13a0afae210f1bdcd25a37381e3b2a3c2640e0d2c73144aa5975720223", "825fc88904ca53a690d4ede7f594660c56dcdf6e7605bdf19094b14a32e30cd3df9fd5699dcd32d7d4e30e92c65ffad48d3b12dcd17423812a34735db2c5d7541fb4f0e0b2605aecbae7ba5ef475d6f5b065c3161830419e2b395462c7c1d27198977b8b0b2000902de101b465786a5fdbf32c732d35490759c03be21f1a5cb8527f89228f2558b5fb2f0cb4e86d6b8d639c25401c6d2ee4ac62ea7b89a94c3250221d9791a9e2fb0dee474a442b82c0192739bbaf5cb6db2529ab02355b1e2985a71287871f0dce4d83dac09443fcb66e1ee7c40cb2cb3158111eb31ccfaecdbca2e1b0c0c44fe7b6237a0a9b5cf56f5d2cd1c11aa411eebf7761e8de3d6ea6451d9876e5ae56442850159e4f0d433a08d493c0291359ea2d445079fdd718ccb85d92abf706d4c0c44a8c325e1f7cc966e2eb0afe03341e797befff129decd6708b21eb4b989bd9c70f5dcd42adb6f13d7566ece61d9c26370ecb33ec15ee45a59876ebf26406a6fdf298101eb6379a", "8fdacf59f53a71be32a0f6a6af05d1b58a96358a575833d57e058faae6cce78e1a3e1252cfc98f807a8aeceb5fcf06ec8d0595fdd85e3e7af1ad71b5676c948dc94ea9ca44b76e527aa0803609282f8c05959d2965ad84a31cfbb81b6bbe9993a0fb5e8cc06e443b0e5df4a7dc26307bcd778d4ad5000c2be6f2c46b69a8980b5378d3242d317bd4f872b23b8b13aa271689fd2f01be221fef564cbe8d555817b47fafdf0793248a75f5713c167190b06037e65480c77d202521b26355ae0ee08799d68804573b8e4a9e853becab1b10685abae81e312b30deafdd9de48619b88a7d3bad1c1d5eebd7819d61e55a69343af6185cd3d00afcc7e21621fc9f29bbba7c709a46d8c5bb1f1ad1d6073ce4452d6829bd6e042310d423db2194fa0826d44fca2359fd44cb8d4718364f9e75d62069a8bce7918e2a7f039c58115c44a2f50d796ea1b0c5b6929a419b17a16eda"],
            ["ab271dd943b3f938ebd27c4f4bcc3a12ea55c2999418fae0551157733269b7cedbc71f99daba527b585801a117b1d14580e9087e5a0682974ed1344d61cd0590ed024fb7088e2c03ad954fc88ec468613f14077727e264b69fa08133847c23d5a324574d07d37d74a6c646eea13bbbea83e6f7bf0580e5c4b5237c9729d034e289fad1f9829700ef98a6ad07c4abcdf65b31a0a42990af74d683a6a7d5e9dab72d42ac87c72fa0ca22302925bea6fe1673062916e43db98419a118299c72d954866ce5bdc499f2679efcad405cf794db4e9720b4ed3e17ae02e7d75703620808b53d6f54745c8d5e51530b066b80af18134c32daff45063e9668a34fd1460f7e2b45409047481c9e7617c962e7de74366e7b6a5986d59cc9525ac561be433f731b0d73465300b5ff904d0e0e49240fac52b5b835872355bf834e1424290f29737e6abaea3450d9e71fff60219122c18c5b03cc6f879c69a5c0c94083498371455671c5c425eec524443f60d3627ae5da5d6c94483f16fa9eff1915beea2bd5c7096df33f518dac1369a23cf1c3c32c5e06f28df7bf4e3f4c23a92267f7eaa881a3885e5b73df44e6e635aae2f70cdf2532eeb3e279fe1c454d755cb8e932a57d8b0a88e361b58737b57126ce0aef12ae47f445c3f104dd2b86bd2ab55ead29dbc6e66a0504ae0caef79568429c76e3d0", "b52bd46f41353647cc424ff923dec89a92a63c53215fd51afec23bb4906712bef1c3c983858751bb6acd28eb1f1b6bb4a1c2743ecec36321aaba780acdb77819a53118062732c3781a0d20af0927d6b04e01908b389346419a34f4cbcde8621e91e27bee53775417c668ec1b0be098c3b23cbfc0fb7692a9938bd704b2c094d6cb30cd21566c103a0c39efece04972c80223eae8318285b3a3f83cfeba9045c0a983c54a5898c7d6e6ba18722ba1f3951a3af6961bc74a197945db65464741dd28d19901f7e823c398f0cf112a20f545102afa9053b95651f330bf3cefb34d4ca1000465d605bd37edd38a5744692074381067f87fd4208c248b7a3e953ba4ddcf79b4084c459b527d587ef99a5902184b34c25fdc46659f9406c779fca26657ebcc61154cb9773da0cf67c01443de371cacf1b804a45d7fba16b636849e69cfd33fce7594773cfbb8e0d7a55622b2f36a1a14dd0e3bac8fc323d0f27ba12f576b382a048f419bd46fe3ce994442dba12ddd7ddf550d7a6a152f2a238ec49a6575e62f3bc6a146cee5dd7a8b02c6842b5231caf970fe507efbd5cae28d9b3b666ab8fa00008ed9060daea0a93b70055114cf416d9cf7825f4e15241bd74877302b4838559c76112afd5a923e72073cdb", "89e2ffb69bab3d93022bba8ad039cead1fdfbf3ff761fd73c49a933419d0bc0b37c34599454ab27c2a5209d54541caef87228a5396282d704d5149ce8290218fb43b9fd2130116eeb08f81d3714e6850254c0d91a710eefbd563878df9bab677a285c8b2b1e3b0cee1580de7fbb0350c07dfb3858063e7cffdb325e5a4ab91534301940c0d73fefe7cf1b32bf7cf78584bb3b12804564f7733b2511c3fa298f84398006180976b19b006b9a9ed0aa6993619749733c3308e216803a3e57698b83bf02fcf59780fbc2abb1a3470b81d593efb1cad42c12ceb933a4e961566f18cafff6cebfe41479cf39214bd074f22220ff7ec4d879634fd64a620e9e374a3e85bed7975eb2e25a2a68705e0229a52043e13ae2a530c919ebd509c9f619e03c758e4afbf0ba0f0611cab24cd9d9107f00f9d0f84537cde0d2faa201770bb3eccae5d83b55d268c84512d4c3d3b0d0e780de7704592eccc88e38c69af8dc0dcae8362bd40e17f58d14c5c22f3cbd08e4149b15b84e31fc2a29891c1aa8d68fab14029a649086783440e66f34149e1da04679dcad5b825eba3b34cb813c7f61f0f2041d0d4d503067f392611daf354b42c", "82a971891c4cdcd27e2ffba98012e44d2be64d8b3875fa5953629cf0f4c7c8de9401c51aa69fcba3878c0aea596b62958a6fae5a3c50096687e9f8f390cd15ed791ed9b0efc0620fb98880f6c302755a6f6243a91b4ac38eee4dde9db74981899625bd4e085fd15fff6abde6effe27add1b4eb06d1effbbf58483d14db5e4d7b447bc0571ea59182fc0877fd477d442111f1884ba8b56702f6e31055b103ae0d334fa7c2e3ea40d25a7d0472dfd978794ecb49c22dbbf7a3ee78279fd1476222a76bdf9d707a30788169d77285fdeadf07e9492de4108b4ca5f9b735ba101af10337ff0ed6e3c36d8d4bc0a476b7adac41459451407c2602d25cd5beed13f03d740064c93ec24083dd4d34dfd150014c3f3259832fac207943fe6ba02dce267e4eb9794a9d79cb1d00f6c470d63f4cd74fb9c092cf7248560020dbc9572417d8855d9ab92983d818820543c608a07d6b6cba082b99ead1bf790bd4ddac11f418f4ce89cb8e264d2e291f826556112de5655148b45df98bda1f885f01ce6bdd00d0997e28503c98b2d1a1de0e52afbc4a", "8a60c06a9624239961d3051949f5dee740edafbacdf4bdb483966b327328994cc8887f90097ff541962dd6182efbaf1389ff718343fa7ca1070096eac8ffa2e5e28d2da204cc17c7e0f7a387fb509ae1f25acddaf3403997ab7ed6e9ab33424ab2b159c02302715c48cd4c86c461398c190aad7da426392997ae81dafb3969d4b942b9e22dc7ca342b7692e47c944e2b33266535ffdf1bebf6152ff69a9ed524db2241f01a904b4a74ebb61b6059b0326eae7c059c1549961aee8d0909a39993b64d3deb951287dd78f9ab90c8bb433f114c4ece379f6a73290e4c551e714d85fa283173c8fcf50738a0860c1ef0a59b4b4054246e1dd1f2e559efd758a215cfa6cc0b655e485ca8e88132065f1bbf7e293152b29fd8fc6dad5f44b3c87f0fc280486b9c92e996bcb4096b25d8f316f96f3f3fcdd7f366c385b504bc7954f6fc6b69fbcc16b92756f980cd2dea3398df158a7fbdba3428714764fdd5e994c3068f024408aab9258cbbc7b6132cc3efa4", "896ab1ed0de83042dc71e6e9f9dc2baa7fea02323d832659c068421972a31dd4a8474ba7c84b64b08df86bec568dae798e606bbcebac946e020d39e8bb1e252f66db6f3649f6ac723d742db69955da560bc168c21a218475ce61b7b7d422d8f994513007e080b053d0600e0e4e199077a0f5a182af9843773636c0e13c55e86dedb66f515873cb7d090e2fe7d2157c374b607015c091391529f75390edbe0824f17ef603a980b87a8585f1ae8330897b35dd67856063820fb13b90f9f0c9f174f998429e0075250e93575ca37b1223d116cb5a622304f960bb3c1951712f5553088e29555dd672c1de82b69e026f91fb33e84196650bd38e0103af3f7dab590ee118b222044b644d28e41077bba5089a1943d9580dd8291111e4deb86b26fcf3d213b41bc95b50664b13cdc092f3deb237249363674902cec885898159ae2b2a3e3af87253f5a01f6d93da1efd6ec7f8"],
            ["975d7a0a816f68dfc14c6cfd793652a41793a127410b01d6eae048af7a119d9ebd350ace00221517e73b52fea143448badf1c63be42fce704dc56aa93d1650f169fdee331c0cf6643d56acd37abda78a85221ace505fe92a66eecdd56e0fbbabb3a4c235068fd387eb4a484bb6ec70123eaa05cca865afe0cd8571578b8a61ecb16b42b2338d261e6904ee5c05731a426e5b5ad6939641282219c534f4d15001af8d6939e1cea8be7d9ca84962641d1e44b4eef5286ad3acb292634bef610d1466da7eca35a4f3285df9b3993520ce5b25c32fb1295dc9efd9834cc4db1dec6b5313ed4bc483c66b576a3e1b9fcdfc0858884d262530364320355d3f8630de430f2066a28c440f6918de873a562befb85d130c17dcf02f1084cd716ef111a750975b1561d04df0ae96b5f239aa0c2e8909ae814130ebb291d0d0a69c53ca0fca5600fd9cf92801693ed16e26e3805ba151b4f43bfc663ef4d5a4a24d71df1357adadfd31d94fe7aa28553ca8a7936796103bd1445b265d6c6215e04ada0dd42868a31c87554cff1f5131374ea80c726d548dd11fc6494c5db052ba6d020366c8e369247a8beb6718fa68492a13c35fbe1009e58805f0bb92f4ed69d53da80d1752dd91b795905f818d4cca233fd0c46d730cf97722aed7b3f12224df9849c2d5ed2ecaf9650b9a6ada419ed754da7857", "b1e7e8a2d03a59a0f7370116534e6c56d79cc4bdda091ba6682c711ef2ed3759728f80fd5412bb9096836d80f2214722b0e3b3bb39c75d07498adbbb4bcf594a250db98fc6202601562d05692c7e89cdef8bc02a956275644225193e6b5de865b9201dbaaf2de7fc04eb531138714070b26de3d16f15a6cef1d12c08e3ed6df070dd5a26493b1677ce0b7904db44d6bb3dd27f33af8c8056f9de1d928c346198bdbaf18ae6f5bbba9050dc8863894212586e77589e5938fafa7aebc07910e8812dc3b9f63cc365ecfecddf80d5cc47fa52f8a465e67cf05292e5e09a0d66374ffeb0ba6461700469224a6f0b8b63fc5427ebc1563bed22369ddc611513149b49d92faa8be12b0c37a45fc5a99a9c54cf14c0fe94dabbf783bacb8a05ca240cc46924acdf62a07cadc3c2271a2a3f5e096a85d583d97aa50dd0d2363ae161249e93f149bf3fa89261c0b1856b1d462b702c36c18abd6048537b0117fc8426eff1bcb23c6529e1a8fa164960a8d7c8279d44ad9e5fff4eb65997d2f85a1f215dbb8129113612a85be5df99a4aacc900f654b8b9bfd0ddcbadf93191b2b9fb131cd514ada6ca8b7b9fbeda642ecb7b37aaf49f91f6485a2b85c564782e64f57888626ade34476db13f4dde607bf4849124c", "8204e6a04037c9cd4a5b912a20863ab05e54b6d0f11cdf6c59616004681eb1f217fb4109a29ba2412a8a0337596d9edf8126226b498869f43d24bc0fe93cd2935d8ccf79e643b5e02a7149efc6e14dd9d357406948707bad0f715016ea49d2c1949113f263d2373bdccd8b08b81c67b4c97e8853d0e2e67d2103b75a45313cda5fdeedfbe47cd9ada0e5d53fbaadc10b699e7aaf835010accb56b17a6ac053a7b7be2e171bc8a4453f97e31d72f1eee022486f1cfd7900d6e10feef7d4364c51baf08ee77cfb3f7962f89a9c363fc1e00356a8754346cdb23be0a5c7f9eeb330cf395f623a7dbb925bc656595a64d84066a78c6580683e074c65b41d106ae36a624deca921a2c61d62f71d383aaeee8768c8de3d96a8c062b160e1598afbc4373a2799ed8cf9f1c84e46d9729760d0ca29efbc5dd0d24c6b24f4a3a253eeb0261f949bad507b9f858c186b445f56b2116412e6fc440e29eaa5efbdb99ccd4f9fdc4e6e051e97695c0bdf4af72907909e6edca091ccd0bc46022f75fcfa56eac22875637bf9f90e60ad8b3422c2a3c0de3e23d392a140394742ab312dffcbbafc93597b2e693b2e55311331c61572dea0", "856be1a85becd5306908d39b6336edcc6d4372f2233cc15fb64144fc1674d38ee76121432fc1e9ad8a3fbb63dce1c629a718aa93c2a746af10abe61d495b8ff518f5bb0ddc9ac96d3fe06d39b0ab19699f39068befd3a6edac0f1a944ecab72a915a028bb254032fba0ded359f1821b3fc4388949b429730e4ee555ee150af47ddb856caec94ad6b30105ad76f1022454f0568ee9b42eca45b0846c37d115aa3b6cbe32f0789ed9013c59986030d235545daf8debcc5704233544d8a06e92fd5959709a6955e8dcc1b8e616a45cad61714cef27ccd2f7263639968aa5c983f6c675dc360fd337d50ba7615d42155e6ec2b16d6d0223e416fdbddfdff583f37b3f2ff4f78181c76239b9e4166eaaa034f15f9a16d4519c074516d48b6f926da06cd726ad27efa7d504e64227cb9f12fda6d380f5e3412747a2773ca81011356ccc0e97ec22ba2c0cb58b32b012382312271185340e5cffc4a41c2bc90630c40050db02be445912b7590972ccf78447eac3b1b08655d2bdbf3b4557927de62d80cc9a486c0722e900579647b27f5a2361d", "b8bc333b286a490982513434ad0aad0fdc349e505caa28c6698a396bdd740670e8facf5d696ba288e9ee40ddc2d897f096a2605e097713addb964d335c9d43aabaf72f4315bf60a8513438bc16ed3ce7330cdd52797c3e10baf1cf503b92882885d31e0bde0b285f77a1050481200338607caba4129f83feaa952a613abb2b32055250b01594dfa1b0ad6ec969106a8814865adcb5cab9707bbc44ec58fd679623b85578f7ba73bef5af88205bc44796528be99e36b8f0389ad11a0bb030b08ae8b47e3be5d30053dcd84088410ed0ce54d1d7180646f08a5f31952edf5c4afbc50bb339e4a3db7b27db691034ab3ee718fc893c442b6165be2233afb487af7d47f573afcbba581b8f5676f2cf15b4bf68a08b4940de5f103f3051ecd26639d9536e7ed382b47c4b6576f1ca8d7e8fb12ef50b99b614386ad10f728852e813bb54f108132b40aeb3a31b39ab6f88165e3eb3b350dc92b18c52f028975e8bf6c323bfe398c94b2198c46944177a75b5b1", "82237ab6ce3bb5ec4f49d41e1c7dccf82d1ff4793f3b232a588b31fd4cfb650711940dfe22318c119160da2582d32033adcd83b990e48a0c733043fb68689ff8ce87b0bc6ed6a86e64c7d9e4dbec1c6557a10729f5cfa288980b96e3366d52c093a0fda8a006f3bdc174ce5b9747e4aa872a11890340ba605f982b687be177e428018ba8422659d64f2c39ca52637e3d3a2b5c0dcc19ce1f8c09388c7f3698364056a0ab632a98d9c229ce2862c63a751b5c0ef729ed70074789c0e412ac05f225d43f7ae6e81c02441ce19bf0c82c7300502ae54642dd3616c36ab44303c502eadb8f7fb2c14be22458b8fa754c839e193829753f206eee75419a9998e92cdf6227af3aa31779c3c11a8cd7635048b14bb62eb8df49deb2663002cd189d49bb4a32a55c2a1a71c5d442cec48c7f95a10613b3b20be2e1d30f3e2b52fedb8acb98e77fc8c83f770a5c10f91fc96a19a1"]
            ];
    // No presentation message
    let presentation_message = PresentationMessage::hash(
        PRESENTATION_MESSAGE.as_ref(),
        APP_MESSAGE_DST.as_ref(),
    )
    .expect("presentation message conversion failed");

    for i in 0..TEST_KEY_INFOS.len() {
        let pk = PublicKey::from(
            &SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed"),
        );
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        );
        let signature = Signature::octets_to_signature(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(
            signature
                .verify(&pk, Some(&HEADER), &gens, &test_atts)
                .unwrap(),
            true
        );
        // start with all hidden messages
        let mut proof_msgs: Vec<ProofMessage> = test_atts
            .iter()
            .map(|a| {
                ProofMessage::Hidden(HiddenMessage::ProofSpecificBlinding(*a))
            })
            .collect();

        let mut proof_values: Vec<String> = Vec::new();

        // Reveal 1 message at a time
        for j in 0..proof_msgs.len() {
            let mut pok = PokSignature::init_with_rng(
                &pk,
                &signature,
                Some(&HEADER),
                &gens,
                proof_msgs.as_slice(),
                &mut rng,
            )
            .expect("Signature PoK init failed");

            let mut hasher = sha3::Shake256::default();
            pok.add_proof_contribution(&pk, &presentation_message, &mut hasher);
            let mut reader = hasher.finalize_xof();
            let mut data = [0u8; 64];
            reader.read(&mut data[..]);
            let challenge =
                Challenge::hash(data.as_ref(), APP_MESSAGE_DST.as_ref())
                    .expect("challenge conversion failed");
            let proof = pok
                .generate_proof(challenge)
                .expect("PoK proof generation failed");

            let expected_proof = hex::decode(expected_proofs[i][j])
                .expect("expected proof test data decoding failed");
            proof_values.push(hex::encode(proof.to_bytes()));
            assert_eq!(proof.to_bytes(), expected_proof);
            let mut revealed_msgs = Vec::new();
            for k in 0..j {
                revealed_msgs.push((k as usize, TEST_CLAIMS[k].to_vec()));
            }

            assert_eq!(
                verify_proof(BbsVerifyProofRequest {
                    public_key: pk.point_to_octets().to_vec(),
                    header: Some(HEADER.to_vec()),
                    presentation_message: PRESENTATION_MESSAGE.to_vec(),
                    proof: proof.to_bytes().to_vec(),
                    total_message_count: test_atts.len(),
                    messages: revealed_msgs.as_slice().to_vec(),
                })
                .expect("proof verification failed"),
                true
            );
            proof_msgs[j] = ProofMessage::Revealed(test_atts[j]);
        }
        // println!("{:?},", proof_values);
    }
}
