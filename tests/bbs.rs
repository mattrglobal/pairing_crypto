use core::convert::TryFrom;
use digest::{ExtendableOutput, XofReader};
use pairing_crypto::bbs::ciphersuites::bls12_381::{
    verify_proof,
    BbsVerifyProofRequest,
    Challenge,
    Generators,
    HiddenMessage,
    Message,
    PokSignature,
    PresentationMessage,
    ProofMessage,
    PublicKey,
    SecretKey,
    Signature,
    APP_MESSAGE_DST,
    GLOBAL_BLIND_VALUE_GENERATOR_SEED,
    GLOBAL_MESSAGE_GENERATOR_SEED,
    GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
};

mod common;

use common::mock::MockRng;

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const PRESENTATION_MESSAGE: &[u8; 20] = b"e8gxekZpmeZTU0VDL9MV";

const EXPECTED_SIGS: [&str; 7] = [
    "b1a1f4161f41099138c3c8f7bb5ca61f880c882f48582dcc5d7ea01ba5eb2f18e38a65dad9d57b417e15f2c0711be5d005ff88fb36798e9bc5780d6107edb58e47b035970ac7380aefb121499c11edc811ecb20b37d7b93a1e0d6a97d47f7897fea95d43aae11080c2b6f2e892a02c68",
    "a7cf97f8c6552eb6a4a28c6a1f5e16bc2020f357371d6eb0e3789119fa659d521fea84ecad5eb1fdedf31fe62c38acb5180667dded9ebcc37ab48e5c08ec2928e887d5e61c93c62235b8564aa13f515b60807527cea3ca3221285a262089363a47f340a2d2fd049d6bb26e56d8506f5f",
    "a447267e407ffea34b14e9d05acc78d5655a78da706bc4cf06cadf9e225b07dde2f7d8cc7fdf2007a5d22cbef5832e326b71845f447aa164fa1444fae60b41e1b4c496ca1200d71d5e56899da07eb77456dc77f1f7915059ff5debc26a1127986ec0e9c94003d8970259d53dcd462cb6",
    "90283e4e93c6995049e0cbd80a426a7f244bf3148b82f3fb8da99462606348c9bde22502dce21cda257073dac430cc1920f1342d6f433a3665afb25a1a850dde46337bdc5ccdf746b1de0704db6a09d5080367a282872a04dcae7f73ff1cdc9ab6e562c9fd1d79042eae91bbbed71c7e",
    "993a29bcf0463ca6dd8722b90e80e7676e0ce7470754f9aeb96494b10e1e1dc603bd8767872c696d6e79cb1279df89e2291a414e8cce419bebd1ca30c8ee92ea3a94985995e4cee7305e9a17678759b763d9c14ea10b6db320e01f9fda80db6a81338d04f20e7c9f9966a8251e028cc5",
    "836c69dd0eb99f950f0f0f5133bbd4eb60f6be671e96487a05c45d16076ea83c59caf13b57ae6fd7135557b0f52ed36a3a2b68ff2e31a3173bc302f35c39c5eedc633e5e8a179d43a30987b4dd743f5b0abb47a140c31e87cf774d2993804079bb2f45bf419f519b01631bf9dcfe7f01",
    "8bec28568ab346eb86b63f0e1d4fb5cc788a9fb379ef5ecd9304886ee3f3e94faaa96495c30d9da55a34db24445910e66c747f6241d10bc684af89253e7c6294d155eb081d59e9f7a21b794a08e2fae31130d3e558354fb9fd1a5bd401b88ca5f28ed787ba1b30b5d12fa0f689540da0",
];

const HEADER: &[u8; 16] = b"some_app_context";

#[test]
fn signing() {
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b.as_ref(), APP_MESSAGE_DST.as_ref()))
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    for i in 0..TEST_KEY_INFOS.len() {
        let sk =
            SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed");
        let pk = PublicKey::from(&sk);
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        )
        .expect("generators creation failed");
        let signature =
            Signature::new(&sk, &pk, Some(&HEADER), &gens, &test_atts)
                .expect("signing failed");
        // println!("{:?},", hex::encode(signature.signature_to_octets()));

        assert_eq!(
            signature
                .verify(&pk, Some(&HEADER), &gens, &test_atts)
                .unwrap(),
            true
        );
        let expected_signature = Signature::from_octets(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(signature, expected_signature);
    }
}

#[test]
fn proofs() {
    use rand::SeedableRng;
    let mut rng = MockRng::from_seed([1u8; 16]);
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b.as_ref(), APP_MESSAGE_DST.as_ref()))
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    let expected_proofs = [
                ["8efbe21f3a5d685ac3e812501d8f6fe2e6ca522dbd723483a6cb5f1f9de2a861e1f7d1bf5fb5f6976e4e78fce2771e778c18f1da3596f8f909c5f5a6c086de7355f7ab8d96939c06b63337722f9ab599dc76f137c3b884772fe4987ba82a888ba139f143acd6a9afb62e021d0623cbbc76a4b651ba90a7a8ecdd8afa88ea785a15bdcb3252dcf5320b424560f5fff0fa56e9491d1e99c1f68977f77f22a900b354541346ceadb6c9221b41c62346543c1f5cc7d16ed41c26d665205d365ea1c1f786bd45cbe052556c73266bbe0ea3af6bd773750d9469693ed4c352087a48b3bd261f1104b3c3a46eb1e238b46ef05c510c570986be214159a53633fbfbab1e032fd4203ac7b00e1c3342e17b8c01ac653f1784af14eb8b7d39a0ccf8abd72ac91f3539fe273e9ff517e5315c39d75f50a1ff897dfc23e99081863fc31d36020efcdce080ac22abba7502a2be84e4cd4cb5e51ba833f4fd191f18503f318623fc3011e13230ad4ff134f16cec8c187f65fec6d7e30a47547d720a544ebe623992b52ba7ad64eb05084f9a36d3367213650e098676bf3e9ea004901c6e3f3f6091786267dd728ded99e660a7af37472731f6c2a02254970db56492a3799f3bb5055aeb86af2e73916e48b35265835a9028375a0b58953ac5168c7a7e18a8ec07c2deb391315d6e1f9124254ac3055f8b", "86793288b1e33f8544552ae4068907c6bc8d3759fa140a021efd24bca20d7f848bdaa5459c465c161f3dd766efef6da0a94bd14828d37d605eb0fdf087916b4442ceb3ea092bfbca0514bea2c46e95c3d8a7b8b3d66c5fa44d41e8484af4e57facc3e5760e53f32cea149b01db67e251d6bf9d1fdf32cd61baf54b51abdab8b15838271d56a62fdec3b39f9eee2555773b0aad8ef9a9219f459254da6b7ee867b462dd3b3a970d9f32212c3e25da667f21c259abb91fd2aee1d82c27c6b392a6e6423d502abf995444a834c1216e1bca035d1882247e2bea6fe35e248d32a9357bf93c1282f19d24670ab9a415e53f05691d1530ceb8d87bea30f60fd02c19b36e7d42be0f117238a293daca32eba5470e82ab7267e919a226aa05daf72aa5426f6edc7243da2867d138745a7579f8a216aa32998ed8668e36001a53023c02f858edfc67d3a09008abac612ae0b7b57609db0a4b6850398c9bd0ad7cd0f2a9ad68275095f90b7e0d2645e16b255dc0235962cddcc9a376086f8bd18f868b3b9f2a52194008dd7afed67147edd12cc8a6491118e0ae306cb650d0d73272e02fe7000d05eec3dd77d83d75b8e852b5c1db216cf3e90f949c98aec435a6d51660ca7b979d3a54ec3f8937160efba8cef26e", "89d77cef28077b003f10e24ec4ac1893f622876e26dce2c6f52dddc6251454b5c95caa945f80af71b451c33a5ff9465196a1c8514482aa618f9b875dcc4250c6dd07a66272d2eed9f989c3c6694603a8808b80d81c8373b2ee63eae45dcc8f1fb140ae320323c584f63624ae924a10ed32e43c8815ce906a104038cf1edbc2da9bf6f6b7385c5a93485ecdd13af933094877d69b2839532c62960dccc02e7ab64c0e39b618ef6baaa823cf069b25136c3f9addf55e71836cc252c11e9cb8d4aeed11d8e9eb15000410304218d85da4c514c9ffc63dccb82b5dc36fa114f820a59e509e8245218d04e7fb860309bbac7c3c665040cc928d6a11ead5cd6851426f85673e1f8aaafdfb6c43b676e6f34a4501e83aa81446eaf46ab435847c360c6266cff0d16b7d64cc573f4183beeb06da434cf9f4d7bd7d8bd68fb9f75ad1cd140e7e93459a8e10dea137a332a20272f92f5018800e5012e374d32945df9e0469de27380b672c27086b06593733fb762e16e067343dd62504d063534511c6bdb98c967f3adec0effdfdc59001ef2d4dbb347fcf92d3cf6ecefdbdbce8c39d69d6f00acae3ed45f7277aa05a6e80e45157", "8bbd74d317cb36ebdacaf5c66b4d5066780b396a5ac63bd572ec0a22d564be2f706e4179bc92f809376ec042f55a047c8cfa503f014cfd85937462ec2371ab2ca7cec24923fa0f829f0c70bd6da713472f33fe707e6e23a318938780eb37114cb5568ea24ca73b9aeb9cfd922d7ca420ecf36c001f3a7416e33ef04651298437affa2a460ab035fa60eabf5a01a2fd1016e785b1f499a57d11ffe03095e3868affc4df7497ab91b72f28ce35a466017d28e6a6059979b48fe9ca60a3d0ad3970c857deb7244a190c82c212d240bc56b416cbe077fc524cd123a21e713660ebf3395cecba1c5b3eb398f298f10b5759653063faebda0af0c01378a0ff63311ba22b6fb500d94184107ed310e7196d0fe033c40b6967ecf93c8441a6ec614b4188b7a8259db782ea42089e3379d9ba59bc2be0226bf47549fb5f7d9c17ef8b25b817df543869151286fa39c03cdf76e6a545bd1b2e1880406840e9cecfb84ffd388ffdf495907ec2a3f98ecef002e25e9a2eebcbc6b892e5bc300435004405772fb06277f5e616ad8922d3c6810dca5f85", "aafcb365e09ce88934cc3581a53f332be0fc8d42fe3ad8579df7b5c5aa72d9d91080a66f252b3d6f02d37e55c32ba5bc83577281c51e1ffed7895522bac02a6d5739e2d5c3694db9cac90acb4c0fe024493acab5d351d094caf864da14958c7faf05f38433407dd953c8c3d6b1f661ff6995182e8fb980533c2ffed1c473f30bde67e46591c842fbaf519b49b3a781bb14846cf2b4b6a39f29b073243a83820ccf8876fbfebdbc686708b02869fdbbe55b714f6adb904baa484e08752f4774d9654607fffb2af7f4c0a8c7cfb6cd64e36fb2e0e9eaf71bc6e8edb3f23a508bde1a92d66466f43bb1069dea8ff46255a4559ff9d84617cf6b4995f21996039c6d8e9b3c6df9329a08bebc5c3341eb9a2e4e21e7b28ea7f2b8050de9322a22bdc726e86016b9421516359b679c6b2a92a44dbc463f485355cbb3bb250c6efbcddcb66e19c89807a00e26accd9494879ab76e1de23730d116b1946cc9fca3756d1974f28f692e3a01902f639871400cd301", "8cd42e2c56450e37b4ccfdea3cb9e6a32b506188105fbca85075c7fb63f003f2f3ccf4ca35e6ee3e681c4d859ad38f088920d55ba1f91c7318d00de3cdd57af62eae2e137dd5533a79d59d1f3f6f868c2c3366d1f1224dc2235b78af93472c8d8861314efb492141e037fbc7aaefc920610bd2a8602f2640c247368faefc720a00f00ef351b8d0b010b9bb077d6d5305677c6614fe5488c78f10de5bece6d9a40c9c57742416f9ff485e9ccdf00a51382359ead6c4d9d69ac67888746762ee6dba3036f8eea8f29e3756586922e9a1c55e0a653a4a27e975e0b2261e838237e575105d98e7a942c8cbc6fe3449642c46507c41c82e5313364c9316716732e882c3a9d5ff6fcf54e760747c76f47029ea4a396b692d195a387f9bb3ceb82c4dc7673c568f95d89977916a4729f08f889e648d4aec8c87e081e0c177a624294b3814c61c91c938db729067a884829b0398"],
                ["a867dc2324aa0e5ff0cf07f8f01e122f721e4ccd3b4ce8fbc917d47b1123d83c3ac86c02a57ac98b51e3d9bc86a83bd2ae5b342ee311891373795d4dc5d33d99b960a77d1ce262a1c7cb18ea566df49b53733df1996ea697a5d3812a7cc3750ab9e5f400316a04a4d3cf4b4747f72452a2cc95a54e48247cb95b2ada694740aa5855b2e833d878d8ae4d531abfe0fa3d32868af595864f699c48e1c010359901d641fb3dd76e29b29f0de9088be9919642a3230d6bc0bf4dbfe865bb06371c6627d9efa75e0fd0450feaed12552179bd2a076919907a1be2543194508324914595c9e604e39664b09d14fe484653918d34fdfe5149655124ebf53e63c576748db606730b9ef4502e82df52a9e19ab76358fa969b7d7c5f47f6c78e31ddb3582cdca5441e81bcd938d5fd5d157dc8084755656637c7e096bc6bdbaf428d14867fe2aaf7f88aaa07a0d27608951d2abc1471ebd2fc00dbb06b88df2266400f11ca711cdf2349a3a769803805d87536028825d6cd1536b327d11b31addad692d94ef73d9de2182f661195217158d0a73710272ceb7b8bfcbd3bde9752aab50e2a347c96722a99cfc90c6d6fa8651e7d086f0f9595aeb4e03987abb5ab1ee302ebd045e2e3eae9867b8ef03bab8dc00f76f131b6ac5154e04ed1be42ff94d1c3e87f269f783bd573b2a0144ee928f7267858", "8fc415788dac491cc50ed4fdfc015ac0b0be22da0ee561af9223561bdf0dc62d55b0810fbf77d99de09bf0a4cbb71ba28a0c4d576821ed70994127caaf41f945a5cc1d1c2dcf50995eb382f14645115f03ee8fe798badf80c20fe2822642af898f132680ee558b6eb2d4c93b856cac02402be80be58c151f9fe313e2a2f4e3ddb3a9d460c97d0ff9a475ae1823769dee6f8112da8de7aff43f95ba0521e32322545cbf9a0f2a878da53b56f3d855f47f1dfc7ff64b7d74d7b0920cc89601b5d34e0e14bd7dc3f4c973774f6f89fc6a8968323176eda2568a91fad75be7af5c234d4d2382d0e4ed8becb403188841f27b17a5cd05454c75a48336e1223106fded77e20ba0ed2ab3e146681c9af9e4adea46e9cd5f8e300bbc04841b30c5102aa83c44eb022d2dfdb7e22417d677bed8fa31a6a407c702230974e67bfd84616fd71285117f6954cdc8ae4886e98ed8fe5621dc29e10ca1cdf8beba8013f863481c54aa78d3ca87f57a40f51aa213f524231512faef65e5d95d37bf33468af6496e8e8d7d650e7f777129b0f5ecf988e29c40287416521af5c0fcd105e0ddb4a45395c296c7107f8e4aea3d7ba81826be2c61e9ca8c13139748e5a9207216ceb2dac39de17ec92877b3f297a9bd9b32eaba", "a7ca8aadfedb73a0bfd39a98094f0d0a54b6c65b36de527bc7d7e1cc81125adf6576c42841071301ee54b4a05a4e5784b79b027ba50dd71fdeb28d00a0c228187ad23818f3f60d94f24e2f0db76183cbaf45225852fd2f28f2aeef91a924052e944ae386a5a3759bf32da653b275c6b5e56328a9ac52b62192b797480493dea83ee70d9900b9d85ccbf3317a3e15db44365db6a8aa1ca8a7c5e85281e5db5ca6d60a239506bb2f85ecd07b4c2d79fb316c03dee1aa69b22432e55e553101ae70e4456777c5dae01ae1edde2bac99f4b13020181ee1ace742e10df91d5e4bc86c76f8de688916685e879ddd820eeab7f5198dc6271dd9d20169f1498bae3c9a26d903740bafea7cd705298be018d639fd3104b13b749a031ba778bf84dd4d595f404488485f820ebb486b0966092323be1b318f56d1909b77b916ff31cee39236b8caa8456276d25e3ce7863b4eecc4cd1ba5cd77186bef418f53aef12aaf13e69e6eddb155cdb93d80753bff2c674b1b49b45d47a3450cdd213961eed98ffc97d794eb079d73efa288f444ccf7691d764e2a069dc722799ac11d152cb20542a277c07f5b2c28b56cc262e0847172794c", "83dbadd08a8f7c5aae3ddf004f18a6c82d6b5c8c9f58219ebda8a240475023a362127dd40b412496afebc729cd05242ca9fb6623a3cec81b48ed2178c54af62eda85bedb4d008b63d5ad2ec91c35e6f84125d71b2feb8f2de12fa1008772c406a2a6990e4d61ced1f1d5601a4c6b569ffc34a18cca3f344abdfeb43da37beba3f73fdaca3c1ba31b2078b2f3c21ecab4293203043633add6ac67456b3fd79c3a74ee2312aebebd62c3cca7b9a6a3c11b6f35a55de6387778d1375c948f7215030f9751ef49c2909e38d595966b04ab794d28c8face5d8de93d33f3473397897b848ee0a721cc2c668ad169c31a05f90f6dfc513980a29040424738e2cce36361b0ec3b43d70f84e873b91fae8be2748b6feadf047de1af5233c354f1ff9bde5ce0f9814b297c950e39758a33e3074f0322083a8f856ca70974414aff82a89541a936e6c8953782911171daf62422749f1d105926fa006801e78eef9e65a27b2342dc83ccab6aeec2bcf13e75c65b634817d37b67fbdabdf84fb48b7fb84699dd76b7f505b9caa14891d2512c560e9a7e", "900ef77c3ae15d654e56f7b3d17564edbf9eb22ab4a82fc7b0d9fa2f2dc5fa5df0e142db78235c32d0bffd94165fd0d1aaef52b60c04e0f0b62ced77a3cf6b88ee5f21e81527e1e678b69aad5f9bc46bd8ea942740d97fff110899ff50c5e48e97fc24f38e08640875a4e59a7c28f2fb8c340ffd8b97b48615b329e1935d0a8962d9f9860e3146bfb2becfe367d2cf8e22c5fd7dab78c7addd68766608bfe1ec4f57d4eb8b1724c500fdccae43be45981b38d4ba789fe519df10a6ab6ac98b3b5e0ff217270c16c6eb1189ecbe336510571ed62377484d38f6a09d844d1354b9663171fbfd39ae04d7659d00710f6b960c1f1d35264a2b722032b71e3809694da895e6d9ef153939a41d1b18ede370df5a7edc758781ccdd4e7f6d258dd10bd63ae10fc957083634ef9b3002e589d736537bb4cf24c22bac9fba7ed346f0fb76e705dd0ad2baeff90e5f989f2a1781720131e8ed4314675a8d8b0d8591ca57ecff943f589e87de423f2d95d5c1e593ad", "ac7735a63c3332376d01c1eec76839dad31bd24618393b32f9d19a34d2c90805f7f4d828661641b033b0f79c58b6ac2588e4085914f0a429a99c48c5eae347f5318a6e0a1811a0449907263199f02fb3962993f59c2b5e3b2c595e382c14c8cb98b78364ba509a753b1cc9ede8b0ded8b9d451783fa291ffd66b83b0f387bd6b71975319ec0849efb360f0ae7a336f6d415595b21b0e83cee17bf854cf6ba8b58fa54803fb69595ee4a923bac72b84412bd4c57b322e69d1fc5f683b31518858a56233b88e6c33cc141ea73a57988e264f545c8111b877f16bea15b0f42a6f2310b509886bbb10af5297da534764547441e859424a8c212c02f273975d8d5d4bb3571bc7ecc78ea01ce9beb79387b65f5aa5a7cbf66d52254d61a45a5585c66bcb07a7291589d45d2431e64a77b3b8e34dd39a1c23fa629dcca6b7c2eb2f61849816be0d5cc4e32d01a44e33a0579000"],
                ["ab45b70896142addf6ca4b0944419eb3568736f82777d191c59986d2bb510bfb189c81735807653e503854b6261b801994b8171b7e9b51d5f084724500cd3844c4a8746c87b971c59ad9bd0033164666880d246b4f73e96ad050f13504cd42b0b6a763f471dc40fd80d65d0ce2f82542a40f4ebc10ec32d41fb4fcdf594e7e04c17b3f3d02ecdffea0583be1de38cbeb13b7391acc49a7ee1a3d155e9e4fe777f691d556524581dea6f2ebad63ae89877082d489e66cd60a50f575d67e566fdb0b2ca0764144d512c061e1d176820f7b5dc444ee412fc6867735efeb4956cca4841c11719bc58f0f7134f73b07ed30913abc90402adcc3423e3024023d654feeb3b7a82134f0a71bf18f30abad887c020a7ae56d8cc86357c0afabaeeb04fcb1746e09e50776506c8b3e13ec32562aa61bb985e819479cea8f4794aa6472fdfd2dd52a1131772a163f48cbf2d8b7c84e6e2c5d7f7035528387ce2fc6b70d478ff177a85536d5d61a6729f6a8a5e1a4121da236c4731e3612aa499ece40e56e7ef18f47f2260a827e545b0b1c23fb2a1f046ece1e1fb28962db128cb583a93d91ee9c0ca8ae0aa2de61b605fa4d958eb13321e6226392b1ef90725cd43b7552dd12ec88a7238dca0e406a0d4916ccbd5b60753cdb36921fdbff6cc8b27e9b1bc3d15e48dd2ba95147bf038a187484a424", "80326b6ef2d98ea3460deb10824c12c8594cda3c1a8347074e74225ed2459e1b1a390b4f76799855427a06ebb2c6390b8d81a3669e33002db9014c39d2972b534283cb175f4fa1c155b3237ee5c4123f1de12f085b9a3443c18aa02c09b9397c8d730912dd95922d65f15307af4b996ae8384fd845dde3cc8a01be589367ca9e1d56b3191be51da1af8868543e969eae45a8b00dba76400007243c2b614e825416f35142e73f5a84a8e05542221f795209d340b79b3b7b9bda7173d576a5195db42cb484401371bb7da6338f7587199465ee229ae1cbebdf057da2a2410dddf8967da69dbc58767d4da187caba415eb859132d9d27b808fa9cafa12e12169b231122928d44ff8bffdae6a2e02d4586ff2cd505b651f95422d2f8d6366e9d5eb63246f4bbced548143f1ab48fadc51d1c4c70a48d042f2343fb841872079c25e3b86006be0f9174dffa55d3380a8994a74dc09561a5b6cd88b587a76f0ef56a47fee1b93c984080763b175c42c8c704cc642dfd030cb6655f7d8d355f3207694f5bd5e2227fa921e917d9e9b2a0f4bbd04c79a538247f1fa8f5f2bb9288915afcb5dc1825a6060f45fc7790b50d99ce601254a5df00aea3c520298c3d4be7ca39f6888739ee3f40ebd8e54a5f6a57bf1d", "aadf29ba24c33fef911fcf647c673fb4fd2ce9ce64eb8313c63e8abac8ee9a00177a51795843ec78c49a1f28e654617b88ffa693abcdd6800da6096214f6941609f8c7ba1c201feb2b09af438cd065c679787d6fe98bd96a378fb07a604e81e88c87cfbe270f9d641b166a001f7b403d6c9dda194406768d5a0d849365a1ff18aebf28b4d3471f5faed3cfcf8b737b6659675fe2851d2182b8b150419f80b2ae0b58f1fc164ac939b92e247cbecb1f466e21ef80a7e1757a8a018a1f7ca8028e1a6b6cf2a4e10b7c90a7f5d42f22339552963a96bc9ef26e8d30fa8500f4c65faaa0081bfc9c5f3352638fd6b10589b931e0cdb047a3b779f2aae33611c7cead6cfcf561a0ad4de028fcdc73cae4b2921d7e70400655a8fc2f221db60b54929082a8dccf519a53339e9bd6db281f903e1804dd612735a3c1f0a4cac127e4e0e6724b5bb5efe118870fbb6a0a1067b64300436ee2829324ba9bbf85eb9412eeeb03f64999e64a155843460875c223819815585a5113ef7aec0ba43f3d0bebaa9158db52f6dd7bed94487398f7cc16c66f626d1f4a2af185699628787b0cb75d8a76fe621a8d2784f5fea68bb0b50cc0bf", "a5df877245f2322c7637cf25730353d3357cbb6ba0676fb88e6ac3cbc2d32acdd620f78843dcbbd1c31de62a106e9e49a2c1e63017f8320751f1bac0eac059a3c374184874f1af8dad86468af3d6cd13f12fbfa2477edaebb93b700623d04a128b7978ac0f0201614697dcd8a8adc136168f139ca224ea7affb7808f2d2a2ec0d79fc87200d55bbcb0a5ffa375703e67412db8f2bfeaacf269f9503779d119a8f0101ab3b5a1990ed4a947bdf57599e21c33bfbca43bf0ee7bd3d12d697abeb8f8dde2b55ef9536d3b7357254a2e0f771047c7f5cb234e878553aa92dd7a78ebfe7de5f8834fb7f61f7d0daf6c2c72be55541426debd1c9eb633778add917029ea2a5d4c0dd178a3820bd306fd04c86f660d82101df1e36539c87b56c3637d20c8749bdcd28d92a121dcb6d50fd52db671860d2dc81eac1b5fe6e7faf51e138bbec4449dabe6e292de3312102b808f36194cfb0377f875a977f4354d431c065fa0f7ba637c987d71aece437557438835370500a51a34df955fa38cf642e72b79d6d84c8fb0108f48c81541b6e4df3e7e", "85ec772bc061a7e314e08e1d7770f63a0a46c9b03a01ed50ecc604eaeb3691c19831c997c5bef930624b124a06fad11d98dd3cd308eb7bacb420886c758696654da5e871129070f8027321c0390f9caf2f7df29e7b26065c106c369b334e1d3ea6c1567408a82c7ba64c508e9a445b5ab8fc69f9a56d822789768daf343147e7a2e3c553bfd011f0a6346b3283ca69941410844e24146a8e818b55e30adda40e636bd7fdb1f03a96b85527f1a5e6e050273ab4daebd26f61eb834510613c5795fbab9db1cf85e46fa05f057f2758b10726ff234975114c716291ed289d7cd7bd0dc702679ca643d0f1551d09a98e7bcb52f1d8da374c97ade7db63e34e40086526fd816e7a7ebbd5b130a45bf0c8a7046ff9e32cea5eca9fbe8fca1a207c6d00cbeba8bf6ba4c66963679bcbc681566a3f33c1f826dc2bfe9338a0e0ed5d805a44458a27eccdb301511ef3dff6c0f58348842aab8a95de309af077a8f9e967616c826116bff4cbf08362a160fa81d890", "b2cba0860a6553cd2a94bf23183a69e9cc94d577be3f22b46d7db3dd997d31ac6e07e4624158d629f4919c37e437ffd091659e278e6b04ff9c41b9385c10fca71d280d0b3340d91535e0ee92e8f0dc39957fe91b4909e0f6be94cefd05a4768fa7385d97136f4f71f19f0864c891df86dc1441f351650d746e52ddebda67b2decc4418a71c727f29736e00d05f21c19663be7e6ebade46dc566f31758b76dea0fee28992efb85daca008e2307ad86bdc125dc9fd2762f9b87026c7333011f80fb6b09556580f49f8b569b2cc48ff067e2b7efb3a0cf850ae44525b69b28d51b4d971af0cc08ce71ed9b4206c11d015e84e366761f0d6ba6d04e03b86dc261c30e78e4d9ac33d3024f8d386442c8cb15a34b81444f16c45400af07aa825bf9ba932cfb5107ad7df4ee7ffb94554801c7f6564908e68406523274ad56a5c5e1d9aafef849afab79a0266b8e68d8ec8448c"],
                ["b0b099dd2abfb61bdde7d7462c47856c5be03da2edcf323b0dd65a6cd3c5f5aa402f1609e48957a5e0c13bb8452d37768d67a3df6e1bb549498be1f5c2ac1ac8d64bd5ad16443f2c6eafc8fc2a8c5933fe1b60a72ec3ff2cc500b4e835b7e6b494cef931c30840b474948571348c1526a630a61b0cc7ea8007dc6523a0befb1a54d27fa7d0596bc3b812f3ac6d8924f02f2b7527bacced281c429f4f899d4207272a803ba1c74af729b9a49719145be600a38eedbbf7d3ab498ed97bfb9b734116560b06fd8e17c53ee85f49423660e46ac6e9361c4bdcab82299746b7ad6264d42a076e77ba0567222c944b79206458389add515c673f1f66a4d78513b012d1cc1b13574caa89485c698bffd8b52b665c47c94ea312e5e657a7f276349feba8767063e5931f62755245ea330e783cef1321564eb32aa30527bb2622dcc639bad17da4321078451f8b614dcfc6e65e8d6666586cf8fc02ded86303bbc557c4f81df9fbc9c85d697f049a34e55c059f25635380f48e2343074f4afb870276aa344bc6a61a5e41fa7a0f4408e935f2f4061d3b51ae594a2272a3e98f1038e3cd4a473312a223de88de00c22c3b1dcafb7024fa8aee7dbf9c6f25282391f93bc35a75ddb72962f70b952da37e582095eea14574e2de8a53ff7ac93f03f5b55024881db176af3871e5822c00a21b43411122", "8955ecc9ee0ee7b94e3bb48bf8b21fb313d59b569e068eebc877426c2d5a63705e23269b107adfae966cde67fd0064cb8ad350352974825a027d6a9a9e9bfb8c68f902d9a95ac21e175cd4accc7006daf741cb1d47a8d340b66efa5310d91465b0ab9a7830a1244f87e5d24fc6a7d3232ce5a49410b3013184ee146c361dd2bf99a493eb76eebfa754678cc7c4e8fc3618184d3c4a5427f37aac751117e9fcb8dd00dfd58818864d76d085e8591e49cc5c0661f0d4c9d53995e1bb9e77b3628ab6e7517b6b469c40a8ef281982e1871133ef7336d19dd9f44bc039dbdf242e8a55391fa50f5f17a73e825c11e0b3c3493967e2ed411c7f16858ffd5a864307e2eaba93716b9737c65619c6884cb11d0434e249d4c4677bdcc6108d6274d09aa859d20ff1c4862409cf1c26cf1da5b26525b9cb717ae85375a0ef7d86d8599cc6c829330cbcd3d49b6830594d62a878f9053c3fd7ae1ffbb13f0077335ea6a16ef4b4c4ca6f916b2de007b69dd9310be20a98701b2154bbad897fdfdd91e6d9064c7432821398a9a649e05e262e3c024b2b041db57cd05e793d8559da9e6b1c699cc5308507c69782f44963d81a20faaf2781a42b993aefc9de2c6fc2d37722f1ef292f819a6e921d34d7e7c5b4b72ba7", "8d6c995e5741576ee8a567b39c8fc39cc246952dc1c0bbc65c5cc2eef1b36808f63f16db315c15409f15a10137f5c14d8b03903715034e39915fedce25a4db3aa7d52d39901a2d312925c55d11deedbdadff4804f1202fa58dfefdc3e732b5f3889d40d339d898f54b202a819f1ce115d0f3fd092b4dacfde5f85e4e712c534990dbf9a0f5b687e2b4a8030f091ae53d1b6b0e7554439856a3a4c6f53ed2d66034c611932829b8f96efbd4f3201549520b7c6c01a8e51c17e398812e2ee2f22e586946a9ce1b1057ef69c2d5a3e4579608160070c5f098319e66dd954b4269ddb55924219051db699758ae68cfed075703d654612ef7e2ce445a08c40d9b840692e7893d98e21baa8b14df3f46897e694c822441300b5ed9f8d12a8a33dfc741e3051e2a3ca80432f9d52dc06d4b8cf632fff2bd1ec9b300544387858ebc281538db9ea157e835033a8742a5eb76fad51e510751927aa4f8065a782fc1439b313e84458026bea6ab127b6228cde2c1426c0e849550429705b0ec2bdabe05c1523618481fc0d7809bf22bf9a5987673d04c503fa94fb84584e9847acfa205e3890110f291e7c9e524795d855a637b2ffa", "96e71116da0f63e6fc3cb09e571b5ab380af969de4c270737891528a9308b7e0103b2f637958a38db16778ee6c1ea79db5248b0fb3ec862cc789199b671cb84c69cbba293243ad1de798d7f5d608edf9f4aad0ce6bfdecec5711906782a2dbfab8dd2f37f689c28984d3180bc1e1cacc364410f7e8d3e3b03c8e87881f3b44f162cc09a0a330ecbe150a8af420924f3c6acf46f7df7866faebfb123a307b32ec2e0aad676cc82669a978fb6433a6631f60d6abf5734085faff037884c08af3310301ab6654bf6bc3c2f0e4d0585ae4a34d5a48740d8190989f3bd80a20731bcdfc38c5a4a5645b24b1ddda159bf834d55cce6290ebdc92a6721f92003f3a31d77a64a91725cd1c0aee232401e3a98cdd1a28611859c476713c27c11a60d691bc15d5610d56c4b04669ac3528d6cef84068543386def0e5539a6c9a1bfa78187809b4cc86a95be4922e7d6f460c4146ae58d32e14f4b399a3e5eaa047916cab7bb5a78c288aa288333a80afe9cfa035f942de1bbae660395eb1954690e65e4c68146b920e01cd9e0561e32e76ba2ff0fa", "944a9ddbb6bc400ae636e4de18fc947a32ffff79f8e813eb24a973e251ec6d45cf13d8d9f4d4dbe5d8ff265b5c06ec4097881c47be8f1f6a8163e8bba829dd3cd238bd79d62e6b85fa83513c585fec4dedb1f00f7e08b63fe768e517f7d932d8b536b22862677d4bd028edc7ad66f20cea5c7263a44c87753e0fa52be44ca7a0f44e8ddfda80c48474d49a1ed9f1fde926a86945f5eacb92446dfac712ad662a93bb959013815a25fff4e3397450385525b7c53cee90dfdb1beca950bd97b02c3c9ac92606161ae4f8618a79e0edb0cb1d4d23a75675ad4f557802150517f2056b9eb62b6221f5f63574132eb52e7c4129ce70aba89523476db91c4252ad0c6a0bc77bd5489f613f48e9e6b2b5f560a86691cf2a9f67b46ccae01c5da457bed2c0855dd5a4f7835eb751682dad06267067d4639018af87fc3712a42eb07ea46a2bb542bd0af3e3e99303aa179f5aece7113f59bf7481db88335821f73a39e84fb7eac678acd4fad331f0c22611b2526d", "b6003c641775ab34563d673245de9359cd3301151168776353d06d840b862df0dbbb3fdbf096129ba76684965d1c1ac29357b9364aebd3032b6a59a5b3ba92474b32b880f3496ba58ffc55706afc5240ca5ed9c52585d514577753332f733b3d94cd97f42e5566bb851d2088faadc7204b5b17632e56fecf7188b1d23377db052d7d786dbc25c2f38a78c0abb02d2f4221630f8d40d5d5d407b00d5e3f9e1bb7f3849dac85ac4e3806cc686b385cc2be0b5d093ed1508a30dad4302a775862f9a1db126fd585342a9cdc399ff2957eb85cf611b6906865cbd91bd52816e50b2bac89a65072c2ba463be154e614afd0bc34cda3c1b441b53c2c3d05e1d6b5d3ff0c1b1b8d17060703f30d4f7a24aab59039cf4d4c9e03add334b6735e1a78bed421653a42b87b73f18b2b0a4b47cabf7c2bb04e9492bd9cc638c6dcda4d6bab703517ddb540dd454f58199477e2d37440"],
                ["8f707341eed7884f54f098f2890bc827991d34c7996f439fcda309b53aebf26495354512b62b241b9d8d2669c17d1facae62425841f928d91a22051b16820434fb83369d50e3f800df044fc2873d00eebc085015b0653c3b785fe7dc09e61833a0cdb115d4e5e07d4a8f3b233a885fa91779d56fd0dddfd1fc0f9a6eb54d073b7d1b16ebe3f22b4984c50873852cdafa400c5ec3344869dba9bdf601b433f6c89f2f999fe89e4ba5d66305f155cb26770b92525cbbefbc27e667e1166376f14104282b975c343f236b734dafb35cad9e5d7b22ccb5cae47bcc30eb4af4f33755b26b57683d4c77ba3374ccbe359d6a1a45d47fe170d20098369e2677da17875224bcf9b4a552b61c2dc136768dae9d3d122cad6890256f2b6ab434f2d8fde58e9c90e44855f28ec79936e9b8806db18069969cb4d15d42670c374f6f63bc2cbe1cd896b0c0ffddd0b563cb33af347ab85e10279738a472a21efab08f9e5d47256a995cb1be5187288b53b45d7f22c8150a04ebdf2c89e27130ae0fd40fa88c7360fc30d003e35c9efe38f8dfd5329f765e1af5c3327069d90c8d86aef2ab551c31c1c5b1f523f96fe3343cf7bfc3a3f83fcdc3137bf967ec7aab3347dedfe0668f8b9f58b721e1827bdc1892dba9fa881ac9748020b662650abb9850b3fb1729b8674bd01fd13a3eed35181523636b70", "a1b93e469c8c97f56649c6bc00988a86619a5436078f713ec64e639742523cf00003e18e3806c697a3d0e96e93e5367f93d74a94eed27f8c4371d78f28177985fc2a8d9a14977510ce7d81add13e66b72aaee49e86a2f8f306a34c0071079de2916cdbe2e7b73d4d799e14a597c3f90329587b2ac5a9e0246932536245ed979a13bb80ffff91bdf7c6405094ccd446514906e056f03df2d004e227d1a55037f8a0aded27c3b8bd4aa1072ba0d67258055d71c95a26df38410636b29e54bb7aa98b9053cb8bd6a258f33fb3edefc608242cb7e8e857b85162e6197be6746d8e27109085ea5677d5e447eb30078e153648410f224e4f927bceb5099f920afd658f14d445dfbf6e20bc052e794f81639cb42ab7b07306d19a009f2890b9e54c59b58eb64061ce384be5f2259a3d200017d937b703603513c10615cd4dfb45706c0e4c8b33a6fda2d03e1875b14eee46d00852f3d26bfd8e3d39b503dfbdb48a2c2d626b58a79813675d160ad2618ea5dc832d490cc0fd8f01e85614544b05520d18f4874af8deaca377b9e6e438ecffe88157a8648e2c4d9e05ff332fa8d2e1fb83053075f67eb8aa712b2acffe49e6ca444d0457316e2bab28e17b3dca973e1dce0aa0b827b1a691bd49363d7f9857a018", "840d3d7cd557cf951dab9c42838a55ec1359fc662c30470e39ebdb8ae357d4e2d9f893bb1604375afbd717c14d37d525ada815b33fadf975a7d48004364cbfcbaff14b6de7ca96f1302918da25299cd0c7fb0abb161dc851e353e8a6ef3071adb38f4982dc165da9ebb60f076ad9454470c086665e27d675e331215823e945c1bd452511560d8e4fbfd14306a8ef33f63b7227a9355beb866b92c9dc2e7e036851ca84c1cd47393370de6f74ac01ecff72979647d7936c8aec40d0426b8a24e676535cff35a5566a28c2b893cfb461186073d78ae2b4cfe35d23272897b42c87dc0024ff58815e5c21cfdbae26a43fbf0f94aad448c8b591ea51a08b5d65efeb49e366827f0f63de623d295d993ccf4c09a288d4045535810192c7cff8b74ed878998214385373abfe735d8852f6244229050f7a21a6245f52424ee7e19b83c52a4fe36ecdcd75ea2155e4ca52a62a9326d3b21ec59bd960247337dff921319eca9ee7a11b1af5229b563439b8ff00eb4c1c7d4f7cb2c894ab1bab37923c877fbb464066acd9f01fd1a3d4cab1e8bc1170a306160283561dfde71b43d6599dbcdd14e4a5af1eb9a7ae44c53701488b50", "b69a78fce8774a56544e61f599103b898b3113511aeb8ea68ac7e115a7cc7c909b59aed84dd8ccfbff1f9c73e6652613b57883a241ce47150ea2ee38f5d764f373646e918d41d5b10711133b7000dd2a3afadc8998fdd2d85e17efde10da506296290a90ee09f3fd126e035c36eea8a3c1e5d68720c4b36b788b0dff46fcc129d3aabef34182ba56c7647a26172877f53bc2b61805e525d729576f41ddad2a914d6d5c1f9eccdf04a6105118c3683edd03168d4846e515d5766403b59e721959430c641f82606ef347750aa9b042e7fc54e677ce5d7225a4b982471e71350059f385d2e1c973ce3255a95bda32abd344332daa21bce69f53fbe01561f3cb4844faaa063205a168119f7bad1c67f1da1253d989478a4012bc7a76f1ef21a7b0eaa0cac8cec7407087586ab44ec5ae5d1b5ab6d4fa97cdac269ecea1364e22eae8c2ce253065f023bea6d32557d2cb20e656cd984a3872800b2a5ff18bd01ae8e83f0515231054a637380a352aa02be880083ec6e638b7ae0fa927771b4ffa5792b66279691318470eb87de7334ed0f29f", "840d3a50ae818ac7a6f7184fdd6e64d33f917c3777ec1d6a3abdb09bb5f62bf96317af9685d5843e42494acc3160d337b3ef70fc8e59cb4bccb046c5c6d1d9052180a2d569bfe9922ad9f97874a613aed440548a107f6daab569e6138e7fdc11a112a1a0891350fa388df9903ff276d1b3ed429108a6ee09f230e1056211f9522902aba35531d99530496ab0ba48a193153bb74839d7286e4b1d4832335e72434877abaa44c873b4bfdf3e62a23dd6f8397fc4b4c70242ea305cfe65b94d0f266cf186d47a46a5763240ecfdd090b0be063f41277480eeaa24721fce372111faf70a6e16da32d246f794e4848c34c4aa72176d917db733ddd78d4d284c400cd185e96dcc8452cbd50a24014b37bd3b0f026a469f6d5ce1cd350be944ee2ba9081752175dab7c125b92aa482f7de13ecc590457abf71272eb7a60511f12824f69042e6e0ef10a12933af3b1db94274ec31fc804d7641198b1284fa71d87d2f2eef61f816cc1f5f830511ae0772cf2eb2d", "93b3563b45dabf7ab388083e9203360dd1c00ab2fd24595d3fd8b122eb3f2b4bc9cddc2f9859a5e1ad08be7e651ca0088654d1f47329a4cbfdbc44296e363baebc2570baa1d7ce4011484f4995b48d14b6a89b6be3536613f3be7d14e98a8c76a9c3c7400a71afa81f950ad043b8877afe470b4c2b2ad4c72808c0b823f194a96f01c6b17d8e6d8a0b500d1d885434065d7a59331bcf85b3c71dfc6290970a40a2788017de3ae39be7fce2c5f7e5f00c31a32e9fc0f48c2df3d4bea2ef8811c4bed7a84da695cabf5ad7b3cdbb85a62153eb1d535bf47d4c42620633862498b360135c17f5528ba9709588fad34c83fb22df9f9e63153d8cfaec6a5a6e6aea84d93abe7ac130309af58f4323bf918a1854447bf0a4580a497feeb29a915cc5e08520aa9668c11fdc417aabb1fe37ae803a6cfdd8edb8cc3b1c7ffba2ab7f2671517f1e899443e90421c895c7053611f7"],
                ["b6226eece411f95d3e15e67ef618315cddb74f9492cf6bf3a717f24bd7de8767e42df81371667bcfabd07e1160308b4db66e1838d4fcbc8013d297350a74bd6830ce9f0b4904b2ee7d1a35d6609f904a113ffcd94a02ae91dae6c51cb18d4439969b950d5ff940e22503c6dd42e0863f6ef9f0960ad7ee8b7984d426b0d0918138d5dc97978dffcfd21eb6aab9a9c15604da1b2201c4c1686d58374ec39708af41f589ecffed74ce78da754a9376e08b417b636296286e42ece08f978c372caa93cc5fd4c53d321d25a2f0be473e1d5e09a71c87fe8e6a5266b8b07453b3502d6c35f341fa763d84cb20ccd3d8e2bc1034ea3a5f66022364d806eb97ab2075ec6fbc8f81ce7888e9dd6f340cd98108bb6adb41f9c45ff505d224d537b85ec889f4e5e35cdf22ace1aa3298039a44a5da14cc11708a09fc17f11f2fd920c6c5c388163978bb0b5bb83f22ead9949a98213a8b68f518dfde8a9656f721e22b303a6ac426d4698ae79415c4decc40b719f8236eba4ff19b0b56c162eaceeca38223314c9bfe3f9fb5f759500d27be594e042aa48a3a2d73f41a2f69157c286b06323f2b7c41b32cbda8241277a07007da3b647c5158fc72afcb59c1f6985e8e001b421ba83f1d00ae8107ad31a59e7af39068ee7698574cc2fc3d950d5b41f4f17dce7c29aca4b0515dd2596cbda0fe5421", "ae50bc5e279be1479bfb5ec6f6c752715f34872a6a43f466b94383f1c5a2a1f39122d65f0b16cf7b6400791f6c116878970dc1b11ca39e85be6cd52b23e60eac36f44554e853f7d99353416c216119e0b2e3e9432efc893b49a218016e4ed062b051c249286f7256315343d8cbe4ac8aecb593714c67d0767bd9c63f4186ba83d5f0c5a66557c7a0c6489e46e20fef2b258b91391f8250eed9e7698b9ce8905d3931ac462f8fc407004a1050812650a709645e3f772a570ceba018413fd2c36ec85201e8fd2ac12b2a934d3edee7eb0c55cac9101c98e01b5ec20090d2f248121d092d25f38d4cf645310213bb19f4197055ac2d0bb9e01edd236d45eaf64730ef0fed1ddc7833958f2f87ad68a6766a69d0b7f46d63784c2c11ffb04670c30053c49535a9388454ba582e2459d2945a485e8ce7cd3ffe96ea44d95c2ae3935e9bbb6dca3fa750b045d902e745c853ad34a50d1f7cf0f834adbb03e8ce4decae0b99677566ee1442e7c619ba8309150e3a6f0d25732667123c691c54675b836e528d52885ec76f9afea0aaf77f98e6ec34c250b0de9f7cf7cd8af3788ce8e9c57eaf04dbe8b564f465d5b17a98f0dbb9309287582fb7c4e6a0d5a453ce6185588e2872b91051655654305e659c3d6cb2", "8bb747412d7dbe60b0022ca6f54e0607e603813bce6ab5da8d8ee7ca91a0817e0a65062093f58501b2e3604a06bf92e1b5f9f4b518860d9847d6a3182928cbfd4f6238798856d43930cc4db5b189701e92d376db4b206ac123d639bc5b4692a4b5cde7d8f53d4cbad4e98683f90c478e6bfa46d0b6090ff10e862186bb3138a5dea84f862354bb569628caea9413fa4f3301b1d0fd653062497b0c4b920b7d427b39b1bd584429070b77abd5c19a8934105e666a1247c2622a1c6f4c31368a5f7faa2a768e26627d73b6f9387c52575a67c33e7a60c4034ff5821d5bae07a56a4fd6981a1e064b48a51d56cde7d08f1c1206787da86295c4f2a0474e19928c00a4f3c6b66827ddb63c4c4622282043ff56bf85dd40b5793b18c6a4189538cf464dec895a6894d151edf9392a70963079433e19538487e5192a35bf44abc6a736fa21e224f0857ce0f279427ed03983e84e1578bd4913d3571c4b72578f231f9f8be90fb5c7c2108198b5024e27474da37120d9f9819b74766d17af83b230e2a11ba5d6e88d9268ecc383534d874204c7687a0d2467e1516d341a85f00b36a90a1ab27e5c17e03cc1ffb398a65406db46", "9787472724cc297236e09ea905ace2faa000c4b86aebb8d01a3cebceb5487167fb145d972eda4d80447574e893f63ec4942a79847db1da39d342995877428416a784d30cf17478221af3a3d59095aed140614b1ef85eb1549f6681ed1cfaa88c8938719872e61da325b8d45f7516c72093d3360f061964f190f452fbb2ba19552b81d4c600c6bb21ff2ca3b77e9b3aad566edea05ac0214ae37fa769ef5d0c5cd7d61dca29ab51baca998744bdb6802762307d86046f85576f77c363ff00e9a612acac4ef424b912a6cad6572a79489e64e1945fc99feca3f6db6f58e771a9510374932035a151452158c2e93aa746570523663387174ba464396042e3f69e485128e59e132e73d4b433ba3919290ad319c90590c3b1b330bffb72312ae8a21b49e402d31fa808beea3910265c792d87395e1652b81c4409b7b68a23dd06fad94127929ba308569f38c39200081fb52e6a03f9fa8551bc5d2f0f65dcfa65aef23add6b34ab8c8a40eea07d0550fe65be59b788c11f5a58127f5aeebdbb1d999a339c8236c51c5bf688844d8cf6c18d18", "8a21de66fb7ca0d06bd77687c92ab66728d33ff5c08ea3a091198f96f8464f8c5c954b9d46a67a395231538f166685a091dd67d79cb535ebf00931fc4d8d42ddd9967c298e8adf51d6b6e7fa8c13bc1b8727f44af9adaaeff1946cd62ee9eb61991a7dcdda18358cb31b17f0f85e5bf2eee1e087e22ac32f120f9e17f103b57fd600e5aa8193fe967cc3625e4f5b7a49001f7dab2a1014adad65b447fae4bd37533a394fd3ed15bda66d0c687f4652bb6db46c20fdb8c30c75fc739b1461ac2bce71abb633e4eaba55b0be271c61ad474340654d2fc44b4a15c7ff4570f85dbdfe75314eea59382ff109b63c142e5b55053208b321c9062dc9de7ff930e1ca2bf42956a22c7c50b4723210d34cc447f644621fbae9873b1866d561f55e4ae476e2b28d3e2bbd186b72754730957283652ef83b04defadd9885d2c7e55bd1e691303d76ccc4bbdf797a604d761f1e6ed464a46354cd0c74e0484c4d29fa2843e141ba859d39641f0029286c5396833733", "87d3987021754d33d1fed258f2485548302d4259dfa8ffe8fbe17a0e4ef3e54ee0ecfe63b9e772db095a1e70c073bf53b4f9d93553b0b9942c041296ac47c341c9cf758839019b364a845fef32045d4d06bc95d845c7ea417697ca3bae7203aba1b25e0c2ca9cb315ad2d002acfbf078cd2d453f2ffa51a2abad908e7bb85b3f46e93c625378f4ca4cdffd7d429dc8ee279eb4e3a69bfed59034ea2ed8a1926b5e2ed1cdbba9ec89dd225c9d975c264537116a09fa6d33b49e4eb59727bbeaa6ff645dd73dcb2755bcbd4298cc02412b4f709d4d1a836032957c99d156d2739ab464843eb08718d6b0124eaaa7d2e7f8693b203bcac3db5c6adb130b6d55b1bc7f545a112ead0c920a8ccdff77eee9570955acbe8f89863c07f39ee05ee5fb52d2800958f6a52609093c6836ffe002190694a3cbfbc2bc4f16969ec7c957d46e39b944b68dfe50326fb495025b8fcc4e"],
                ["8621f0b0c85c30a420d2f169a5726713d545cf25adbb22aab8f4f351c66a6264ebf9314944f4385480db6e226e4cd4aeb06f2ed803100e75f62c991aed80409c7f7c58cced2871d2354fcbe305ce53a747f11697c036687400193fe768f10190994cf48a30f06883927958340bc467668f9ea37a64d2af02c73cee620894ca2970f2bd9a289310222f15765d98f07a2d6824d9c9c59d7b331faab7f9c2c7b37b9478744eda3ce7ce21d455ead483c43d64bbff5b341a373fe7c591b025b2e47081dd8cca8870f0029d541ce2c7eb96eb3371a1046eb54df2eaa4da9e244622c47c837a9d2e5b229fc015f1113c93d38a46cd002f3033720e2fc0ab2ccf4497285b6e98a2596540973607534cf5cfa3bc497526421d94b898ae419eccfea721fb372df713f626e3c7b594f52021fdb8e0394462b1dbd93fad28cb074646b0558271ba0a5754d0d777dca9207598d48db70509cdc646a8c1f62a44f598dbc8741b603d75acf1a5b9d71defc441e85b0e2250ad6ceeddb636d555bf31d7bf848b50321ad93b6165a193058b86050e77ccbd0e866bc96069fb29ad6f0c7aa06e0f2483a66355fb8a67c484d1944fe25b28aa406a916e3467a791767578b6fc70467d1a3daa9756f0786061a52dd01cdb342940df757966560975280fd68b8f84f4765253182b91dcb0f8a2826ce3f547b98a", "8628f70a4c7959db09c68fb0ebef887d16f8d34f14cd688e4491d0f39ca14b227db20cb75a14e99360af0b2c95f2ce8ca74ab4c1a3629ea7abd9f24665861ac740dbb72ac83e7789e3e786a0d959d41198ef668b0376223d3aa5e9c21e2a81b5b578be7b6f6023509395cccfc48ca2f735dd6f123d8a41ef8e7188d0b741772d4d95f92b327605270963457a5af314d526bf5af625771ae020b24a5f97be5e73a5faa9fac637a3e037ebe987027a484826793836c2b76a2cf03d5a7aa964b4715e2e0eb40513cb53d7b3956398e94a4f4dcd239687314a32205d447f4d24fce36cca4598d3a6195624c9447fe3df3e353e38f3e4a87508f6d992bf4962ad02238daec45eb8f2f249cef7f6b4b45de4aa22e5c491bebddd6d8016de10e5690c7380378eeeb1113641d7060a1fdae92ace1bfbe013e457d8eca01f6fbaa966f744b92116a066c35f47f6d6554c6027b46839222d4fe06360ac4a8b397b34060db1503706a6e3afb4e09e8787e3595810c01620e09a757b43f6521ca2429db8614d2e9339cbd3390c7ad82540dc560ad82808c35df1e9d91aaaf4a65e44ea133e540acf138ac12b14ecd64f024545a2968b3e6d9231c5f1025caffb63863e81399c6d57d333e81a8744c07099e5a01f15a5", "8ffb6a458e8760267a448986266adc96c9d65ce21eda1615b44a128197f06ab052ca5be7467edf8ffdd73fa807685bac881516d6998d3e1db39dd896e46e4eb886de2a1d52eb7f2dc8136207633b7cf8f672e8fb091da6c80572044889a6c350944e232804d894fd024c385de6e1ae667ab40e0d1052fc8e758c8acac7698fc5d849fcadd168b40e72ebbe314207eef60e22bdb52f48953ed2f61e2ca1c84e23dac58af8f19ceb98f335bf7df77682d95ebc7d2b16953d518395f9293dd8ad3806b38dab9a80c52a29087b0e262044bd1c792d7184f848493528ac28297411e8f50932082b1e6e05d9afd78ff3e2cd5e08820f3a130613cf6f675354ca4acda30aacd7b86ee3a49999bf14740dfdebf212a509d746f74f9a2ac43eb0b9ca71db91317c097b13517a83e59982d32447a454bc8bab4178425fb2ab61e21f02e34de4d89ee3fcfbad974cb1efae27b85bd53d6f0c8b040dff8ad8bcc1e19fd1127271516d9f6b862d9b5da573d886a19440162f10f8cb6e2731c8034a27ea3ad4a25ea4cce8716eb27aeb82695b16fb266b3ec26be8de107340d293dae51bb22b6d8f6a5a91fcdedc17674f948e880caeb8", "a46c981eb9fda747f8823868f9cd28579ed2d67a2ae4fdecbcb55073e5c8cca385c060a0651eae225fce64a8c146e9a3b3f6398074895907b32ab9c524f039006d9ce45e3e3eed968bd69edf0a55a1b812624aa376298cbc99ac595fc1e0ea41ac08a23466cb3c2228b45dd15094d3b228bdcf9d6b80dd6f4f843c61fe099f5a135064541c6686e1ef92ff9bb7f3141c1716601e04bb70c716119c17040c4f9b753893b3ff0f4b9bd5036638caf9b3c3022cf3b5e59f077539e3877b3401010b14392f12dc40549c75b1eea7f89788580a493f7c29daebce2b2a62a68e2ba41d7700266f23499fec7997fe028e97d0684f8489033d84834299f47e06accf4d52bc3ab8f7fd758ad7b136f01d581358853208b4d70eee2a4608440c6381c1f62ce6a31ad809ba3ce7a0cddeae00e6519856dc7e7848e7fae5f190fc81f896d03b4ccb8f6f7fa11b645f3e6c9c290b8a263c6cb2fd8c9ba88c7513f36987cbc8c929100df7351341bcc4bb598624277e3163949f8bf452bf030ad9008df790d8128634655adda40e2e106fa407b3f349ee", "b5f289d305d3ea9e3750db58e9465ebc7499197f908c9bf42fb640e8a035f508deb5163ed4776f6c763851ac18fe60eeb31fd4d70006ecef64095c41758173c5b97540e2069c06de1976a03a950ced1a809ae0a36db543b3d4eb5e36742d7e3babc11a6a28cc1fc5892417b9ec2cafc311610546bf6ac78eeab432b34b871467a43df3400e3f2232e1a57b4016779c7111642573df7c0f66025fd3c22349ffb38d459f207d29f15ebafb2b1882d724f64ff71ac36fc262b51cb8ea35ed34d98639ef9e77d959a66d062a34c554edc614132c2e21b20f0a87b3bd2ebfe77387b1ebf4015b62235841210aac363aaf38a95cf328346e0cb66fcca81b5b47975e45d4a9172bcf6b187be5c1ee30a18e51a7669361fd28559d4adec8e82b1f3bf83b9503d311f210d8297569023528a0f45f0e458e76a398808cd6864315e4410ff8410e633eb905a1b55bb114c0e3f3b09044e1e368395c2ed4a4e9c4d28e1eb2537b514bef52b0ba4b9b89045fd47fcf86", "84bdf18701e9d80aa88d6011240a0d4840ca8fe814054538e0b205237909969066be97c7da2021f9db552a6b31379ea8a4ef9220cbfeaa7ab8d4c67a06b685e4bd8cda84fa15bccabb243833e07b15dac590a4c40e19ad79d018872b04574f32817ec2d3309733c0f3f46fdbf6611b47c502c46cae083724d98cd045ebc26c11b00225e32e6902fceb5f2e2e91442ac95c9928ac5d0208fdfaf97b7d29824e85f4f34d77fb556ebb40bd58ce50e298a24a925ae1e385faff6c9188f133d4785285920a71d12bcd335db52e3797ba04000ee78d77e19424206711b9b66ecdc3d5d3fa4e5833826ee6f9d09049acc4286761e394b08fecc86e3477e02d507c05f858ffbb0f4c16b944705d48910da49a3d64e25bb0321217cceba6d31ebb476a50e896aa7c6959945f4a21b6b799139b0942a2e618e565c5bd9ff00bf1cd022ccf1c32e8523de3e976d4e84992631ca159"],
            ];
    // No presentation message
    let presentation_message = PresentationMessage::hash(
        PRESENTATION_MESSAGE.as_ref(),
        APP_MESSAGE_DST.as_ref(),
    )
    .expect("presentation message conversion failed");

    for i in 0..TEST_KEY_INFOS.len() {
        let pk = PublicKey::from(
            &SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed"),
        );
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        )
        .expect("generators creation failed");
        let signature = Signature::from_octets(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(
            signature
                .verify(&pk, Some(&HEADER), &gens, &test_atts)
                .unwrap(),
            true
        );
        // start with all hidden messages
        let mut proof_msgs: Vec<ProofMessage> = test_atts
            .iter()
            .map(|a| {
                ProofMessage::Hidden(HiddenMessage::ProofSpecificBlinding(*a))
            })
            .collect();

        let mut proof_values: Vec<String> = Vec::new();

        // Reveal 1 message at a time
        for j in 0..proof_msgs.len() {
            let mut pok = PokSignature::init_with_rng(
                &pk,
                &signature,
                Some(&HEADER),
                &gens,
                proof_msgs.as_slice(),
                &mut rng,
            )
            .expect("Signature PoK init failed");

            let mut hasher = sha3::Shake256::default();
            pok.add_proof_contribution(
                &pk,
                Some(presentation_message),
                &mut hasher,
            );
            let mut reader = hasher.finalize_xof();
            let mut data = [0u8; 64];
            reader.read(&mut data[..]);
            let challenge =
                Challenge::hash(data.as_ref(), APP_MESSAGE_DST.as_ref())
                    .expect("challenge conversion failed");
            let proof = pok
                .generate_proof(challenge)
                .expect("PoK proof generation failed");

            let expected_proof = hex::decode(expected_proofs[i][j]).expect(
                "expected
             proof test data decoding failed",
            );
            assert_eq!(proof.to_octets(), expected_proof);
            proof_values.push(hex::encode(proof.to_octets()));
            let mut revealed_msgs = Vec::new();
            for k in 0..j {
                revealed_msgs.push((k as usize, TEST_CLAIMS[k].to_vec()));
            }

            assert_eq!(
                verify_proof(BbsVerifyProofRequest {
                    public_key: pk.point_to_octets().to_vec(),
                    header: Some(HEADER.to_vec()),
                    presentation_message: Some(PRESENTATION_MESSAGE.to_vec()),
                    proof: proof.to_octets().to_vec(),
                    total_message_count: test_atts.len(),
                    messages: Some(revealed_msgs.as_slice().to_vec()),
                })
                .expect("proof verification failed"),
                true
            );
            proof_msgs[j] = ProofMessage::Revealed(test_atts[j]);
        }
        // println!("{:?},", proof_values);
    }
}
