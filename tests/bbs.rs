use core::convert::TryFrom;
use digest::{ExtendableOutput, XofReader};
use pairing_crypto::bbs::ciphersuites::bls12_381::{
    verify_proof,
    BbsVerifyProofRequest,
    Challenge,
    Generators,
    HiddenMessage,
    Message,
    PokSignature,
    PresentationMessage,
    ProofMessage,
    PublicKey,
    SecretKey,
    Signature,
    APP_MESSAGE_DST,
    GLOBAL_BLIND_VALUE_GENERATOR_SEED,
    GLOBAL_MESSAGE_GENERATOR_SEED,
    GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
};

mod common;

use common::mock::MockRng;

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const PRESENTATION_MESSAGE: &[u8; 20] = b"e8gxekZpmeZTU0VDL9MV";

const EXPECTED_SIGS: [&str; 7] = [
"90efa1ee5ad3675a967165155c05c56d74b197932ff061a0cacd352979b6cd12c66303981d900f512d657f92795d74396e2d8916128cfbab7b55ff02890d7385a0b53639c98cd20b6f32edbed7bc4261906a13407fd9d2d94d3d85469c83d4a4447a63926fbd679ba0b71a82057d5f2b",
"8043aeaecd76366cd417aa9f9f8ce4b233b26b53426a1af120cbf57b2ab06de81ac231c31dd9e5f6e5c6c1dc0610259105ab98b35203d420190eb894f69fcf2130d966f97d2f32163cc302a25debe13ba9a2b79b2dff1b8bea57644f423cd7e71152ace95cad9a58c00a500e1b38fc03",
"aaf9ca17f5d72101f9728f756df0ef065ec04d45b5347d4b937cbeb6c90c081b2f0f8333ea8883e30fa4cc3601aae0e7176134e48791a4adddc939b2ad95199f600d35d83e04563fcadb3743b935092cadc62eb96450c6e9c798386a6ab2a3e89b00f76ae61ab81f19d4df8a718a7022",
"b01672aaefb1379febfac07ab4e0146bb84cc3205f7f610ad994fc4a7b3b7466b824dcc10abcd957c1135a93f3240be695e5ad52d67112f1ed90eed38058af6534cb0714fe87f65e05fc09fc9cfbc263eeedeec721c49e83d5048605c4c70fcbfd4b378d10e05a0c43846b3b56b06512",
"b1e56325f8417d572ee6bd4b908d8109001df148419e3535c3c295cb1d2438742254357a41c6f6f60d8a62abba47efc8e42f9b9f435fce57fce01536745b4529b74718960ccb61d390fe2e13cd14a75936063c258169d4c6aef12a9ef5102164aaf1926bdcc892a86786356f307c140d",
"8db4b8b1e2f2046f576987a6ea51af7adfc69bb1073fe82198848c742d8d7bb282563bfca94f47ff921021d3f64546325384dbb0a42a0e1f2c227d839ce44fab84048c61453d7c3720d6f893224ac552f35370490d58d91dd8784baf2e50f6254f9307bd0a9844d766f19afbbe400b2e",
"b0c6bfc00a75434227902f393a25783ae6aaddf2dbde40b2306206f42e3ec8b518545e4927c6a9453aa0b7a343a5b3dc499f5c4b7f49641cb8a887f2e3e57e2c858198cb23bdb94debeba07648e2a644c7d9f0b515fb9b87845f363f4b289671172a609af284b2ffa208358e40aa8361",
];

const HEADER: &[u8; 16] = b"some_app_context";

#[test]
fn signing() {
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b.as_ref(), APP_MESSAGE_DST.as_ref()))
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    for i in 0..TEST_KEY_INFOS.len() {
        let sk =
            SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed");
        let pk = PublicKey::from(&sk);
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        );
        let signature = Signature::new(&sk, &pk, &HEADER, &gens, &test_atts)
            .expect("signing failed");
        // println!("sig {:?} = {:?}", i, hex::encode(signature.to_bytes()));

        assert_eq!(
            signature.verify(&pk, &HEADER, &gens, &test_atts).unwrap(),
            true
        );
        let expected_signature = Signature::from_bytes(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(signature, expected_signature);
    }
}

#[test]
fn proofs() {
    use rand::SeedableRng;
    let mut rng = MockRng::from_seed([1u8; 16]);
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b.as_ref(), APP_MESSAGE_DST.as_ref()))
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    let expected_proofs = [
            ["8645fb1a843432b74f66cda927aec8a444ef32ff18b011ff483a8bb68f02337801ea916323cc7e613402d7889516c9498e254fe5521f1d43c8c7e84fe36c6611aaa59b8d5fc2919c2769778e66374a597ec12d93751d6fd5d87b421c7b3941fda086f5a512fefd38375dead5452d969506ac9822add73bdd4ab0214264a66bc3f61876b87dbd96bf07f8160836900adf212b95485132287c49a13df1c0f21dc5f1e6d5bb6343a5b9a2962d43da1c359e6c78b33df9ba6017425f0b62f3d1e9434d9aedf30a6532330970b90f9a1e815a43898fb7ede22bfd6e6b3662d47e523abf5467a20f9b4130a01cc470ab0b91015b3ff55c6a778f4e19af4c64ef84515ba57bd09efa9cae3d0e443abc7879c4fc47320518a6c0dda0ece94c43658331817a249083e54b829c7898f77f89de4648036d28377d73fa87716c5265d3c7d3ed677f82e4f0481522361511125ed41fd82cb07e3bd85017e5f7b2c148ed8a89c442f82782da728502bf1fb4efa458b5762cb1c3ccdbd88c6358d3037524102fd1e4f9c88f28a48b0e16c46646f625ef096393037398c6593aa2c4a903964bd50bb6f3cb4d5ec0b569870ce4ede8d412122e1ca598dc5df718ebdf056749d070aff83a876061468bccfd12766bf31bfb794c8435569707cb0744a500c8e290c63f011e45ed5e6efe0623ec3f1bc9a1cb6e", "b58e2022bbe7b526afaa74f857e13aa6e94f4c3d5970af3db2d664252cf48216295f22e3538e2a11f149e445ded62642b7b153e3b25e875f92ee2b8793ecbabd3dafa0917fec906ae7f6955787ac73e2b41fbd9e3b9e0701b688a2fb824198fa803fa23835d46d7fe93526b65c9adddb5874de6abdf209289fba569600f241c39eaad266f4c054e23c1418b3b379a64c2218ce0a3ae4fff0da714687c88e810533d25f98ac099197529a265307977e1c594733d93aa6c5f54cb544e76530b968b4fad53de91dcc9e9c2301202e85c2b33163b4ab29f3de3921d317bb8d83c588de0fe669485c5ea0d896572f28c82b1613406fcc373af1f0b8fba662db29655fb3c4770320d1cbf501e5ae3b2ec543bc0f0b0d50185610ed121d49125c7b0cd31963742398e59362cc9a7e337cf7975221e96d0cf2de1cf2b35777cecab95f11d13dd4a0f9ec13074093925319725a803e86d0021ced8a154ba9e3a4a1d0e6c78c9bb3dbe0f8a8b10b635a02507e5b165beffde18dd8aed93a238a1a5ceb3d9609fe7698303f30699ec42a6314077450188ee8a7490d674e576b8756e863472eeaa251dcf468d4469b7bdc976f490dcc2ab382736589b3aecae4966d7a67e799b16b82e9491deefb87225c853cdcb483", "ab568b93ec9be76aab46359005fc485ba88b664bdb75cdf421ca5c32ddcb92b3037af2336377362c0920967790237a9fa1d68b654ead8107a8168ef708b4fe75325908d5596fd1623a39e5059158f9d2c9acccc6dca7cd00a4a15e20bd22aaaab5c1c3b9171a93ddbdbeb3492927e7f8fe17131e7e8739562022f8314b28afa02a1fdd8809fd5d1b19dff610b6875bd273c58216162bf965da12f267ec7935e6f81a18c920e4b8b80de96e08cdb88fae11631f423519010816027398616a7a8935718fc37885081c052966d5a7aeffc14f7ffeea00bd363054890c4db37617d6e0ea99f9a7bc6562913f62e90c6a69c648ac8078556594475754e256e28c62cd9f9d48fa70006cab17be073418faea5a72bddb2c59f8a27a9c723cbb8c279c5548741675f3e24821bfd87a607e203dee1a65662779a2689bcd86f6cb071a2eb2018a54ec08fc071a40455b79f6e1a4cd0d2b5e17a8b3612a776133ff0bdb1f596a8f479d78a59aa670adbc0e7cdb749a50c68ed692cef6adb9870941b11bdb5dfdfb1e414a14b57b534c02138b7f221409e3c5e57109085c1df65ff4d149a1ad7f04dddd24ce71af0c5f79f139c88c7b", "96d772cbc512ce2f7b90d9468206f120825260d07d62163e10700bf2c8783bda0d6f6a213089271732b186cb0ddad0f48be8704ac78f8f31cebff906acada4ea784025aa3598cd70bf4318659417cd5146bf4123ac28f6cf3c29063c243d899fa573363c97038197dcb6a96df6c8bc7fa114dc14c2ffb2ca51c3dacbbada9296412cd53252318206ba6e74305a6dd5c25be007b1d5393cdaa1899fc5a9b568f269e494faa5f8b840e1a8a9b9754dadbb17622e50d5b21495a559f04bf03e88047650d4e9c7e1da417eab649ef2dc93302df21ea3f4c3155e4fdc582e1a8d508cde281f5a3d7a5bbb3b2bc066a2f69ebe3dd66fd8a07c01a8b654fe851ed2b108370e3cec000a95133d125a339de6a7df4da7825562a818a43b3b0b4e0e74e0d5c1845e3573cac00de5eb8c4b4e27702b4cbd1b6df82e736ee5d4f0af133d1131f788b6256c4eea865d3a84500c3739f5182d725a823a7eb8f457f74309fd425d09b4ae815c079c8b16f1d66664359bf43f5e037f7757a133d13911564726e3346277a7576b8ae541d77759448c54ab1e", "858f39be7a34d4c4f20aedee6084f992299ad90f0f9c997b8d1c1ac091f1a2427127f1bce707c4decc6ebcebccf6fb49931a02d0110888ee54fada21680dbafd6d600dc5be5d7d0a8ebd4810a4bc70b62cbd7653aa6c9494f2e93d707837b4669063f016caf2f17b2616aa825fed9c1a1cbb3e021b2f850b2999a3484853fa595e15c51028b0c9f7c872b941afe38cd94f045e9d243ecdab8f361eae0eee934fdd5d8809db3d90b9c2a0af99c5c36df81a7d830dc57aff013b801e27ac3adce8b4967759913ed2f584bc6543e56633d62168b7c7764192531e1734b5880d84591cdedbc9730689369bb544d1a7c536cf307163f0124cdd5f4f100b7c8c12e917fa1853499a99e0d369b02ec267e591ae0d3e2d3aa0558be4357fd076d3d9721f3e32350d38616a356551ad8a47989f34502296fdc72ae9ac627273d1947c444f7b6c7fc9edda6a47dc63d1d0fde81f7d2c709b9c8df9016c8c3c2f69911d1fef69a986da35c394fcc1168765d04feea6", "8936f4bcdddf523d0cb175dbf7a24fa82a06a9105476a85978f7e43ea5966bb89fa8394f4db8a9eca15a1de1dc56cf9682334cd3ded136228d4dfb27d60b0cc5a9609cb771473930c79f261de3afbefe49263f27b6468a55561783d12988b76d892d07de13533feb1f4f9a27d88d7cfc534bb038db644bdd7f8934e7e1901ad48605fb850270d9f60f6d618c1a6eb0915432f9c1da4def3e79cce3e3ba2f9eb4029e2fea49a0e4efebab5cdfeb2f5a1128bee147560445d269804a5b12e114b3ff1fb70b9ec599eef2f09c9cc83ee8cc28c34248643762038df206f54bbc95e4475247b65be27d7f9a01d8d1d8eced0c63277a084b8c146cc9143db86c09e19fb9621c1fb328bfadf0620ea3f7df8c314b2aba54b952e27a3354e761fce39128ad4e38ab04dc80a2e12cb4b590f308623bdb82adc465f6494b491f39844c7e196e5effd91dc8ecb7259c664b0c1c41b9"],
            ["8d0aadfef716ce88483c05c9dbf144561b6db4b8068696ce04973bb40ebe65ce15e72adfa87819851dfdf8f987a508bc83bc34533e76ce7a1fba4c822b97edaafb0d54b0788efee78f138cc4e68b243f8be72c96565ae9ef5caa3d9fd35943f5b16428d5156c241610cc6185cf48bcaa509abb1d3245fb2a6030e53209edb94e36a6b528e74c715580357849413ad1911e6381b7f8732b08d7d11921ad93e0348abd63a6ad3ad2203eba282d056ec00032462f6d74df7f693de049b5dfe8bd0147d5515cc6286cf3753623af6abe57a62a7601e5823e9470e47817793d281e0b4b949534312e216daeff7284cd1328fa2331f1cc4cbb28d45547d14decaf09c1ff21609daff59f10898d64139a8dba512dddd26f04bf8a8d8d4b44f48d6d5d7109795f2e0249aa96a2d33e5ddfea171728d16dedf59275a8645b9611ea78eed6f6882424aec9ee2d817f71aaef298462616eb2df357aee3d0b1597c0d1ae7189b86fbc6ff4212f94390acca5754e38952856b0f1ccaf93425c181cc9446b94c76456f13964341e26d609f2cf5a10f41266d51c1bd352e514a7893f93b3a2ac5acecbea2367197fd45f86df436347fa663d8a9078d851d719331c5eb5a476cdf036cb0dc3ccf82429310ff02cade290234da446412c21f89c15ddecae731f1471ade8fba51b39403ae1332a9da3f67add", "8896298a9baeaed4f7ac380b0400d577b784d0e8c6717d205ad1a415fbcdfcffffbe8700fc85ac24b346629edf2afb42b6d8cc41f49f1fb71ac0c20339176b05f708591dd6df8c0b4e750a0b3e0d562ee6095ad8bd9c8acd485a161f67fd62718d1abf553cc9c05c8c5bb84d2b4ae73b3c26304990b558bd06666c9bc3db519dbc713f0b8d42040b05814cf48f79ee6a186cc9b5da7cea5bc3a11d257c6fe371b49783fcd9f07634c2d5c0ac71159e5c308408b2c501d80953b5f0e93c85a91910296be4f2301fbc92eec2573d0d01c9406627c8e21ffae7cfa26a7bf2120ddf9b5c56fa8518aabf23252e8b8db00a73313dfbefac82d3dd550b92bd2dfd21c42e8aeb3171985c9be78f0e4b284bc22f58ce3b1d75f946ce616a2a1c767b2419e414b8faef4dafdc39f07932a54b87361b79109a444f56f3f91b028ba9920dd01f0cadc6633b22dc0c1e964db3d347b426fe53a2417518eabe12f23008070291537310836d8605f9d4472f64329d902e1c41009ee65a93e62f79b2d9334b93a6248c02afff2ce93b746fce70ea11c90302fd94eb15a459287c62772052732ced7de0e0833dbe485b0242a306efaa1af0420208413ec81dc21a33ce98e36d260d98eeffdc1ba9ffd94624b447d1e33d1a", "88003df31a39313bafd8c25ee98244d058a7d117220313cb5088f4fb4026dab0e115612f1c09af5a94be70e18285ee3481503d021ed3ce6f6e645e654cd766718a52cbe44051b494763e22e5abcf1344a152572cff6686ed10fcecb0bf6eb2d2b22a749448dda9cf2e1abb145d47f4744585155b258dedf2cd16b95f3389de454bde4fb78d3c10a5d855862c5bfcfe6b096ddd646fafbc2d7c4287ce3bb3131afe68135cb5a2847337b9027618961d4440e5d91359a28a370a4d76858713e4969f53839c5393696130240435450b92890968e8ce14ff99d3245c0f4e16c9eed4e740afdd5396989522a24cc686d928261a0e7617dae1cf9a05cee53316a733285076688cc86776198496738c222d0272038a5e4c35522497d13a7c31a4fac4ce35c19e0e61f0970419b98d7a8069a6cf3cd0f7578f41cba25979754acb6a5bc26f6ca2eb81197e851a35aa759b3e4ef65200b8841678739adb04b7c950501fdbb7f43d69556026dc7821b27fdc27813e1ed98573f98f417ea8acb0ed1ca3e93749420776307e9e360395c6f8c44929fb18b4800663906af78eb49980a52564d74e3a6065a0c98fb9a0434e3e989373ad", "815a686628c69a232ed4a197285ffb293dd2f70d2265d5f9669a5e965ef066dcc95d5973082556a7eec269f5b8b6625aae040df607294783e69fa22ee727164febcbe6e98a895d22720f922d8b4903b9f8e7778ae5b0c19d2d00eb28bdce20cd8f55fce403bd982af7e7736be3401f439842b57930345c7bda9d560d0ed834acca1a9ce471ce2e498c799edf93ac5d1314580f7291fcb81f0063327f3878d80eaa684ae185148e56c3928073a29d82d65735af5d615a0ee05c68ff332c136416ee1ec6cf89fce7aab0b318dd56f0cc4f2ab30fc1e7965b75558bfbab90a52c3de7c556a62aa507db4cecc539d8c668542fb1d26e5ed5f641f8ba5196fa596f7ce0def80e360e0d88bb84da088e3ea9953ac366ce01c5dc448eb85eb3625dc933507d7525c4deb844d7cdc286d65c42fb578e049ab6686fb42aee2a934416ce03bc516711fa5c00a3c3f8d2dead6887985e4403baa13360757ac742d5052c7493e5227d7597b10d4f7f8416f84c9243cd01dede7cf22ab0ba5bdc7deeae803cc218f99701400c2afe70586a238327832a", "94c2d44e3a46a3d674bf0ae3d8b42f16e80e0ec2adee2840aecc19db19e21d8ee567e248333b2fc6c6fcbf4458af3589a8c992cdd421f73a6d2b285e6e6de03369997bbb356b3676ef226c97597f52997c97bc89acee54c96c3690c890fa9436b0518b1cc5658de1dd0f55b2890825b53dc6706265ad55e6f67cc11e344644c6c2269808912ac5cc3c7919e1e2b416115768db4ceb3b1c9b1edeb46092dae429187a17055dab42df165652088307301429194b2dd510c9179c0ae6412484304e2bcb53f7230cf6db157d61a8c413f35d4e361412a06fd72a415850df0bf612f22ad9e957fffd64efb49b1ba2c9d199886a77a33e4f20f08ed2dc558b3b2b202f4ef07ec359bc1f99b16dd2d7b9b293dd217c803b4a351713a6d17f52ebb12f2f4bee543b7aec87320f4d5f410337e87b2c79efc1e9a6e71ca3097a1cc5567eac48fa762b9b0e15b603756505fd82cc461c177304f8e60e325a4160c5bdbdac2d8b1d7fe544ad23f890fc558b1d5fcc99", "8808d5105a96aff5f57264d9f39d4fba265b297d762880ae04d98dc497d816b0b7c07e0fdba33306c86844deedf2ce218ae100c02bfeb8f097a8b66d8ac5db02756101848e52b4dbb97ce6b72bb03c4fd5dd71f3fa8806d9509d26d2fcb269b28623dc5575cbce4cffe86baf9853ee276a0bd06b66522ce48bb344cecd42aaf77f54b328ea3f1b372626e74f5ff476cd22d094ff5490a8eb103e95256226aad7cfd7358fceddf6fa405e5ea012f5f5743324ce2d0d6e88b8621b5b900217ca70e1a923a0fc82153fdb3d0f0029a30ae056491065b67d37beb5409bf4bdacdaa9275aa225985a3f4215b2d47781837cc71b0484ea45ae510f87ca84e75030d2ada802f79884d8ac70921ef9e08cd360c6242d87e8890391951f1283f9453ed546272ebe98e19ce4e9119faf4e9fc8e6ee227770ed4ab7dc5c88d893e80d9115296fcefc6928a7cb8f39b3fb98553dbc1c"],
            ["b11d6c3b6624ff16ef5106fb43ae339420f7998404dc5ef17b57ec2f18558ccc988b4c9aa26fe2addd3d87737d65bbce98f8a6709b978cb840071a6f251e29ec5b98193004d01f2f04bc1ee9a6452c588a9b73733345d7448ece707817cecb7489e8c611dc3f16ef08b02741e53168646817e1c81da7ebf113e9e8a6eb1577004ce7ee2ebfb4906be78edaafb2ebac4d47672604cda53df3c2cd353a9bec7af5b8b8abcd3c4482f2049af3df553efceb668c5fa0e4c6b4bf264c0283a1374ae4ac5f4c57956bd90d1f441ca8d17ef4fd03c6e7d3f6f0eb2d17105d3153b4cc6c6501c41ec8b3d27bca2d25320dc4be9c50b4c8467c8f995b51c05a719ef83ba383dee5510b60f98f5c3a2adce36bfb7a5c4280a4e09eadc098e3e1ace0b13b0febdbb3f1adb395fcdbdb9426bf156bc46523063a859599a48ca76c2a66a8b7b849d57086be45623a96b4ca2e6dd3a43873df25ab089525c784bb6f9183b4d088a9ce84562e11f6c01868ee1df7ef78d505a25ab7d57d0a949a5d0ebf23f1ec5397a8cf38e84ead63b52d4ef27a8a71934ddfba6185a3f006a51c8e2ebbf83b9a0d28ae2c7ff7edce90d0ed14e23be13911e5aceacb0a55e928cdf1246999a3aeb61c8bbb5ac8442c39b86f8bacc21c4013970b63a3e5f6ba6a14045b84cfb52ad0c540c70ef26a5473309ed28d70f567", "8b826d9e12db1eeb6b691a571290fb40899ff5e9ea42c034770919211eeaf3a3705eb21b183756a75a7a1cabbdb64c978b5401cd4e211ac5deade35972b8e1791e4a234453d0fb870361ca2a7f0ad7dc1ee7c836aa7cc61701f5ba88d7fe2ba59366684fa5ea8f23c0f97f756987c8b6de5ce405ab84bcd8462e3c997ac022a3c4945f514cb6f693825c90fe45eed74b54a0f2111d32a387a053dbcd9e510ecf02ff415ad5e8aaf52cc0c399f36c3abd47aa2e1ba31159fc0da7d59b9088c5010ad80013df6b51e8fcabfe6b94c6eda4601ab182ceddc1d4b0aba0de34f5c32cf5f5a58ed08f938fc731f6538fc83acc17e099319b4a2003bec6c5904ca7e98c8c6a8fe967eee1fd0bed3b050018d99d299ac5493d699f00de65dcc9c0c9f6f6958df48f607c35c4dffc19191fad5bc32cb12281909fec473626794937ede36bb1121a579f4dd4aca849651d8943657d20b02d6b3f79ef23e964518236590a713d4765de5df664353fc0f0afd0894cf35e4a819de53907472a3e7b14ae00d7e3ed83653b2bf008a6121e07a4f70dffb94eea95bba4d6e965a3ee3846d7f4541c7f9d05898f3d7178c3da89c2d600eadb5ca43e1372effacb7182bc4144ea7b51a9f4ff002ec6459e72a2c04ed9e75fda", "b830d1a741bce797aaeb24b4c277983aba2e3f4ba75bc1ab937fb63f79d79ec7e85062698b73c83889114ae1f479808db16c5a14dc0b7294140b2ed745b6c3488e37af297b1ad4654375af76e8d3adad85294ab027cad4bc7ee332e7e842fc348d66cb699dcd785d8ad6ee32ddf20690f5f4f8d71c01ee4b1841b1d3402eaa7cb19c8a65431e72cf89b04261f8927a911862240189e0390b817bd9744e6a29a883f016852da87d3f4f2c4e433a034f0904555560a48d1efd8a85941104ee6cb303de7adf5e64682e411f0c07e7f283243b405d8cd03a22e524801af5d644bb88d72dc6decfc92bc788ca34356044a1ae20c89461d666958358d81613b644a9d464c3207102537e1b7cae9ec2b14468a75e3b89ede6d87b9741aaf7219c5a583d9de3c9a7b7cc357b6c57174fa8b17a4a3f810adbc8087e0986d740fab79822174301e4695892b192b3e6c29066b1d4e6493f7b7ec7c49fba99746d5fedef310ea77f1772f79837ad0d8af1631ca12b4d444d1f5639f015be10a99f2cfa7c5743d9dcebfbc3c29cb5a6655887740b3b245efb8ab61808db754820ece9de87c785ee3de034b3edc1c4cc9700673c6d06ab", "a136abc599cf6d04e8f941842fc7be13a274b99578c187e3d6c99de27f6d0aa060d7fc912e3710f73e4e63a5519c2108a29c9839bf682acce8d6868cc6caaa09442926aee80ebff4d1f1d256b7aad42e1bc8a1faa670bf7d91347b682e4fe7818059caea9a3bef182d263015ba75e0d3ac43aa0eadd6a65a5653fb0ea36d061fec2bad941a759735afcbfd5408264ecb1b81dd603565e858941178096d14bc4eb65ee6d7c0688811e251d073621dcf586cdccfd92231eca9ad78a131f621d29ca3e26f7e949489d9a328b652bc4a7cba2070ed74cea0994e70257ddaf665c3f0b3df440988794456c689fd35d13a83be1614c8c57f90d4cfc0202a129550aa727c40c483af82c06a39bc2acb3f7757633d9423455f0b2eb6f68fa9a51297a33699b00d09d9b4f66baf84fb5aefb629695efa386a788948cddddd14c826cb8437200b7055efb3296972904657fd0063fc1b9aadc16dee5289db7074895db67960ecc48d3b3c9239bab4ee8037ee555d72132b65d3744ed79426bf91446db811c2ca919b037944f70fdcbe116ebc982054", "83e871c39bc2fe3844a356792e28395167f6271e8d355615754dcf89696922fc2564844a7d5524e3c7802f75f14cd0db91d0e95ab42b5a87fa348cf7303af3c4271a891ea446ed2b9d520fb638606d3112c473365c3a716caeca66c17a0e61f28035db01c983e200525768d84a1d7a509c6517919bcc18e9faf9e92ef126a12fdcd13aae05441087aeb55b3c9f897864319c8bc036b87a3002ceacb3b7241888c0475eb699a926c6290968497d3b2bdc5bb53857eb80f86b1a8ef75a4a778b501f944de9be8de8cf47cfaff2db8b1c3115446a8d710c830cf4c8995e0c3f69bb33d0d6f416af00bb9ca26caec26344ff3a95f8ea34b2ead87a8596e77f161cde3f46442d6ea4023f2175167b1f1f242e4beff95da72858b95a102c637b1b313b575e75b5aadbcb94ea1396028be3f8376221ea57e48149409b53e2f8ff47bb1cd16023a9ddb794aa824398735d56f9d9216e8149a46e8a33146d769bd7820be35ea93263cfa6d026c76e7293b08ffef3", "99ec0e326ec1e40e5f215778258e4f0db6d4c5fe98002d68ab6fdbfc1a411d9ee29c1df91d17c11fa245a526b284f90f827ee9ad85562d862aff2af70879cb2194525adf14a3b3e656ce282507302e77f578b2ea8c8a03c552ccb21595002125b0503811ffd40704a7362cb8322fea14223376d50de18be1b3ea0176f81d04bf9183e92be76e6c9b5eb3cae8c23bcba2368068c1aa213e104a063b058459026ad3b6e2024056a64f57d1eb0fc85fc50327180f28d379cc343c0978f879c70ea2bd59647fb6d98559385bd8ff118662cf3ee17c0ac713cb2ce3240a00c02af30d61ebf4aa27f87fbc4961057fef8087f602608ac5e69c93ad59b5315f4e9077403445574a18a920d83aecfc06ef6d3b2d338dd397c2ff5dd356e478eb1cd11d923f09459eec6c0149d4938a2b22223741635efde25f53f57b1f37943431d64af4a09c7d32ebc62e83b71d574e02ad0f07"],
            ["85e0d7c8f6f0ca02ccb398a1a4d50319c3589aece122f123205c5ca9fdd1ae2c6c941416df05137b42158438f7ef4fb7846479db924491ed39e8aea3b05eca94568700632b05e74555c640ea33177e35e0b854eda95ece8b7229253ca113dd989419dcb9bca377b1c32b70721b152da1404eac76ded1be410ff122b6a726d54d1e750fa01049c600db2ba7589cc419f458f778052ada4cd6aab8e532fa3d57de89e9f9411b2217ba14d09d8a4249cf0d435b6ceaecd004588e853dca9285b63c62281e400c10e37d17feb527d3b63bf36ebf7c357b6194007fef030cdd261408f41e315e1a14e6668cc0f21df9118e3c231a69b9a8a3dfde0fdde5b44aab943516aa695fb412ca6692d0ecf0d919c6eb70768b880e821bb032ea94b1e6453473e4e2d9a1491e58ed4f2e525ac42f4050726bad26d8b28f27d04fd55e13d703ced68a4de57d059147150358030a3229263bc02536c81754584d22186379fa53065ed4f4c90f60e4aad9cd28b9c0f95bd843a598e4c0ea3f08591dfb764706914acaebafe643ce8efb2c3917952b481f026085933dc495f87ab3e2207c7e708fbed19dcad0788ddbe378b4e927e03a2b29463aa3e3c9574252930a39627bd29e73eac481d35bcf5b231669cd41727bfb923e612cf78cd8c9d9f184f0a1844a20cc15871e303e40c801e00c2f6415e039ef", "95d97d45bb2abfbed3d5bed5b1b8f24472734a16b78f80ed47a3f0d049ac9d1e9a51a6e9250200d4cdbd1d8609b9df90ab9671494602aaaad111711abe3e4701d77630cebda15166dbed7ee190041276ea6b027580dedbe63b255ef1515de33087ebeeab294364a34bf917d9ad8c0c504581df8eed6ab0ed22a76f0bef2fa92cb114a0ec12d3014d2f4514a22329c6c91cc3359db1a3f9461ca529fa53775553c770dd7c505ee4fa5e709c72e93a42f4375a81fa14a3ed66b9750b1e2aa43517ccd865ff1f451d8095ac13075bded7e65a416b99b2d197b955c20ae227221ba5f19496b5eb7f41e07cf71545023b87a6051ff2b8a1f6189108b1d95f1fd7b6178d62e05f6c75771c80f9dde6d8900d401547e1bad77ac595087db27d47f74b240542ef066d3a26cee44a59aa6600bb9d2a79f345dffb2df7bd39fd4eac091e90dcb6def5d869ac4787d0c4d23fe07ed8046049f8fa49a6c5d178d8d31d3278ac547b9923bd095c6e64dfca8f8379d80a40dce01d694735566ab9f13c6373f55c0c9f9479a233d23a20027126d57082d849498cc62c701693eee68567935123f74d015d209e90ae8c9023fa4cf6f993dd0399168aec750a643b5eee2d70886fe06b02d2aca8152d178451ea58d342cc5b", "89a3e3045ae2ea34737204ca9ef1852e5c3ca1913056735278321287e198b4aeef52de5267a27688de1f7e641ea225ccb7bf8aceac9f8d72f30594a19e21858a96b8c6b7654d5166ce41b1cf88e38f7f13ef76d31f96e982e3f8adc6abfdd156b7bf75cc4e0f2280a23d15caf31dce5e7f1feb3f84091b95ac27e787946fa1e86ec96fa9b6b9d34805b57dadfdb95fe730496c3711242c95b312d41d346c820210ae7095179e79af0c2b006e386780eb51d13b91edeffb711cb89771b0499f52f4ba01515c11a7c0134762e2e9e62402336e34b6284e728579a5af989ccb80f11fb60bb31007e3085af96a41b88ff1325d79ccb28d5f7cd768d51da0acdef8d7300a8fad21b8d0ba9c733904be14b91920d1ef3f14e7c5499f66ff642b1ab93df17976b9bf90f3efd3b25c7ea665618e13d46417fc965913d3b8d4941ce79bc4a027d2a8b8cf9006ddd89dbb4c097d0d4d59aca05c77eeff0a0adedf4e2020e1f1358d7d0ac4fca92f4db19315139e221970c1f0c1352665346b658f8c46f9c1b430d2cf44487e8e92ae9fc70e248f8e0bdc104d20ba07d685241ad1b25b616759869abc46e0d4453108642402caa035", "98a03e8d6be127a07cb6ebcc101c9423747bac6b78205e3a751cec6017f7f71e6094c543474f9148dc31e77a58921b94a9062b24ef41620f9b2c7043f05d2a3f7d4b5fb43d09a5d460a840d1861d3d6484c22d588154a9856e2ac6633f36bbc48a3c576774f5408ebdd2378e08ed4dedaa2411dc1cba0c57db14c634d9e5ba6998c5bcbfd366813959568b56d0e21d0d51b98d33182262188da2e2b9331e57d1175111566d6c8864b327ef5157edbf736dc629355a87618266bec8c0c3f43399d6bc7745cf7c64469b00bc368f39e41d4a3dcae376e21d34ad08c576386ec8acf7698f1a6d789a27931333683786144106638487742769900ac20482451ab811c39f0f7fa132e48874fb8e1a8f3b534709d2a8442dfb39beca64d7c4a9150e3c5fc586b2e4c60e1523f71e4918d0094a5a90eb28adff256d18bc9f5ca794bd00adc8500a39268ab677d70034376827eb2233eaef3a89999c694a5e543f4ba7aa739bcfcf233b25e640eefed669fc414d5158ecdba97444b22457986f8b496a941eefac76d7f80b205051f08774a64eac", "85264940f0e919ae2dd02caa730ff0d24574448a9e7200d1383e874755374d81e8df9a060964a4494889008494dd1c5581f14e5e68798f2a7fd4b9f7158b66b6c19965b6af9972b9ff77d683bfb3e5cae7c6b7f0146364482f94b5a3db35118e98a496c773e681d4db2f234ab09fb37f4bbe84c88b3099095e696210b548ea6162f4806d106c0bc47329cdda8fa57f040288e4c602e6d62c010f95fd72246ffc2456d654c8a7b074ba621171b6f16e7051a2da53582f738092730953c95b1b7909fdeff7a05fcf5ceae3aa8e9af8b376583969f1eb245b2edeff9a717246dbe4b6192d45b4ed4c05d3b803bccc4a5e9d6e5e53ef15f611f884dc43cab17288bdacd6e13833f3931b869ec7462dc75ed843e7c603084bbdc29f1747c1acf3c7a19f50e32bc748c120fdf00e1447fbb8eb3623434086113bca2632fdb34acd4df400a2b86a940013fe205f0751c3695ddf6f031e3438ae52e1055f035faa686a838a07bdf3f43013ecd31b1cfc35f6d8b0", "876932238d5cea012fba7ecd99ce5f6411f04915cb44a987d7ed532d74f9a91984a921f8c936d74394a131e73e824fba805dcae328dea632b22d6ae98847d2e0d4508b37dda54b2d0fd6c0486170384282c0975da03bed4723a1796d39e707ad9088effb4a5acc60dea86642899b638cceec06196ef8bac3152f0567b4a1fc7585019e065ac14896bb62f403b6cb27f958aa3aeae478813caceaae5cf6e47b36f7b86ed5a8b0718318b21d86a3d8a0f26ab14283d6f4bd5a17942385f8b15f6feec096bc22f6664ac03b876b3aba6a05662cbab7b32d174286a35ce2c18cd9f95def31d977f7a7d9fd5292b066e9b2821308a0c186479ca1cba95945e506953b350fcf8d1b92736bc6f6273ed8ec4f550f02b22d29eed97a29efaebf83b572b6bbc6bdcc7a746b36a997cd06d8c754e620df4b2da015641aed5adabc15099c620960628de5f561d7e25b776ca03e0cb7"],
            ["a8ed557c6885df4156ec9c2dba7acf6fcd1a7551da309bde7dd2a9e39c53699741558b9aa3c2227d7e7fbd126b54185c97bb406860dc7f19b9305f92e332bc133497041f4ebfc6caf02025c2e7fd6387635156762c34051ef281acdf88bab91894620b930ea670f2cf5fc7da8b89ec33f67a8b1ac6db3561ffeb663ae601db22bf99a7f72bf076e85e71d7a488d24948652c02e06f8382d21b94f95bbfea1f958b233d35f7a32e73be65058cab2cf2ea3eb2379465dedc9bf7408ea30fc27cd6b2559dc49a460b0819206e322e9e1f1243e9ac62db7812c8dd522d9f68a08c52d761676afc41cdc1ba3ba795b1789abe2f36d665723219464b69482df37f2d1a5042e172550bcd933d22e43b6996569c50aa055396a5bf71cfdaba4a22c1e80e3f1b42fb8ac38665ed76014d18d6699d12d6ecab122254b34f5090ae017bb11f482ef09005b02454751d48fd57b50aae66b553b919b47a612303ad4673eb715b1c63de95b6f80bb825f017dd5fe0b7be3cde57af443969d2e8b314575e8853c71c89d02a073caa2f6a7af81a96864b1f328e9679a3a0ba2d9ea06bcfed167ed846183aa93ffe944d8be1b5735146ce7b5984ae5e1b8fd1ab8b4eea6edc5ac60efb11b0a8d439148e67895cfaf48e417c42ad86e1bff63e75bbc58c7b51e2d1ff2c46dad4943544039aad2915687600a3", "a10648b90103ee02b789147756f83ce8fbdbeed4845cba0b3d943204dd81ff1e52712d854f0a745e4451216b6d54e877972cf350c4e202e9e1d04af1254386677717052791ff1d4bb5630993bc6bd8b83a24262a86a020b424ff040a9f01de9eaffde4faad8dd30d1eddf3d8874b5868464be3ffd898e9537eaf5cd91d46db50bfc1fc9b873fcb877adbc95a991fd0af34fd5fc76123d8ffbfbc220d6ced8eb3e2003ef8b71b3a664704fa5570d2cf635f2b2353192e6ae4162a059105904dc24c5c5c0c658c86e056ee6469e186380546d8ad621fe7b9e902b316f8442c2fe33246fb46f1dcc431ad0ec801af2b85362ec4736a8ead05dbe9ab4fb63e1e06902c5490a688bbca34957dd904db44ca5a632d9e570e9b6b4fc8ccd4c8dee31efc32ed82b20b3b8694dad8596ae841b31b4fa81187c586bde995bf17141e07bd5490e8f4979355e7cb54fd73ecdd14bf1363c3d5eba112c6a32a1056b8bf26fd0a5243041a39830699b40042241b4abaf00613bbc4512291470135647856af651db5eeb697e1d6dcc2d06d733684099c2c111b61fc889faea6327c5db81c87b3f148b7e9c4978ed45a583e0758826576a45c5f60997a7372216b65c27e8d00dd3bd19f99ff0e2d096a415f47410dd4e30b", "83cc46e4f81c654031fd2785d343f1eb79f4d95be6a19cd515af5eb0feadc3c25183c0774520741f24448d55e44dbbb796a499d6728f5cebacc642b150943c8a0d0d3042b15d05aa256d23c97f5e4e3a7139ca41a184fac3ccca6011871a95ba91b63ecb68b167eadbb69437cf622651945087e59871f609082c1bfaa3a902c82609a80aabf8f7754ecae0940625d6014e36ef323b601b07e28b85912366a2b33be1d218192c6edb308cfefe76a2bc0460235ba59932b928199438dfa98020d630baa04939dcd7df38448819b771c93463b6107ff2bd72d5fab1e98fd399a54c6e6b2b2d87cddd786fad55413a76f7132138464e209efacf1521093864052c569b7737ed0050f825fe541b59292f321830193cd8211327b5ce1ae1d599df6cfcfd70c211e47ee9cd241101b8c28b4e3034eac381ed346d0945a9afe2d990d442116ed9f89fb0941d0cdd4490c34a919b69227fe47883125c96e1fe28a7b8d286e34f9011e40b7ff4c7762f91ccd655624afd7f454d40b7dbf3e2cc28fbcacff6a3749cf1b66617f306755a64fa623ce3412a7879b81eb5af7501bc3e490816b384a6203b0a4b24c822d7354a248ec016", "95ca1de10510552e4c5130e21e723806cec1c98565faca3a80210e4fc99f9ae0ad9b1f35c160a24257e9ae482d36e67aafd7a43dc7cb7fb257ada4bc1100a4bc872937335d83392c87a5f7cc20503ef53f9289e953cea3411004ff758d1f9799a18cf74dfc3dc8766f9ec887d254838f2f1358b40a95b23482aa5770d9de21d44158482c5489464e9a04be6ef1a519555b2fd0efe4d05a271b5617da6d368bab1b3d8baec24fc51c3db0826a0b9052496d1c4426253452c6edcb4a3d27dfa12d556ce5385b320ac738f7ec3d706005eb449c209596cb37f1dc49121937fd5d9d558287c98a80088fb2eb88d9c3b4fb593fdfbd07a5bd79bca0f09644a9a69f4c5c6fc612e97711d1824713addee8819044df9df05903962e94fe90d1146d9907b65e78ee2de5487fa5ae237d8bdc5d483f7ecc6c8ff48a5a4582ac7d8b4280037b2593c9b2d088713472e2de961f957530735afca4f9e5ef6932f8e7c271ee177f4d5ac39ab62998a22e87dd667456530a152451940131d943aa05df6015f89af20dd10c642f8d7cb70b28803c8262c5", "b957c6485043fd985eb358e8b239c43feb38b0b46acb583c39ac67c5d6316d7f939a1f9248d23225c979dbeee9fff0e48d89f52808ace9d81be746f7c7608d0f4ee93239ec5bc3a5f0e6a87e6c6c94eac477ee29198e8812c3bec43d9334ad37afb330d69a702096ce3f88ab7f72aa90a463d683bab9aac47480af74c2dbbcd1d63fde52977df56e82c3f1caf07e7c0967a47c58a54444350d1c7b652d026708a875e7b2009f350a4a3978b25d7803a14138a6c4f74d437b8c5f91388e8f44b3be1f61dcd5bd12f22f5a5f3c2ed0c20a465251dbfefc8364a307792718dc70c91f0f470e16889cc9496358fd0b688c5610f1b58094cc4a0e5f2bce6841cdbff7e0c01c7406e3dd8c1456fb6c87f81bdf3c71841dd90869d2172ac13e5120d846994abe72fd8290dbe1514a678fc3bbde5c9f1ff5c33c70a37bb2a7d1103a4bc116e2bf419885e5668e0e781ae04a7c62224b30747ba611fab930995d6ed80bae549d296312eb373b8b99d6fcb5f3a23b", "a231dddadb406c12dfce1604a7859e68857eb5dee9d4104993f201fa7666df60619375b92718d87a5b01486cfb357221aa212300242278caa7ab267e47713deb1489027aa88b38af0a667ba66582ebf5cf4d7cd63057c865c26532d5520b6ed7896d7a0b53bcfff9ca935692ae5dd598f03413e59475115431db431d41ea26dc759da25d31829d201553ec46cf03c3ea24f2bd52d80c8e1499c636b51190d56d0fbfac94ec37b3bc6e9e3f62fab4cb4b49a2e0ad70126aa113ab0d2729933c53d176db8a50812dba5bf92496a58f980700c1184cafd454904adda9cbbda35d505cc0797acff988c4310b59b71c99be876f3b2e69daa716d5422542fe7ac286616900af391708c3851d4082c5812c26fe016f56608fa2f47fa5c3c0400d949e97d10e69ace547f9846ed120550053aa8270f8966e551db41252135c45c0395877d309f6c9908ab374eaa2e2f7407850a7"],
            ["959a82eb6512d4843a2a544f31f352a2dfe176879dc24132d84992597d4d8e3265f10419440c3ade186a117dd13718f08109970379ce726735797c9cf124afe2f2ed6537a0606c05e709a0555b85a83eb738083c8c4a3fa3c97ae6ce981165138ff3f395c5d5e5dc93c9643923bd5a6c19e6fab480c9c57be91af22d89440988c289b8131c8bc7db451ca2d0c59daeac1505a6f3c0bde091982bea4c49d080ad9d32af0822b1b7d618be5c5ec850fada6ae89ac65d53b1647a7ff18639176b80e411431a2538186a558f42b72c3242552a178668abacb3d0657a8cf0a0c390e60397680d01b51f155e1f4acf1f48b6724817b13f4712c2afd915b9ea92df7e12fbe5caa5b4f05decc7c6fafd905bc87d56e5cdd62a5504ad0d7b0b8e891cbb9bd24d0c5a7b49af307879d0e07bd75cfd0663adc844d17e8695549c5cd5365dc54aa1fa5f6699b20614f4ba6ab95c9dfa468cd641bf716280bd596fa2fa386af180cf049356aae57b4ef267187b338067464abf74a34959effdf8d605d0f6dfa892e9e152f35d327999f04910944c705d53d951a7fa424fae524441ae768c2ef8ef7b880bcdfea23cb55a53c7ec2a75724b259b9a680a96360130fe39fe4677dad4c7ec39ca5fcae75f635d642d9e00dc5cd6f8fdc42c8ca5858487f51762880985584ec58d796e885dd0ef03da5e8aa6", "8a230f641c73b68f43d4cc1ffd77c0862f02119e7d73f5969004eba228fd5bdfb9ace1358e8ba0199bbc9f05a83170efa4bac3c5957ac855b8a59a923bdc8d7c9de59bac971b6e698cb31c865f0a3f94b696180988a72c200766a557c7194d0ab684149c88f9ce04ee2fabc8acc3d00c47c7329a80ad9623532f9a3725bbf4d78feea021bdf55addd640c47e1f8776ea21fd7e7c85f1dc8ddc8a264366c97815d8e1e1b5314c3948b66320638502941366511ec52603a9bc4b36b91ce490bbb23714610899a3d9d6e07fc25beade70cb17e698eac37f85164eca00a768d01edd1d064f17606dc8aba5cff234399f489e70d977b8fdfa16e06f10c25e0ff9ae60c82129f49ee009500a616f2b24eb50803ed24bcaf5e2d8ac4b948aa3bf694b3f9d8756aca1c7bfaa2ef9e2f10e8b984b64685feb9830731bf28e6cc298ef4bf1af0460b7770b20330e04d16f415016fa354d3a93f4262dc4c64e3255d4157154d013c8f8125b1b49cde01f8054984a474356052df6574880e883ced535ee99cb3abec950a75a01ddccdf277c9e1e439754af1851a2a5e9c8e3a4821bac922e08d2fd4e45e34c577c67621cc81f1edf0c41873c8c068d0baaeb746862eca8beb4dd5cdcf23bd7ecdb7eb28905380d8c0c", "80672401eb533b082c26d03add8632ba801ec9091c7dbb3fabdf47e515e1021270a2cdda5422bb40375afa62f4eb9055af999e99a4f20b1a1ad61f36b6cea1e6373789dbb84b38d4672892ea0fed4ba218c144a641f40354abd90f6fa5b7172ab4d9108eecfee6d32749d44e32c8052ad38ea250f295d683904e8b751b9a4a235b217478c590699139974bf91bf6cdd90c0c7fe7e7fc5c14404f1b85e85c89d2656df52ff64f6459a56c071004916a782d3f6cdd7e370f7f29fbc93528da9a985c0622b939bb0d627feb38bae0677a165e380a97885c8d70183b3498faed6c65470a8fde72b84918c14c4a8bffcc22f2683542943ea663551daf909fe3b35cc3b26351b46de1ea6664f7a70ea0b481083d72e6568a209ef24f10368eb6901c511c3a35f661fc59ae3d3f84279d949cb9677b0c227bbbc3a78e20aa8e9f4338f6f401a9d695431c15e4453726dc34f309723ae3af70d90e34e1b5ae38109c2e6c30b67408085a6aefe4d9d0fd5c3659e665da32b5f4f2f369cc65aae59aef56d3220cf96da4b57d49fdc0d8ded752644c0077709ca0af928b5f4ac2ccff95df3707450fc7b2bd537c4d36adce9c14cc2a", "a90b67a615b10aa10f130e8de3ea91d3529f4383577bb1f9f84141375d61179283136b9159a2a4a795b5dc44d47b0e6eb23cdf23be1be58b21056c82ecb2a73881fdd6aa0f13e9457b62fcc8b93aca74aee0e4792298a1d9da16cd838253f61591d611f9d98c0531e94213e99d232b9b6d6ae62bc536c21817717d0fa03bec8f4fd11c00fe0d6aaac6ee7bb5e544718f1bc355b08aaca60ca02d47d6e4584ded2f3d279e49ee51a988adc0891d4fd2846197d2cdad90646442793238d48d943b09cc46397488a2da644c3461e08673d761d3826ac68e6d615fd7147a8445089ce9aa31ec53726bb307924b7660a425be5603ce23c0f66352aecad1a2e99ea263a5ab930cd1562dcf13cd68ddf0e590c44de87a811c304ae232a04c8439958f34e0a6769f09a058146f811c45fb5b3e5f32b8bbcc22e379bdbee3f0fe2d63a972be979d04137a6dbcd628af51585b64b10830aca277f97be83da997adb5681dbcaaae1e91f7d69fcfdcd8e5a25374b08271b80b147ec65da419ec8d90b7d0d61cf077e3e690907ee4d909469e797ea407", "87c93dd146a41720833face7b614786c42283975388c289fb7dc611047cff349b1862f731bcc3e7d893453df5cca77238651315c5115cefb2d92c51d07242da01ceb951d787417febf722144c1fa866190e07f423197b696e2f81d67d9576f958b24b2e2abef029e1589096a33327bd19b8b66b38f9a17abe95e147c8f95daf827d39d9feb7f8924b1c8e65e68ffd5a20ecddf962820640673bedf2a38839d8967620e6e47b7d337992f4c5fff720d6f4f9897353a64fb540ba75530fee993ef3f6dd6a83cab07b206d4d45de9eb06ec69c1a74a37d44be705e763d2676bf28e9fce4cadc19ce20a2510c7107a3f173c0c7c7ad1dcfefe3b49e9fbc152c00f772952d668a0343fe521d5a3cf56912ca44f6afe430e1ad66c2161e8d4109b791f5e8adb56ec963b0660b77c3165051dd51c188b179816bc7b976e4fb84054b12d07012629f083318eaf0b5d0615359b942217eacf02e22caa026ef8ddac17158a8e37c279d29438138056502565373734", "8f5dded7ee26597ddb6d7d8d7e243082a0a66f7b2fec3e77b36e27d82a51096c1fc6f7e486c4bf7b7e2381838591b3c3b9011cd2e26177d16146da2a8fe9d9dce68c787c4eed40f44eefbed3f66931b5fbfb684f10c447ba30b01b39fb312a2eb336224437cd5779d7de2900a1fe716edeb9dc4c3104f726bb9a56870b5cbc8916d437be5928a8365057942655060dd749d6ecf5d2845843c04db67406ce1cd64506890b7fe6b38dab4756a7e1d9f9ec28c8b012dd25511a39afd8190e7f212a6bcc49c4463f604fd1957dd7594448b10c15e3d2a6d082a89886011d2f21330fce6e2068f25caa58907e1101910ad4c43b91ed9f26f7f413afed0417c254ffb6982ea9d22f0e467eb8a87881c2f7598e19278008882dc172a0bc8a9551099cf434ae057e8769dcb9cc38f80e9e521932135f48efa0c7314014f41a9a97e96d88a066760834b7c426975b570eae37931e"],
            ["987786a33d0b535d1a02e177c20c0fb09d769de0cc7d1485e7a7679fb4f135ac73d0765f4629547b6f1d0381d076762183a7bb41bb67220af0dd84afff09f49ca314c6e966ab486da74c859a2d224d6861e0bd497f5b8fc9b8c50540cef29c5d9647e9493dcf0a6bed942aef9f3e0192f691da2f333cd35d1a6845df94be1d229f8a6fbb8977b1506232eb5ee43d7fbc6dcade78a1659fe4fc515fd754ed79c439b42216d5a59c11096080fec0805e04572faee27360f005d79c6f61e94593e9041236208c32239a9f38a608e068def55559a2dce14c73bd5f32a1de45c3e3023e990daa9e492bcaeb048f51f5a20f9506ed9e8670d4795fd4b020df9547fe9ba0b37875f0635b18acd7d9c45654317e04bf0c5e0ac45ad6b2f9cc0e804b01b57abb20e5585f77d5df2560a882444e640e41354675e335d930238a89f3ab84613fcb8af16cb4c7d84950234dd456c5853d9a53404039369f1f4538088f00aee21ad572fffe4026dce308fd975d7b895e1ff33ac03a02a88b8fa468b2443c4d59fc382ad6047c06bc8dda0d84b97aacd628d0ae300b812e45647e55708f953ac43e06dffb9e44d9f59fee9caf17a9ad0a6d75d337ecc529e68f210c0fa2e51e8337ef8f89b75d7dcd2fa6e652d2e1b96631f0578774f8a13fa4b515faeff30dde16b125202b815f05938817606829ce21", "80f670ce54fd61d065fc61e4002718cef68bacb25d186e078855ad205ef1648369740044d3936f0bd166a71ccb62aaf4af5f37f5ee059a6f528b8c176f0873885ea2635af1cb5b6fb9b157ed693fc827131b4fa718d9e11ce92756f78a9bbb7db054ec9a150b09a68f9432b44b49a01796c43e94312161edde9087c5b5643b34af1676bc09e4f5c4f36ba46eec6575f51c883c11a3ffa3af01b6f02afc377ef9e53ab8ed385dcaeebbed27a345085de23122f1bece9d74ebe109c55f9d746ca122ad2c34bde423746c8408b4362b0e80523e7c53f78311c75e290098a0a316c2a5ea48164f21d31907992b83f0dd02633c4d419b929fb8d48cd79f9d35dfe3a5f73011f576d02426d0ecf341cd42e47b61947f4526823f9543058e646b1a57fa127bbbef590a84bba3cbf81d0026b5e325ab1391bd5858febb8601501d90e6dbfd7328b1f8db33b8052b710151219be0577d3ae71c7e850e2d2d9f67355944a24086e6f219a20289ce07834f5d1458f1116b86f52f58c0bd281cc8947512b53f68d9b3df3c067f17af9b303b4585040a1538806547a28f67ab987fd04bdd8be14c0cf3db35d57d097911e7455ac21b392b6d26ecac32ede4f346f1f3c4ebd2967bb0ec0626e1e926cf69640866317444", "ad8eaa6b988d1a798571cf7a14688abadf0123fe9fe034d44109f0bf095aa521b02f952c7416e2fd6e512dbdd0a3ae20aa9f9475a591cc36be3cc8f35e54a8a11553d79f23e73c0f7108aa11c504e71cecf8a60804a0fdbc85b1145b797e90eda2189e1fc20493ba49444cf1d82052883e9eb89de56f9b01e5e9f479400ff5d4f8f29aa5b53eb00466b805e0d563f9384a87ea337f1604bbe086cd61be0e2dcbc4ec8ec45f9fdce0e7233b7dc6896e5b2ac378163f0cd2ccf9ef7825fec748c27adc47d7088782ad1a757cf958b21b4f49f6269693f88110899e4db6619bddf2f86473c6641c640bf01b0ec4d1786cc706a30b7e7ee69cd5ca94e0c2326e1d997ce67a32f12da79fd7de6f10977a8b703842fc112d0952a4de023fe9d31bfdf3b2a35d2fccbad68cbb26aaf4668bae5f2df581bd7f5c9b7995a69883fcd04f4243ef774fd965e3f96517396403a61c914894e6ab3ebf5bb0c33611a1f88da2962aa66a6be939f4e877f08e5bb4b5c040694fb94c39000249e3d4410e710765a0625c7babfad248fa52a2f6cc3b9493286cfddba5612f6645305bf7c183a16c335370a9e481c01d3ba466aacc10ccc9f2", "8a5f6d12e6c40c09c0e28570602bec45ffbcbe457d570a427ce2f3404de9646a4732a003aecbf7930d8842e798c5fa5884c45b1ab242d842da8492f401840b00b12925c93af22ebd76d26a12bf8f5f91d9560862240b2f5ac6211d110b9c9cca88892505cdc91592f2290a722141a39cde6e819cb04ec97ea102aff146981557843048cd97a80fc6338ab94d1d60876e0daaa0daa8cf5b7fca81adc50e7fe3adc2f8eb7e6fd767112bbd19cbe9e034b31c1a98cf66b6cddf77bbf83e3f31857bfe7709f7c113407279abcd2f9532ae695a6d209a65cb434fc0f0a693ab4d710c427b909838cc4974d90ae6d01214c6eb2a0048b36139aa1465878924b27bddd82e069cad0e96f9533735e4c78cc2119e71da9fea781bfd222af626300b07dc4b437812a4f54501134f04b7e9393710073d3b725efba055423bc565f376cc9c22952b48d79f9f0db1974b8eee0c4e0458271585d783321ec5a1c1c709a80a698c120dc2f78f97844b07cc1516f9ebbe553759235dbf8c8b883eff41da4f5a3f86ff6b91df36b7099be872d7b132a46423", "83d90406e8e099b77df13e9fdd83e8549b13695b2a7f3d2fa44aba7804ff024637119349d0e28e2dabf237db6ba3b44c91f39efdd1125b673175368a5c990fd23584daf6d72e73301c9b4bb62094c44a345c92d4ac9ef909e7382f6a5aa19e5f877427c258ec0951455106065504d8891753bdf4caa3a328c167a69e5f49ae5f11dbe29225c85cc6119182f342060b0f6cfa12405784e30fab48a832f1116553e7f93428e5d54d01fb9040bc928fad1d0f59f7ad64926b5e2905e10dc3374efb4b0f09eccfa22b97723beb58a0d609f650198b9e75dca4793a591c09d5e16fba03faf5986159ba2a703952f3757c205518e0d64fcca7ba182e1abaabd266076d2ff323724093af138b1b668b8c29e40115b254ddb0c1a47c246013b7f50270238d24d3603943649eae4e91ab516bb853397f57bd9ef4c408f79fdc8d9737debad32818b35c5ab95218e24844969cc89e17a0c2245e472fa964f0990dac42d38bdc81e3cbed079dda829bdffd85954cad", "93c94a369ac338ee8bf51258adc2bef1c2b71a80a11b345ca6749f579ed2c300b66808fcfa89bf554a2f25103b7642a0a5937bb156a2a8a9e41daafb78bf613d59d6fe302b85342eb232fa4d7965636ca857652bfd52ce6cf7155d7bde3a50bea8c5ed733fe5f7243db3ebfd57e44072c59eb6dfb100b559951224c86f5c9dfcdbde179c0f529a526b8e5f7c513efade640e80f9f78a9269cfc98db89cbd7c558a5bb46ffe571b62f5c94e5e9b0c95855bd86a3a16a04b7570e0d4f938c6b2fa25fbd0f953cd33c7a4a75a86bbfd84765182e92de8ad8854a6f631e10bb734150e7e32c88b74ad60b93a96ea7ec4557b2149e5e9d688b7124d1734fec5a5364e3999e49bdd4a1c82331fce0407ae24d5712fcff2bea15aa3a914b6f7003284dcd903e90354be02fafc6694ca4df5bf23411ab07895ba282593183a80a3f03ffb3f87982297e1b7df871b06e7b7690e2e"]
        ];
    // No presentation message
    let presentation_message = PresentationMessage::hash(
        PRESENTATION_MESSAGE.as_ref(),
        APP_MESSAGE_DST.as_ref(),
    )
    .expect("presentation message conversion failed");

    for i in 0..TEST_KEY_INFOS.len() {
        let pk = PublicKey::from(
            &SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed"),
        );
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        );
        let signature = Signature::from_bytes(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(
            signature.verify(&pk, &HEADER, &gens, &test_atts).unwrap(),
            true
        );
        // start with all hidden messages
        let mut proof_msgs: Vec<ProofMessage> = test_atts
            .iter()
            .map(|a| {
                ProofMessage::Hidden(HiddenMessage::ProofSpecificBlinding(*a))
            })
            .collect();

        let mut proof_values: Vec<String> = Vec::new();

        // Reveal 1 message at a time
        for j in 0..proof_msgs.len() {
            let mut pok = PokSignature::init_with_rng(
                &pk,
                &signature,
                &HEADER,
                &gens,
                proof_msgs.as_slice(),
                &mut rng,
            )
            .expect("Signature PoK init failed");

            let mut hasher = sha3::Shake256::default();
            pok.add_proof_contribution(&pk, &presentation_message, &mut hasher);
            let mut reader = hasher.finalize_xof();
            let mut data = [0u8; 64];
            reader.read(&mut data[..]);
            let challenge =
                Challenge::hash(data.as_ref(), APP_MESSAGE_DST.as_ref())
                    .expect("challenge conversion failed");
            let proof = pok
                .generate_proof(challenge)
                .expect("PoK proof generation failed");

            let expected_proof = hex::decode(expected_proofs[i][j])
                .expect("expected proof test data decoding failed");
            proof_values.push(hex::encode(proof.to_bytes()));
            assert_eq!(proof.to_bytes(), expected_proof);
            let mut revealed_msgs = Vec::new();
            for k in 0..j {
                revealed_msgs.push((k as usize, TEST_CLAIMS[k].to_vec()));
            }

            assert_eq!(
                verify_proof(BbsVerifyProofRequest {
                    public_key: pk.to_bytes().to_vec(),
                    header: HEADER.to_vec(),
                    presentation_message: PRESENTATION_MESSAGE.to_vec(),
                    proof: proof.to_bytes().to_vec(),
                    total_message_count: test_atts.len(),
                    messages: revealed_msgs.as_slice().to_vec(),
                })
                .expect("proof verification failed"),
                true
            );
            proof_msgs[j] = ProofMessage::Revealed(test_atts[j]);
        }
        // println!("proof {} : {:?}", i, proof_values);
    }
}
