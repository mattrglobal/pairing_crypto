use core::convert::TryFrom;
use pairing_crypto::bbs::ciphersuites::bls12_381::{
    verify_proof,
    BbsVerifyProofRequest,
    Generators,
    HiddenMessage,
    Message,
    PokSignature,
    ProofMessage,
    PublicKey,
    SecretKey,
    Signature,
    GLOBAL_BLIND_VALUE_GENERATOR_SEED,
    GLOBAL_MESSAGE_GENERATOR_SEED,
    GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
    MAP_MESSAGE_TO_SCALAR_DST,
};

mod common;

use common::mock::MockRng;

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const PRESENTATION_MESSAGE: &[u8; 20] = b"e8gxekZpmeZTU0VDL9MV";

const EXPECTED_SIGS: [&str; 7] = [
"a4dda7ac2b3381fd099a44071628b425b1080148bb5624f9a6c7359962b09b14ed0de4853d080a80ce41f9e32fad9a360c6cf5f2ef87c42191f72358097ae241303fd7592b59573ec9c7aaa8e366abf536a5ba0cf0f1cfa7723d99de54beb7ec42e2a02f89b8c6d2f0f93ad336e2dea0",
"98303dda01e2d393625d0e7a0cb7b548b2a032dcd95237b7f58ce9ffe3fa31c97ea075f26640c6e0d9c319f4aaecd81f1b3945b078b8b6500a22ef66bc612eb15a9fcf6e2af6b15c638b2fa7633720ed297dd6c0ef3841b50896a1d3f47326afe2dd804c69305ffcd198a7245ce99e0d",
"8e4dc6669287ef6fe661beb3444ce6c38a1fde1bbdb31c373f26ea1904a99d665319ca0b34c11e14e22a786f03b5b4b8366744b6665e31462604dee640bb2be13b2304ae85c05af70ce2c3e6fe9024f616b40c5c4ba4770d86aaee653c1aa407823a3eaa20aeaa67c9ec64e20135afac",
"858ec43fe9115cd3e4002794b9eedc28df1dfd35879580baa44950a67bc5b5cb64e17dcff7959bf4a8cc432db452271324819f710c2cc6f641492f429eb0a1257e2a552f332f4da65f95199078b48ddd572e4ca3c1fb132de480a7f010e8c62daf7a8d77ec92b0721453e3294c8d93b4",
"94612a15ff6578216f13fbe494e7677cb8d0a10c8d0049ed35ef562a3bbd3374590d8eb1f31c3e2906f6c0afe02603ff1e345f79f320ac9753f0b405098ed6a041951b08cf6d001961959990c3f811bb4711502bf758c9937d23b9bc6bbcecfdf143f5794b15b26e516e4644e616ea11",
"823ff99ee097f0a6dd22e9f01f4320cf2bd58a1a01ba8db28a0887aa8b820365e2129ecd0a595f9889b8b26a87e1de9d0d0cd472fe792156df7bab97cbacf90f0e5e7da8efb708e8a397bf30afc9aa9639d7a5116c9fbadaef8a28a8b451948659749592fbd0e8275e7c0047f869190c",
"8f2b714b2c382e1fe5d1cb50ca0f8d95473477b7214540306dea08981bf6f0806213bea1aeecfbdb244b5534cca1cac155e3dcdf553e50bb46287671622c27bcd722dc482d6d3ea40df906ba94ef883a1bcb012e4632008c61456d9ea8ca4450b035530359da155525806d7eec27e0ea",
];

const HEADER: &[u8; 16] = b"some_app_context";

#[test]
fn signing() {
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| {
            Message::map_to_scalar(
                b.as_ref(),
                MAP_MESSAGE_TO_SCALAR_DST.as_ref(),
            )
        })
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    for i in 0..TEST_KEY_INFOS.len() {
        let sk =
            SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed");
        let pk = PublicKey::from(&sk);
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        )
        .expect("generators creation failed");
        let signature =
            Signature::new(&sk, &pk, Some(&HEADER), &gens, &test_atts)
                .expect("signing failed");
        // println!("{:?},", hex::encode(signature.to_octets()));

        assert_eq!(
            signature
                .verify(&pk, Some(&HEADER), &gens, &test_atts)
                .unwrap(),
            true
        );
        let expected_signature = Signature::from_octets(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(signature, expected_signature);
    }
}

#[test]
fn proofs() {
    use rand::SeedableRng;
    let mut rng = MockRng::from_seed([1u8; 16]);
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| {
            Message::map_to_scalar(
                b.as_ref(),
                MAP_MESSAGE_TO_SCALAR_DST.as_ref(),
            )
        })
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    let expected_proofs = [
                ["826dc0ffc6bda7942adfd9c56e4dff444d123e6e6ae6ad4cf83e73a5ea605694c73988dee8834da541e084aab37e9601a032db8446f2eedf21148af61594d470778f3d20116ba8cccb89dc2e0a9412c3d5499619c3a2f051cb576a944f5eeca7a95e0c5bd41721db4d9ba86cbd5179f4f053dddda2e68d1ff4f362e6f1bbebd3ff298633202a62c3b536a6dd24b97a3945c03d3ee7c1557156fe041c65717517d2492f58e262a8c9e7936aebc1939e7d429966948db809c4b65214f2ef13328debf20e0c41c9cf50b4a352f24626987a41a25b33be7a643502f00c610f1ca49b6a1163db3cee6539faaa989224c4196d191ad1f49aae3743850985ad698fa07d5cffd35e299f338973cf521e575f267b694e78329327bda2ea16fc0ac71600d4f034243738cc8bd5ad57126a2249ab710b3a12556355bbf4a281badd1d354ce65836ad7ba4c27916638cf6185cb4fffb1a8ad28a75eb88d37bb38ad7d01221efbe10bcd6c079a63e07445fde3dc5492813fc0fd563237a5f586cf892cdee78cde26529ea163d825996f2fa3f7e1e503437dce4e8ebca94e0dfd24e6ca170b50dc3eaaa1fa43cc7754be88b8991399039726989d698971b72317f6aab8d74668def63a42af5d4cb73d8ddff68729118a72bfe1b703027375134c7fb4be013ad571b5ca990e016e74c803671e78e926d95", "820b31c40b709986a80759daf3d0497d7eb7899664d64d2953bfd55dd7d2051c08f5b7b07ee79142aca46caea27d3bd185597b2ccc0b08da05f227bfa92702af44e4092fb6d8ea6d74428332f66286f1046948900c109c10a5e34537c1b34cada0f5182b6f032b4ec7b87cc1e48afe95f27e48594afda254350b50f69ede8f533eefbc85653b242fd9aea2e1b00c6e8906147794ca1c9176a39b98ee2d4b1a5697924dcf22b3f216832231966d10485a552f8a3c4f4c6ae106c3c93013ef7b723aeb4fbad8fb74e81af6472bda95a39019b54d75c3b03cbed72198107e2e84f98cf7662372fd8ad3b92b473437f838aa694c10a96dcfce66cc59218108e5163890f886c9cf1870c674fc83ad59d90efe41a05b240b197177079e8912894d4916a4573443845da44e87e9e18a6d22e64e72e3f6fe344601c96f75b13bd42b9ac1f427e0d8e990b8093be6e5bd77f330e5646f795a3406abc9b9d2eb97a19eaa30e2a393648f11b1b2b4e4a7e677661c206c80234b4ae440c80825195161f07e42b5685e0bf9d99ebd73f9f817f1f9543849e045c67f7f71e5507b913268e903708cc0c0e36e7e4ec3bd002d55da3d4d7548e310351028991157c7078f4ca4ad722f7d4f922e953c306447797d16de482c", "9291923c3ddbad8a735cd04112b04ca1300340e312d2d1c84c92b200b4caf33f2d1bd2fd2895342f1a1090d9e1638075a271d9df12ee2e5ee9a68ea70839e99a98565316a44ee55f38cb2ff68c38a879017e714f00d548c9adf754d79552ad148b23245b08694bb0b6bf534d9a6479a3a17ffdb75f99d73206b1bfb680acc5727f599b5e9cee3f635b397520f8cd8e811f2eb786b88e10e705e5e966bbae47bee2ec08fc82cb27fdb56cfa858bb2639b317b0f1bbda2a6ee3338a2fe38a6f5f0796f73ac54586ca6e8aee60d988c9750684d797adcbdce8c29c44f42b927f663d7651f2b76a68194ecdeb2ef095d32b14bff09dc9c5cef60274ef074e0fc5655131390b0e708ac4b06d9a4db0c7624110205ed5895a0bf619d24f89519a84dfa5b48a0b71f5ece4257356a1ff9ba109c28ed3f336bc8f4b7e3318794a52c1b73bcfd205f2ad5b58c8d797dbbc8ee2af073ddca6015e1f92d5218d72c919abfbc1b887f0395a604dac7eca68c615a239010c453a5c1d6c6539c636967abe70124ed581b1908f69fb3d550f5d79191674e545f9595e0b32ec2c2a7239b32e9562e9320292f559154d7d76bd0c1aac5f648", "91d558f9e5006adfb85aade85bc27d37331e13462b3e27b493bdec21bd9d3bed703efc0376b85fc3ffc26771d50242c3b83175a737165d536c80f7361d05f56c73bafddb3d715469ac966bff2c4ef4a2b461e29c51fa2eeb011ded7629d764c982ae3615641cc935c0187c6ca21c7e02670269039eb18e913680dfb2d10c0911de5661a3f2d85cc4afec8630edcadb9103f96dcc95f43d294d9b8aa23a939a3fcf3af01f8435a50dfcf3252184adff150012bc3887cee7f809666a308973633495b7ad7e55dc79433317b8101a33ce724ca4cd43dbc21c9ba03a5201b64cf9a83a986ffb990208eed01a3371c80e76282dba0dd7e14632eec4a87129aeaa495593c0c136ffa3086e1249366032586747355994604d30536dcc8c8f858cb93f28916f10c0649677ccaa770b2341a88ece1ce089231963e834253bf527422d1abe6e22160eadedaaa4112d351b54a28b8e55d7c662500584bd4f7980474d505fa17ec7b5dfa61e1399a14ebe06a20acd654957ee070dce4fbf996e1968ab0ca79b72f5016efcfce863db9202ef8429dc77", "b26f34ffca108785ced43919a61db7fe65924d857f7df7bae8643f507379597eef4e0a7e097f853eef4afaef8009d0ff8e454d21f645ce01831579cd4c6364ea977498eb6f64375cb9674e3505f1ca47b4e41befce87d264c6794663468f860d81a4ddeb34c14fe03a7c51eb2f33489ffb914e083b6acc78cb3240e1eaa3a6eaeaad1cb921f13ab7dc22c555884612e81f38c0d76383d11674a0ffccc296cff110cca2e5b89a89aff3e5a39ea918275e48323caf2da034d0ee5b8bbb1f4d27c28e03599bf08ebc80cb0eb5483b5e61566504a8012538e84264acf4c9c609fb47aadf948b5ed63e1f1cb1f65dcafe585410de75f82e8c777d177b392d0e294df684f1323c53a3f8dab8e4115b907b88712fc1e3a8674d6b60327bf84be1390b67e4c9705b0e494cfaf729163f5c966a654c377fb6b1e167c9b8196d03ca2a25f704969fde9365fb06cef65c89b6b25c711de7095adb88d7872f8ad5ccccb57ec0fe2e5df310968296b4a4d4eb1ca8ace1", "b447cd32dd4966bec20cab9886675f48693d6c3fe5c01d1904271f85956c614fd8314954eae2a8f301e57327fe945a0e83cbb69eb14a9c012aac5469a875c1cf63a3732b0b53a8922c70bc06755f96a2c26795b5776720d249c45de91bb0be0e9629b651e3259083939af8b330be9d17e470cd33ddb33122981753e4f930d7bdf77865ac64cd2c7c89a84821d5031a72453670c9348ab5c5e55f6cd2847182e833d65fd2b98d80af2c7831ddb362bdaa11dbff2d3c91d4a3d8cce1f0f821fdd5f88ebb432515307c562c621523c3f33807b685f7557b1443a92580d14b915f3bf0c4d860f055751cf10fc2dc856242556e79a888ff1ac6cf2fce71e26af1305fccefdeca37a196a35b6dad49e43de916031e7c05a28278d9ca0d38020d146cf4989f826191d59ed92d168504c0c0694a03551ead9486cf3de68966e133f80394de48fa8f2fd41c7dd86893dfe6238961"],
                ["a6b8ac69560f9168a6a62fde73b35f19dd0995c2d838a654eff345fadacf6110ef27e6932f71edc4b69805d65a0da7248340ddea4da66dffffdfcd8bc7fa4d1b8db75f377f9e3a064e6b137c0b3648abd9c11dc846edaef6bba120027dc2f9ebb919fd54fe650ddb1f6e3698c263b7e6c81df6740043e33cf8cd012e78ab89f3341bd8c88187e20e0698d99b34e4b7b05a55eeea284f8a254f39eb601d77fe69cba60f341ae943346805b3ad0982403d63abafe389b6cf2326370e86768c5ae652101383973cea328021ea87f40f08e746e5e20e3efc5cbc39e8ae16a3ef1d35132a8fe730bc4808214b9224461f5eab0c4c237875a3ebe84ffb8d35fe6103af76c5a02ee69f20a44cdaa6d7ae2e5a5c06d7e6f071cdc521b0413313c1c95a0981e68aec0d35355bdcb7ee5908ec8036484b21e69ce3b3a56e928679c15c630e3e4cd5b6451dff875f4b549b63baf77c417500bcb0b789de93da8f31153dec1c0235ac500c5389f817de82a4cc8e8a0b2975147ec7c0a2554f21ed57cff47fb8d2a296dfc6765b6db613eb7e12f9e24410957d4fbcecd8ad3c1cac3d11bc8adc3789ae2acd330e82c3c4d556b1e85c7568577e5f6e090b94026d31b3309eb2e8dbc878c2bfe646666fe0c8571dd1abd14aad627d78bfa37ed2b32f8abd0da1300479f2015bf720fc8bdef395565d9eab", "932ed950e9bd4fac2cfb3e435b20c8153292cf2606be108eeebd2e6c436240cf1b1038defa0caa4b74f35b127287aa5ca4856e4af30562d247fd9f86e1de96756903652950cfda0ebf50628cbbe6e607c34b285172082aca565d7924dd9b555bac3c7ba5c54304bf376226fdfe524ee977d60800bf2436e179c3d27b41781906508776cf78daf9270a66c0bfcd3a25e84c6c13c0428809b45e8dae82979e3e2b93d0d9194ff85790d000fd8da8e8ac454b4661eefb3b6a597d589b3607f4ecf67311185b560acf4c6434a6c38353d4fb601bd5104d44371d56e5163ed33c7afae6efa63d5bf25bf5871eabba32af43a140dcc5f5ed8f23c1eb80d7ddec9c83cb9c3294cfd20234999dce765fe4f52a2f2b9eb305995d1d106ee7c9ecf542faf043232c8095a7302d131589fa4ce791ff11402c27eac8e6136bfb6584bd4865a076fd65c8cba063a65d858e84406ca66036357984d112dde7fb5c2f30586ffdbcab729331018c82e0310f8b429af4175b6222604c0017e567dbc60b44a0556d3b17f56a15417dc14e8773581f2141327337d9211013e6491d2f47c59e1c9d25ab5fdc040d5f22359f4d8c0c07a36bbf460fb84ce42a14c327f3f70d22dfcfc1d42dece08e45b40cbef35665e75f10dd5e", "ac9698c1cdf96235abacc413b0eb950271b41de1867847bb2c03cd62e7ce2c61aff1319b9e947e768b3ab3027489d345a8e4560a1b9bab9980112311dbab09a793fb0588000527a1c6a1dd3ef97f7b50a935895cde1e3779c1c0314a78ec86bfb05befe21205ea29ba533a6cdd096e6cfa53210f58df5bf1977320dbe76aa1e13e90315d60b51cb96c32bcb2ca95f4a81ac76476e809adfd8bff40ea106cf2ae03eb2185b9e08c766564f31ce3c628bb6dcd12b8a43b3900e3ccb7e044711ba4c067a06d050039c44eede11ab8cab418535aaeb2225131dc380bf25d56d80d4f75382b9c6941527c6c4f869b38e59f5f4e7ebe9a8ab8455237ccb2b6b539c80db329b8949430d451fc1694ca55dc84324ed3a43dfd7653d8e4906f7afe85456877a889666ef67928b0b0e774ddb3fa1d1c00962f657d38481b3bd4e797eff19d5233c775aa0b4c59bad063185a84dc3d70f2f1edf2cb6f2c3a3c634e2259ba254ab80ad0899b2856359a249679f8046f72ee37e8adc5fe119a07ec1bb26f9ad7a7030e6272e5c09a7861b4b2f4f03f3360515fa52af17721faaef72f583fb3f71714cad987975ba60c20bf8cd0b8e675", "8c8ddaeed01f19998c6c68f3663d1bd38d6a90e6b6f4e7d70c5ad71d8e2ea8cd4e163c90add0ab2ff5e8289cc380f4d0835e614603a0dc5fe62240731a96f2a885814688b989cea267f7ac0b8f96dfa6a58b0fa617f6cf04872e22eabfa614d1a14cf2657e119345d515c71a933ee97473b54caef2ce2e7fcb5ca75307d87f9b9dabb805c7c1a97b25a4b14ae97ee45252b2211f7f38a3ed83f6efcb3b08912fb31dec1f64e9a9614e59da94d95641cc4757eeb23da45fcd49d7df2c665d2eea94d38e7b301955153db5b08e20b0433e54a3c231005d70676d7fb7be8d182e7ddd3d81abf54e3ded089563ccebbb41ed6510a8eb8f7a637529427c9e7d4ac9edebd9827df68061b51e0a9bba1484779e523bf7d46adb8de04f377e286382aab15bb5aa690f5ac20bdba5f266928c4aa304f30cc742097951ad530659d43be22f5de3f598fa0d75407fe255423f6607e73e7d7eb0be73a1e74da85c75fde426482755a716412b9da0cc59affb880dd0c160f89cf0b27cb8d3afdb6fc6bd48b0b4bd74f6a3e4143c046ab92a599cbe5e21", "9417faccebd8533312d8578c4a246b585f6fb0e367bf95500b9e96baca00c8e4f2b3748449556113c455c106e11cb0328a7f38eb221acf9b09ecaf3bbec1e2096736d76a44ec3c675b5dd7b0f3e045a6d6c9ab112ff9e75364b54ed173da2cb2a9a5951bc9068717eb247e81c26781aa52a3812e9b9e8bb55e1fb010b62bc871e119e44765d8dc117974bc7407c41cfa32c7c9954d36ff4c2aae1946630fd2df7ce4180617ff00dca68f65c1b25f85422f2ec6e8b47ee6cf99c3d70ff461ee15a9a7332c3b32334d0da98d33f33b2b2a6275030e557e70167c9f200ae91a1bfc14af31914c4f1a18b36f1122d8007bb1621cd454a6675962d21bee9148b2005607f7a74b6a3892dd54f37b27a788fd2b5ce58d83945103ab971dde9f5ebbcaad527108910a60e308b876cb504ecf776a70536f32b9422fc5c3d155cabbfe9f5d9046f113bbf550118c47fe89fda338ad0ed039700ad715ecec87a4fa442e492b8ef78360422844c912d489cf2be543a4", "a334d28d877feb8b044ff6bd010e0c0bfc534b0cc3eff004e39778aad286a6be3809fcae58d0d2c0019aa8595626e25fb080226108d4e757e5ffbe2511ace10f207500eb3842d38e48343a390fc7b89a9fd1abae7fa0d0fd2a5523bb4c37ff7689cc988272327811b982bb5d3d35d65e90c9bacb56b596b91f82b8376b9d297ee4ab6faae75479f9ca9361545fb979a30adb386eaa1fbcd526593f06c125640359effe8a92b4feedc4495d8d046d1b4130cdd5be2da007da83cb4c81b3c258d082064a427159d34e1e4172471cce36c76f0e7d706c7101065123c87da3cd226f03597b4dc124a3a679fc5d65582a3701408c2f3183863e3ffaf34324ea64f4bf5ffdd1ffb72b09f8d34c7a0bdf782be21c0a65c978f94ef4946d8019bc1b47cf573aeb0c5f32267f1f98f8a9c589bdd22cfddd896a24731e6040114f374d1f64a2c38f30af6b8cda02c714469e81067a"],
                ["a9f438945d9bfa94f6fb1bedada09be980435da3ae55dc153d1b62ac7b20fb91ae2a8d27a9a8484a5761071bcd9e7ba1a00cdcea28b7ef32871b22a3067d927a496fb4937bbe31e6f2a0ea579811dca1221f0de1ea20869d4d5694e3175087e380605cdce5423cae1b1e46fbae7626a350e3f17f31c65b865bcb70f8f2eff7749a03179ba9326e7f3bdf637d219023542a909666ef6ad00fb88f3d620807b01338441329d49c07efa8b5f5dca2ca6ad769442cfe4eae0a8dbabce064e0aaec428fde47eb18345ed19dd13d0a0b1877321656f0ad9b854d060652bf249d7486824fae87d2fc32b35fbefc167ebc52b4aa587d6eb5e7bec5e048d7a1ed9acfa1fac548f79cbaef3f6db8ce4fa0b9f4d316261bcac6a7e81bd0063c9a7a77260fc7936c5312c4a0bce6d4ac2e12aa29e92831630fc7a9274a544327b4ed7d970de199687357ff5aacec22c1aa18d9039893444e8b9f79d96012ec3cd7543cc59c2e0f01d33c07ec61610b68dcdabad195df235b3f183c1caf163c0f6551a65dda86d5225288857459dfd1b458f19de5490b57b4c6f7f4158b89ccace72f8ba883d522dbd9875b8b9d8ee77cc02753b79d71298ba19772a580875211cae0f34d5b4d0aed79ecb234c51a9a2ec975a1bac6785469116c19a1b42bd3108a83e6b4f2bc88d393af2711ee7bab4a7cdc2ba7d6fc", "9347372b2c7559efeabce17403fe1f3988b501e86b629f218c6a2a7018730024c1854e950c75cd6b081b6d3de9c38033832365c80416f58bd9eab3471d963897887b88c0878990d497beca3755048a532896549a1e6e872cf2a7f7a1a598893fae7dc4f35ace09cf3ee97a2ef69ce9b3037d939898e894483b8d52999e8f787a6ac641010fc020305acd825e7d4f92ea1e5ce835c7ad423df2ab3e84667bae3b2d2b3e27a6a2d028fa458e5f8049700061979edb6c3ee5d832180c0e4eb7db87de65adcb39eac3c902cab6d72dcde90063c6459668fc8613a7f8e2200b22725b85721196aae5a45747384674874ea7d3114d27d0b53317c340ab4db246331f7954bd074f0b739c674285b18861dcec1230051e382bf1d61f8fb5ef96aa8fbb8b881093b8228a834f7fc58a198d188ed842a199409567d04ad1d3fa2dc3edb6514286f7f530b7a2b64f78a3553bab96c90549679d23be899ea8c70f36bde799cb015f0da2d5d01fa6860cf48e2b82e87e585eca76e482a728cbebf8dae6193c5a3f0f51950f09e002677090fbb234b13d10ce2ef1d2fa9db5bfa017c546f403dea036a09a12b473ab3b8dea951e063de667432f2fdff80759726ac023f0d964ec6848cae1bce9550436464d478d2dfede", "a26b5b616f19e17e5334e0e57a8a3ca46459e2f672ebfdf9a2f810703b8ef9a35d9daf30b69e850a18f61f8e7e368fe4b59d3a45df15d45a79df52ebfc568cbe91f674cffeffac9d83c8113911d220c8f7ae7c6504a5fcbdb5f016a254279179881b6248805f7d9881f9243720c1d04ab2849a180a46e1f11b14796ae98dfef7228158cfecf02483560d8eea6678979349d29904fd57b4d99411e162376c0d2f6c91515e16cdfd48207f718d38e96ea349e939d3d6dc4b1d09facd32f2fc9bebaec650fa37c293bd42d58f39a68ebf015a29486b4e3b8f441d80f84b55f2d17ca5ebb607ea6dd472b922c3ad2d53093a043256bcdf08767fe4e3abf0f16d20f588158efed4cdcfebb072fe9472ff22625488506d09db64f367c9b94eb4c259324f97fff32bb238e75099ec314b0dde74195b5164b44a99e4b9f85271624639dae01fc102e41be088e5278b2b4b8f5f2b55c8234d4ffbe59ea3e4adbbb9852fccc9451ac4d01286f0c53066e33828f3860874fce5f5ee5392404b52063e0c4192a3bbdabc8f97395ff8c3b14811bccde772bb12befaa818a5d08d945fb30f90020d456911762f9ce962922f778e3abfdd", "a772782dc2a9b7a5097de024c7459c2b2338071f60ceacddbc637c9fb661b95800b8f61b0f84e044b39826c8eb5b8ecab8e2c63f9b662120267cc1eb18ef9edc86de10e174bde01ee706ce482f7e9f97f3d64289ec749de77702de41c4d7fe89b4a2ba6e90dc92ef7036cbeedce714f71dd63184127c1ea806a5f6537c53554342c92f90560b01403629dc232341af614ee920005e8adf4ca65384108ef68665373dd496b7f5c5c559ae882e48456b5319e1ac71c5304c7802b28bcfec04effc9a686cc9557b30bff0a4974409282022040648bee4516c9b3ad1d2270587a578e59b7672238705e828473100b92a8e48603784a4082f8b34abc9dfcf3bb497ff611ef3b823acb66bec102047b2045a74201841440efb7bf1144badbd4b1c9c65f0cc086d32510642fffd41fa261764667292765aeb404573001b784f6ef59d65f483cf924b187b837481c0cf8952a41a22db6a9389c3e06bfa9a5ec5ca01d8db6d2eb96e780416228892f714df3f714047ba17df93181bb91f9bf4ea3c6f70846f7f2a35a845263645726578d2188a19", "801fd214b55f7c7b405d3466204a634b48f130f502db1354f0dc9d7f2d88e5291318c4171cf7b15c323e087b6bd9e37eb4ce016b8d752f778ac78c84ac9965167f800d4e635658ba15f76a3967e485564320ef8db07e6407cee74771ef8dcd7badd96a91f64ac333056994a5cde023f1d2d8df095069098f80da53afde1a5dfc4cfe833ae6479cbe13a5a806a37efd9f4ea006bf8d3da631943ed2c91bd07c0ee4b02e395612295453df7ac7fd794f3638d63322eaa79b3603b3d833af1b223e3f70d494bbe57dc6d334aadaa07dc71942eb6da1b8b074d6d1e5bfdfc8fdb75455a79396359875b30e4f581b52621f8a49a4bfb1d4fe1b4e4c1280582f81cdd2ac7665505e66f123a3bcd38963cbc1e423e5c759534d941189c8a8e08023ee8672fec01fdb734b417d3454a78331e5002dfe9fa15d87d73e9f7b738e474738683199603235f9b138c63e318ae5e3e5554a47f89ce119b9b8ad87f3bc2592751003968267b32ff214606af164c8dbdd60", "a1a9e3d5c491389144d53851be69c21bc2a3d16e18c881ca75470eb8b45c2609d5540274536df2875c2def39c4a67b67a377ad4488d164974765e95fc03d449d9cfac7fc8d4696de2b86b32cf845dca7b0f1787b0f2c89f86bbc88fae33a44daa607e4a1b23f5a83c30b51b9a3d6c6e97f1efbc9e109f2e35d7d76176d89804cb02ac0d69a0a227a263fc266d9f654fc6337bec104a7438e39c65bd4226159b5fb0baaa4a3fccde85b74f7367995b71c3a9222705c3545d11a52fae38e288e76d03d9190e0bf215bda98c961c567139714e0b74cb7c1b60c0b7003bca42c3a45f5221fdc17ac91111cda17abcd9267a53cff308dc7e78baaaf658aeadeca1e92446ca77ef977c9aeac888a40087129d03f503f5c273918382285ae9f77b52dfa20bb79bf08c928e7706607d088c4ac24647bf3268a740059a6e8dc448d441a7a34c4e3e6fcdddd264ede869b418e10ca"],
                ["8b364e412ab3c43752c298ec8b04d083d8b248faec95f82f8d39e1679b24947d6e1b20bd8d63573ffe4a37bb729c53e18eebcb1a5f5e4a53129e219d7fd69364459f56cd7bb6371feeae15b83ec3d29ac8adea6f85d64d60c80ac8847db3abfd819db28255336b5d0da093ea2470ad45a997e8d7f33f0e65133d7584c3ee20c68f1cd8a45e2fcd8ca1d1e33fb21a70443c17add950a522c7627446bf19e68c8fe240191436b1ab75d2981e991efd697f0a601a6d9def6c98250a99ae5a6c68af5901affe7561607bb04e85b9385cbcf511e6e7f7bd297d26e5d8c75a1d3a3084f863520a08bd29bfc72a84dc49119c2343d4c16dd9a3de60040482aa8adf4b48619bd2db048e9b75597d1d1d20bf75c4500ed948f29ae9f1b8cd56e54a16bd9825cd7bbb8816e3138052056235cea24521a99f0a76ea3bb4c382fb0d51a3d228c941f7130b230ad0b1fdd49a889e8d485ed26c175f425da591415f3e7caa7ebab5d55860d84371bc66b9b6fb275d228d55cc40d1aec953c930f9fd63217855a926bad96511839bafdfde340ac9caa4c52f2d75c68072b5d8f5f3c8e030682f616d250084373faefb302823696a8b34f10bde45126948ba81bafff2c702d68e31e1f4ff6f61647176cfed85c36208fe2a3f92357821f9c21a8f4aedefd12d2901ca21efe9086f30c803b8006f10fadc61", "b42fb267f379ee1383476bc76d7d00b2410a8ddadf00bbc8ae6cc91c3f31efcb882387c4a2cb886b014d8c77a9abac72b1a09cd6d66e29ea0e308972f2ab47b410566bbbc5f2fd22606f4d50136ff5af40a4ebb7df4dc2d2799bbc626e8c9f178334fc7599fa8ec093e76828673a047b60963bb6179d090070ce3f03a3c5e9c9f148bb98c8f34ed30861d5f1faa07d120b7fe678955844551d09d0a994a806e0b268b3dcb2e6054f8a939d37d1bfc66351f334efba22dc144930a8bcdc153c1ce4f26404078e4fd69c72fc6e8cd1ff644b1b96c171ea7ca9f15ab51d55254b6adcc8b399f58327b611ed38c67afd75f41d130ba3dedb7a5406b20863d38442da7bd25b443a64fb1a085a8072bc9db9662c5c89a76e32e0d29517c82706ae4cd7076bb12b346d976883a1795141dc6c4871062b24278335bb14b975fcb379e5074ff9cca5b4e92bbe9e5be17b2b3de35c1a8c1cf471c534d71a3b976fa06b0e2698d545e7471d96f019fd0ce41f9cfaf000a8cb2fe68ccb976f3b0d31b6935b022ab196c85580ec822d6874af4da913243bb320661bcc044e3a1a5d8aaa50100cdf7df2b33a7f7de01e98dff8341b42d32553259f62b1adee863cd9e61dc1dce3b46f8a9bfdb09546b8f80cfaf4fbf3ec", "b41086a823756dd01e3c4703e5bf1d8617755f27afd35ed603f6be76c7d9e740f145ce408dfce7030bd4c0aafbdd1a918b4b8f79654030d6ae3968394c2868d782e96dd14ad7ca39173e1ea49a85c25ccd05a0cead10e4042a25ace9254ebe528974fa24416cb70fc9771e61c8023ea219353a3f82c09975a41c53cc6239f1d70cbaa14e89a3ea1621c9c0a76675de672ff967fdd78fada1e5ae409e09aa1f34e9cfc3ccc206ec8ced7065b9a5e804ca431c567597576f02bdbb9040d617d34ca8c0e071d5d0d61a176828dd11c398df1b4c7235c7f2c59a9e1b4355ff4f1d61d932ef46e18dcc734210822e6b920b4553449d06fd6a4361cceb8f2b8bc12eac8689b3c6a09fcb38fab2ecdf6e75a33b18ab189f87253ea1dfa47954b405c431c23c5c38312884a0eee2dd3f966b430471eb886f6a7a6a70b604b56b7403fe73748c56596748374a854fb8d629457cea1f5a61bd9e894f8c8474890871a98105e9785890479858ac96d8c2150aa509a025a3dd2261aded48c526d349affeee26b1fea3e34e12148461b41181f97382eb6dcc5fc8dcb922971149bc0d3a59237f58e81083616f61fe7831c5184d1ba51b", "882a2c30808120254c8508a36ae8d8dac64d2d051151e818e1bb5e60a7efc804395ba6075b00661ff28e4758354cbeb18442dd4567b7b3d05db5edc3c6a12ea4bf233e2494131eff47a3b03142797672c50500d25f101983e31180a53c5ce16cb7b58763ae2ddcff8e18aa1d31a8b6dde0124076e1ca102339cabda5e5a9ee3282f3dc3da0bd9a198a78b3c3e2c0e39d1b1b79aaa81a9f39f0834aafdb1243b9b151fd8487c778f19c6c8996925e8c6537c9bd648a69ec24172d1e649e020cb501841c6199bb51b10d14959398072f0663849f1142fce5c3e87f69b29d6381ac035222c4ff19bc0243920ea2340fcbf7623b1e5ec49e2c7864cfdc3dbf062f2cf2b4fc2c770bbe3c1cb57838a2fe30cb73a9aa2162c4866b1b637cac12789173a93500542d0f279412cfb47c9481b9c365c547b35582e45b8111b75f98ed55786b13f3b3b980e5983014209d39f05da36ea1771b4ba02a51d93106c2843d0b2a0a593ed5408b15064e3aa50940172c65600be787171a54bedcf5e9dfe821aa1ae28ced2a75dd56e58e2fdec37e78fd31", "b4c46d5babc6da71cae3a22e2d4da8ae1d033b28644e4731d93cedf649933e74b0a225a46c160a8405b80ce5af77f43e93bcd525b3d55e8c30640f367b5188f6a84922a801dcdac974129cc257b74aeec3abcf6dd2512a59c7df624480e187278a77c9d7f4517ee003b473ad60210c331b45acfb130e4f5071d5d8c39d337ade21005e4a29899cee3c67df6d13cf27042607923bac311f2c36b67ab63d92f7b38eb613d5e504c46241cce61ae3dd5eca1dbd48cd0aeefa10251dc87ad71441267ebb1d7ac3c682cb82a868c172b77fdd357e5044f3323fd3fda20639f0c368430e65140c987caa74b1a75ff7cecb78015dd8885cf27539f2995d09fb1705086b026203d8a361884ef0fcf8efa9e336483a255115636dbc8ac1e93a62a1a4da7495b4b6449f620a9cd676a517ef4c13ed4ead0f2a3628d47c55e61bc8aae173e959fa29a24d3aba7cf31e9d67c7ac348614ccba2fa5f642a97cfada1372c5fd1e7e05bf886fe65eabacf7447dc5cf0b8c", "b887043d240fd22e559a80a34348c768fba31a7c1fc1cf6ca1d9a1114ee335f294355a41177fe5ef4a249b762781ec0cb4134e38cdd19dced1567ea54ceac7bb7f9b7f7d0221dec532444ec9af36aef96c5d4c873f90dbf8648e7d746bed469e9200ed97693baaa41fca9ac8ec1d407cc391b7720e22808c1cf81ea187f4b221484c43d824b2a95f6d9647d9bd2bd2f543173bd159c03ba5a908f8ba53028701edd2e62ecd222339564636d7e1eb93e06e74dbb4c10c84ad99c6add2f2b2c82ed3c0523d58765d804c66dd41060ee2615c5621f60672c781de8d33998afa65350e28443d4e1b3ff786b531cde012c75e3cf1c67a500ff245181ce0b8e10cc6ac804f7842957b03a2e6f1ade3c430951950e3292429b7a3cea2d42837bbfb989c6d416c06058467dfedec0c51c486bfc03a71d339b75fc6ee06798ac79dfe4b17c5abe71f0ee002ad8c82dac467af1950"],
                ["85c0843480366c39f7180d0724dfe36a933dda12f6930ae1b5316b59b0808848de055ea0588e277e9c2a934e6ce22f99afd73362bdf561a781f735fd5cb685b688a165dfba94ef932ac53b80bbdaa1cc978358c19cbc30d25317cd4be1ae5d16a8bbffadc47cbbad03297fcdafdf0c58e8ecd5b3f474299853a5779ff76f3a23fcb1668141f69ecb52b14f5dc65931c0314f8ced1037f910d0091b0a305945affc4223925b5ffa918d53b69178ba3b9017e263b4801d0d614adec8d5e6a5c8e0077d338016a9c43439783ade3cfde3933ed89a98de10e49bf442017c2f19534bee03da0805747172a9dcd974603fdde36c38937e2c2e9933914a3655394c68db52432f64399cb0bcc6a8a63f0fe43f543b58806b533160086fd3789d6fc88f791ceedf1f738e8533a0c89a1469210a8c1be7f26386471a3e8dc667728c4cd8298753090ee12e27f845368e3fdc926da3137f75c4e2616ed2d643ce26707aee63fe1c59a23bd5756a08fa1e407561ee3e26fb9d3c039b64b1945d14d4ed74daf7e4a0bf03b776371a779cf6ddc8fbf82968ec8df37bd765fc7a867f743d1908bdba3ec51a61ed54bf1e131affa4083e8765aef07f3ac0c179ab17910b757bfc94546a19c1be1b64092932b64eedf92f631efd801eee14050dcbbce45db055341e9834b8660ce9d78c80fcdf7e4188a974", "a01888ff98e2a817bdbcc4f57e671449718290ff89cc802b31a239fa0db30a8c41aa88d729cc58967fb93b21da36b617abea43e293df4ad085aec250d970fad8a86f1d2a4ce5481d52ba6e55669fd3beb09bcbe83068bad83dd9e07c134ab1d48488f27eab42c86e5cdfd1da538cadfe83eac1e1e9daac89c17b9de8ee4425038fb7be2a40adfb4b1deae8d391a7f6d36368ebd099129ecd5b05811632329f116c8db5ef6b126354bb537769b752a0110e5a9d10d96ee8990b63263f0e955644e0c01e3a8668858add6ee88c616ed1ef6fdeb4581bbb5625e08704f59b1f17b6435027c4f00619bbeea38808c997a6ac29fe0ae0189f3634b06e56a8f9b65a7f8d4a8cbf69a592e8ac5021b81aae49ee7258c129d24e67b390eba7fc7a7122103259dd621cf694c8a096a5d3f1cfc6ca3d6a5a35a0b31d4bcdc8f832f153a12557fb069fcd793140538c0e901f58c00a5878e9161c9c8392cd868a84c07cd1c3d524dfcdcaa18820f6a2b6969200a59b0a425e8e69f13043f30a191040c3349e83ac1afa690e275432fd2aade53cd9d068a53110f2a514e1250aa874e083330e5b37e836208535c42f1e3a94894ba15f41448826e1d104f8ab6f30d95a3af7d4863b0d07f16f85a92aba0426d3741629", "8114f393ab88be449824e5c206f10a9afc9b76a2fbb71aef4f9b037adc1c6d26868ff40af1c2d5eb06c0a2bd682be6dda1fc8d11efa85a9e6b62daf155511f50941324563257d21047dda5aa1a7cb35639ab906fdd6f199d6685864cdef2f5ea8a65422fcc6eebfbf220103684a4f7a020e0fdeef630a62db899a4bb0a2b7f8aeab4ecee1d52e42db6fb5edfee8f4d7132cdf892d0b1e7a2126a12804c129c7cccef2118fc21c922b47ae767da1fdda133a24dd2463d260eb1ae79d597885a75a6f9f838eac0d486df7c6a89211d486442c9807ea55b645ffc08b5e87fd53c0621e66e423b4e466cddc79721f60025ed33460b555e9b2bd3a7b32d40f220a0c7d004b421a82253bc347a211ffe24bfc41371fbfeb4fd41089f28888881de778274aed8b4ec0c480e2ac277a1e8e7f87e47bb4b22e8181d4b546fbf1f4f64818d84446b84195c4e546a8fa32ba38fbfac0566a930728949cacdcc38b6e874f46ac3c06442fb6a7136f0143cd56fd33eb64efe0a6a897dd9ab1fa467ceea7540c425a444a6564a31cbf340c40bec0a69945b96e276e66896dc4702a23326e0278066cae84c45cecacfc075af09d20467d7", "8e0b730273b01cb5760943d44dc57ace488fe41cb9e3dbe3192a9ae0cc5bc12c9b6909f842fff85ed47377c5815ab69ea484dce4ee83ee7327cfd3ba6d1b40d259406b8323c6dbdb374ccebc6faf450d7af444ccf32a347dd0b5d52d80275909a1f203dade189c81927f56a8f258eace0d0201061926dcc4fc16d6113e8dc2b2d69d39976440a1373bb12fd762a30311262f977816154c0251b50dad688575cf2c7ff969073f25aacd06f6e33787a65e6c31609ac7ba40e26d4b3b3fdbfc635d1afc385cff877ded91e0b3bbb13743d271a01e0688accb1437bb80ca6b07b40c4d2eafc8396514a82936bbafce180c1437ce5e5a5523835b6719671e1695457afe2b0ae1d609bf909f6b7059bc57479e6d802ed50c8fe4c7d3fdf15e148275b77ff3c7d0e0955208995aad3a864e84f82deb9019b27aaeb7c6e771a22e2c02914d30d614db3570c9b7bd1b58a93af7c3444b79fa86e580dc75fdcde8aaaebeba2f83b91d4b674c7920edbb3be3542a96207d3d6040f03df15c40383e5e16600085e4902e04f8fef6dd5e851f0dafd7e5", "95ed86a643cc270337be459291b9f3ec149681a6601fc1db954ab3bd8784f06c237610cf16da662f3c9516d66ebc180c92bec5810ec63dbb6a4e7fb1a6faf1355653baf589930aaabae8a3633d6217ee4d8cc5ec67dd6c3243b78d52c2d37d21acfe96cdcb3d92237e967b5c5f9aba820e449ab2c3f329fad1b203eb1e79517e1e88e624de00cafdd719348033cb4b8731de0915c93e8bf4c46eb14985b4a4d7b265a7bd57c0448a0fe51f4de80da4c92e317c8e69442494d9221131a471510c661c2a997d9fd1826807dd0ccf44230f44ed9256d9341a1adf7ba1d64a2dc00a92f4224457f36174334c80113ed5b9c60edd16a86f4f65b9de44d9003f42b501eec25914c8407d64e8f35d01cc2a2b8721d36886c59880fc664ec2933a93ca712ac61a91dfcf171f865e21cfa1bd35da0a28bb7d45e9958a308ee5eeea3b9c718cb69e0a299bf7e849a3dfd7b85a79335c3ee57e1ddc3d3b680ba119bd06ef8d9c01376b41c5a92261d05a9a4696d95d", "879b2730d61ea9f5025ac9b512c8f8544c5d7fe5556fe7396347c839d8c96f271b829be3739d01fa97c44543b80de410b4b9138c65869828c698fa64bb31daf55c9d033426a865e779d4abb008f1f10c4a7521cdfa6cecef60e49b9a02c48315a627cf4d5e94ed9ba1203e00a48de1719eda260a3bb6bc9e4187337082f001e63fb1c09c1b4c198ac1d23b8b108bb40824a232fd113a7200cea0999d73c5efef5682a7a0137e0b5bbabe09cfc20e8644501871fe587a0311b21681620d589782dfaf97f19b16f8b3e91ecea4686f55d55d5f2d5d9a468be9cdf2cc58a6ad201f39e6014fdb8fa4372ee3788f86c96676475a2edd3f3478686e3e1a3ae220f29e8e0a0d0e4119699372bc232ba12ec4492b2dc02ab466e89bc5f404183290b7a48aefaa852417a309e0eb6f45b4bb3b824bcf8a784d8906ca7181346ccc50878ee9736279339a45a168794f77b3c8e28e"],
                ["b55385661a589d6951b44042623c72cf200749eb4d2f8138012d94c8f4ab01bd30389e3827e4fe7e865490bae67651258cfbbff3d7e454bb49ff019dbf6e1c9885626f418ced47565787f6654a4b0d1048c98193e8896e71cf571d2303a3ab1aaa34e1798ffc328229b2f41f21e0d72d22ddae1ef1a7e3a5038277b3eb7a74ea3683b333efd881680a39d1dd657baaba502b58f0d4ec192e339bead364849fcfdf323fed2dca563f1ef34056e85b48d13e8947114395db3ea291c9a227dbbf69c76303fcc5e3f0628f5c3160aa401c4671ea87af2dc96065f3af496edb47be7da2b85081ea101ec9178546e8cff590136bc1631fec427787bff142acc02eb35250573f330fd6c68cb5f45f443148618b662cacfa5e71ab45dd58eee31b714f9338d1b62435027a6d0aae8e5daba760a61d073bce1d669d96923c6583add1d4dcb5f9330d1ee5d2eae172d3ac85efb59423fd0e77fda37f394a7b94e8037d14eea822cb2d89c89560ff6a12da0d88fe1d494b520894dd839d362f82712e8e9633a5c254646eb45fdb46c94943b12dfc2d27d188cda86470f8fd3a40a8f3b062f973e28262f5194c8ce5f68040993858a01df8fbaa12d0f43ff71560bee640a97d2eb4ed710836f0c14327a6dc21a0f5d94a23543fd27102ea41387488ed3f43f29ecdb82b9050a524b4391487a68dc024", "a3a8dc516356f82aedf5503121bc0da8c685b1452da8c1cbeb515d9b81d585470ab085f3aa51f6df31ed775452973bcdac7b91ecc4f23a5b4517237a67ddbc5bb5c44c492bb8d38e4b2cebddbec941d0d679ea6e1626ec24fc78a0abb7ac59fd8be1eb6a2861d32ce4ec573f68d0b5a29807f6db464a93d61fe3d345b2312ce1af0cdb6de59d5d7c2d3b942a1e02775a257bb7e6a8cc6d784068db2f2cc6d7cfd7606aaced112791f41e3497760585395e113288159e78b553f827063aa55cba6e39bd95d59acb6f8cdbf8f6133992d15d85fb3fe4b890ddff918d1e0efa6714e0551b57032b7b7c2f37e3a231e1ba6b0a651b46af1f09a4821015167c14b9c44ad815ccc6143f1f115e28f7a4310321413da358ecd1de94efacc5c1b1eb766207d29c0eff3f9fcf55f2dcbded85668842e71686aa32ce39894e8dc1cdb40c89e3aa1b794c507df677645b0ad44729443e254a878921fc2aa4a119d275cf3c2025258237e4aeb1573e9d1d178018486c45979963d8e1f2a395fd26d863878d07b6d845de32c08dddbc3f9f03f3514b9a54bc4fe499b794a1f17a4c7487a0f085e068e8f7b61c0dabcd943ae6b3af88ed3c2e70751a8d4847a7651cc57d0dc63f34e240f118337270c5759f106f99c666", "aaff8eb667ba9d499b2c76c20627d7941aece65552ad01bb8e8a93780fa50436a8378edf149c0c67f9af61473b52de39abef64d5450efba9f0bc4a6a4c6c754cc57c7dac393fcd9c54e162c6ef95ae84ca7cab925b916a049957e5f7a0674b14800efb7c13b652c2fa809afacc3af5db2fd078d1bf1cf83d3c718b5d1182de93c17269cd95b0895e592fb9d8575f6b335e92353b68f2c81f1d3dac523c8fc60c7b2c37ce86ad659aaacde96f977a99e6024daf4ed05ea7cd532dc47ab89a5cba55206f3919a73725e73813f705a012f253595914f9c94d8a791f53d7063163fd9260a674c8d73af00739d8cd27ca344c4f4c5222eb5b9a7efdc4688bcfe166f31882a6b10d61dcb141dfa1dd55e53b813e197c997df2fd4540f7e5382f9ea4f5eb3b9928a66e2f0e2f94426ac6d0594f43351fd7ff1b81b03d1c3958157204b60e55412b9598791a2ae4d8cb5611e21c0430f5cc1d26c1f08dcfae480334f162107b7b28e8e380bfa9ea18f5528021e409fc0377632a9d3c232193b0e17d94738928d94438e614f1e431b50de8e58d9b1d0bd8bed484cbbc46786f652bca447d71149e1dab2258b9af303279e0fbc1e7", "a8423e2e6c258f796e7547c9d829d62ae943b66a5a0c2b766d9b00975f33aa266dfbca1e85db51e629a5355d8df92910b3dbcbaf3db1596347b5ef677b7eeff4e64c8c88b08f15e1fed5db7a5f1dc7da9ef0e3b58f4868145d02c8d08be8dc32b7e0c9a52d279c5cd703fe6a3a6995475fcb19b8f1d500f0dfadc3a470b252cc402e382a853299cdf5564fa9b0c439a26c99d66d171ad67ae0fce0985690c8f383e928e5ed8d8d675f32c0c0235664a70eadc5d358eec6c0496cd8c989aa15cf39506fa43031b858ca45ae17a419f6ff02d132d113881ce6d6f53e8c880e323a0c4ef9513b9a1d7b5443813cad39b3311db3ef5ef6bd9b24d6ffae14e84742b92a5a4f37547c58aeb620f182f1149905228d849c825fad758e2e87c10ef28abf44f6d1a3a7078aba8089f644170d3ecd2013349c1ec6c28f64cd9006bdddb4f62a418775c6017490303effbddf18a95b07de606fa186e1be88aaa506cc73a94392c64c9c0a8c7f834f6719cbc1dddd4f45642eb78d14bea12739876971fbfad7ecac76a0f4b6c95afb3bf30bf516ccf3", "8a0e2d7aa7b2a0f46f2c1c024b2e4dbbfac79b94317d6a2cb4427595a73969029ae0abc6aa0c1a9d798f252b54469ebfa619064d57ebdc97786fa325166bb00e8cfc7d7343059c96a3804822c80b76cf96cd944b64ba2287137c768d5d1684dcb6d32b56b9cf512320383a4a4101b936dd5198b8bd2b92b2062871b176ff7ef9acd825d0d22646011a414f13326340e33282c632f01983048a1ca0cc1e387f13f61109a8b58078ea2a61f512e849ee7e40826e165ed41ea87fe7ff99fa09ba974193e66043e99c9011dcc9f00d49a9bf04c02900394ee0eb19e49a5583d995036158e050275f880746b8d7f731df89042718ac5b033cee83a413f1cc0942b67a82028a91151eb6793ed86bf9b3db0655647813c2cf420436385138ebbbf414e78635937aeef86e3885b85f8eed5cc7233ca3804a190d8746efb4710079e89532f649ed4472db3ff3923c6d48855bfdf015396ee504d9da9fdcd5f365a2d0d51e607536afae2688dbaaa89466b34d00a4", "83e0255977fddc8f02753da2561efe15a3bc6ab763b51aa82471670ad36d7e643be58c75eddf6b52c46e555bce2a06d8925e6b7ad4b5d568e78c501d95b379529fd8caa84c73ec6ace0887c1d5666c9a9c8c4090497ca3a75c8efa3d21161a36b5637df028a11cbe66f0c6a45443dcbc95b75820115b6d49b17f9c35962a19c20eea8996aed3d7d310fb6bb3502dfd9c17a0826a5e260a06a18a017bef145f6cbd861da27424e158279e2d7739439e2712f7e9ff03c29eb6e011217d6067d7969c9b2657afb272037d5a4ba761fd807d3675e8001c69aa48e60723ae0962fad96e16630b968a14765b4c7079fc47a59c1657ab4c098738ac41d3cbc4ebedb47598b0a7de546130bb399755e818939f66418657d452cc300bb78aecfc6a0207ead07f98da7d9f33f41b6f3a5d4035c7e21a802872c76c22da9b8fa7ac660d6c09f9d3c5c0d99f7b122410da91193f84da"],
                ["8cb8084add4eb2701956f08326217df01e899b1c4be237561dd61968679abc1cace607ce60f6573d5bcd86acb333f9988a7ef44a71f7ef560fed2f0deee66a32796678eb87cfcdddfbd91484868f96edc68ac00257a44f5c80f0ed344f5e7f01a6961c410459281160b135fb326d38a65390932c87db7719f2caf24474a269d4d5077fde9da07a59f98050d943c6092d286479545ed4fb521d2c300dbc531d70ae92b9bf7a48f738b96481f351b440e707b511ddd5d7667fe7cdaee762417a3e587ff95e31689b449c95470d98f32a621d0e5ba8d2703a4a7235b0179a2a3c227a7ce0f45fd5e1b854bc95996ebec2b367d0c55259862db61350c89946b521fe067f48867a05c13b06dd7a681d17b9ed1f7e2f714ddc374ddbfaee9504b2851cec669be4b0c93d7f0e98897bb93032154c6587eef629b0bd42552def4794de5c493fff98088edf016a6afcff1925bb936fa71845c2d7faf322f6f3dcc18a0467680384fca8fd67dc7b15f7de3448e3792c3a7fcbd4e397691bcc6cae5146bcaf09fb4461ed6e9d081f22048fbdf403ed5501c50515c2332e08afccd21cca87130fd10a9af61bce13055a42463de28bca5ee78c2dd9133f0925d432a55cda84804c05353b9b6ddbd0b76a75c5932777352bf4bc94d9e8241c2185f612b9fe0922ee9e410e7336d406f166ed2ecb7c6797", "988a540633d37a4d04e2dcdcf31bd9dcdf95a553c9be344f08562d21a1ce21567a4f6e08b7315625746b7ec811c0d352b38821f736983bb431553b613259d1e5e25b3063b719485dfb857f2225815eec3db3b21c7b9919951d1d631b97fd6d8ba5d335d0ddba8ae6aed63f8e0e5acfd5361b74a4c10372fca5bd861b0b3753d4353516d74e02f7a4b90591822fa4390528ca5171f65a5cdc3ada352ba2c30aa48b6c9238d092ad270ccf37edc8b6ebc91e34c7570bbb7c4955b7e093c851497bb6c4674a3e87174b8f0ac89bbf2d0f025d43e2dffc19c68bf39f96be902e053d99b920b291a1b9ee73ca217515884f78026a2626e22de3973573f472e76ec5af3eb847f800238c4c1ed923e59b5ce4f6345f40a87e38725ee1d212f0ab7ebee17fc3420d232d580b79a2ad65330eb449198532648717194985a49232d73fe6c9f804cb0e596d77f129d6323a2faca6a064e1d0f40411f136ed33212fc133c0a41a68de34299a4b1dac3e3b1a3994010c2d6e99bf23f03b07626edc6d34e62f16b8990902895775bf57ea608cf49f60af122342aaa19511465c629d73e076514b14f48e85f758b10b096d73f53d861ac55caef1e522c67b0d582438fb436c85b93ee8c1702f6f6aa778a79fe4a4b922fa", "97e8df2ded43b99a6f17cff2bc48324ae5427d3e8c965d070da205e07932c8e54e608f57e0eab09a5cf59b9c46467138929f05809a564eaf5815d9eaea962080c4840fb3e6f40d88836b8412d27e72b5b22a75e02f6e6f0fe8269bff3f77b1798b7829803df04738c379704a0456d0b15649162c56a71bcfbef2e8a04f1d9bf3f33f9670a0e350a9f09528194b5909005addb428d6c5ef351f14f35b15ba6c73be3164f96f4efc33572495079c50127f04740a4964c1d5e6edadec7267443ad797971c072f9efd9b7db5b6f6e9612a7503a8d914d2ae950f1fcfd7090c4710cccf50440e7d8e29eb570ae9a9462263904677303bdca852f4f48deae4ae5faadd7a48db82352bee0cc5d2bbf634af1463477e61d6c505f894760262c323a8c43e0834619763c5b585b00e33962eb085b23d0764232479a935b0c6406068c5fb28a2aa98056104c5981f86e61bc505cb9548f117db1987ce363d6b75e4d627a3970c1d47273f5fa8cffa26e536d671e76a3f92532abfa0240da425e9573aa1fe73b3b1d359f6e8169de2269ef7c41463c82635beab2ecd42f2ad77cd8490a5a9ef9b472818cb2c1ba8aa30c8bb016a9a84", "b4953f1435b8f14889d81507817574e816394ed70a82c19af9fbcc503bbc1693a13e8239fa26cebe2d0280b59a39a4118a917faed2aa6296405299e7c2d27101881e5326a4a3a1cf0ec7fad55ed6db27ecb163867b5db9b105da19b15ebd6b158e5cb74b337c866d49a42db3f001d2923aba2841cbaa4a679d575e7bbbde22e2024590c0c12caca22afb9a636fc7a81418ead9ed983db334dd249ff0bbaeb735b1146c12acc7a86a9f8eded6410a44f733b5b52856874995a3833cbe2e57c7f595b7af552a7e54c1beca6dfc91b86b065a63d016c3e98cda2758e69eaf0cb925cd0af958aab5e3dcafb7eede2e49405b6a8dc33e17ca1783cc33b62041d644214851a93f6fae4a8dd5ab808d8c56a2c31908fdb361782194400b1167b6c1648c989b78972310e02cb2881c1c68f3cc6218775ae067a21f2e2e16cd239b903e5c8f6bcd83d7552dfc261b45d8bf2fef73388326fd05d16a2358d1a7fc91edddf67843017ff6c9f1ee69878dd26fe3ed6446f88a5073a2fe0464c2d9c3667e7d379ab78b009456d66bd337fb88cd0a4953", "87c30104d84bec595d77a6965a038c5f6d0d393fd4b39edf419000c12909d3b965da3b8c07eeae4ff7508152fbf016238b870cd522a204b67c2f2faeb52171a17d19c846db9f1d20d19cfe6c92a3d1687c27061c56916954a0df7b01def2947cb0f05265868a9cea336fe92a6b3696d6386f0682390341b10153eb83302db49831c8c5f3f02b3e793c3ab264c40cfaa862383463da638a18cc70c846883ac39918a7b962de9f6a357b03dd5653e36f3c1a55a7ec055f805336afa5c4c02f689421ded7cd162b941cc78eb12548bd45062c76ddb2ec5fdc4ef11e44077021761bf993857e59602f482110ae2df11878a2040034ebde6568747bcd1c5269f1f26c8f39f8abb07954b53372728ab5966951151f0dc287f90c581cf0d2994ddff1806abbbbeba69976cfd5326578a4f6d30f4425e359af4cdb57f0455722fe5c37f78b1c20b7c5fdd55e346416357b4d84885f90c4e7588caf5955bd0375b9c87c0fc60137c6342997d6368c8ffb9ea32597", "a7c074ba9c3e56207f1cd594226f0487e225a58a49b4f102461352fc9887f52b7466a2d6a87c1f1639bef466a7d822e9a1657ec0277c0a747496d5dca0dc74bd9193966df54cf8dfe9893193a2e949cad9125cd58117077c57e286d2ba2e0dee9502c132b002ab49684c674e939d81dedec488f75fc40aefda08225ca9cfc8af64e8e81545df34aa94d0a5dae2a5f791642d3999c82b84223c65854c8d83c5de0f7befaadbc2793e9f7d1d715812df683a53a08e7f98c1e6cac2e0bcb7e66b7d984c5dd041fce5096bde9fffc3a3c7501ce492238d8284b83f6f94796aa0371187f8d88064ab2f1e7e31cf24bf5d2b384a4c0af18c60f09c448d416e449f3901cee8fc92b135668ba47fb583936d170364b81426dbbcdbb59f96ba4828fa051d6644ec2ddeddf4b1b48135fca42ae8bc4e5c1ea05c771606ee9932943d8663ae159dedb3aab62dc95566296cb659ef63"],
            ];

    for i in 0..TEST_KEY_INFOS.len() {
        let pk = PublicKey::from(
            &SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed"),
        );
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        )
        .expect("generators creation failed");
        let signature = Signature::from_octets(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(
            signature
                .verify(&pk, Some(&HEADER), &gens, &test_atts)
                .unwrap(),
            true
        );
        // start with all hidden messages
        let mut proof_msgs: Vec<ProofMessage> = test_atts
            .iter()
            .map(|a| {
                ProofMessage::Hidden(HiddenMessage::ProofSpecificBlinding(*a))
            })
            .collect();

        let mut proof_values: Vec<String> = Vec::new();

        // Reveal 1 message at a time
        for j in 0..proof_msgs.len() {
            let mut pok = PokSignature::init_with_rng(
                &pk,
                &signature,
                Some(&HEADER),
                &gens,
                proof_msgs.as_slice(),
                &mut rng,
            )
            .expect("Signature PoK init failed");

            let challenge = pok
                .compute_challenge(&pk, Some(PRESENTATION_MESSAGE))
                .expect("Signature PoK challenge computation failed");

            let proof = pok
                .generate_proof(challenge)
                .expect("PoK proof generation failed");

            let expected_proof = hex::decode(expected_proofs[i][j]).expect(
                "expected
             proof test data decoding failed",
            );
            assert_eq!(proof.to_octets(), expected_proof);
            proof_values.push(hex::encode(proof.to_octets()));
            let mut revealed_msgs = Vec::new();
            for k in 0..j {
                revealed_msgs.push((k as usize, TEST_CLAIMS[k].to_vec()));
            }

            assert_eq!(
                verify_proof(BbsVerifyProofRequest {
                    public_key: pk.point_to_octets().to_vec(),
                    header: Some(HEADER.to_vec()),
                    presentation_message: Some(PRESENTATION_MESSAGE.to_vec()),
                    proof: proof.to_octets().to_vec(),
                    total_message_count: test_atts.len(),
                    messages: Some(revealed_msgs.as_slice().to_vec()),
                })
                .expect("proof verification failed"),
                true
            );
            proof_msgs[j] = ProofMessage::Revealed(test_atts[j]);
        }
        // println!("{:?},", proof_values);
    }
}
