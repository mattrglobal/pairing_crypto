use core::convert::TryFrom;
use digest::{ExtendableOutput, XofReader};
use pairing_crypto::bbs::ciphersuites::bls12_381::{
    verify_proof,
    BbsVerifyProofRequest,
    Challenge,
    Generators,
    HiddenMessage,
    Message,
    PokSignature,
    PresentationMessage,
    ProofMessage,
    PublicKey,
    SecretKey,
    Signature,
    APP_MESSAGE_DST,
    GLOBAL_BLIND_VALUE_GENERATOR_SEED,
    GLOBAL_MESSAGE_GENERATOR_SEED,
    GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
};

mod common;

use common::mock::MockRng;

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const PRESENTATION_MESSAGE: &[u8; 20] = b"e8gxekZpmeZTU0VDL9MV";

const EXPECTED_SIGS: [&str; 7] = [
"836feecea821c51fc8001dc6f734e39d34f86a76aa4030ab47ca9e102f81090ec7c51c6f7668ae8049baddd2730b9fe7273dcd5c7a75069720902ae96119edc773e20563dadf42747d4fdf0f9010ade0662cf08de30ba63e628553ba581710ebe626bdd92f00f8c5afe1e219ca5cea17",
"b48b01725e6cfd90b04fcf085ef5d1a425d011a67af0c88e87d6d3657610b5c82b9689af42907e02b24cf0a673b8366f4c36d521bf77a3f1ce8af4cc7759c29b9d4f53951259049f0ed8808ee0e7c59a1995c0eca52d7494b930d1e46b3ba11ee01766e27e2e1d2512c4b9648875ba8a",
"aee9683aad19d7aace57648fbb3e827ed69034d58383eba01094911d3e2828222cfdb123dc72897a93b7cca5ee3c32cf044a7c66452a05c1e34aa87efc3fd9c10aa8fadcdb19c6e443becf5beb44f14f06c7faf29d60adfcac25e931234ebf9a88b528257822c5abbbc9f1663faa86ae",
"8a68881b9851f024dc896f388b1e00eca8ec1007f1de0cdb9cb41e12375736f5b9a6354d61e13d033d400fe0cade5c8d56c87464948b1c1aa418ddee9f62da6e5bb51caf2d14eafa920f6cf3983bc42c5642da8003d6bc8e9533499b4574c5d673dec46135b5bdc0c099affdbf78c162",
"99e1366c19e79e97f25c2302a695cba9aa8c2e9bd1a92ab79ad55d7a4b7569585b3a949dbe6f5da3d8d9930a5ead0df470c5309e60b637e91f8859cf0c516f76e89eab70758e5b0fa30dde9a7ca0b2945f0da57cd9372e900df8e37f43238ac04a65dc8b2215c86a328823117301040b",
"b80d5eb6c18ce5c2ad7b2d179e71fdaaa67227ccd544d4fce106d14792550e6eadaa24c9e02ee9da516535b57b0dbdd65b23d1935ce11a768dcbdc3e75cdb4256ce3d16a8218411a0899257c16558cb8385587d34a1d8e427e98cc6c4d307bd483426091df8b34d97a62187bc75d91cc",
"af17bdb71ef2debfcebaf3ffe418ca2759ee442f021e9df609754ac3f1b096dfdfb9f82c0a6d224026aef59e00f3f60f02d6c98816afe4fa81fc677d1cb521fe4258a466154426d2d683657654dc2ab93ff4c8f527633cd5d347047757406bc468c1cb39d154b230f45638b8b3bdeb46",
];

const HEADER: &[u8; 16] = b"some_app_context";

#[test]
fn signing() {
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b.as_ref(), APP_MESSAGE_DST.as_ref()))
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    for i in 0..TEST_KEY_INFOS.len() {
        let sk =
            SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed");
        let pk = PublicKey::from(&sk);
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        );
        let signature = Signature::new(&sk, &pk, &HEADER, &gens, &test_atts)
            .expect("signing failed");
        //         println!(
        // "sig {:?} = {:?}",
        // i,
        // hex::encode(signature.signature_to_octets())
        // );

        assert_eq!(
            signature.verify(&pk, &HEADER, &gens, &test_atts).unwrap(),
            true
        );
        let expected_signature = Signature::octets_to_signature(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(signature, expected_signature);
    }
}

#[test]
fn proofs() {
    use rand::SeedableRng;
    let mut rng = MockRng::from_seed([1u8; 16]);
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b.as_ref(), APP_MESSAGE_DST.as_ref()))
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    let expected_proofs = [
            ["b28a1b39f6e0595ef59ce0c147b2f63049d49a7e7cf434c7b0cc5f19f646b68e0d38f366404951519d0447cd4b3bcc9f93703df96bf86f277b05e40f62f7997b302f600da133d1a567ae1b631dbf9c8a461070cb93d17e46ce4ed610b2d8b48b8128b9081e089e6e1b5cfb4106955a20e538ccff12c51b4fddc79f3ec27c3cd940216927fe84a25cc0a5125039299bfd3631b22a8e95cd4ec802becea16b826f246bf92280f6d647cc736cad18185c562a0c55be6aacb4bcf3fa7db64f14dbf67354e9656797171062b01132fb99fe2d3db86cd0df9908fb56542114aa10ada9c0d194a24822edc3cd8270868071c1322b845857f468715b97e2ca4817db1fb1c2bf7f39e5acd970f2db3242996ebb8f00b2b819a4378e1650a02818977e9be8787cded005b75dccb6b5c401458753a812128a3aa0f43d025bfde0b163d21628129dab610b8954d4e08ce98a3b32e67f5494ff241a75dc08b9e405776e37ff947baa29f397d20002f165393883774d49613b12327160bcfb0e0d251b120820dff34291b30d0752c2ebd3a22eea553c140f307778eceafdfaef87119d2d353a57182d09016971a3c160c1d9d054843169392777f503b519cb0f2f48b507d7e5e953ecf1d405ca9c0b1668d90b54ebc64f3f4c8eef71e257acf50cac9cf70ca59e176b30d7e0a1f3b129e67a37e316e558", "8fc378989972dc8f721b3085650389c6e208657b882af491b363feabe2fb034c0ff5a07d58badc4d27f0eca54445b9b8980c9c57d7e1d47a28b51122f81cd4d8542ba2b5fa002080f4d825f4d43a30bc76198216097ebd9c815a3fe3443395358b843fd36db4e3920a7ed8d436c78bf2626b565589ce1a5834651b997a0521299be36e1e147c2df7626416f96612207d23009a8652c6db21bc59745cff8f8dc739b1fe97145a0f657f155242d73d896338fa4578793f5b5b3d0f17778d40c88b13e736d9d1bbac92b13896b5a1bc6ff52f5a54ef9d7aae11ce14fc72bf93e30f84c3e5496eaf085bd79f9c01b3cb3d1454c722a216a36f4cc57ca482de86ec469f4a36d8ed0cc682a3021fc81630813f4ce1ea48535d47e0c6cb08305b306959ef6adb2ce0b30bdb0bd8b1b46103bb4f5b19b7885d860f712a6b34461ed64a9e5208295272f96568d7baae562b658e373269faee0e80a78bb723ae43c45cda6545c4b4591f48660526eac4f645629fa84c966f506b2709701a420edb823f0f874ed509d02cdc05515ffee0c61505e5ba739286dd734f0108cb7d54ea4b691a8312220bba29c07e6eeb24f6e6720b2f97590c17cb6a8c262ef6176e4b0b12aef1f8a8cb6830bbe74a69d970d3aba53787", "a930ec8ef9e876c869878e849abeb6666ebbe5b49e1fa4493e6a12f4e3d40f278905f8b4336ae30468d5733d71b60da9a0017455079d1a8f2b18ff0ceb97027a340eba6a1fe135a9cc2c290a369fbe7e30ca4bc2758f77ba40ceb9c8b31685ce81380300ceb004c47b9cf7fc99409dca789ca39be82b2b6d72fc4f0108bb20b03531241d5cb272d58269bb92434ed5bd376823242c92cbe37f9ae8cec54fd3c909268aab472f9aa7ec0dc19b3b198e2315f56603208ddca4636c322ad63eae613c2a4d61984cb4ff24ad98e3fbd02c77178c65170e0cd42a668151cac214cfef9e10a44acb9bf30072095360fb46451b6f2ae7f10427c8f0062962cb06d077f61d65eabdde358585c6dc5669cd7e32ed0a7da19a68eef15330db1813bf60dfd9986353d44afb2a1587552ac6be537e8550114948b8757daaa6bf46b3d3ccd3321d953f97e1569fa041c890c957fd385a12a33f098bd0c807260a0d0c9cd1cedca960b4f6f639cedbe7f413b5ec24d66a5308f46a0e441188186beb6ba582249dca3a07aa568d5fad574471ab50f4a64f54c0d2551dbb7887e204071161a81e8b2dea1282dfa85c5d5cb0dd51112597d7", "80452d3d9a11c73a0b34c681a4dfc6e660e5fdc5614f120421c7e87b32030184a3a2c57ce57791abec408a846e794eb48a288787890f6b08f3c80478d2dbc05408ed29b6d31c5682bde9f12babcb7aca3d104ac7883049fe7b5da15846d1ba6ea700c7eed635946bf218fe51a322bf31c1be552a6fe3fe061e93e85dc2997568fbd077da2701fad845451d422056bcee64a90bc305e850af02cb98c8a0b093a24adaebb6f078d84eb0adc95361a4560f6939d87812a0037b775b66eb22cc392e37b7fbf00c44a7898b385dc05e2b97600de048abde00bb646273b6029bcbc8148c660127aeda708f5eac8535244b4da44c1337407a5d7136c5744015da1cb80e7ffd8052f30070bae3d6badd744db1ed4b30617a4cb468e04fec4353010e90966329d1b8edc376b6d42fd584b41e6d820bfb20e785470bc9dac24bed0780f8f792b5c8dd65bdeb1b7fc3100251fe633665a8cde7fa16ac0867b4a005571da85d4e2d53fbc6a4b6203b9c3a9016e60fd40dc009d340a09ef62de54ccaabc822c18115f922edf87826425b54e42f35bc6a", "99f59237b188925b074e226fc27ff1f52ba2706e48a3eb9d98c950b11c171b67de8283af5f1fd442ae2d9e8093d3e1a891187971d2ec57a2d2afee6a26a03e5a357eb31f036eef30657c809b8b710f3cb3c3ce0326878be45ab14b63e2f33eb58364b6d0c55ccb80945d6b03d53d328b51fa0b743dd72aaf6c863facbd9ffd9ab0972cf14b23cf27e1003c24cf38310426816b26a1a8ecdc124169cbfe2e6d47b53070d1359c62ca5bfa8da2ccb2c0ad2709bf1f8cf6bfc8c0e7a27212a54755212954df6dc1f4e308c679415c755de123ef14f518edf1092c8d01149d2a187cb4b80e25e9e86508df0a7caa3f3e8cc41ff73bc4efc68206c047fb0441f946e9fd9005ba29d5a1e2e24bc84363d5f6ae25e719c4f19001a67bec60860f82d4516f84360a2bf993d899d7f297ffe1ff0328065acedb957c3d5cec3185a82183ec9b06df016fb18f538063d253e6afea490c8ffdf91be1d44fac96c454847f84854bd7487dec47d65ba8315ee758c5dfd6", "b3cbc80559d45b752762eeeec478f00da2a1d379849e0b7fbcc4e85040256a1255ea135cc600ffc7f3c31e14111f5afd8a882fab8651f380d09d8e8b2be5d2a9e43cb1ea4bc92d4ef1288de37d43cd126ca4a289532dfa15c1dd477fc57b5b70afa695777f387c722e72942b025cef12a9a69d731dc671a69ca474fc672526a96d695be0a1a3d6744045a6223e50f7860ff3fce795056ea8bb0ccc9123848c485ffe9b74fe6b0738eb2741ce530c643f286facc5b3cedb643210087428d45323b274eafef8fdafeaa53e982431782bba72858bd9bff14df261a7276c5acad151c067cd29891e5ca9c7c93bf2f68b278264cca242cecb642a9a775890c35fa0018d6c087bde03b9b2e42e20648f661534175ff1af606d282b82f3d8af869d3777d72fd0f998612058ce59a17ca507311d1b38bc9c7f40db225363b36897469602db2be01062d0dd6876cec95620d8b075"],
            ["abf61805f103424b9cc63ef38ea609ec5a6e5d590d0fbaed826d5600fe396fe4a536bce6798b46e975a4b2fc7fe1cf36b35e0fc3244bec19906e09a51cda19bcdcc7a3840864a6df45e0c938b9e796f5a2aa643bda1961e90123cbe9323d3592b05df0b5fb6147f917b436575971317131198e5dd0d222ef3661ba263558f75bfbd4ae5a7684e22d7f89d42da64f1447122f8a688e64ff9680ec116d6dbc9fa4c1956b6a4b5bc88c563f08fc5b48a815177410f6e047293f3ea589d3241425a45f68e22a2992e05b59b50471b96857294813c632a8c75254fe01c085920bf8fe6052448ece688d1bdf8580f0cefd45fb59a1f4eb1a05ad6585dcc6d4b2307c39b2cd8cfe32983a465fb01c8a6e02d5c407901174e63d36c514e3b404cd326b04780d41c5a494eb952d0685e834cec8225898909d10513a269b60809045f164a9908e778820238bda474dcbd3f13ddbbc09b6af535d48d7a5beb9bb5010db3005ccfdf9ab8f4216175e1420f7a4856b8747488b773e5c3cb6680eed522e42d9fa09a8ba689b526a7a751f0d4a363b95965f44cb4104cdb7d8fdbbad4123716a5945dc056a1c57180988162e7976647e7a2202585e57da3817845bedaa93018172707cf63a920534fa4e9e5103096df96556aea3a7002ba8fb74207dd733719cf6866a113a68795f6cc8c927eee4736120", "81a245011515a870b13d3bea9f309855a57e900a918bc98b542cb01db0ee94489e81ec161bc291e8c331e91f01a0f8d084ff451185a625553ac224a23406843dded73f5eb28c51ab9ed4f30e3153e4f3f4bf6318cb7f406ac79b8826cf4cde92975cdab6ebe36c73729344df6068f451d0d46931416636a43953811b724169b9221722ab76bababe92248ca430da5174052a18554714ee2662aa241d267538325624db5cbe5285e5eaf34c8627be91dd1fc9f57059d10e1fb05a86bfe9341de0d2add19d9e0e41a9798890122cc7e24451e86188307efd78a39400b25aa0966799d3c71d09bdd41f86ef0b931bffd9023029ec9a912eb125c20b1b01918ae0a6387d7d5b74abe9d9bb90f0c4f3f4c6d10862e8476ed7b539816d2162c11015982c1e30da72ce918376992ba191deeb8553078e526baef22b3c60264e15b21241073b49054b7fa860c6a496ecd8fd1e51305d2e5aba3f452feb5b021709ab0743336692f5d3a937bdb4b52e8c001f346165c870df326c2078298cc31f14010b0296caac4b4f86a60cbf7048a9642fc7c4342e00cc1e1f0e39e3f2b29381b86f2c635846f161b196fa747eb366e724f0d3129c487a2424f92f24c210ff5ead34d3fed133da756cfbf85179da76d3fc8206", "afab8c07190a747ea4ba83d68838943b3fa805905a99615a74a66a7946355a87da4953fbb8c18b89e55dc13b128ce1f5b401b390e4e8f9369edbe1e758a691c8a920136963714ef07ae26031ead3378e55957fd9a6341790527ca5ae0d9637e58fe7f8c4f346ccb1c250d18c370a41a63637510fbdd4ace8bc3daa32416da9625e7b5c89eef33970615fa3ef504e52d668f5300db1360edcc191da12ea25b6d1b68ec249b6755b7d7314da024d675ebd5e23a64a790d74789b21ba780e6681a595a3f8fb729653e657f6410708d5f9276271cbfd7da297c611347341fcf23f21f4ecd3fd35b032f26b84bec513bb133b67350610f2f4f06d8c98d6a5706471dedd5d6a40f7e584f372999af2cf075803069adb3e94de2e04147ebe4f330c31599028dcda7f1fd17c823c2bc4d3e30bca3728d46762819d9946008a8fef0da3ceb911129fc8e4766a7eddc5d1065179c623565a055cc148e66b0e39fedf1c073af31c014e6d331528ae91d225a353cc125354e08ca806e2c275bd73983b9afb37ade1212b09ac4f910f3218998964fc937378fb0164f85a77da1217dd15029fa3acdf8c3e88b366fb7c5e330973209707", "b3cd3380549c9e85e6bb7a2c8345e86367170b6812026b70c22c5da27356edc6f1b713cb747d3b831e2c5c4dca39b224b7c115fa1fee98f42421e55d5d64a3e956f33df5055f87e0df63839d291473c0f38056f86909b1fc17d51c4c174dc3b88be21636866a5f89cbee33babd8bc47ba687fbc44b575bf8d46ec1d2b18834c014b25898c5649da709f8edbedb1726520b29d7b5c84c7315e7df1e831dadeb56596c6da643c24c5025786e1d290cebdd3a95f4ac30d04fef605877b2f9f441b2104be6995012e1d092f24704afe70b6c33d993920061418c64bb9fdcf1be850f3bc115737f9d10dc2e78bcf81cb1da852ea557b04bd4538a9481aa62a91a4b763b8f460a4f4052c8ffa068493e6e28f42a6d76e9b98d70977e56af59ccf068040a9301a0734e2d74bd0f5550ef74a0b759ef654d0dd276dc8d2e51849724b6d187f9c806f6e2067fb7d44f0eb9ef7f3a6f44e68b7440251f00ae6a149c3d50d8b33f45a5eaa27921a58d14a1b86c116a1ae960303348664fbd4d8ead8d529dd5fd5c560fa4881ce5d6c06d71f8e9ccb3", "a898c13abb688b811dee3303267d70d5e31e045f9d18f6318b77ce73a30398a4ea4bb46c48671f199e5afe8f1a06df6baefe858cdce7eade246b8d24e3678beeac3f40f13c55c4d87070b6997c1f8653282c6fd93c1f47b2cc135c677fe8215cb87c1a63bcf8c580dff8a2469cfdc5b578f6d772de9ede678d345bc664a13de5d1327a7528db7f065f7c4a4e3693498a63683848d832296d9fb0d80395891cf88c55484da6c29bae4cca96cd957f68a44b52f7b10dee65634830b97359a33642ba8c5f65cfae55904e49568580da290f60528f719d9c754b0fd3a2d0b43616d6eca46a4453236b9dbb7bed9db0b34c463a8d8318fa04229be50adf4ddd96fa5c4368eca87a07200c753533069d54215722e74dc4dbbced71b161594605c7c411510aae3db346a6931829dfd31af5dfc20623aa2daf9ef6592434368a798cd0726ea728874057fcabf03617f287e7b5a2258b31f3a9012c02b27131a805916af9a214bf81f4e8e0f2697f713445b025b1", "8bf503a498398e0fa0adea795cae2160954d681fb3d92c3bccb1809e039c0710818ebcd0874131fe5029a16684afc42e844173cc96c33e5aeed6d22b6fd8e27c4263649a6cfc96e037197966c95c0ac08ddc65d0c8f5b510e6899d034de7a89097b26eefe4755edfd6ef4871c767eb259ae1c2934b613c05fac29139c1fa63321d8b30701b4eeeaa61ec9e38fbc6784607987b19cdef23184692ceb4162ff9d779cba0e95035dd03484365dae6a73a99623c0589697b1a2ebf515a48ddcf45b4272f6020901bd55e38c7706f4f973e761d841c1bd41bcb5d0b0fef25a59402ff2762da83b205a490fc167138847a08ac6056d9308b7b38891906e4e3f1e44242f55f3307798a11007cdc42e533d10c336278843a437de9dda3ff336836b0ff30277d9ea70a1fd633fddb4ecd44d2a465627e1e263e63d8524b461fee73cebead137af97843c0e918ce3d9a91c8beb731"],
            ["89decd462d282f55a1f53b0fe427fb39eb328e11d9c103dcc87dc6102805332e3d4b074f5b0e12f46d775bd689bce45fb126e86d48b7f2a5624cab36af7f4c988e537298f06261ce7a27b2ef94e03d249bcb546612b0b93a315fd158f2af182a92a68022c9b583e08893994abe2a6af545787db94d8691ccd701db1bd042eab1aa131a5cc46cc2bceef8b498242c989e6825e8551ff0064e1308d2f6f4b37f8604ae84d4da23e2db27331084558f9e95527de45be02f0867f3c16ba04e9cc63b2e64e1b6c5c7b96caaa3fcceab692b801a50be7bfd690f322bb365270cb21540389117e62bc818e85139d069cb89cacb5bb5276f525b79458ec9bfbfd80b93df9a8df7727f5d35c3538179fde012f0485036e52d52d2083e5f0fca023e5d1043532e203de6b8634a93de343bd806a8850ed313ef977350a9e571a2394a8286ebc472f492ed876115a0048814d447b3c962d493815b24c91de4924c5486238a85c695852efeab371ea5e6804f5b208ecd395029dd5df45d18d097e085145b903abad42251a1543c97c533c9dfe8fa205e33cdaddb77337e8b860f510b3bb1f4e044000ac30375decd6a234828ab43576b2a0828d088f451a92b933a4881ec6265d7dc8449c22010b52ef454303182b2ed30b1d323eb8d8c2be63dcfbb0a0dc32680e38a92dd9d1c3576f84b900d9f0ffc", "b1e10bcb84479b230f3752bc414886407880f8caa69bf9b45fd36e443ace981484f04a67b279312abb5d378d0828443b82297fffabfb97d3e88e3ac59d7f08de8509c813d98de97e1af8ab22f738ce8505214b469618ccc871fa23757c9e939284394031c233b15b5b66aa97416063f03188d322a59189dc53562c30330a924428cba19e77aca213ac35d58909dec0874d7424fc6fccceeb2ce6afb33f770741641963186940f41d748bcb15ff6c83d80063e81c0e70b5a96e3c3850b44214957d7a080b575f0c7c3fa22df9a917234b457de7338a87adb7e8eb0e47aa3f964275db7a8d67dbe0e88cdb6401dd7797f00c22488f77d8920a9c56ae83a7ab0df98d22a7aafa2031e68a594f25f8fa1efe3b5dc212a59604e6a7dcf9f61aa612251b70bea5a90e3be34d8fba44a06690ba03df3a43fec3334d28bae47d9ab70837d3b35d7c662de4214d4c4150d63f43ab635d5bf4cb6a1c4254d141f8a4bfee0069d1df75ecf638a5e74007b52b28477a546d491b2f6d10961a1c37aca9249b121e18e2f726d66133df0b2065fc89c14b3743379b8a4bb9c5fb9dfdf23930c2b114eea32fb6d38a243c88f8b0ab5ae9363484712e8bd57c9a154e9a7d597f02a23ddb3c3accc37f0768f438650451a54b", "a7c749b495bc32b6efec06fa8954d274bac81f2aba338ceb1c87edb3007ef1c6ca36906e7100db74b042e0f294a1b7de953a289efab08011105371ef10176d013603205529ab0aa046b7aa60062be5fa73b9d27e1a4271a4236547d9b496b577b8d34be1e2c896b4692125fbf4475eb4275a5c91617a97d467a5e8efaf0a953a88745aef1e058d5df41da4b50a33ec66423dbfa5403789e1c43da051f2f347be45fcf84d71bd15ba0f4f86fc0e7b9c0027ecdb8954fce8ed6be85fde2acb5876667fc7fb939510a881d79d1082bbcc14401ffc94a7c14364ad4b4305094b30c5a9adaaa92b8940ad091b9cb0df52f84c0c646f26ac5f67d8cd345fe4d6dd0e719b8c11e842efc8f2dea1205ed502edb856c6fdc47b71d183fd90e16fdeecf600d7e3eee6a0fecf96da1605ab326d930928d57a7c252387cdb68867b0e4819bfa0ea9f9eb4a3873bc76150a1d4f4a3280622f87d46ec357ec198dcd03f93cdac365eaceef9348b6313f00db8e15c1280127a54383d4ee4c6115dc998b22e03aaf83fb7ac10af70e0bf26b66e9e8292b2510b6e274485c5355a05f9116906a7934c7dca180aa21cd3392543fd7ca38347e", "a5b43ca18cd20b230348f4a4918f89706afa89b69969c07e5d957d17985237c5a29f3c2fe26ed733875023527259af70b794431dd537d1e23d3de29004e30380db4ddbe8563753955daa62b5590fa25f9e123c08c5e88380f5e6af829c5b94e99225a0ad171e5a5f7d84dca799105fb144e459caec14a537f931f3e3ec0780cb9b539be4d374e2b02a3cf530c4c97ee20a22f7a61c3e418f721ca4e0e157fbb50708835e0a7523ef6084f6871eff142437635354038f213ea46fd8e85dda7020b25d02b8f17f7255ea81f5a3b76e70b1311ba6e35652d55790b22e4d66135376a5bce15e5223adb697315d0dff8908005c996926f505d2c6c93108b4530a573f269db4e2c3f24fae41f4fe1f73f17c46012dd077c7b0e3afed7cc7aded141c0708cce12baad0ce410939e54625c71d685dfa18b52c10b94720c7edef7794667e18da58ef5854a994c1cd2b4ccd9307c672a4cb2cf340ef98c19440fc4747b9d7777b641ea550ea7308861fb1c7c771613295f37909b54d391b82cbc62190a3140136e86c8158fa7143fd1e4817485a03", "b25c9fab876f4de92d5a7b64d0fb285ccbe9a6c4eb725ce7925ddcd8923aaed4d9cbda8ed192842f3aac1f005854a95d912b351ce67b4a3829c0b8564827537bffd2daf1f284fe9dc163c44120f3bdeee3b5d9bd2580fc2fa29a5cdb547d1116982fc8c543adc0645a8a33aaa3fdd010517063d904fb50c17b4498bf58a2e4c035c9d571df401067477d13c8ad2aa886164af5e646f5f92ff32c1cdacc02251f967522fc09c0a61ab41c45cadef585eb59b299730ec5fb0dbed28bb76420824f294a8c3b994b7791570f0b9b77089ed75474d4c9c8a5583ca5a5cc0bb5f258695e7a433bcce9ad5117f3547d8dcaa6de4aee3c1290a514a71565357813fdb794a3ec978ffd92079e097dbec23bb9f8850ec590bcc7760f91a633cb2aa77ca68bda24578798167e2e6b156999b19bc784107104a6349c17cfcdca4e620818dc0fe87018861c9025ff9cf9bb5a0ca54f245a203a3e068cca15f04ec025084e270d967e72e7e21a188004f72ae9589b3113", "855710131b480ae345cfe26345cf1fc07842186a359124e77838df5ef7bf421d4ea136c7809c036c8f0b804acd1bb1c2a7107486eb200420cd94fa3db10093d531e9a6af74410c1283d712a9f94cfc5389e4fa4eda08383500a2b8417233bad792e64afe423a395ea290af14fb3042d35f5b614094eda6fd8aeb372a09affa616a06ef15f674a6deaa9f36a658088dc84ec9f0951c2c5e8a89521e53c9a49c07302a774863e60cb1dbd711493e74737256ba3126fa51e3e4302011608246d40bd14658b06e66552d313f65f989fa72d7589dba0383df394066da311c530e46946db7c71875f5e92a1d55c89ccffdf8460754ab55b8b8550bbb091c559f05d0b456d6681b12e228d46371ebc018170f790585eb201dc7701814ada82e1fe73253e2b4edd2f0e96cc2f54a1eb8fc9917813514be1486c921e98daf74dbba769d3ebdb78bf06fd7b8391b468e7b3d2c784f"],
            ["b19490f06c8b93f35fcac312f88a605ae003086e8379b48f42c856026ec62b12b103f43ef9404405f2c3da2dac87a53492a800c05aea9a81e4866d43a454e56c11e44fc20dd7a9d46b41da4d3577c263afc2a210a758b9c4be895e69c418bda28fe213718e4075ad618d069f11b5899958bd2d076de4c93fe05bbb49e057b5f2a87f0dd28c6e725387ac78d6295e1b2e29178a17576e7dbc7561b49be1a6ca04062d1ebe0c5ab854aa4e3f94bd3754164e3791165a821aa96dd567c618331f8fbb711586c25145fccfd2b3da4872f19415f1833e3446ea699764481e92202207034bd9ed4df10e26bd9248d1701a4d7c4029bd2490970cb50e81282a3757f9a22b1b9fc669c9456fc1ce642d50ffbf3a57a4b71b69674ee31598a2fc28db72396efd6ab7e2b789d9b69cfe0f3916cdf1660b6ed2f9aed4df76ad4eaa6f23cbbe0245dc6858aad6594297fe7a5e0634383d0ae3182d4c943145edea21c7fe897084ace1a1035b58b417aee2624b67473945d3055a1f41574fc7476da4291c0b206a25025545551ff9e13679a774465008702fdf934ce47bdc40feb5f356f360d5d34ddd5df6b0ca443db8e2d7bcff20506c10fb34d67a4c7c2ec01f2802fedcb0e3444a809da19408e60874e9cbefee0c64e87435da826bd034039a8a668fe6402311c025c4be1c25cf39cec699b7f0dc", "87d7e56b63c62f73158848f792bbd6fc24a45b92f3a94a7b8365ea0c5f9865d6c28ff159731185f102f8fba936e848e991f0b6d22ee1b11cbb0b553e14ef110d46c54a13e7e269f7aba31bec18e3486c946b25aa405218e368cc030a471db4b0a992fee5ad55e9517a1ebda7e9ecea846ac4c848effb7d7a009eed8a1d47a3b10696436c42b512a6a1103bb369c9282866205487c94cd5943bcbc93f15607f275cc736d99a6a9993652d9caacc1914ce65ca8908e7c3c1d25e11188358f9d6ffef46aa5f1a9c55c04435d7dbb186ce196ca3b1285d5cec4a56326ebd45ae75e21cfe8d1fdb521e71e542cef7456e339c61d6dc26fd89cf36c271ea0549cd580d6f4f79aa55304420eff267bb0b29ff6f0a5189baf68676a609e8b5b346b6e49488be1ecd8197aee17582a4b9a9a5e7ea0de5f54e9c5f32a69e1e252e498a7b05a6ebe7e622f04bdf15e5bb3a760f93390e338ff8db66ab1e10be6167169a9900e9a51bf6da19dd02d6f97aee7122893a221d2a742e4168665130dd6c319da7ea4b799c023856aad4f63832c7b60936f73005c04200878138ac71eba617b72298331a7028e36034876765d012059c28186ec83987a254392da88d67e4bf8f6359dc2f8432f3e021aacbb6c80e923cd55e", "af16147ef10987d4a53cafa1ca6ab170d059312047e1e56359a298b415bc2437e4b4050ecafb225c428ed86836b1cfff9538234bde397ff0cb0293beccef039f805bf84dbe780110d3a5802c6994f1b53935cb1079c24d49e756a6b4aa10fffe80fd4d7d5ec2c87814a2166e5da0c8eb69a595922f62efc7f13486713ebec29e593f5c85c5b172d0222fb2bc2feeecc725cdddd42948ff1f9dafd374a8f77fa02f5ec7476579c3d472e628cbb308ba1424bc273394bbe8f05dbd310f4322248c777c8f161eb1034900aaa4201e44a85f096415af0a2b80dbf31ce127c891d26953b7ef3c7029eb939dc138b89360b35b619286d456e0c3979773870319d08581a203efdc2fd544ce8f1a38d8b0f45b1044b779b6d1e06a1ce4af9c5eaf3f3991c6c14d791ed3bb66329dff22983631bb42aae87d75f809e8719c4951076abdc23838de9a83d4ec89d6b85d98886308fe38600a6b3af56b9112e0ac181d5ed35e891bc63647229b5d136b0065dbb5f40722e83d69c5d34b746344e72f13633595e877f57cfd3cb5cc3cc8d8cfb58262aa61cc5be0547cb445313542bffab222a2a3940f69920523f59cb213cea7e938ad", "b7614091d0abdfda9611aeb1b6ec0772fe496b5eb0ffadeecdbc689777ca8bf9f184f895b43bffe582e4c8cd80baf02ba3f0567ebdc65fcb343f9f9e277744e11483e3e7acca7a8b0497491530c625b2c2788d5d779e8e262b2a5e562cf6da03a2721e7fb8c6b91065d08dc95bde1f5901a580601208dde6bbbbcd53b04a189ebd6f27125407da10bcc33ffe502f2ecf10305ba05b5da286b63aafc17251b720beeaa2e50c25ec16087da9c9fc2a29554072b208f5cab98c14d24b016a63de2f447cf25d6eecfd74c8a51cc8ffc0e7d15a2dc2424021e21c0210c7e5ac842af9a6de725ae7be8d9fea099b8dd9e1bc9d2c867b1bb9e7789741f1e924b70cd4ddc450517fddf289c5b6c820b34f588b1956cdfe573b7923fee27d102df1cc4caccd0d7ae7f6b48560ef4b0edab7f2d7103c8c46d6a7556b99f10c98b2b34449f17347ec92ee320639ac40e3d4951ec8b854e8b5a31c22e27be7d22824e660a4d9a898954b968587219a45bda2ba426caa612907bc84c348f23381c57532f0958c5496d7e9fbb3979bf1df8d1043650cdd", "84d97a199369bd2ac659b2a03e470e4ece76cb2d50cc45e58803d2ef50dc34b0db647ffcb28129233d6d3074e33f20498926392ee64bfbcdee5d5e991efda50b41d4d042f5bbf6aa0afec879389751e297081c9a4a8d6f4a82d72ef8521154d185452f3c8153e40482f3039942c56077895d68b8354f3c83f008f176e77f8b7f05293ffc8cb7d491365cce04324dae0116a550b057e07a501a637cc6ef8474e3a0afe15d64f2b3450666cd2920ca1de50fc3f71ae3dd7bc4e6db61063dd310ca9a135ae3318a7ebe5b87b587a4e433f50b1f9f6febabe42f0c3768462fff63676f0cc6cfb5f0414019ffb776048c31fd41d45b60e3906fb2ddb4f12095ba84835fd7a54495ec6670d468751cb02231456ef01a3998d039076f6693c36ff699c4221c7793bc623d7a43ce2e18519a712a6487dc709567ca110e9c4c3be635c19cf18cf690af82fae34bea7f92a09981466a3a088dc9df90adf2a230683059715716d5a8f0aa62dfa1f94a12583e1da2f6", "94303ac85a7083b766bafbec60663e7dd9cd0a79babbd95c0492b4bf3a52e1fd251daa57c606cd6c3462329ddd28de22adfd2adf75cbda1260b4eac12ed129c4617da73c60a45bc6a371c8eee448a2e2ca1dfdb90a84e86e9dd40ad02b41f81d93dbaa126aab7f2a9b856d97ab545c0256662b865c69a8b5ace1a5358de28ccfd9f6cb999fe6f54600a396cdb4cff3cb1ade544a71a46bc9505c24bde43bcbcf9c8371303b10dd601b04158fad1bffc8368e7afb16c2d3af3b44bfd53d9ebb1f394ffada6086ee9c2fec3283f7a2bd7a60eb51bad479f8b9aff31fdc775f368d6fd70f08bac2609a41d43e0daae9a469535705a24b38a55dcd354e754ffc87bc8a2c98c8a081f1d8d43ee64b5a71064a042dcceeb025dc1a792ddb05f3902f09c0f928d57a06f7e8ebc9aaaf74e071cb625d21581a134d3a7003a644268109cac64cc59108202a12d4369a70bceaec93"],
            ["b4875df837034a8e28bcaf38785d38556f02105569e1db4bbf66b90e0dd8ddb357c97de3749218cd8d932e98b6c5a5d6ae58bfbdf0bbcbf5d3cb2ff73ed67e925d62a7a8b1ad2d4c2e885cdcb36c23f5b173c7315895c3d570a6f38bacfb0610af549cbb710809f89df3c21b5fefcb11e8cbc75241127746312486205ed1557b786d3084fd8e1efb24035a1c6f9c07635797af19d650613553ff4f246017c79fcc827f7ac9abbad7d184e66b9e30b6ad53f5bbb8b9380900e1f6e6a05ee4f0f74947758df82efa1147b1158ef2de0b32313fcec3a6ed467f6b260f974dc8836e8c747a342956e1850b0e38ceed861aa51c37f85150a920b2237a7438a91a611faf34caa910f7b351aff2a8c2d97ac2323aaf467562043b23b57faee5d59f2fab4f6bdb42ea40fb69c76218fc908fc818698788942213b3f2ae36474b9761611b787aba666696b7130acf6ff9095738210cbac87486484a561d70438528a6d2244e451a97ca4a6e8521887537618d8c630b496bb7a53f108372980e296cd4553e3913d1ba13abc831d22a1108c8e53bd11c5f5e19ce110ef6c560d007cdf7e90b2ba7dabbe1d0ee9041406287fd0572384035dee11aa0c4eeadfd50e014ef86a1846bf25517a61315b282ad18f4ba92ec2cdaa6a722078c43df4b32dcae40cd5357882587a3a4ceb0324e38399d706d0c", "a893e9fef836fa29ad290711008edb4795727e9749d3dc71e9568da3986f3e86af3ac2f249b4aec99b54172d038be7ceaf9c16d8db90d719f1a5c5c3af5973c29b34ee28f8c6ce6bfc2c86448607e7e3c66cbe655bbb0d96e44970793a237c43b800795fae7d2c1b596d21a807449ba50526375e5a47476a5844b3dd43e63fcbc01499d3c9e438492163a9d44b107f9e1eb7a957368b4b37883979e5cb854b0c8b24b157cf4f416d1efcebff9c15ee375b822bd781090fe85021b0757497ac2a66e25dfa86f29ec92436ceb56c5a3b965de10307f6e9b44c8f504dafbac31c4711dc75bcbff6e7d2c0c0db9e9ad3dfa248825e232c7a16a7a77178d3eabb8a788541778df4819a8b348486ccf2004820518daf14b47419fa4df6f66818e14b5e10b3e05d543af68b8fca8c89ccc12cf749737691854e4ad64a7f3c930abafa275d1bead72c8abb4bf8334862b96bc2d470e3ea7f1401570edf8da0a06f5faad530e7f0e3237197bb19be6f358ca3f46e6281d99fa91ddf1fc2ca0adb892f7289f3f5b10dccf53accc024c65d4ad6c3e34628c0636c8275959f94ba269e1052696ac4e38c419723672410e4001f2746ee5e521a62df8cdd44610af8a4f9e535b9f3b2f9167b519ccc23bf8e16903d3000", "a50c2949dcbccb9e1dce02b64afadb274d5ab66cec59a49c952ed8b1c633fccc2620e5009dc965d5c5f2ddf2599abf7f805f79193fbe8356e141d5d0bcda2930e598fce742d91542725b96d81439325c6c3ae6f41481cd11dbf452d947cdb5b9880246123e6995191a9d16741c8018c36c947f11fe73599c3903e0fa463a5e2170e66e767d38f31649476d7944887fb83b2beaa269fb190a93668be057940a2827572abd6211f9bdc57604e8954baeb4290071c49e759bf6b6be74604bd1eb50b1f0c20514623effcee71da82a0b15d773c59c12c87bae7c38e702c63d0ac7db3a62581ac4138c3769bff703706b107c58e3dd2f1a81050797cdb60313f098e2822a4d8efd536a80d0607bf561fb6792705c85720deb3844c77f5c1669d36a0e9d9edc91c9b58dbdb78371dcac23e9743eff946877bcedad8abb2f6efacfe674fc451dffe1174e2bbc4cca8dc088b498506ca5e7b1ae2144f5113aa526bb64c2237904d7ae043f7f2b919512808e45fd62ffec9547d0bc52d8f1363c846b3535d71568e485b2f95d984deb852bbcbc350ad5cd30726297b0196a460d19d9936874398fce35f2288f3d38ae7ca0ec7062", "b5ab193a50567a49cce74473a57d8c0f94b8d6f106c80daa8a42081bb3389905065cb3e62bd10d693cbd3afacedaaa0cb6b1c7b66037d16b3d1816869fdff455c27b029ea4bcda2d200895041c541b4aca831729d651017505df9a6cace530f6a8cb6da5b64d7dfb293ab3c6566c0fe7e9b284932af5be20be7f3350f7478c26d04847f0d8df64eeaa1a779ad754ca0e4e8d2c8807933fc2e5a20975284afb5f735e6d21b6213f8b9c6d53d895620c3d6604c4c417140ae622655fee78eb1d86e70b7e463894ed8560f5b4b6d75e662515d179e920a30e15d1cf1468a2016726f48a066205b3c7ece3689667ef5f8b65029125fd70055cf602f91616c9b3145edcad1d5c9f8b49038c9ae6e78ce3f7933d327175b072062389f0fbe5d53ac977b6b4e8fad934bf1ec2b48fca3a9122883746eb4ff61fd83c06c867f12664c8b06c1634f2787ce5d0d3a504d715e55d7509a0b1e7072b93624d46ed1e7df43762df0c6a6f861a25c6870e4d4a456716473fca0252c2e50b4d6ca40e71ef8b56b1550debd65edb09fa85f8072fb556c545", "a802aaeff5588a877ae452bb3f5f3a694111e165b2a85a613b4ca44c1de8227a42dda05d85d93a2c5c9fb2b6d4b10011964341b4d2d79e32073c5e0f5900fbb1a135cac6b88b4ff0d35415d68b4094c125d15c2d400cc61b26349ba803118f25932e756fb64984a5f12342343eccbca33c28b4be3d9bf45973b6bb58b2b75e15b4851cee4714eec4e8d9a502dfd8ef191933f2eba9851127d1155763743f80247a6d00b5a4c05220eaa68ac15694a8ab4a933e97e3a093c11e68f8626a99869746c7f709f42ddc725c90fe29de7f447c085adac3f39ec36e5137c2943e07159bb0279c37e5464eb2a937ffd244faacf307883cb18a763010acb59a7b7e46627a892516d6816f72b7b717cd28692a97ad6ff5ba200bdb3feaa029836726ecfb15e3e2d514bb1d79328303d9dc336964341618193baf1b62c376f27033d735b822e41d5bb5e206f565471d72ca6b393909570afe65a9333d957b9345a472a1be6e310e147f075a85c2ba9703a092282892", "88fe108d4ac8245ca5b3d5c62e55b8fb325a28d0c9d348a22d5aa2d71edf106ae53eb83a9fa21fc91e40737abe0d27588012832d353ffe75d3af20bf6fa50a9bb20bee00483de041171d494190b5cb9111a643f09cbd01fe5563cc4056d539e68f48d41ad1d1857388094d2822891db6e03a6ae7c4e1a47347048d90c28ca69aeb575ccc1ab8613c7bd64be57d8061e34f4ba5ce12a3f1b42a30caf8e418b5ebb3d83d4de0c982d7256dff42ae54daf6217b3965dd43f6ed522cbd3a7ffd0805c8ab52df7ecd91bd319ae7cc41b1a7822beb12478c99178b8108f1f0a9760cbad60ce609746252882a21f4785c86556211ecea3a8f89384bd92e365aa6802345974f4fbfde274b8ead57d4bee465d0e8609df6835ec199e738ff533c97e31b0a4a1fa0a6250dab72f4c355c600efdf362ba8d821ad45d0ee90b59c2cfcf7218a9630007fcf5a39d30e6b3ddcb9ce857d"],
            ["b5753ce23905e1267ed88968b7b63ee7f984021924c6150681c4b8282df11567e87f27cff0147ffa603eee896a45f3888049fc534fdd0277c294e050a13f395f06d08b85eb3775856d6a000bc953ba62515c083ada9468a481dbcb586a2a862fb15b9af939d2d926511843aeaee0b9c103d42a7dddfb341a6dcfa4fcdb6f9918d0a2a9d83a7d80aa0b23c11e5ad9e0385ba79a7afe68c97bfacb7e904a3c727e5c2a62b4c48d87e6bfc2d48f79f3f7ba2e356bc7a1548cbad9d851aca51ac9506e68d1d70d580cbba3920785fbc2dcfc652b2d27e4f7a720768ac21a328d9f5b34e3beda9d4cc03a839f019fc58b16c44131306601dca83f0c107f89c104996a8662c17e87387de1a9218db1356288bb5854b0d292a45e57334b769051d98cc27bd84bf98d80853243622c82c55587c8660fa642bd6c8e9c95274e28331cf891131c3b0b7e69bdb968190b1ad129f86b710f7e55647108a4235f1c2cafc3f783f11cdcd0d149bfb98d7a25effdb96efd30fd376ff1cb3ee8643359beee26547141f3a6cc8080c7a7306567e3bfd2656d207a0208dfcddb1682fa6abc903990ce448e56046b0cccbb2dc8890cb2b80d2a61c096f4fde1ed4533bb2de5090e8626aea5c18288bb9fa21a0c40581f9d45ba07cda9a1cd673b1a621d9bc4960e2cfed8e68569b163d7ded87e34b858efafda", "87a708dcc0c9da9dad29bdcb892fe628145458000bd083d9102a056055f648ba71b322a78b2a42b22493115c6ba4f62aabff092619bbab7ca39cb04725567f7df4f3af190316de8c0d38cb1733dc1f955983a6a4215187a3a1d646d2c8dd46fc8f1717ae60535e6a104cc124191ec5bc7080d93cb89f287e646b4f834505d335ff50b563467a3017cc5b75e6df3f70144b4582e9e57f1fa4ad9dab1a2fa96b03127230390b1caae70e9344bdfcbe68ff6a927d54c91f582cb82248b1ac271ad104d84a5c878be20f890618d1c94eb8b45684f009b9f14458c98892a6bfee53afa420cdc8f47fe8b2ef42f905721b398b1c6292bc1067eae144925842a1fb0dd0b374422673fefe5e981a375184338e45306272f706a8783985446a7cbc737538e6ca5063f1a2818bfbfb31d60898f62642916eadd0e2ef4a780bab1972a41492d1f35daafaf4722bbefb3cb63ed61bb34f59281c509c9453acc2c369585550d650679a2820cf2a3602ea1d538c9aacfa0e4300e4a23a2baa2a4d6f2a1e9a5f660ea3500924d61ef34de43b4f3b8bd9dc513f64478efbc0372f4c8dc71e7c3132976d5b04f3572ab90b55a2295caf54070f4bf046ed9c62b835a8fab24cfabe8c2ea51a01035b3be7f648cfd9dde89939", "8aba300c0521e8d01801c17cdabb6e9b71f56acd4a8ec2669cbd885654041bc02af25e2adc352027abfb9353ac5cf735aab4b65788b3f191a636773bb07e69beb893c5e4cd713e4cee153e1ce26d1f872b8a071441a0c0c9ae4a880739fcd4d298247d1ec77de69793dc2bab9005eb8b1735b804d6b016671f2e64b47add0fcfbefd0108861787fb880f4433ea40bfd36894b5386d657245789193cee12d424521f66458715c57fe0385583f35f3dbd03350038eb77929138f214027ad5b7d2fbb5fcf9c25d50e641558765f552db37e1ab52e3e77c36f04c4bfd30ba791285f36f91e37e15ccc5d1e83eb5f68d061c550e5e1ae8c8f09d2d196f7c8d5f1094b91f5ec78efc0d2cc2b73942bc098d0d74cec492a475f5c9f942b7344a0bc2bc8e414d91ecc20177868a41b3f3e995de85f2f6b80dd4341db8425c816bc8606a445f69448ce9e3a76ba55a2cc209d4a2a4b4461255c66d50d0ae4c991456fc57fc9fdb12637a12c089586fd5b847063e5070bd923534e601cc7e027646c1613bd02ab74f024d9303e1c5141323dc57ec070bc16058618a55a0762447838285bc94263640e3ca7a81628c66e58aef4e70b", "8156ee72d5213165e2a1498f385548b99781957890507a913f86aad87841a0eb1de70cfb98d57b214d0f7757fb90bc1ab8772d964ec918017515d3442dbb300e1452a309101f47863a70754b436585198c185439f202ae0f6565a9eaa43ae8b7b1c76cbbd5018fa72bf4ec408f7c39b0e60aa938426aba954203efe41bda93476306908a4ad5fd67cc464a0599a776ba33cdca67a27008e4a585d854907c3495223b73ac1ba02a90aa4557bb00053043210f7a198f3bf4b90fe3f8e8bba17999b9b6ac86bd458c36d075df546b30760d5a9c84a0624982e2155039283e6f137350165bf9ea290ba06270733051904c2b2c3bfadf53afc8022bbab963950e2bb2eaee733553abff7583a98cbc594026ad6211a81b301136e42282684b9040702272b477beafc727c12231b38fdf3b153d40b4d902f0754f2197196aef1e47d49ceeb4f5311a7cd0e92fa729591a7ad55c5208c3870bfc1acf1d593f4a1809f909eb197c3fb1e248841872c691e514d27253e9696c71020710de3c797bbdd12889db2efd8e6c1552b19f0cf8b3598b18db", "b6d5aa47e1772197d93dc80124df9ecd450765465854e2684a4f73f7979206303e29ac1d53a49bb4c57b2450d91697719215f0079d1afe26af9bbb637223898d96eef2a788b7f0a12dfac0cca13a5b9e11e5f1bad08faf359136734aa57e9309b09feb2e21752e337a8ddd3b90770570de50e4a8a3d42db97b98c0c1135249d07886512ef37dffcc180d19b566c2af415e6b39801dcf73bb60ec0db98bfc9fbd9d87ad0f5434a90ad3968fc8e4dfe1fa160d48ade0581364410edffcdc14f2f19a8b68d0b880aa3c4bd8e07cb4f21e38228f32861dc7651b3f869c9fa63f8198cb96ded593e134fec9e5a41f0b7e7e0e153df488c0c0e4258e72cdb1d12b8ced1c0f43ead6bb0c7694f93c7e21923218706cabe2138ca7d507f31ffa77104b6a32db83e243d1a0f90e68f0a7e9b014700fa009c99f72381e77d42f78eef06ff5412e0a1934e80113c4147f1490e3ee88613e4d4eaa9857cba7658c1a94693fc41f5311dac82233595731272e18670fd6", "8071e495114c2112cd6153c0cf2c13dbfb7eeb6d323a4a58596d759080135962da7aac8b6b4223873d119f85625c5f13825e4e206e21beba133be036a90624b70045d21f474721707e06999a52debb6be3368f7823ad645466a944ecf01f691da5822f9539555966ad25a5dc19528309f2515bb02a5673e641ceee13b21b9b1d486b88849037497ac9e3ef7cdf2ef70b4b3c5c1dfd845fd4551d02e449d396b4651fdf4727118b3a2c6e1989f6635aaa6e8cd92bc133148e40afc31d86e1ff8e9376186453c301a9a1127a7d51840a641f99dcde9aeb7a4a50724cc377d258a72d801c21b19d98b1ad3a52e74d01323865a2f650dd80740151dc61521617ac90392dbe304e24b17291f1a281fe8733e7264e63f3b44e8a638d88c7afe3926004bb63929259ce2b4bc062d2866c6c369a044bc1373efefd9be31c615a06ca4a7739bfecb40e4c59a162233970cd55e07d"],
            ["b5c5cfbda9eac5a84eb5eb414eca6b5b2b4746830c63e062c4dbabeb591dd52b8cab4b67874ea24c65b806eaf025dc73a16f5c6abdf590b97b1bd12f07cb8f7f3b21f8bb95e302aac5ad51cd01e6b4ab31fb53a338c0ab2fdce4eab49243a8b1b2bf64b6a8c239ffb0d700f171425f79f33e0064bf9c31ff86511950017d861c1b87d6ee049dbcf5b173559ea35c1a73551f1bdbbaf6b4def5658d36bcccda321f8990050ab652a22cea3fd7f000c667390636960e557bb846b41f2fd113458d34b10f92df41d814925f7e9a358dc7f7671ec57cf5f7917cc73aebd09627671abceb110b4ab9aae901b3f4df4790ad7107d457d7498214389a1c5ce88ec1a6e1a30413ed75e55281d24c309231a7e76b383b1869133935670fc3e2e1aa424ec007daf70b458d91bd8a62821d22ab573331d5151700716a2f49a28c6b7393a1eab51f8657f13cf908e9748c1104e20a3109be2ec2fb6527fc2f0dcdd8ab99eb4259f4149729a3b8223ae0970f86fc21d801cd21e8bb767bb0079ff272c35df053cfad6f9f5c85418552c853aa14a14a346863d93550f88ddf283abeab349ccef724adec36b7af97ee1eb40410b3a92ac70071138cf0cad46136712ad95784dd195c4a028b0affd23dd40ec4aefd643f7636d6dd0035d64df6f5447169f5372d9c3850852edb754f55d235b44a9dea2c6d", "b531a46adcd6311e14942c7151c66d47834c6b31b3fa092d197233ae89605cb4cd8aa5bf59f48bda50a7bee404dff04c83583fff62fa3e8950eec767dd1177604a54164b1bcc10dd2409584f551fb88e1ae6565b6e4a9eb6db6228e425ecf537b716d61b8ae97f5bb6da8cc679dc1625e5044e528fc6ae746abaca4dbd0336c649a1327fb81201af333304d0c4aae9a4023e9df937b8d7d59b147a94ef6b5cdc452b8e5f50d50d23ccb7d3f7364ee8ff075ecbea89e97ae7e097a31ffea4720a798976fcd129c9db9872b9adbae6e0006e158661ee6d466d214e83617a01e9e0e5325dfc2439e7799c1123e6c9b1a7334e59c83bd0b55a8aa8f09419db383eed1b754ace29e6b07a9e96df9f1051334038921b8eb0ebb315258a75a9cdd5623b31e20753db97aa16458f760eeeb98ee76e4e292c1b6c64da201cd9872369d9eb9c91750e41cc889e1c9f27cbee19628a046eb99461781b417a33e2e012a300a9bfb2b79f0ac651d77df3758d0b5ed90c255392794111e2427998ce557a473a41ed16887349e9f8cf2693be50249ecd816a588b7978f559a6562c7a518dce0232b0b4708476f729867f4ccdafd9cbf90a0c46a8851876ebaa0099a4794b60d07ecb0feb32de46cd4ced0e91703f8e11f7", "a248801e38740694df0e44c14fed6aff55cf5476f8895f08face80957396129aef888e20be34a8bb0a55182f3a31ed3793544627d68dca7f2aa771967d5df49c0937b16f679d018621e37efcc729c30672577c979a7be7b6c0d95e2e313e4051a9fa30e7202ab66d9e3043f61409d128abd4038a49b4d96d7df7537d07b86f405d20e95ea6193b1aa841b454f33d10bb0ae2308e76672d980a228940305c7e385b943629e03a63f41214a581cb82fd11733bdcdcb61739db9bd080302afa2abe00c3c3027630c4c9d64dff46d00b64282e988402496c50e9ae93de6c65047a5b2cefb02f75cccf728b48e1cfe697960227746af567753b37e4eaf88f521357117520fbce913b3a7536d0da965ba39a823153695394ffec6056c19935c7186715f5fc0319b2c25a61f87e3178e78d54e31022e12f08a7c2db7dee3bf761d242106734fb47bfdbffcc18ceeb17f1012e13452f72235830322e8ad3f7c38a9fde798d05bef50c8a80b48b5f4eb2cff276496cf77a66d2a79085da886df2d40a8ffd8ec338acd2bfae155b78592abc0de6760af7e4d8e56ced92408453b70167a93baee65e11611d01a54d7d9739d6d982e8", "8967fe13197e60f05564212c223c1474e9bee9df9a53039acd84e2995672e5ca74cf9cc3609c67b9c5cc05115039cff4a264eb3ba56761f7e78b656a3fc5fa634ed45e07f7a17eba381816823d87ad78aece3a32581ef22dcf459eb984b69d9a85b6893d61270c7cacb5a63f54f8e61a95f2777547bdb8c5a848c3d8b6d91654ba5a8fd4c256f063871a531f496c2b0e2af3ec6ea243222e1b8449f60f070d3c1a80fec2c36fd8a693581e17164ce8a86d4c8b8f978c9843d0c62569e8b8292aaae5f2bb7a6796a31d8e45b84ea761755c8b439cf6a4583e1f8d34a44b68abbb64b94511b363d60a1ed56a86fbee067643b59407515bea28db18ad6466c251ca320d3f37f28eb4d9262fde9b94f4c1333e25a7beeb4ef1ddaa348e786a92d0fbfe6c8228632e0d115a2bca29ba58907210e0af5b7a5b3b76198b1820ebb7d7455cd41035a4dff2fc36b9571f11ad907a1a339da737596848b061a6840056eeeabc9a97da3e5a8605c87e27dbd8a7d2aa2662176b1fc10d2d5efc89809ecf0a2fd608a4e4c314594ce41d622ed132fae1", "b2d727e8cdc2b7a84a8728e6113319b1712c3e8ad91a204f870f4321c281c171e063f7b13e11df4edecf4fee829876bb88fbd7fc79985cd1c0fd5f762236c36864ae10b2e304d094a249a778e59a40510b5ec770824206418db898abd6ee7f86917fe7ad991191e2fbafb65a10de98383a80cb2832b2bb03100fa27f03b0e5a17e9d434a39484090cc735be953bdd93d62634f30d427ff7244e0cee3ab65b4c5b706e6c99b0d8792d933ec40ca001b624b5c3933cd6f9001fa6b3b0a2fc52131857d1cd6ab59eae363a890f8eaf539d54d8025591e0a5ea509499ec972db3e43cde7c49ec6987ec8e917904b874c805e5653c61759ceaba94cddea648f21eee2a151acb79cb469fe66ca03b1c236c6691f15318cd8fe70bcb0298bf58e742fe17fdfd598e820c3b81e53c810d3d566574cfc33e70176a7bfa9ad181cdf169656842289939694bd13ae545f53c7d39239316569e6edf36c0fd83919752d6664b2e9e42278c5a6446a042a9f2fe9469491", "a6c3129f0c70d544b6f803fb2f8aa9a67016c3b603c753c3b0e69486442a0a32742b10329edf6de1c0cd870b8e5586a4812873ac6d4ce2e7656aa58757eb54591fdc209a010c2e589bf5361e0302e9017e60b6352edcbeac72f38d39f54e9bb28061a9030235c1568a9ead1949ad1d67cef062656fc568735ca3f0a4f3a182074aa7dbdff98ec59eb35c5761976c042c0b02b2a0f73e0a1847e77406c73b313ae192c167f7e0cdd8dc824bdf0f2d5f0113e58067d1dc4d6c74316412d02dc39d8e0947c285d53b32009656fc512eb76d46b1ad00391d6fa4e48d5988f3750590e1dde8c89008641e88bd769b060d5c376e699d4bd14d1ab98d325dc013f11f37b45171b6a0a8239bfc81aeadeabd35c361afd978bb4938f04b27530f307a97a7d07438d146ae8ae255a6388ad6a10a013bdfb85eed280bf2fa9aa606ac66df339ea9f8292b41fa9cb1af21c478881538"]
        ];
    // No presentation message
    let presentation_message = PresentationMessage::hash(
        PRESENTATION_MESSAGE.as_ref(),
        APP_MESSAGE_DST.as_ref(),
    )
    .expect("presentation message conversion failed");

    for i in 0..TEST_KEY_INFOS.len() {
        let pk = PublicKey::from(
            &SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed"),
        );
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        );
        let signature = Signature::octets_to_signature(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(
            signature.verify(&pk, &HEADER, &gens, &test_atts).unwrap(),
            true
        );
        // start with all hidden messages
        let mut proof_msgs: Vec<ProofMessage> = test_atts
            .iter()
            .map(|a| {
                ProofMessage::Hidden(HiddenMessage::ProofSpecificBlinding(*a))
            })
            .collect();

        let mut proof_values: Vec<String> = Vec::new();

        // Reveal 1 message at a time
        for j in 0..proof_msgs.len() {
            let mut pok = PokSignature::init_with_rng(
                &pk,
                &signature,
                &HEADER,
                &gens,
                proof_msgs.as_slice(),
                &mut rng,
            )
            .expect("Signature PoK init failed");

            let mut hasher = sha3::Shake256::default();
            pok.add_proof_contribution(&pk, &presentation_message, &mut hasher);
            let mut reader = hasher.finalize_xof();
            let mut data = [0u8; 64];
            reader.read(&mut data[..]);
            let challenge =
                Challenge::hash(data.as_ref(), APP_MESSAGE_DST.as_ref())
                    .expect("challenge conversion failed");
            let proof = pok
                .generate_proof(challenge)
                .expect("PoK proof generation failed");

            let expected_proof = hex::decode(expected_proofs[i][j])
                .expect("expected proof test data decoding failed");
            proof_values.push(hex::encode(proof.to_bytes()));
            assert_eq!(proof.to_bytes(), expected_proof);
            let mut revealed_msgs = Vec::new();
            for k in 0..j {
                revealed_msgs.push((k as usize, TEST_CLAIMS[k].to_vec()));
            }

            assert_eq!(
                verify_proof(BbsVerifyProofRequest {
                    public_key: pk.point_to_octets().to_vec(),
                    header: HEADER.to_vec(),
                    presentation_message: PRESENTATION_MESSAGE.to_vec(),
                    proof: proof.to_bytes().to_vec(),
                    total_message_count: test_atts.len(),
                    messages: revealed_msgs.as_slice().to_vec(),
                })
                .expect("proof verification failed"),
                true
            );
            proof_msgs[j] = ProofMessage::Revealed(test_atts[j]);
        }
        // println!("proof {} : {:?}", i, proof_values);
    }
}
