use core::convert::TryFrom;
use pairing_crypto::bbs::ciphersuites::bls12_381::{
    verify_proof,
    BbsVerifyProofRequest,
    Generators,
    HiddenMessage,
    Message,
    PokSignature,
    ProofMessage,
    PublicKey,
    SecretKey,
    Signature,
    GLOBAL_BLIND_VALUE_GENERATOR_SEED,
    GLOBAL_MESSAGE_GENERATOR_SEED,
    GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
    MAP_MESSAGE_TO_SCALAR_DST,
};

mod common;

use common::mock::MockRng;

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const PRESENTATION_MESSAGE: &[u8; 20] = b"e8gxekZpmeZTU0VDL9MV";

const EXPECTED_SIGS: [&str; 7] = [
    "b9408ed28f2f812ee8fb0be09a6c0eb4df40765fd122ff6321026fb5916c427d216ff96556553a0ca6607aba00975c9c2af2bbc3d8df570a879728eefce3f9d4c19951b9176ff79ac38400b7562802a82f45dcf84dbc1ba1af75d50aa58b15c22c967746883f67030d8d43494daf97c5",
    "879ef244578e9841a02bb08ce4d6cb7757474771fd53bfa3d770d2a524ddc1b62b217a80210f02567d8c567b85fda22352f980f3ddf9d2e440e09bd7c96b6d2f69ff8b9e87f278eb6b7707181d0ac29f3e34799f118d67b8370b523904802e932514ef29cf576345382832d9a9ec6cd3",
    "9440e68bf336704dc97d3761206d1f7dac705b7f125a2f8c73af5452f7534cdee06ca8793dbfc8d52dc336b0921f4de670f517534abbe75d946fb55cb192f0492f0da27e4b43a859eceafb477ad0fd063bef58b6e42239e5b5a9f7c03ee26dc5bdb2c58b9882229f6f1298ca4081cb35",
    "947c828032ec3ed0a96a39ec06d28959f904df9738910ae8a00c2426a0659bfdacd5cec13dd48400caaa89d64418a535365a95b5ac35c78df9a0bab531fc5e1e0a9904dad5a3ee2704ecd341f7c4afcc0336626db3ea2c551dc24b1ad7eb444115e1c09785ec296856ccbcc94f6f7b8e",
    "8d441750103762e2a6c5a09c9384bc995aebef47df9a48b3e99f5dce445190c49dc8f1675b9cd2330a2cdc728cc2547517fd1403add7302324d1674edec957bf42dadd2c2ff3a21a461d4d224771284e5726b46e6a2238833eeffec536ea74be64d2a0436d99123bd1f3926ce4794e21",
    "8b4752f814e4289a3149720e72445b65fbdb14fbe912d7799662c3235926cb557de2e407a21163484d8da309cdcf535447fba1319a87785c542aa43509c1dbd6a9777b82ac218f3ee825c0bddcd864381d305c1c296de857951062ab22e63eaaa7a84051912031367242b831b1de0161",
    "9454e504820f0ece6654604bc06c63e9000e327af0cf0a39e2a2428a6700c53bb660077a78b318573de51b339c0b6c2b6b10cd449d02627365447436e3a4111ac7c08743cd06a78efecd24c281bfb7bb43c0349e1e49f66de443e063cc42c7d84a407503dfdd83c1ac98a26cfa0c7d2c",
];

const HEADER: &[u8; 16] = b"some_app_context";

#[test]
fn signing() {
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| {
            Message::map_to_scalar(
                b.as_ref(),
                MAP_MESSAGE_TO_SCALAR_DST.as_ref(),
            )
        })
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    for i in 0..TEST_KEY_INFOS.len() {
        let sk =
            SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed");
        let pk = PublicKey::from(&sk);
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        )
        .expect("generators creation failed");
        let signature =
            Signature::new(&sk, &pk, Some(&HEADER), &gens, &test_atts)
                .expect("signing failed");
        // println!("{:?},", hex::encode(signature.to_octets()));

        assert_eq!(
            signature
                .verify(&pk, Some(&HEADER), &gens, &test_atts)
                .unwrap(),
            true
        );
        let expected_signature = Signature::from_octets(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(signature, expected_signature);
    }
}

#[test]
fn proofs() {
    use rand::SeedableRng;
    let mut rng = MockRng::from_seed([1u8; 16]);
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| {
            Message::map_to_scalar(
                b.as_ref(),
                MAP_MESSAGE_TO_SCALAR_DST.as_ref(),
            )
        })
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    let expected_proofs = [
               ["97af11b85a71b19361a28d5c2772a24b0711f9d9e8e6df1a742bb11dc2c2f3aafbaa1296c5f63355aa1f39a1e505441db467c260e6cef9d712cb8bf9e5cebe9c6a59f51b938cdd9dd5fd906a294f669f4306d432e3ef5914cd083465a4d03e6c95b64d19b784d62d388fcb38d7461069b26b8d9fe6656a2671a9ecaa1d0b1d5a40efe96f5ede851bfcfe6ef48104e81b2d741aed3c197876f884f28b37ff5bb01626f375fa0f12423fd315ebb6b916733f3b111b961d39c351039dfaeb390dce966dd880725ffb1334bf5fb9014000e228629cdff22c4e2851b31f0a5ddf53301cfdc1255a3a3f80a05ed8ee40a4fd675d774a14c2fb389f0996ba128397ed2c429416abf0529c122a78dd73a3f47bae28e2fce530eb63383a3000e5ad8a56632292b139d9b00cb374df2cd6d2320fa11ba3ae9f78f298f0b8635c87f0bafa635b049cbbfa9ddf8f56f30f2f5ef746bd12f714cf2fcda59c65c9137106e7c066b4491b833cc0b908150cb288a690b0ef2aff6bee81fd2826010c12a2aeda209fbe1d5336fc3951106de601bade592e864a7cddc0aa504985c0902f77f42b5512c7054f2e1e71930238196a02397f268b6e9ddcd6ebff1156ee451f2087065949cdb649f509ece97930fd12e94d4e74096b81f92588814b39e2eb14d105b9a137ececcf3fe08ef9e745ca2992a0088eb9", "8485281b17e2256283e04e1587b343c3c27a3e6eb28d9b006a95c6f8d035eb14a3fbf5c5ab4c36186a6634cb62e9b2fbb1292b4d70998ae820f89347d9b5341f0b76cfbb477e1cc81612b83a3cb9965922d4ac01a77510d4ccea101c7879e306a2a844c0aa62a435f40b07b7781df980d41e9045d20fc966767db536d35dc43a8681cad57547fff28c6ad2ffd92e1f0800c18efa06a19aa7f571224988febc80ab5d8511fccdb921b71e83ab91e6e574529f2c819a934dfc61e357b01f9686b2ae69228c5fb8c998f86f2cc77ab988561f9bf681bf87009fe1849916946177359352c52b678495070c6733b92073829012d7174b5c1c1d951338c44880c48a721ca18ea7e5e58d1211cc956648433ad74b53743b6f56e86e28402aaf4eadbe7179c9164e2b160e6a9aa3c3c52b1430ac674a6d5d0dd763d0c7e874ab01cd89f9d305596a19c14dd536330a69ef23244b049530221059dd48c6aa91e5c5d36b98e26f39c9854fcd9ccd57cb3f83a1a5240d8a314f104906a4788a6f842ff8332591fd6002e9509373ef5b784bc008b4c92725533a3f5ebed79bda032e2dcd5894645b8f3aa4990d98be7c28731d4df8d13c99c02c27f93ddf2d305c973678e5c99a7d53814390693169d13a04e9bc0f63", "82316778eacff70030dabdbedf40a1a46604e1fa4b601995c3a6c1e6d7f2980ee0a7b84e09669fd5a8a425fdbc5b93f4a179d910ab7c6df370fc608d3bc21bbb53555cf8de25c4c3106e1378745ddf06369fdfa615c6539def85740dc88612ed829d76c6e597a70123dce19cd0cbb333891641d263e9504de448f08fb29e18162e0335dc8033744e3ad0ef1d51adb1ce6ffdf0b87c0714f43a0bfc8fe588b5ea270c25b9556df181aab979b346f7a02f50ad9d74b5fd4b8a0635547bb306df7adb7cc904f8818300a6a6394591afc85701d7a02f47adb354ddf3ef526a716647f6e5a26fa6d454e5ea420695329cbfa751750e0496dd97be936e54953cc4d9fbfd35abc4d63bdf3031b3af21397d4d07046ed69bde857b37b2e424819b2c07660ffd860df479ffb858fdef709e3576277134904a7bb44b4397fa83d22909286584351a465c25940abbb4d295ceab91eb4e8aa3c9fb87880b82cde73b8ba5619035fb53f1e765b29f692d296c822ebffb201520299a6af5fd315b86e17ae0ba7e69285ab571367315e25a1a66f199777640294b88c358744bca0871b954d146025900ef73738495d43eaf23a8518d52c3", "8796a7c3bf859d5f09bfde48c3a3552a07afd0d729293d4b239d3a0d639ef476a2232403f4f8b0ed12d0d2ad77e52e1aa0ff469d6df805a05f646d82187a704652160f6ced54a850aa2bf6012489ec0745546e4e6e2e0dc8a931e5312999d288a043e3be9e0141bccd242f40e02df56c78b88686b32539feee72ebfbd65975ed158b422dbbb7f72b7cbef6a2c32ee4b839174bc0be354af6cbeef40d88c3555de657d198f22ed4c8be8a93e97b0225831e48481716411a29cc995e6e89ee7002d4c248b8e2670a3470b249e33c8c6f4220f289a35862bd0e93d726b5e43dbf6bc602296800ff970e847128ff914337aa5c1b0d99694b46302fd6d82306e889cad4a2daed46341fd5ddcf96a31183b6b23aa3c47b7d29fe29848749abafdd9df086f85424049aba5f53f118eff87f563a2a02772ec3d692644e0537457d250e6d347277add52549edc227e1429e9d9924020496b82c0b147c86e84b7ad9b2bd18956b3cee1ccdfba8446ff605ad171f040591af843654b55b0e4f2db4ffb4485a7661d390078c61305c227281743614a7", "84182d48c743ec53268812de699fce7e09763aba62f7d2fdf3f586b73c21721edade31665f862ce1239fce213836e4e18eda3f012d5556b6b2aab7932210fa5c4a2cd6cb71f0fd65da30c4a493eaa58f1533948d4ab040a9192d487315bddcfda8fd1e2b8de4e0a3e38b57e2e6f595c7bb2da96421bf44253477f1f3ba8d261cac39eef3764fcec0831f204c0b23c5e00749c11ebccdf1c9a0b3157d195c8d95793b8d64f6135a7ba3708789195e2f7f6fe9d514b3a7b81d7c27b49a890ee910adb2394615c4a871223864e192c630f42325ac26dba61bd2f6c084234c9a2a245cfb79eb693fe9857348daf1409dac89013824882f69f586c5aed5d693f5f48bfc1a1fd6db51217c04e6a53e3fc317af16f5658fe8d34cc3b70583d9ff0468f417d64ebf863027a6eb480e8a9d9a6f1f670ec865109b7e96929c1dfc835439614e501b103dc9a941d1d35c0a687b3f8d5f0933609d8cf4c6a50d0f1cc84531321b183e1f555d3a7a47d7c300dbec1585", "888eda209ff3bb226cfabf7baff1d51413c8bd1d31d300da14abea8dbcc6eba03a52380192c13f9c34ded2211f527820b143e5bb7f5136df9fdeddbd5d08425a2816581d81d19704610b9bb5df4ecf08df96c5fba776cfb30fc3bb4f5b770645b224e21804607c9a6d531a652be7fe15b96c61cae99a6e41f34f55ae9f44fffea6f396b64e42e78cafaf2460b16d0f9c6e0693f7dd77caf3f7b791e06bed56d731aca9a0e052f3fa8f4caf108f4d35aa6d3a0c9066e7aee0077d6677285c5307071e010e72b4612479fb36a97083a2ee5eb5c53cad0dc77add0bd15085967fdb277bd69eb9c9fd557c4669fe1f89bcf4530eea8e53321ad27003ff8d777158d9dd06f938dd4d65a33047774b24fbdcad1a621161baeeeadb83c6a8401383afd99b1597013a5c9bf9950e844c9746ac431969eae2945fdf4693529cbef5074ae92a9e963a201d1a7a5573a198a617dfa9"],
["b1814a55e269729cf90676f7fad9617c4ea177712997349b072560ad193018926b4d3adfc58a669df6662efd3215c06a9197e63f36b3c64efde712c1bd590dfbab8ae0ce6a7102ba50f983b097a5eb0ad5f0a8bd36989f95db1922c3224b8c1b989bf04eda23be28ebdfbe3b10a7de6001c73211e34b313ef774c313bc4b7622ff718b3407716a7869faf6440975ef500512d890df3160fb8ca6218febb9791ede55051e188745537681266357cb2ace40eab594937c5c19239822d84ace660065fef79564508b216cccf30d8d394360315f50c2cb41548f70df993d7f49b888282f843aec1a0a7497031273bfa4f75c0e61313a5abeb21f4ee9f0ecde6793c54ed5ae719fba7f3febd0fc4954410f6d1bba370a6056b15d20fbd245a3725a4c4a272ae205cc07cd3e93550c0020ab2a0dfa19e7de025664c98d7192bda2166e3e065576fbf4224866b148c681c0b49f72dc999a730fcdafd2bc706f35042d9c374c2bd311221b66072f21c93373a1e347016eafa939779fadc8cbb131a53c565079705b12e5d9788f73b122bc8adb19384e7d377f7093e6ca8720be6ee76d93403f5bc6f80c710f67ef3596091917361eed4dd41dc69944047ccd106d82fdd7da0e8294430c5416d6506e9cec04a5534ea19862bbe6b15638c43bcf973770bc88406754830c4ea0865b1a0f9d248121", "b4cb0e6e9e5eba28c2fcc75ce12779bde567044fe52e981ba519382ec348ab2df088fa2bc2c560833c7a328a5f830f86abcabc4e23aed33dcd475a31ad73ba0189ce2ad2d201f6983c1c32aa74c9ba6fd3bb0e33d93adc760c8dfab721b494aeb1d95400706f60c5a516f95ba18e79048ae676e7e472e981b6315a22daa9a57e2fd380c9d945da6a8491c142610de3f23ebd33d30b4d2f36a6bee278f372203e0d402350bc0b8e152f3be356388b94096a8f50775daf7ff412451f4670afffa5765f3c4a65f6f2e969b07744eb41f95b5160181f61cd258f86ec31419fd9ef14a3d5a309224cffb484036b55f0820f6933ff9b8e1cc87d1fe2a01d505a6f25ae122882f7f2e339149a3cc0af7f3a053e3acdd08cbbe702a2c6e79e28d6f3d00900e58b0579f5e0f0b68cf5f2f73a27db0c5dc3286d0bb966bf7ca6d58e406e5e0c537f27f364423632ed4ff4a420e8193875b4eeb4ba1aca9e702b1a1a18e04eef726c689e684838f1f15c2ddbcfd8d83b69a524dd4099e019aff669e5a190f0deb6ef74a51809d7d5d594a63015d61c6964d3d800e8f025b63d3ad79d05665d1b64be77358a296b431f032694db9ead055a027a59c7edefca0a1444865dce2876415b66fba8180511befd78a3a3bdef", "97cb8ff5c57dba438af79cc261c3923ff0333936f46518070e464c029c94ca2970d0846161299dc0fbbe5426a9c8407c89fdf19a4bb630d5674a85638dc6df9a7b6be58fbf5ebdeb9820b9d02d10a25c9adf9a78a1907d874c3dd3dcf305cb9b84aa0183e1abfd99e02a4c5200ff504a85bf56d782156978dace5641df121b18a517aeed46d3bddc4f50cdfb7cef76b9300d081e9bac871bf00fe7863ab2f813f54d227e8a2812ed3daa05fb2c4b1dfd06de4ed1c334080b9b0bc4e50db371565f257a8f113bd352bfb46528aa957f4f5b6669ba4dba3fba31e1b31fb6eb47c27043b1b5dd042e9cd589865551ea323c0c85076a49825c82d88396558f205c8a125b62d1c02a030f9e7113a2936fe22d210c25753f844e3f12f74c87e6a2df5c98a960a01f85b26a3ebc80302be2fedf080ba33da5c29fe323e29f2ef5e022ef6dc1fc4bf1537074b090de39f1678d1a356b6ae23eb33fe476b628d62f06048497f2ec6230f312df41751760491b7445697605bd5a5b7edc87834abe0c86436c555c787b71933d1f61c53f849d0d16df4314eb5332fb8869dd5cc29c382d97ac4a73bb322a212ad4c89bee31097f195c", "ae53315bfb543b04c2bcc5fccafeede9c398f1db72ad82ef473db0e6c36707f24095a2f9bda13daa72d6397e157078e8a8319545c35e135f43b83c367540144f1c9b86af7245dda1a7812306fdbdc298639a281858e018f8ed5170ec7b5002b5b0f789469d39fbaa4e648647d40a35df065a711e39f96c1fd352b2f45235f8a8d05ab645c0cb542144d7b07967faa8e56f60c7b2b5ee2959cd4e5fe969e14a7bedfc271e6c1c6217ea850dc0d07cecdd0365c1cf2003c83ed2ba76f027800e05cb108ee88d0af9795dec3350cd70b42a6e3997caf377bf265802f7e862f85a06e65e9aa4ca54620235ba99dc69c54bdc66e05324329eac97b3a7e958611093eeb0e16fe9725ca5935dbde904edbf6132497d47726a232356c6ac78d81278c9c9001204a256af6535d9cc848495a53a0e71b7b29093d8037e9988809010cff6f611cce208e8b8dac2b8880c2cb47b72652a4e3412cc55025a902d255f39c90664b5ab2801267824c23c9d8c81ecd0db6e67cd4a9df3dc61456b1a4198f2d5a8a71a88f32da8f7c9cb8e950770184cf3b3", "815f7ea8427dad61c6aa5f43c7f10239518d1afe949d7232cc3f961470156e8572a6f86ad84fbf04b33015da478efc09b84a80d22cf34d6baeca33306de9b04e23928a6ed55017b0c7061621041f0522dd07fbb5efdd6d38beb00a97f68908feb89d940c1e131e6c60ad7fb90425c642d6e195e5eb1a646fecffec693a05de8cfe10320b9c944b2e208086cd52d0cf21108ded3cecc1ea753126f529c9236189ce314d5b047c2ae283e8f1bbc659043e73284813204ebf514af796247f1ccdc6ef86a6ff84cf3b372a64b5449aac032616a9746bd1cedf8fadcbf9a03bc70e8c7084891b8cb54a20e4a4cfdeaaafafb2060f16dab65c32fcecd055aea1f762fa05af86025eda409fb4692913af88b91f42607f55a17ac88a5fcc309c1b7503c339d11be38539524d16f91631099a926b14ae3d8c5082f5cdded6f865c3f464ba47046c11198356121b1c6ecf205fd5fe5b79f887c3aba87feb722278940c838d2b6bf3ebf7f904ec5c81262be3571fe5", "a374a4e8650c574a9d5e9e04142805af6744e2ac4d0eccdb3fc42e28851bda6e91a53fb480956d83fcc5101bb4d6c0498f8fae3f9ba7fd2ea4504ef4ba64090d61aacba63508e48cb6b0aac8d7e7fb11e34f2894a95ec7baa7431ec1c5e1fd8ca208b0debadcfd5a7242f53a5f3c63b076c48d7aaddf7ceef4965643ea5b63d6cd7458271884703c5e6e71dc9409771855cb336f52ca0480ce9824ce5dbcfe713f17a9ca3e79753b001da774d5d0378d42cfbf0ee77ec0b9b2abc540bd3cb2c7648bcf1383cf9c7603a411cbfedd9ba54891a21ca7516f25055f9687615d42ab1b4bb7e1c91c4262fca1ce252b91d7f80903bed1757a1e467cd3f212473fad82b3d662ed117835b55257c05b0e0da6ae720d8e0a005198be0b38fa86ba1a80937265ddaf41787bd60cac22d9b7bf6a78289c255285e7f840fdb0f51d62849275a2a858090cb8479eea500214ce71af45"],
["abba9d123ca746744a42fe6eabb1da66546c2a2f9dba45ec87d31502a8ba8b77ebe9daedb7699611ec4277fb96401cf488e76a6fac191de204414bb24a1df655e7ba0840abd1da5f4d95f9ae944a095d03d34161aed53a3fe7f78fa0ab81dcfe8187490a915a173fd77a8ba9e268bbef04f3d402bf765c96c20732af85d4eaeca2ed631c30f6ace8f4af6fcbdac40f5b2e604ad8ba94bcba60e7ce1069c535e7118e8785851a2f9646071ac7754ac3615c70de29666b5af107b5c927383e5b176059bd02d7e4317e0611e8c53950c4fd3623c2c2703d95b85988ecb6e31c78f74d31b2c66b19e79fafcb39bfeaa6567c593cbf8b4af607126bb2cac6dc6b9bb0da3a2daa3ed2835469f6fe282f93d3855fdb63b2d2028c2e2f37de99dd01eecbdd7cb18a169d4d24c5b4391b796abfd3580f568288a03184c4545bfe7fac51d1850d9aea84a297fc09a30fbf8d27e578009e561d420fc66be9ce2e3ba4b3df7ac8c430699bfa0d01b91876827cf3add173bf1d4554eac7c7360393afc0e736a88435b0cdeaa85b8a6f6964720414e9b470e7e16a2f326b684a6cc98a6c599fc59c5c7cd3fa16cc3597f219d83f49d78f1a82460a51699dbf56e4663756675f246f76530483ac3f36cdc6ad7b1ba503bc6ac75750fe9308cce5ae316a884151904c608e906e574dcb536409272a3bcf65", "836b3b509088fa1c0e3191869a41a75aa04e279cb2a59ec04123e6c911b3550d1e9434d26deb7142315b5edbb9d28199a952e8a97de461f363747ce733a8356b621cae3803c3f6a3573d5f1c68a397008940e536e7ad80524a41a992df213bd8868f98b90ed7d42fd5ac6fb3f43ad245bb9850fe8c4903349abfb2c8364da8a7979394f0578339795421197327c58f7b65a7ba719e25de414e609e7cbf5dce72a323a4c49c40e315a94330b8124ff46d194b0390c09acc1f9190b3953de7406d2b03df8d186105735cb3477416fcc1de26ce9c767622e2f60d7e7a98878114565254b2e1d2ae6350a9271bb91a248751651beabcd26ed341bb12694d3f026aa49cc4b8981422a5274c9d7fefff0f488e142ea80bd787633f1f6830b4734642d27a1c911c12437dc37a2edf1a52f88cc438849521ef4424c04b279fc8fdf235551ad477f69094a466e2b3ea07136c919859fd80bc0d1f375b670f7e9fb5a81871d72d92e0529c890d0ff28970371a697c1323939c8c5dad9807f88e6f67ba091f1a4a35687b110208c49ad0e054ac1a5d1d9d7bbc62c23621151ed0be8e63191f9758f9997f4952515c79bde6eb03005b68079dadbf62819cca22343ed6ef8f4ace8a6c7959a4f8bf7f601cf17c395641", "97ae073696e39c322a24ecee28b668d062597b28b48ba38f872ff4a7b2b854c620f5d7a86952a8bdac4c2e88bedd406183accbd83c6e7d8ad489224511968dd64f700e0d5121c8a2d06f3410daa655636482c424998d7ea148befd56d3babfb2a757d0ed726d52ce96dcbd938a50d3d45c053626d98c34370608ebd502aac2c225aec7920b69ba618920e400d3b91dbc08fc089d93442b5629c25d83d464d0d93da0cfdc72be7951e6f49b9eca2e10c265576c78b6d2acadf5975563af55104e39ee921365955beaf78f95a38b6bfcc62ab30235cf7458e29dc4c15387ab2050018a7a7199c4c947ba9cc5fcf3336efb612d93f436b0b8c3ca5ea769f00cbb2e2cb2c707fc1f830d056fe3b43073edec2c0b2fd250fb41a536b17989f6112b3af75267ed0899e5f19dfdf892a53b3c841225aadcad0ae569c851442d4df3589d86b848ada8313340bbf7722e2546854c5a642befd81f79af35b53ca554ec077ae788011ae6001cabadb4ee139b9fbea039a863eddbc8fff665897d0ea6c62d46fc3f9f0461fd54c3c66a22941fc323c63f12ec2228479b73710a4c48829ee78283e98a7b60c74fe1742a610a41bce2f3", "af0f12ef95de9a4afdc42aaec89ea65ac87401df7447de1e3695504c838088463bcc08755669376128569d7af98acd4cb8d0001707b1874abd232580d8c56a14ef57579dbe93805009e4ae52fa1a6dca9804c01d1b58c91c475eec65434bf33385e0546a3b03b07295991f72cd345b52adfc5c09f5e38a2434a9143e8deb2e757d7bb83187b42568e833cd46b03ac022217aba67f21200302c7aa4083399b7b9fed7acf17e6e8fbc068202bdb18038895e12222201d477cff40d6e9d5bf1f2d737f1670308e67ade8134a190a8bfdd5d39bf4479a01982cff3c923af3c4928aa80b7aec01a352a88257c99a2c8b53b8562d977fd26e4f7e576a82d503b7c7ab3b43eb724ab7a0f86aaf115caf95b430404997e4286d38d17c28abe59f241527a4b2033559cc4f525e8ea540853e39e72116a133e083e932d273c5cf7a579e29cc896437215533eae0900364aa2a3ef8e6464ff54ef29a4ce230f11f168dbb4453ab296d818b89c7e8ed89db1e3c0ac4d6747a4ddcc9cc1a599047bf6c64d36e3baa964bee3257504788532a39040c7bb", "8d27ab020192d4cbe142d611085a5aaa8b51f9d809c257f45cd9c9f98f0650605f4dab0c2fbbd37dabae0bb0f79dc97591d356e3719675e9b77aa1f5e807e7321155d0c99f8eab606908149d9edd892b47b892f0b29f674d086712170560de1682149795b6c6cb7baee54c4d6494f0f84f5667a35208c4781f59e629cf5c5871a01fe7d7524d01b3a6c326a2c7774923307ca1708abb68f52a78388e23db0ddad57acad3c666d2329d97c02ab4e5ad7f5251d7b2af6f23cc2d28362f44ef34ac338e5896d59d5b340f9116c1fa89367937d9f76278a38d8cb75962e052a543673cb02e1ed8089831e4d8d7ece46b7d4661f557ce3a1f359f4e9d282efbc01197bd211f65d888489cb456ecbb6a89287314e7f7236ab74607838f05ff407ac8420f2fa72777fbc614dd5c775ac9028316157756abfcd5afc2395282248cb1b6ecedd75255cc0dec6221eeb05500ed495e2a7ba07ca464af131527209f26522b3bd1af79bd5ce80a447094afe81b1baa82", "84834f142ea24def59db08bc2b851cbda37950bd49457998851070e4982b36fe44eea2daf64fdb5366d54fc9a4809b3ead81cda4a6cb0488459864e30d7f30e5c39aa8e7f3d450badf066d526b1a3ac44e22c9dab500edd501a435a03d05f1fd93ad34af5e10aff2b7918e5c835f5ee857486778e47bf52eef8f52f33def4119d14f519d52abf021fc327d61b0cc0d92195543dbb29447545595d7c32907b7fde9cbb26e0242bd547cf00396ef2ec50b0bef6bd1223917f595f3069b3b4d446f259b1734fcb9864ee166cde67140ed9b24f5fb93763da209604aae10aeb6a1ef0d4fce533b88da34b066c657da3185152ea254ac6e218e7017212c145d29c0b492c481474a12cd1064edb86367fb400460e43c43b812d6209ab018e75b8f9cb60843b2fcaf086613585b6afa3d3dfbb26f378fd61c35c6ef6338de0eb6f9b70e51509d3b8283cb554942a276e28b24f0"],
["8c9593f4f2086661e81026b2a603c1e7e1d8074324d90081ed5cdeeca83cdef03b451816847c15a9a224089cff45ed0eb4a86617376d5fd461b4ac549fd88029b58d99e6c55bbedffe479fc5428aa7fce747a0601fab84edd2858622ed7083dbb2b982d8880f19e072c3cf646c0f0b0bf98f12c20eaf12ff65c8fdd94b09a82edff19775771c135589f0e3524bf42c8d3082cf1ea80525c60ef34948a8779c33942a77333d18cd9dda8dbedcc2f44d863f43de8ab83833725fc52734bb5e8a5b89828109f75cc6be271c7d4fd30c84784563b3b5ccf8e012e33fbbcfb9778c56797df8996327a47cc4a77cc1efe03adf5a928411a814d6e97d2065031614caa67af4a9a4085d61b75c57f879ac8ca5e24b396f6df0cf572722d2da4dc6da41f827487f56bcdcd9b5fbd7c75f90b3629d5b9017ac8ca4589b30933125af7133b0fec8506c542f4005eb0185f0527057ff058a92c074ef2c97b0f2d1a9024bc5602ee714303f776b5c09edd2c09d3f44763a620eb36a59d44aa45b768c28c8c96794ed7162c1655c8e9e694357666aa4714f079a274b6a2b90976adbcd13500286328a70872ee3bb3297ad22a9edbb1bf411500270d660df097ecfc9f887eb99ca175dea291d7d8aea1bef2e0ac5bd59a8302c0c9635038452f5f575a45357cab7225ec6385b3acaa9eeeb5fbef0c6a627", "a5f49798680662c9178ec94e054d2d87ee98c01e4853457b42572d1fa640222f21d6c1ce9f38d200d817821e86853310af02d59cacb2348fcafa81279692c58a49d9c21084bbe4a49051d9a40139e9a527cb3810af5d715c8eff72de3f5e86bfa4addf8fabe0e8a17b84f9f597241f77c4a68bab286db396d989fda80a37fe3e490919b13f79944256d879c95a2e09094091ac2536e0c4ac01156a11d1b8eb52caf6888ad79610f500c564fcc2846d293a0fe51eb2f777ea4f98098f2d1bc5c931fa43c821e704d8eb6a0875fe22ad465861c4d9b8cae2488c0c9b93a30f7fe9df3205763fca230c23f34928aa4e9fea47e3d46c77ba6e2d77a1bc3e0ea6c5545092371db533c5a7b67611bde311b1d34068bd2e6e92d7a22c141a75addd7c6dae7921efa1f428bf64ab3aa129dccce852783ab917ba54b691ac63c38406c334a52b385f70e94a5b828091a8929c8d7e3b8d4632a1185edff700c18ea00839ccc5b5bd9635503dfa899b95524a9c459d0cf2780695140157c0f9ff7a7c0a179322079899c6af379250fb14ab1287530c62dc29ef47178ff62c0ff8fffe60e1448cfb11512e8ea7bf21d37abadfd66fc63ececc5c6e6deb320338dafe4357d8039eb29559c76feb5aafa5b84202aebc5d", "b5c8846ffe0f10c0fdf6821ca44535f44762be239d6e518cf87363a77d443454322416e5e698debcdad261db79f9851d83931e03c1837dab4566b05ac4b2ea89902680e3df4e27d2bfe93873652bc3e64a48125aa2f15b32c72f77cee6e3c29e816be05d71306a01b6e6c28e7238001a66f25ce13287c3f4335ad7ad350890eb3ba12db926c371d40f2af3fba43ff145252154ced84a9451d53dd19a24d574ccf5b19accd4fed2ea44bc78473ccf03866e3f64ce502d6a740765f6ed1409dda5670556c263af62e06de90880332678447090bbd9cea62ef67a360aba16bd765a51903c33a62fc4ca4608ca179df111aa31827a8d23b87597a0c6526b0bc9d35a2a124b09eac5259241a87af36f4c3b736babbe425b45763ada751caa808585b48abf8837155a0aec79a879c11cc068001dbd9c2c2cafea306943bdbedf6a5d2b1b8bc284e2b2aaf9ae41318b0f32458530fa9150ae6dc4e11ebbee7421ac33dbb75e3d09d31057d6c1de4fc12cd627a8595a074679647b0850a7c5d3269bfd59a2280238e4cc56eda170d005bc219dc7387f163856251683604195a58981b3172b3c91f18765a313123cc75d136006a5", "89d09ecccd6230a38009f5f56a2d77a7fbc551d8dd7e3363fbe26dabce25bbd989e60f6a51477668417c3386512a1d69a8fc1557a27e49079cdaa8e86e300ecb4c248ce416ce4890d7beb355ad2ae784579cc8d847629af662d620e54867325f8f5efea41badcdbeda08ed100a99b38cf7933fe8c01f4c1dedb5372e8668297f27bf023ecc8da4456434343425792fd654d8d78ff92cf0ec8a8ed090a068a0d3492302e7fc7b4774449d36b0c4633eb0184ea385e4d5ef0d7ae52f9020d041b34a91774297b505d07160d490da0ec9ac0c4e0a22ceeed324ec8d6967b2af426ba80dc9ce04a7135e7e04ef5d155bbf424d516c6c7b5156bbb8abf8afe605695c0a76917b94966b69f6827144e3ddb13a1c69f1b053a3f415b2f63f7239dc59f01441c885076877fbd5f6f70ea50fbd5315158f145e1cb8a00ca9f159b0ea7ef58e1b2a7742dac156b991b28dc42bc2333b1525927a066bc2109e8743525a1ebfbfbe8c8b3dc935619bc1d62edd71299f6f1f64b74312898b38f5b5928f2ae62b642b50fc60dfed410278ad417fd3791c", "abb961f4980a1aec55c70dd449b40ffb073d0b326260f451ea7a66b5a7a3a50ad7cc3f5be22502fdaf80a09b9b12804cb1662bac4cfded61781c7ddb5138f3e5250d2fbe38ef2f5d0f59da5cd9c5880f8c2aaf9f4645329f6ad3680c55abe7baa6a835c4882a9b5be762689a8ceb222d023715d1e41eed11dfa4880e65b3dc8c13f0b0e9602439839d4a4a28927560814c8f0b9e1503ddd2d351e2502eda0c92f7b9807c56cde6fed4bf464f9073e9994e793aaa45637e9a565912bcef2553b2e2d316d7b2c4aa3e1de20e14fb260f3e4bdbb142a0a78a8a645ea28e3e23c50066f576786ab16003a6f4498e8611bc345192a3ab6da072d45efed3254fce0e0616c481bf5a82f8d51a73a837d21b31db5c9616d34ec91ed657cabde9440617098b930cd657eaa05baaa674971602ab8068c52de1693e49993f7796755222235a3902cbea6961f5165c5daa1cf60f8768174eaaa2606e10a3e8c9e3194d6ead9d58d43d79aa6954dc633cd1999f554b6d", "8c646cae808bfefe2742a21a8de76a5558609ed8ca08e48232135fa0579d12c345cc522a3012d3ae527b5741dcdc08d387d0b94e4b0a6090ae027540ec7f27be6d756f9a2ae269222aa02ea72f10a798c0b53bcb54da6dc2f5b4a2bed8bd3838b556b31a7e8ac6d67d874d42c8e76b955e45bfabfd78e185738c3da2f29ab061fde627a12838e4c2ef070a8c17026055614c026a159286b46caab48c133e15e995ca3cbd8915a865981b4cca974c4f4a4473d94cb1a8e208113ae2a1c4391a97bd1829037e5baa3563bf1cbf30d452c90cbda0a01cb3824c0c57827a75d11f89d3aeeb572b372218a8da4d664466094555fdf3ab672723a95f9b05d22d29e3edc13e302b5dd9d6c5fb29fe36b56478fe598637734eb23763d78340e3b4a5dc84e146f9b24646f410e4bafcf94f0b8f380855b71e7f3d255c371d5421e06bf6edd3acdcff6fba035d1d6d11e876ca12c0"],
["88846a8f26ad0e762f4509995a56837dc01ab23c4f7c12b95e91e51cb6ae02430614790f6d40c9d250ca26a674767dfea5655f7becbe2aa2514d0be366aa252015eb5044ecda127599a3e0639e9c95f9b250d193ca42265223ceb29402f5b5f7aa74df272a4ad065bb6cc8206de199ceeb184690818ad4fee180c1a6bf48ccae9a5b0e65e2b49c0ba47cdc382e3d4598238efa7ed836dd981325c3e30a280040434c2fd021f35aaff6be141ab325e8d75ab6e824e2b946c584bc33523345b817c4aad47df0bc6646a8abe161bc014dde6a7602be0468cd9e89d49679653136019ed7afa56ef0b29862ccf092d6e8afe269a3a13bef9389b3dc81520b3cba141ec7a43e4bb1e2960cb9a9b8b629c3a5f34fed18cc06ae65dbe3c39234776eb492227a2179806211b9970e66d5fec51bf046803619574b9c6621f66b34949761bcc616fe76d8e3ead7002a8384ae8f6656510b7f2d3257729e8c6c3bfd3683c2b2597209d9af714bc64d96f10a7630ebc72ef0f0911bc8d66ee039e6d1b8e5b875851b250f0c985c0c217b8e1edb4a5576175bdf77fb62d9a4f871421db0ef6999425611f1f79f552daa5d8d7384e93d7852dd44bc32aa4240baf6de814a32e25f6571e4b5e0ac7670a4c267fce53fb3163d44135ae843fa2f29f66b095ebd71fdb4fa3f6892260fbfee1cd9b33d3c7ee0", "82dab20381c6b36f7ea14dea274f541cf347fe09a3099f37225f566174f5e25c32dd942a72f23ea0dc4d3b4c54570198a4aa8cee6d11a75825a715e8715e07825d705e826810f284298d149380e163333ec46d01977b924784bfd510a65b789493062fac77de65a14ee58e83faa43ef98894673a74d8cf16d970047aa8773766678db5ff49ca138f60e0cc602891bb1b69c207163f90f920e27c0f8e8b87fef283237e4b8c36bf775a920f003f68c19c16bcada321310a6442be3210962f2bde0f7ae1cd8cbddea09783e9834d225724365ff9ab7436eedb5bb65f4504af6b8e72748fff5aef2f1778fe79b31312f3023520abaad89c4e63d9803df8d51175af36614990ea1f602252ff9b712289d28041e349d4b35e0f460d4f1d14659abd4d15255d586bb5f19d0f3be2e2a2276a21112896fc02d570047579b06eb55896dfc5457595d7087f2cf5e0ac10fdb000c85cd939aa189f222a6909868debf9405271a3a0648760970cef0cd662b925b07f597b9102a88310226e629bc210ef396ff4dbee6b408cca2d88f1b98e25ce02b6009692693b23abc3eb1cd46850bc79c5080f4291cf0093442cb14cba94b3b26b1c36512c75ba76af9a3837a0ca5b0ff461c1835a8973227608ca47be0f0cb50c", "a683733eb49ad174293e891699fd79d5e9959c9412bca6e229c67c7c8983f6a8929aae073463b9152f2a5ac12d5821d4a0452c5424a99320109815249ab92c37b5db47e9cd13e4caa5d44e8aa44aac2a569caef163c1286ccc6b27ed2fac0076afc82824f271d1fe48043fb17b5dfbbad6f498be5cdca7646272a115203840ea503132478c11e674eaef7e5bd249ef9917638b43f16312d5faa78ea7d26cb724459d8d26255ec2b3c2bdd222e5194efc49f78930915f7102d207e07a605d105a9c4391d8e137cb362a94c6010f13ba9c4e9fabd5548a34fda62b6cca44c9059ed0ecfdcd439fb4eb49d0839a13bc4d380286b6dda1d6e3933339088af88e89f5e95b742ffd92c35c6157056c4e8e1dce0d938eac49434f87cb79ad5e7552d5a694c35da6964654a53f4aa33e9506084f1b373b1a198e195ef7be774a09d08f1ca1c37b7daa9f3c38bddcfc2b3b5c843211ffe23723b5fc7fbddaf46d7c5325c9d19499746ece162da125d9cd1c6fe2d245d711ef97356937b82119a1f374ffde0447d626330cfe547053a67a01d7b9db13c5676ce2823752bdb51c58450d270a50ca521f21ecb579bf30eac840f2ab01", "93b60c6e82a9f3ae883f10197caa3f675b98940a59d4b2e9a579e2047015197f067974581f97f5fda8b1534ec506604cad9f9aba7abc02953e129cbb0c20488de26b09836fb0284c78e7f6a4aae2b6e6e6c43552ecc7e7adcdabd77b885da9a2ae82d623da92894e0ef95dd986460f6650bda864aa3c2daa92927e94c884c229d2c748b911c4847620db7f3efacc5270177b63befc9eea8d2f6ad1ad39e731f2172e95e3938a550c542c84c8cdf18a5647365b8000fefa374d2a72bf97740dff606804341bba1c9453f7b6ffa464964d18ca580bf27c3c2d6169e885dbe7e4735061d7325906d3a48ac5bcf0c4bbbaf272306ed305598774f57c5e1080f0abfcdc808f4e682971fc6bc4fc8298b4123025536096443198ccb70ce7f86479f03d0125c2c97cc767dae18c86f4376380b34d5e0fc9303f395087d21628c0dac39bac1870e0747a0a0b9b6415010bd2166d5dcdc0565326ac11c9c7de63460ab75dee8b0ab2f17c876d28ea5361d4cc630d168ba38eacdff8e6864ccaa4da7bce2601348f893482a59e69d0b10eb2a90900", "b80c8d7a34256c64623e8de10bf15c7f07180340de4a53014931eacb962a38f53780f0cdda63bba68103e118501cc9b0abdfa564e1e92a4c1e164776b77a1f3407f9521a7df8e437ad0b231660e4347557d094de32495271a961056160f9aa26a7a7d8c1fe05883b4a08ecd31b0fe8c319e94ccccd8eda92b40c2b83ebbe8fa1960ebf654cab8f9c859a32d481e5ab1e034bd521247f1a5b1939285320cd49f8a185a2f322b401f636f06d03dbf778d20c2ed2d11f5930707cd88d93e6b39d62ba21ea972c02702be1d0053561998de462d3bde0e4c9c10e0ac840902069c66f657c4e4f923bb672b91496869a24e02e657f64d5f771bd67b2fe1ae09f069999f8555c4d4cef8088bb7c50b62f7a34c243f7e5d2ecc0c14f85db38327f24f650e57efde70df2bded42745ad430f90d71118368c583cfe7113936228e3feeff31c3de4fedefcb1641e52bd149fdecf54123e5dc549d1eb3e816061779abfeb7625a1b43cf7e2a7cdd09a090b0dae5ecb1", "b6be14593e14588a64e755b00632668954e31774bb9c65947a017f8213f6e88e79420ba5e92604e8e6b0ed39622829f3a3d7899cef64162b299b041a66ba997f737ac6c70c369aa72df5e3ed47933993be03a29f709096a56e1353b9ff6f2089838d508d88b444f0d90933e4f37819c3cdfea270991f67bb0dc9d8ed3803a6b7b3104f59b125476c01e9abcaad1c307c63cc6b981c5331aa33d51f653dbc2cf9d4a0461ca89a91d229b495baafe94e813d464712682598393a9b241028e623c3414f6a50896d131e83c27b600485840350b701bb15ada9430f634ff7d22d9d81695eda9515689914f55b950e384f36841f85866b4606370f57fa45dd3427b14ff02605ab3dd696865320f2b016305b2700557c8907d3e5032a490621e66d001c97f7206ce2ae87f9baf6daf7e49de49c0e38c3c76d47d25c8105776b919a0323d7491afe9ef8451e277d92ce5e03aa25"],
["a1ae93bfb9714b253778bbc285aeeb56ba1c1c2db511d50ec74fe748d8010a985c332c6aa63f999a1a7ffd4f93efbef08f915733285f4758dc2045d1bf94d00ce1a71c0e5c61e8d63c63e1e0762e318856d57b79d1bdf8e0a46ba89a0975540e96858fddce9605857dda58b84bdb480eb24cfad4e4dc55a72d8d163dcf36a638460829226cd60e1a22e2569e4f94e2e753c04fea77417910e82cb7301748805a4c071624844d51c74294221d77e7b3a73944c59e6ded150e579d1dedf65d0995a4c84271550a1c14b95907cb5368407765d80969ddf5588435e3fe172b859d9328f8e09a2a3e91ec71e2acc04252ae9671faad3a9937a633569680e84b371017a2c6f1584294ca02b384e0944ab036a626692838e7e9a835103b52ee9eb991ef970527f56a03f907d839ed15aeccd7d0549520ec88514e18192a9322e8cf29b08fb2e3106940a66d010edb3b14a11b5062a164512297cff14bb95cdd69066604fda611367b935f2e54b719221f916a9860f95801901dce9f92ccb9a61b86baf1f7099d09ca1e430c013f6e305f76dffd43c41134e90b9c8fd4e8955bd17c9a368edf42e222068e3dc7d4622faa3610873edf5c97cc67f4261c51efc2cc8c12bc9e25a21c42fd7397595824b50fd863476b8d40a72f21bc5ec4c86d10d59b0463215c89dc822ae3bc8257b958196dcfd6", "ad34574c08b15d07d6d1e444d4a070df9a2c9219c56df9b129843df6010b07492c550ec996f2ca0c0e1198a1f610c6af98a13de4fe6e0b51e6f699a9cbcf3dfb3f5a22ac090a351e59b7ed144a8cfee7605309916d9053747a39cea99f1bb2eb887472216b5203997673db904aa40a8fd77e9499b1d1bc5f98a664080479a8f1311d3ffe3d43c3ea266ffed114c4df886d43b16f41726a0bb7a1c2dfb9c8cf95aa8c1c7e1f51e4f87a84ee5d6dd3745c1d4654290e0793d801a624471dcfe6e528ae48468b12b25bf55a6bcc9858b83339fa9bc4272b2a86c4afdaade52b5f4fa2207ce205d5a994c8f62cdb94ef77de658214ad297d3e904168887ac7bee9790ce0e7da1862f7489e11ed67cddd979e0f40e324998c5cdec98323563a6910f7ba86a52ad0a57737a41bf9015a14dc5a326fac58d3afe0b5807ec8703bcc0083fdd0f369ed3efdd0e77f4e286435ddb6108ec60dbbf7a9ee09fc92b30d065f3c88e6f4c0b44c2fd37832cf63d9d46bfc5f66f11551f904a177b30ee51af07da9f6afdd438d168cc28a0d32a343f3221215bb339a918367201d633d0938a088953c893c662eec720b61a11d1925347ee1734652c9d684e20016aee0cfe918b4fc8f2826b8881122d2fed91d0d184b3990", "aea27ac292ac1334794fcbeb6c46359fe1c17389669f6c6c2ee3e9b208f2d91825f02171e6f27df384fc16152734faf0919166718e6cda2ee3ca7b9ba4a37806a2a1a33ec77d7a2ce488df055e3df75872631a48e637911ca9af8271e401afe483c6467756ee2ae7489ed14a07365a28fea3fb82b60768c2caf3f5432263e2a2fc06d471d434ac9bca8df3534b9de1d210e7febfeee66a17744215d4be5033fd3be956528c18bad2e196cbdad2d8a4356c6f0ab4d4f4129c154f4dea72a3da3d4050ee682e7c2689f090a4887cb4288d2cade9bc3f9696d9f07af859ea6f57e3e0332ead831b5aef20bd7da2eeff410003b5b40446ad07cfb06314bb8f951125634ec340fdd2da85b24d688724f120fb0d3ab0cd78c37f3d5662a6cc435e03e40359dfb37ae8300ff2830df2bafeb81d291dc788d2266025226dafaed7169947068a7da276e36be1e9a92773119d5e3707ab805fa1675ddaa529c89f3bc82b34ca1fc7e5f4cec88d8f2630c3c331075307d6b6e787f3b48634304f307245d4bf0b35ee01de8ad59f66d865e7f6dfab1c138e8b94dac0f177cd487010d35b1c068d08db67e66da71e6fed442a98d545cc", "8dfafc842edec805b9acef9d2c1daecaf68acb677851e467dd1401acae2a873a700da43fc810409f83b9048782c278dfb4a998efac24b19c0e2dbd185b044b5716048edc3b2b049ec5a1225b10cb5d62cf1c2b57d82352b2b119ab41b9ecc406b8a2b40f016cd66f3fe0f5aaf9e0be5ab290e028a2f176d1e031f4d9d04ea2fd118947b8ede55b9d0f2770bb29dcbf165877d6ab4219a55f13c92a281fe5fe307473ae15af2078a566fb62e5709a5c4b05b1a15b9f8290148b11e4ef87b5ee0e677cecad33313f4633bd4f6422109e703bb308e93c4bb04f0d7f84040785f443313af9e15ce4e6b3b9bdc72019de7b4709e644949ad03ba1659fe92d84a2bc3d512df3f764635a37f6ba2ba7e3f74a2e346318ad27284ec5aad3ab9f0c58f01c6b6837ffb843ad915e4a3a77908cb66d360f6d1051c4b273de1953322b91b6c75da17494d7a3d416077680ab60ac51e1377d4c4b459d5eb3392a9cfbf14235961b13ec9e486cd39f8b5f30b025bfea001a4ea2ebe41cd0f3b5c4f4b9e46523e08065e7de0d4ac2bcc33a8a828115339e", "81ad7d3fefdc68a2acee7d6ae2117c12fd544ff690b2dfe580e54ae811b63c23bbd26e59c0bcbe9a204ca3656ea9ce42a323d6ca13b29d411361dcbd2088e88325df80a7483527e33f0ebfc7129098e7e4933b520801dc4e970123312dab59f2804790f29587dcfe00f669cfe0ee3a7da661837e2b1b0803b5e4a54754f451a73aa7b513baae90a0e80edfa85129d10f645390b65ab04ae528886bcc959f25b235b2dfe221e63c955c974592cbafc2af28f04d361f969cb0e14bd154aa325b87b7deeb6b717bb534e59c79992c4acc7e35e5a4f534ae9a257726dae1ca40234b67709fe7e43d642f5d182b73405bfea0155506995e514b6b802337d63cd0e45156685c088dd933c1648e7d73c0dcf60c55eea8a7ea362dee229a5b86f76364cbc27906f3ceb57ab47886fbe18782b68f550f64dbc711b558229e2d48dc0b0bfd127d0075b7897516b57c19a6f8a937931b336b54ac30588f1297844d015a86bc27b1bae1b680b185b8137218cfdbf4d7", "a1eab2bbd135e6533f85ef1a09172a9e3329849b3f11d85d1f991945c85bc0b23de3fb7ad39f75ffdee2c38e27db1b4e949a5571cc9dcdc76c1c709cdfb3f00df1271d6a341a7d91cfa073869bfdcfcf15de8c6591aa0c9b1b08e8ae7e6581b580893104694c5fd7e076dee9b74ba24d3f06eb3d9977d2a1bc2f1552d7e74105718efb7263f097b08a74e5d4f3fed45e15c162c137c37513f6915e4d4ae37f378669b2c30e28fa0d71d252856ae61a330a1d53e184af26294cd186323afb60036e9d8ec50b9975a534ac034ba572d17447a9500bf6c70d528cbcca6fdbbe1b3ef90716b6558d73e35bef2c76151bc12821237b7301849433af001f2afbcaa96d9f199df0874c567863658b5e9822064f5e7f36a5cfba58839da6350b193c89a1b749a0f916c271847eca5ff2671c07746f2d54ed620a0c8e40f84f9de4978c1d2dd2716eb738fc024bb99d98bf91e5fa"],
["a1a4a6d786abc21c60c5001294873fa2590d9d67bcc2709b0d22d0f91421f86fa4f20b51625e67e088915f1477bb71c38a082054fa05bb0bc397c68201d12337dbb211eefc9bb529a7b431c71b3a194c0e8b395c2d56973ca95fba1de99bc679901e02d92701b838d9a351361f75bfc77dcb633805a7c3282ecb6f1da7c2f16b1377f8c082a6a27257ac905f291f1dac2fb9fef919e0d2c929f0d62b59460ca6f02625fa5316269cf37be62f5ae9578817b433112edf52f851143dbfc6b6b5bbf5afe4cb58577a8a8972498d02e02e264f229dfc9f9c7c06025191f2676cc0d6f5fefb8c7e96f742a611bdc8fc6c55e61a97bc4569869047eede7182a3f891c9d5411c0ffab789ef37fae7fa5efe7b622b68a2f504defb8a3cf963f390c8e16dd0f85f96f425d7aed3292582fc58d54b1b629ca7af9b4d7da29dc2fd000de4594f6c1fa17b17d69aa7ef025993ce62dc07eddbc329777c0cd459882beaf68959c349e20c4f097eeb9e994e58e718e67e11cd2e25ee37609904b9bc7ea5269c4db7f4040f69bfae4a612cfa97e0e37a256dbb0852f81d3fb336ed955c2f2cfb1552f1dbbe530ff8bae490ef05b5c76b36363c6793ebd145243710569e12a3e2329b3e7b009b2f34b8698561201788168c26d4ee8001bd5016a480bb8c9f34911d9511e185b8979354a512a1ec9f65c859", "a9a0c6ff00ac1eadea0b2e56716d89f3bc1407d06076f8f21849c072610cea3a05477a16485119015980cc73a73f8400a97552ef54d0cc383118519c0c4e7bb39acaf791467d07f264e10a94f5df6c3ac4b2dd361c3ae675f06b2356e625535fb9c8ef5222ebfc85e2de56e3c83f8365bf00684b22328b0a10fc1c81af11c62ccfa2368286afde4d6e0bfadf09cefcad0778c581f3c9836d51cd3c24d6dfed9f7b601cd0d966147709f06362b0b97afe52494a3625d59ffdf0d43e203e1e2c2f7592da4c100fcd7768024d7e70facb0b00f021777eee88cf075cc705c992b399a690966f9d32ff4a2d7742373ef194a3369355f38a8abd42a9bfd0f7ecaead6387a665b5cc9c0f1255f2d0a038782731604f3e3e1bebb6f4786fc999e61b2e96523ac33376ffd0aadc6dc2861e7e31275b5971c92eda9db5153a4278ac35ce91444466b58073caf2e472fefa1c8c37516164c2872c494d7c9c9a045881f282c792875511aab523fc12c525ff63a4077a65f79477d64ec0475717f6ce4d7225eb0ae72c638fdd7d16b2793f9648417c5f00f84ba059dc7443086104d9f1290008d1cddfbb2bdef4183b971903993042ac525e494dda529bde81d09b3851bafa5c809eabc275f2e2be6da60f53eec9be53", "b99c0006ae25786daaf781645387473b8811057a14f3258db39e92cfb1c8f2fe3595450ba2aa4cfb460967cf72f7ac18b028f1efa61fee670312e8611aba2f6a030c7884080fa63d83c41db90614266cb862868aabad038bd29ee337d661d99db051ed350052643ed9e52a73cf73ca07174a5d0bc123af007d40e5e8f11ce590b2f4de9c23dab574d79801dbc6584e8c472c789bda9ee3299baed19805f73a4ca37b063c72a845ef7fc8c1d523734e78113fc5448424a81196d94ff43b76e98d4634195bbf1f0cf3f257013a048a4f46500fb279971396dac5fce0ff86f665fe825a9efcba17dd43624be863829a4f8e1f20a5baf06dc45a5786a00ea9ad65ecdb2e42bc4a772f7a9eee3b2d9edb274b6a65b43e45a75900a0f997fc655bac8b6b3a51aa1f79d528056715d472fc2cb7197339b65543ac9b33fddf4c740916fb71358a3e0bab7ab60a35f67ab3efeef64cd96d920cff4691f92114ae90ab8ba0e007056b0327d569d94a9083a9014ab70912fd26bac0644398de6b99d190beeb951235976dc85a3b675e59524c95c48c11436567b0df8906ae38c13f4ab6e8c3c4fc19a5f2cb7bc5c2fdf81dd1637605", "a0a2ac8023eb6dc043672874884b8a76df29836fbd9f5c6079742ba0a7cffeecfb65afb767fd41f378b49b395987510fa8eefafb605d6875770edaf076b4e4fda78d96ca1fff6a18757413ef5ff5161ab50f1a1ab7bd2c951f1ab5251e32a92fadd740b64b97d7fa45cddd503e84167cb4371f2c6082d038be9076f17dcea82c181a6e724b216c77e9fdcc625b526e9921a6d5e44f3baffebf43e0979e89f470f45164cba36683e68b8798c2a1f74b942e3cce38f61b5e7eba205fd4491a081849b4f7c8a7e6f3b328a193fe55a655de6391a5841856ac29a220e491472a1744c7bb28e97304842e68d97b6f7c780e1b18fdf5fbe788cc309f6a8a7aa691257c2b51e150400a3244bd35c37b18a7dcf3724e0068c0283cff10a0d3a384c861b8d1902fe511f488ec6ce07463817cb0e46dfc460e3a68a33e2ffa8a51ca0d989fa550299ea145df1ea374c1309ac6aae00bc150bad4abb4381fa2e19874c4c9317d2a9ec8700182e2edc693e20a125e0f722657adee083e95194e43e7d804b8d4b07a226e255a367c9823a45ac0c52d95", "94fc4f348cfc0ea3359c064b70c6d7ce94c9f947801bac8403fed072a6f90489cac2bc81a61c9819a0f9d19dd7bff43e892d2abeb8796fd702c908b974d276d1d9f2a8191dbd428f8b6a740de583f1809373d465616549b5adf25115e66bdb89a4c3407d1af410bc9646837e6eed68d0a9ead3cb85e921c2212b8cbd24e135150a4e93497ea917b07b6701bf1b179df101862e59145075b53955a600aef80aaa651e39d25c7311251b5205b5d75f3a6f123e6795b51cd95a2bc2a62c8e04c6c1297df1e40d96901e1df861e8543a255b2f2600877e6f4946e072e2e418fe8622f2e8010c97abc143605b672399e5796909d19a31a65d49180fbbb3bba73729746f8a3cee08fb6d6c53df013339a0eb2217190b9f25ebf2e3daa1ccf7135f300caf95f9100f81eb2034a181d80042685e4f5be092e02d5d9a173325d76bff6ebdabfa567e7eee09853a50d9dcdab2d04c36960fd82147d28b30ecc8b66db2b3076e5a3c4a209afb498a3437cf3ad4e92e", "91a2da5a0e15a379a01654adeb2ef26d6031dde6303eb1980727a8ed00a68ef5f5e05b63002041fa4d071e1fa4b3a22f81af7267558e58727e055944ceb31f63656859c32a29e3f8f0f7fb04aebbbe7bdd2a478982823660930cffbfef33ace8a17ed9a1c8b90593e452c1d9f26966bf553cb396d480863997927d7c74dee250a7064c5df32478a9779848ab474d5de20c7a06200e003f7f08ae292fa35727d0436511700c969dbd381be79da7db71911c08655048352d28cf7e9f471f8e4bf57a98420aacf8ac99131844ae5245e8f56946eb2ec484ebc714ab33e19f93ef9d93ee266e3b8a094e8a2454aa948a7f641a7c3cf9690f31134fee68be36546cbe49e724ae9034bd71fc5020aae7118ac237406f9a594c04949cf6566e809cec450c804008d27cd875e3d25254d0a83ef05b4ce0e511ba2fefe06e8bd799f39ba99b4466669751cc1fd5af012f3f4506e2"],

            ];

    for i in 0..TEST_KEY_INFOS.len() {
        let pk = PublicKey::from(
            &SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed"),
        );
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        )
        .expect("generators creation failed");
        let signature = Signature::from_octets(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(
            signature
                .verify(&pk, Some(&HEADER), &gens, &test_atts)
                .unwrap(),
            true
        );
        // start with all hidden messages
        let mut proof_msgs: Vec<ProofMessage> = test_atts
            .iter()
            .map(|a| {
                ProofMessage::Hidden(HiddenMessage::ProofSpecificBlinding(*a))
            })
            .collect();

        let mut proof_values: Vec<String> = Vec::new();

        // Reveal 1 message at a time
        for j in 0..proof_msgs.len() {
            let mut pok = PokSignature::init_with_rng(
                &pk,
                &signature,
                Some(&HEADER),
                &gens,
                proof_msgs.as_slice(),
                &mut rng,
            )
            .expect("Signature PoK init failed");

            let challenge = pok
                .compute_challenge(&pk, Some(PRESENTATION_MESSAGE))
                .expect("Signature PoK challenge computation failed");

            let proof = pok
                .generate_proof(challenge)
                .expect("PoK proof generation failed");

            let expected_proof = hex::decode(expected_proofs[i][j]).expect(
                "expected
             proof test data decoding failed",
            );
            assert_eq!(proof.to_octets(), expected_proof);
            proof_values.push(hex::encode(proof.to_octets()));
            let mut revealed_msgs = Vec::new();
            for k in 0..j {
                revealed_msgs.push((k as usize, TEST_CLAIMS[k].to_vec()));
            }

            assert_eq!(
                verify_proof(BbsVerifyProofRequest {
                    public_key: pk.point_to_octets().to_vec(),
                    header: Some(HEADER.to_vec()),
                    presentation_message: Some(PRESENTATION_MESSAGE.to_vec()),
                    proof: proof.to_octets().to_vec(),
                    total_message_count: test_atts.len(),
                    messages: Some(revealed_msgs.as_slice().to_vec()),
                })
                .expect("proof verification failed"),
                true
            );
            proof_msgs[j] = ProofMessage::Revealed(test_atts[j]);
        }
        // println!("{:?},", proof_values);
    }
}
