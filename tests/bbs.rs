use core::convert::TryFrom;
use pairing_crypto::bbs::ciphersuites::bls12_381::{
    verify_proof,
    BbsVerifyProofRequest,
    Generators,
    HiddenMessage,
    Message,
    PokSignature,
    ProofMessage,
    PublicKey,
    SecretKey,
    Signature,
    GLOBAL_BLIND_VALUE_GENERATOR_SEED,
    GLOBAL_MESSAGE_GENERATOR_SEED,
    GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
    MAP_MESSAGE_TO_SCALAR_DST,
};

mod common;

use common::mock::MockRng;

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const PRESENTATION_MESSAGE: &[u8; 20] = b"e8gxekZpmeZTU0VDL9MV";

const EXPECTED_SIGS: [&str; 7] = [
    "823cfa56a44f487a793aaf0da6b457a5edcadd33ea6863a9cbbd147d783deb93824207c7fc99a809a75dd14768f6ace7493154908ad0e8f8348818e5fbb9a9eb9eaf0ad7620a76934827fd60223c2d53719d9e17a320f2fc35a0e0154f2e4845470baa5050f93e2956cf1ebe745af007",
    "a0d09e1b1d7b6435091e398553382a28459f893932d813926f7f59d2e4a00c041ab3a555bc72d8d4c04e73e4a7dd88f46e6daae946f5390d16a57fedc583b91cc9c0558d93d9849ce03be4beb6c2575e4e0eb66b395424039e5efb0a45801375d77f6a83b6563981a0f289a023f94340",
    "aeff8bf9a7185f1aa943dbb3ef850e2d9c149980d442ce399babdda3dc0e76b3e25e40c9ff99e3a0fe5006c1166401306448d3b54e2e67e0aaa3d17d3827e451a8e223d04cbc2afa5af6d3078698ffa6643c242d77cc446fbda681e97eea80f19057ed5eb413f1d88556116e3588bbb5",
    "b62485da163fd4c552fe9510372c3ec5a1b29985564f2cb286571224a9fb6473072f38ee9690c50e168e1fff476afe936b7ed5fae8d1596a7ce874f8926d89c4359bf65bd0ad957b57dc6a506705efb3122344abd6a4da2087343a8f670b61e7e048b0f4f12e022dcaa759ec50728e35",
    "888c450602e083eda7a446990823cc92bc8799c2588e691c7f59e9bc1298755ed78099cdcd5fb6659ab19388c2f08d654f12e4e924d5f1ccfa4e1762ee583500383fc3bcea78c42582031507925317fb5be1f6720186cc58b7ab87eac7be5655175ec0c2b29248192c05489a7815d5a1",
    "95572022ee3ce87280358999e4da800caed43e22fd79acfccfb7ce99a409a47b73d23ffa17c38acd12d1ba0254d713335465cb92c1beeee71e2fb041cd7f01872121eda3101aa0945612ce27c310d6335866671db1b79a031ec7651a94c44bfa93c87cafb8a0284377c554d89f681714",
    "8cfbee2d3c0f74c0ee8cf6929da522dddcb0daeea04d0a7c9e43411f44cc0e88d51579f13cd9762732d210c38000352821a7337bf5b140410c660dd77966c5608ee74a72864e34f8358c43a7343891b43855e36258ff8418f5742d216183b1892749c846932bbbbea94312d4986c7989",
];

const HEADER: &[u8; 16] = b"some_app_context";

#[test]
fn signing() {
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| {
            Message::map_to_scalar(
                b.as_ref(),
                MAP_MESSAGE_TO_SCALAR_DST.as_ref(),
            )
        })
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    for i in 0..TEST_KEY_INFOS.len() {
        let sk =
            SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed");
        let pk = PublicKey::from(&sk);
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        )
        .expect("generators creation failed");
        let signature =
            Signature::new(&sk, &pk, Some(&HEADER), &gens, &test_atts)
                .expect("signing failed");
        // println!("{:?},", hex::encode(signature.to_octets()));

        assert_eq!(
            signature
                .verify(&pk, Some(&HEADER), &gens, &test_atts)
                .unwrap(),
            true
        );
        let expected_signature = Signature::from_octets(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(signature, expected_signature);
    }
}

#[test]
fn proofs() {
    use rand::SeedableRng;
    let mut rng = MockRng::from_seed([1u8; 16]);
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| {
            Message::map_to_scalar(
                b.as_ref(),
                MAP_MESSAGE_TO_SCALAR_DST.as_ref(),
            )
        })
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    let expected_proofs = [
            ["80c19b1688eb2a9ac0dc48cad26e0a4667c48e90bcb48ac4d2efb6dcefcfd36527ba80e87f9924419cd73ce29cf36bed8b5c39fedc06c782b593ffff88bdddf38819eec5dc2b29a2b7744a5459766bc7934c733875eaae9beae4023d51ef37288f1efae6f59453810ba786982ee77fb655ddfb9f36847c7080674d969decc68e4f57a2b75d3dc4a00bae3e8534f6726f46aece1e478d34130f74aedc2dfe016f0043d2daeb1f359782de3f4b99183c7b6ac1a79dcba1cd9884c824e8dc753fdc7b6a3c5967c295658eb6155816620ad83f755eea26f12281011046818679c87025d1c2f18ed582ad3ee7f8e5f184d8e52d275cfd03cd9d99148736b51b00e369633ce223564549af81997ea68769e1a60662a00b4b56474a8455078dfacf457c54d02479a1e1f99c77438cda03f4a4d4480003c0714b8b01f331daa05d86c518d0d59bfbac753cbdf0154d20853e9ff65bd0abf69764a97a63bb7d2148d0f063f0784cb184495f92b206703ec11e88976562b537919190ddd31cad618b28d336290cf637dd0c74995f21752dc662e38b5777264740887e5797989df0d438d0abdc167f8b86eb5517fe6b291fc25b537f0d7764c6f7eefe05a915706d42a8c669cc6098762495fb6730d19b1854afa95365e74c36ec74dee97445b8a185b82d1536577f37dba8ea898576b69e7e693f78", "94bd384b9e1dfae32d7b9b573df7eec79db8bdc5e543348b2ca68d34bcdc6003652573b86a472d5924b82750269a5180899f9c3cddfe91c25a6175b6712252001826cba5babfed4ec3da2a4932f4312224c2c77ac6211df4db05bf462189a2d6a4c91836398d27e4f30d190dde86065eaeedac82cd2bce5ea8d76db15400cb9011509093c10bb16ab7a1376251c615ec6df038fc5fdfa8c3d6e8f4e18e6ced2b78e15552aabb5a5ea72ba4c9d5d5f1dc56015035ff1e2fde4a87cf67b600c98dda3f6170d5d9402ce08325e81ef12fb3091797fb2bdcf9443d00719004fda1be6d76519bab138b2944316a22f40ee6ba53a22c98ee87876e94e14a679c5380ed624084329d83d6f6fa62f7c5b1f647582e6f94bf0100b86bceea17460e97bc454b3271f74b0d3f38834bd7f66308a583054486a844ad01dec9a7a5cb2e29f0263be85814f229c7def6f53646e8d7d7605706cca355e1a0e53ef5b273ce6e5066865721e15838e58f9878088a7011c20e51c57e7253449c1cfa9ddd4774edb95ecf43d0e6be9c7836401f3b2fc20ac6655ef74c1ce92d04e1cc19b99f8f6ea19a5a8df9f1a7059c1d901d360daace14c01c9d3325ccf1977482db77e5566829558cf747d7b8fd865228a8ca1f5341203a", "b7ddfe13f956aaa3cf46388fb4069976291b00732d3e01743675bd1fb41a7bbd9e0b540906d009e58ce7845cae19f804b3b1aa60c8e29b825f205d2614dca80089c39f942e0092ca71e3eeeee2c199e228c38976f6000d59ced996f8d935e12889761d16fa6a25f559a7a1c174a3dfc28b47f6912394637c2cd066f071fe61f406f7133d4f85fcbcebcd472abd5ce3f9004c192473698a6f7d3ce204ffcb1b0c3c9a6e6ec0b8b5ee4451c3c1d3ff51716a263f94af4b4d8273846cb6648351a98c761319875417a1d2686935e6dc43725df8c9a16cbdac86ffacad24e3621ccc37ed2aa9d988fdc73c952493a5b7852b07005103d91faf9105f5fed1cf582f9b76881f9e215eef4f2e18fa74b47711fe42aed5924aa3eeee79518b3828eec831b94c3e39672e58dd6cfae66f1b72162e104b1769efe1f2cb31f64ecabcb47c88f565d81b01a12f73127c8de7a0b1f9d4000d0c0c3576cec22dfe667b9f3f683f5e81f5288e058b189ecf0e55208b23791f2e1c52a947e674b03e6befdc9b6bd9bcbcd89cc915c86cd539eca02583404f5a0840b01677062cbccb97a9c2246e21cb9c7f40f64382019a4e3ba450ff784c", "a9136adcfd36d74b982a312febaec707ae15f08bd65ea0e6a97ddd77f5894769541bd09c1f472d20c1f83eb4fa7bd60b88a3a645877127c0474b024e0f921338947a343d410676e7eea5516060782919bed109bac2220f5b4b17e1f6ee90bfaba062d11dc7271c41655ff640f5edf2312bb351c89f6d52c6c395c3ecda1675dabe6a05f983c72415f17b6ee8e8e13f701bc56e65c55e0e387f14d5c98aacc6a1fcadb875dc91eac653d903a37ec876982cae7fc012f13b7f6e63f227760ee60f8f1d83a5aa5b5fb507709e70732cd96f0933b435bf994c95495961f51787f19128b722e11c985a9258651b7ce42166ff0e24504adf41a60f5503f6882414fd35263f5686e64fba37e4e4caa902f057df5a05fcfe48a03ff33e2d9ef90b02923f68ae384c1de683911a8e21e1b74eb64010bf041aa846c933f7556fd429dc31da2fd3efc26e12d378d15bedc7b6ce1c9e5b1317c7b6f8ac85054f081cce0649813239229966cb27e4794ed1e2478589854a01031f22b6fc3ca0363f68437a3b3777367bd8b3dcedabba1c632ee07b1dbf", "a7513dc1bf885a4e37a23f6a1f4a89274d6078728c0aa1668df74cb53f623bf806db876cd00b83f50289a5e0e49fd4678487bac404dce993618840b998b31461b175b7a87701cd548f448a9183627b96f7dfa30db5d8f5ca3a62aa39eb80b8baad14240fbe0438da75c065d46ff3c84009cf7dd542b73f3d80db7f55b8e4fbcb5548d44aae9457f994fdd6678a1e50c1692eea3fb5465f4eee9a90c7de65fbd1530721422f5e83dd1af5d8a44af0ee3f1362920d4769443ae3d8745f86cf0440c176c6c542dbee8ca10c7583ffa3305f1113665c93434a38864518042643ff18ab83a71e2fbf9f36388d7c39ca7df0ff3354ab74f3124d7d170c006699eb3ea52470ba9d6c1904a519dd2ff5beaca9673a7406fb9e71e6646279adb65a2fc7b251b5df9e8062ba1b7864a3f4b304841c27206245c2473d6863664d97e8491332d5d271a44612a3b7e4d7d11bf5aa15fd712b209e6df69468ef396455c4bc0d05d359ecb6292273e39263821865c54222", "a815efc8eb334f04ba5d3afafe46523e68d06a11d7c037d7c9bb820a822e68cd90a5a4bf3fbc1dd6a7968cef7b7127f5a9adb3c31a602bacb3a4bfb14b7f006dd1c2ef76b593faf8cdc9ddf2612dbd9753ba5deabbb26a0848d9ad94fc9ed21c93f1b550fca037cd056b1ec41d992e21188294eb242e864eaffb8c84df517d393390bc259f56cd74fd5c773c32c3f4a61f60efbfce5a8d52cb7c044673f02128f79682d4daf931130425287dccb9ee3b7239c2e2b592cb6fe9f044e345e5f03099e8d3629591307fca731debe27ac53b023304d83973387c78af34cf173ebc0856f72bdfadd436a0c4fedf5363b8abb105b3aa2f8f465ab0950168bc5928a809f56bca0266082f6acc711e280d4dac230e4bc51d1dc9d097f109ecb42fb82f04cfb372d6016e7e06d616200d42d4f16f5e7f9b66d3baf80d8ae806bd2a8fcfe2cf7345af6968c05417e63ee0b9a892d0"],
            ["acb4fcda5028f0ae830ff9cce4c3c07da18232f536a37d46d8b130ea5d200eeb221a664bca4f5d6e0675cb236b6bf3a1901288f2071480c32fb095d9b703e24e5c3f2a8bc0edb3d3c26a6e142ba21aa7d15cefff7c4fdb7f49d58ad4bb167d6187b1082b72397799473160ca4484f0c1babce400db4a86772c2c804527f2134f78d7cb37bf62e3ab770631546bc8255e6238aa9b3823d995d43b41d2733be626ef92bab0a6c55e32e2db6922a6beb8c920948aec907bba3dc168f0e86c2fc3c0fcfb5adc365a2c17336794c65dddad531d61bc4512b5c2a2dd862e7ee8f5abe04483ebcba5a0ed23bf657d5583dab50f612439ec6e271655dba1c2af2b038023af8a80877a22f65b4df969d155c22e89355d9bacb27c644d160307fddc76d6449936e4510421e5dce4bed0d766e6f0d746e205cecf145eae9e4ee23f42987569ce204b185549fa89a6653cef527c4cd2409e0f6980b08578c633d26b6a1ffcd279104591ac85cff6a4c2ee1ad2465b8e4df164c48caf11dace25df66d057ad3d72992c231e629471f5b594376f70961417e89c3fb461790880e1b3bb98012fac18b8658f107bd07117799f70d824824c2ff78d563a014944a68e3e95373b9bdd169cb4c337cd746427ce4419872d20fc431370b74b1772a59b45134a691ac991e3355ee993da6e6944f2ec13f08a3f5c", "a5784cc2b72d59d7968e9063b328708148676ff36f9155f8beb33f21ef995c9ac0a5a443c40c0dc09e3f2cd55b8a8bc7a5530383f879b0205553acfa1f372d29c5a455013ef6c6ce475b9af6753cce94605ad27b41c4f997e521ee4ff3e0bcc8a7b021021226a5cd52b82e1142912590d5fbea29528cd794d010b027101f16e27da239641b9cd5327c55793c77398ac72d9602c2a0c59e567f56e9fd9a9ae1d1bc69d310d71270968c8cd6ce9d3799831e59c6fb9ebb0dfc22c1b5430a154f0feb23c6d6af11eea67b8324622025c89403e54d448cae8df2077493d6a658c47f286dacec95cf3250cd541ae40624b3195e5d82fb78d682ffa03e59cd99b0e9b22f411cfe7589a9994f6afd8561c999f4627a8417a82d1a52fba1f5c4a4922d4eda46da754b802dd8675bfe3604330adb3500fa15a9baec141e7dd879be912f034af0fd014abb4b9db39d12b36720c67f4196d8058c0f0845d914498c62dc35a30112ad964372dfcbffd8a82931824a3517c7bca602a3120bef2de080546fe0020facc289552adb8fde983eec583fb4281ef4cb99ab7908c2933f6468d2f0f00b8b333d56bf4d14fd521b4cafbc08db4b352e0a0c9d5441da5f5eeb727e3f60ff7e7600cafc5a56f8656260ce5efb075f", "8fbd8289e762a0294cf450615fa9a4ca1f2a5b8062f63e3c26ea56a19b90ae3c9b0b29f206cb6769ba2ec74e821cd7399439417ac5072cde6a17d79a3142e8ececae22a72db4b085152daf565058d85a9202c545fe3deb1ccd4db300585fac7baf16c844235519ac2413a6c1690a0d2a386e96f32d4b5c720ebf4392c81a50247725fdf40820ac4a905f186e81c17b8f4e7f24af4884e7fb4b333b4b1a7a24115e6de9d86a885bb638bae870f768d0945322cc2fe462b0787b6be3eb086caa91bf1d3204ac0838c3a4af68ec80f3c84c4ac0ffc42a32422e749accc15ec081cddf1b385a056a4c5be2511d3dc428ae8c655853175df61ac4a93883569461695f2f0513c4caf6f17b6f579efaae8969dd66d5478f4233791b8e37d09420299ab3c75d1e94b63224d6f39dbdb2fe5f3de931be1dd8bc56812e3d0bc1e1b032aa3aee9e7bd8f382de76f7dbad0de2d55e903f8be1caf8c08f2aeafab1a52aec88dfbe319fd19a0fa236c9d2ad229404f1de37cd6c2be92e44df1e29588ca4c8af114b79365f51915942c90bb73810eb24aa23638836b19368f408781bcde322a5a0679cc9edcd4f68e338845668da7f224c", "b7bb8ea9113eb56da5f71ad50e07e2ec4aa441de7eaa0c9bef7a4eff93287310823a2573a633871d3c10b683e8406f71a1c34721ca14cbb4b82e6b65a9ff986afa028bf71b4487534633b7cdbc4066cb663a4dcd13494bf96bd9b037f25074ce835b47bf687e2d3bdcb1df2903e45823c6fc556b749118833c1c0005954144bf4b48cd2f757a3a0540366f8c7e4f29b331b88b3f12eae0489accb13c26dfe0c2db471d5c35a1d63fe6cc215da4175e81702698c084305cb18354e2d17e1ecde2383ca113558f5ebd0cadfafd64d1729b5619a5d3d0cbc564d15d82cfc811ce09c1dfc6422e989b2aa044908dad62ef0053b229a097dc770e805199d0e683b73c045ecc565584eb6ddb69cbe49b36baa15228f6ce042163ec3d7900d199081db31ad59140e93852de3bb7dd1be132c3546e3797d4c70e2e4d9b94e18f418e9563479f0ade008ec9b105e14e2f53f496570642b4089de114d6be59fd754a5941e3709977ed98a64d5aa8061c0d406a4cb26402ef43152aedbc5ddbdba4be44fe5614b041d70500939c8d8ef1942c3b7d87", "aa432911bf35f53a79e111c4b5eb7fa8353f901e69ff3113ea8b887098e381211d483d055a9164e9ddfabdfbfd03ec69b0c4dec3d23c8523bbbf423a51aa4e060229eae577fa13e3b58ce1f2397082670531aad3dbcc1cda4b35685a3fc6f9f8a22297c44a7dc33edb6c69832203433f2944ff540a5b8088d97983c5e8956911a35fe297b93afee50184b50df3ee50fc2547d418ffa1ced849938a0436d841be89c9263769997ea8c8c011d447c2499d574b83d9a7388eb71c4b1f9ccae53573b4691fd7b035c0a029c7854df39c705547f97319cea1d07952813cd2a2569a7270edf526cf1dc717438d1b878883230602e9241bd76e02a0b86fce9c48d3077973184143f3372d2639be09447b849792178c097c943827bd7a19878cb2ea4b17b0531a8a95dbdda115aed3515d2b63546a786eaf9f427e4fa7778b44dbe943a521fd6ae230db66681940b957940cfefb30bc4324a9b12e8cf8067e1f97b8a552f10c3a877b567a4449ee95e15a11fb93", "929f1fd38ccc11b7cbfe6c7663bbdba6b8c59c00872e9cc48abe27c5562c7b69ad7f639f6bd8d2e7f946fd139d0f009294df6374c3fccec4d4a419672e0a37373802986616b154cf0d9d990e00b2ca3a271c68ae2d3bf70385625b8a465507dc904b9ce17f04a2b3fc880d359691a1d6452ef48d0437de26da408afdaf22a19e6602cb41da7ab64e574c1996c0c1d6ee40c90f66ac5f9d434ad127742cb3d697106ac5e1270f7faf063ca7de585decbc1841310ecf988609deafcae0b494e7cbcb627d2d728a6c04eddb061b31a519a644714e11244f90ab688d60cafc305fa65101b0eac4863e6f76d53bb610e4302f26495652212a7fa23af44c89afec9fe688490d98a17951fc413c847621769db001a8deb108c62162952a328e7905d5e4298d601d58835b348f0693f2e075794250f34d1c9fe272b70c05b61f8889c164da06d3ca2a7660ec63bfbe31310de1df"],
            ["a362b8fc4b9b4529223f4e77d7060e2b714fca7bd6cd07be3301cda055ae382dc21bace88cd0b40f6c003ca88d45caf0b3b39aac2f28825507a46b94e1683db3dee84ced276bd9468861b387508aafd88ec77813595226adb80c11bcb11851fcb7e219365c0284233d097ad10a898db1ddbf095c92a3bdeb647aea48c2e99614d7204a37581027e9932275ce70cdf0ff5e9dc288d9c624c76add9549577bda5b3407f5ac33aefd6eacd17bc767dc185762c9ebf85a87a71b692fb7b817ea22ad58844eb37c2bf58da272e74b328304aa217e0d0a779503af28cbe222a4eac41105978663337a70438a38476a6da0569852bdb7050026bf010d69f2d0da41b2944ae7ab53081f56a9cc50ee628fd52e946bad50059941553f5e6173ceae22476816731432c3231e590102260f0f71df272429c110d86a65c85e4c078f65204a423608f1c4ae0ace485b04178e240d9f9a3d89ab68418cbe4fed7112c2ea769442d00ab9098fb8b217790e4a30d5f0380809b4a1383bb38f3a0f5be9c9c596e9d04b4879f2aa7c315bf77f87de274d0f22192f6b2c620138c30d40da1125efa617f3fe74d5191b788381fd1e25263355966d4e76796b144b01677dd476bc9442a03a1df11f0b7e5ac5da461561ac164d573cde734367bfceafa561f75a23306b3729914f511ff6cb8dd0739123ddbfc909", "98b558c77525dd0555aedb6ba0193eb50a6c333c8fec0398554baa28cc48e942b455065d1f733840a7ecb8860124e6bf8c6631875327f7614c9c32cd41420d8f210c73644df3122da3456f18984f7004764a00fff6b2d41c5ffdb929ddcdbc5687220cba5fbce013a7ff25f61dc166566f1e40cc7e3ca1c15de9129979b41840081baf6b8a66b7b339e654b33b6d40ec632187a0db2e1ff1eb1cf1efedc7ee4461ece280485213fb742b58c80fefd6df221ee57da250b98ace622abfd5c0e17125f74fa93ee1cf95f0f0508b46db05d8361da2b140a3dad75dfbc4da8b0ce8ede91706096457230f7b53c804e6db52ea3af68a25e362ac028b95d6e7db94fd7f1870d76a1a9525ce1ee3e4cc3b3a6b501d09633a1a04541fd71b44fef5250cfbf05dee09da83a0663572bfae2c81ed7e3548fc454ee88adc8c3c31dc93801f531715dd72bc24dbf00ca19182f06204b45dcd454e9dc3df2abb235d80a4af3ae6b3c6b14d2b3af2f71f9643ea2222ffdf40e31edc5ee3cf17783ef74652f61c68d6699e78a4d53052e121725eadcc9e60200c452dc1174e2dc4e9e054c6c1e5e58984238fa47ea637dc7d7d440ac96e046008e80a98b46b935b3e5c6b712d860015f4cea5dab803c0420ec9f6d922926f", "b67597388094dda241603eb099ac05289ade7bbdef8f25a2aa94ed837d0a9c4bfb07de75fe9092125ba52f5596eaab6ca0c74793a5d762ed5900b508b707895faa14dcf35428f72807600f567700f07460c7bb902b173dcc744f43c0a358eec091204d1b01e5f8bcddf143e03b438b20c5476e4befbd33508c98a5d92a468ac6bb440ff42468005eb063a9248e03f00b49c44b0a7b6a03a044c3f93a13388ca98860b91e7d1ca98c3456a78305242e0f29d42eab1da45062952572977c6c79539f3bd783e89a9f83398bd296ad94d5ae5b4c716098837440b84a805b8bdf8e879bf77208b78530488664cd3a25a118223fbcb327ac4f1d94e18ecd3a534e567807c4940e9e18421c2ee761e761ff3d665dcdc93d014b10bcb67ca2c31f897c46a9f4742fc2b252a1125d214853d61186719de9feef24dc422e9d4a0f58e4b2a5b557c6a9a42f191627e9d9d707831b1d3398eccfc8b289db7b0d3a61cf0ff87f79decadc81a495ddc5fe101157d62190691fb40c0da6ebb9f75d2a28b9bf721ce85e66407b9b008f115cebe10d1f77406cf5dd8d73b5a83151f3a8972c63a480f04ab1da43da6733163116531dcaa4c6", "a2df3fc41d2e2d08087f12da621bb47deb0a011834d558734970420bc50b375b6e0dbfa14585c81a99021a1db845389185d93130f4e68ca3ae02a7d3c554bc46e6a804209b7d03aaee594dc7d727cf82d6a29aeb4b65b7efe24e22036a1fa307a6e06abe030847dfbef4db917fea66815f86f39c33fa02d8002795bd4df75c9a3ada8e561ca6ed5a734f85df21b7279e1caba2e71dc91649e331dd852c94a5cfa88dcbf04dc571184beb8ed7927eb7e85edcdb30c835b3f65ef98caf9ce2eca95235fe0d54ed522e55462783fb3793e0731ec8d3c76dca4bae05d475ec01571808ede3218e76c8a13070ffd4c0c63138070d250efc79cf4a1976639f52655aba5886f6a31431a914c9133b7375b214804ab976bfe0e207457ae8a985f940f1a29d11649d7ea94a776e0828faf292009c63db77a76a88f5b16c96469621206db8efb51279e780a10359c83c9f2eba8377319f62d37a9ec738ffb2213db268014d3125b4710099bc93d910f0e3c74eaa370d24a9384641ef2144f019af36ad837a6364c072e127321a37b6db96a593ed84", "84202a7be606656d7b8bbfda49b96ac82e0bf808181f13d355bd08eaedf6b49b21d659a90495a5cb686db6fa935b5194b5e5c98e78268bc9f36b11cc27fe1bd3619d740930f31fe271668b1eb2e300d02dc49a6dfda27cb07b48a20f08276994aeca0d9b9aac03768855949b4dc46628e4b01d6460469767fb1ca16f78ae7edd53c3ff1368fa05d466732e339976431304b7c09dea168cd1a2e371b361736d7e4ab52e1a3ada6022d60c70d774c67ba63881d0f0f2d3beef62f299b9d37d477b029c0978084e008e55588ea0f0e79f2741ba60dbf874eb5cacb9b8ddb8f83f2f04ba9e5047e9d9eb5aeee697bcaabb026c22134c7e21110af01678c75f9a5be2870e090c7dcb71bcb33652e8c4d6329a2f356472f7cc130b4e063e13eae0f38dd19a470d4e73fe61c6f39b126030345f2515059c6d9f3ec2fff0a70ff0c3c7581ee319588e7ca3223e50b27760e0dd8b2330d9380785096861be37bf741642b386c66b64cbb6b5399b64cd54f19bf273", "a5234f97180134942ae61616ff0cf83394203c4230e3482f72fae8b65cb2880fd5487254e62dffc084db3217c14f5923884a723ab185d83cf2d01c165393bc6422fe94aa705b89b9cd2c2172e93e0667545fce4457a6dfca91c31c7ad4bfd02eb79ba4ed0c2e4e9a37f493216e6030e9174ea95481a386804a7551b530523f68ed748352865c6e1e46dcd6abdccb5ea9534b6eecf52bd26aa0fcdb6245d188d2ffdb31660b88151c44b0968dd04331940463e634aacb55c98e81aadba331b0601c4faaba72ae6680c158ff16df2d4b070a2fa5368c68d3dbc3c06ac62441485554117786cbd31f961620e5ad7197553a17d71182da2724630760a56c2e115ea8f77b062a1f8ad2aa49e200b13cbc612d531da668cbf8c76f7e15d7d07a56c8c16d02289ad781dd4bf6acdb39bd4322170761f172693d41ec8056292bddde77e585e6a2b4cc219617cb6fd2e51b7d29be"],
            ["99802a05b2e9f122710c7b9f4c29f89a1c7126157304d16056656b89984d6478ff05b7c9a25a75dc2f715d550e73df1b841c9659a1b7874e5acd0dbbfcaac236bd1acabe899f7a7133434a9750fb6ea470eb5c5f58a12def2a7d4d6d19f76cd5a52fce10132afe3dde089c9e2ce65565489704cbece29fa097bb0ea4ad535b1edd90c617610691c1b8676e7e9cc6d90359cf3a62b7cbc8268628a02a4e9964a1850bbfab8f60fece40955b01d318101f0982f50d6c1c3fa7551fab5eb16994d1ec6b8dd91a9be424d5725c1c787bed771c93a91e2dab75959f69f165d34ea6f115d3405043cf1ac4efb35d08ae372e4033ed3b1d498f550beeb53674e941aaf95f70b8add48257d565ee39b4e55f0a222bfc4549280ff1af1e1c99e2b191d4b0c51847f3bf403a6d49434cd1eeea76723b0f3c685be33b2432f1883f8ddf64950383bd6b388da75d2aaa1b8bc42bfbb0362ebb385be48158a0dd705a5a1af4d48a045370c29f7c86b731c05c2ff1023e634ce4e5adfae85945a9a7bf3cffdf8b980914d562743d545ac42ad9028ff6b35ad0e578188744aa2deeaa06ff92a6ae978e117827e983882438ac2d8ebc96ba1b5e6a81679c6c69b5a051f7dde4899fb95c3f4e8f77893b1b7d74ae5dc02b2959242464b22eafe07d526a905891cbdc7103e2337d09eb58e830eeae8218d41e", "a9eb9afded5ab03bbdfb08155f8ac86d946f7c821f25e9ac98f47c69695b081e29869c23c7ed96e19da88a889d1d14b8b0bc3131fc48839ccf341b4a1baa4bab35ec2483c5fdd340569b2644a1e5a167a86002673bb2c269a65d927b5d10b9cab6380df2b9e2d23cb12f056e0f38a1dd1d344ff811a7225ca2f2fca212547cb41491801d3ce007baa53e4a4e277116951fd9df57caff3157d210018c1bc000610b20f453759c655de07aedf22a1d906568984f2e3b885369faf73cefb18d77e5e4830e4cbe0c69216ddf18e5fea3dec4567ee47a32717345e21c9f081ab3229f33df2ce560b69e61f50d6b9ed72b02d5715d3127060b8fa7a8b89a86e1522ca1606d36d7d7d8a09c4150bf89a34b98ec5229195ecb9845231c3cf9771e59056c0c0dbc7249c800b4ffaf3f34bbb133d64b001564329127dd1428dc30436ab3a494a3429c3c4043ec46e93af44869d9473ab319a75642501cdc710be9b3c3a4ef3a95a22362189c9867e5a45fd7cf990d689d2cdcb8b43a17fe05b774da8966e233fbdb3dd4780c4d655cbf08bc363dd45285903d3299a78ae1fc5771bc2714d7ff72982c6e5b25cab910af9e9bbd32a23b1cb8ff867ed9c73a003ba73e167f60c0e593b66e07c1e5974aa7c6159d5289", "88d5c14a11d32a95271ccce8edb745e2bbb452a41241309d10f12b9301726528f540090218076087ab78937c533c44b7ae890e5b686cca06c27f1a314b6fc406ab15648097a3cac20fc817fbc241a946c583e0b882cc19a072df92e55cd83d39a67735ee8b117ec4c096f3bb7fda98349f537afc2453ddd82ab2071594df7ca64bb9953b68228cd6445a6c2a66f2d27a54cac8509bbf7bdd373580811369ccc042d013f165fa98e9ce013a279002ed015f9175b1e18958f64d1ddf254354c78d601cb9de56a045f3d1183c6afce359372d0f607d960b89d769f64a9cc1e1f0ba71b62b359850576327026f0ea7f3bf0839bad4e88712b7ead731b16f9d50ceac6bf72a2659a34cfd4dff7ceeb85b58440b7ba938bccce9b9890b7bfc8ba96bc4cd886dfba87f36f75686317342c7e88c219c2eeea82697361aacc1b2228c5c63bffed5309eba75ca4a516d9130ecdfb3274367747728217bea2f55758172f270418e172cac6287b42023d8644df0d1285c037ab8186b3c79c4961b79425115d2e3fdcab810c4d2f2d8a5b71922f4a180088c213e260bc29abe5e814c91d4759a2ce5f108aff1117e2923d928a83d0e42", "8bd297a9c16bc77d40bbc41e9b8b63d12a0d24564f637c1c3229d633077cbac91f8cfcfa79ce89bc15e58980df77a546a08745d02b5abc59312e5e0085e1ac57603a1a69266a1b55f8a68291720e01e8142b2b05a8e4244aa372d479e0a6016f93270a7adc0982b884be19634465a674a1666a1573e4890778eb9b92e52ddbef9ccd6569d8cc22779aee3b49313efe5b518e496c73c171fbf33268d489a4bedd3308de6ede4c27625385379f7557e1225f45400e93de9737c7985c0174aa13e96ff65c4405ec8a9ebfb14c7ebda086970087735df91efab4179aebac031931a7d84cd96c2575564f2167da957c26eed441483d58e473c8d256cb1f0104a55258d8919165ccfc51ded43e8dc09ecc254b25cc1bdfcd014eb8f64f5abf3344262157fd5c62e3ef780c5d236488a8e15b0d187346773b49c8f2a20ea0f89e98169ed49bca4ce596746099865563d45b8f593a790cd6957894349f1f32b3c493307326878a9ba6e7c23775740d29cb2877af6c7aa20c8016f35c20aab724455bea8c70690426156a59e626787abe8e92c80d", "acdb56264490f43cc4aa23751c5e112df1848466f9e0e0c3c87861cd0f8fb702072d1a2135fd88509762288d0151ec268348957d8a2df330b1de9ef56581a1272ce507c5aeefa27f6a260b1a78ffe4efc858ea00f4da92b31ba9f8a83f7f354ea6e7568cfd8eb1b1ac8b899575e9222e7b12fcae1f363fe148e28a26cf70ab7c5a630873f4b8b5431f9c84e8e1c5011469a4b9d6fc5c1011921030ddaf5e5fc1f46ec0ed3de9daf1ebf7827054aa97352ebcfb0ec5d3a9023f1a3ded6b39bb46f30e61c7a88db9ec16abb47293eba1a821084d9630a905f14e2a7ac71f41b6d0a524cb1b0277fbd98c267366be374c8519779a5dce58e990fea1304ddb5990e02e36360f94e433938b133974cfc508f87311b41e91d54327db417401d78f252d82caa17bc046a25feaeae4bfcf310eae0ac6a3dd4dc4c804bb8bee67bfe1338ba3b439052a2078a24e2c79dba2e0d75020ce15535919feefa869ef4751eb04a1a3182772d5aeb3127746c27554498dff", "b99b36c999ae9e0abfd1cefe7115a7e2b107b5946dd2ab1027b1c41e1f7275e4f0418cd56c0373d1370846a39512e79c8500b86c3bc1b87b987c259c6b55435382e2a2b8c8efca93606a431185cd1e2d4498808af08ea0e11d78c47738464163aeea0b401db6be2696377d78265634bd48f6759c5277f54117a0e33682f27484e2bea1d69727af11c997655165096d615d1b39b593052e427b783b149b7b5ad4fa98a1ced81b68f2ec5cb9cf9c4cc9784eb06c4a09a09cce82479d4015beaf5dc7ec0e8275e265d13b1d72b1e0f023454e828b305b29fc413dbc3e6371688da361c83a094bcc5d9f80c361918d0da57150c625a0be899da69349eabf3231018e36038afee1eeaee132386e5051574e6632c4a99d5a3e40f9efbf8b3dcda4e986a9110f37a42a69143269193851217658202c2d26f5d364ef3fa0999d8610035c759c0682433f5b308373d71358a5e288"],
            ["b0834b8602907d760ca183269cff27bd50d8da4b225271c27873ec3b74389ff6508b24965cf9210ef1fbe2c58045fef38f6d97b0d0e067bf50c70572d85d78a944b20865fe6dd34f1b25120eb655cf9bcfd5e447ccf2630775e2b6bafe1ef983b130da7d71121f59ee0717f509c171fc3bce4a69a966466f1f2786acbc417cbf5e35792edd1170ac065cdea0119240205d15a4bd07dce7ef2ead66e0b594f680c17b860885f64ae12be57b00b526ea475866098480edf776f38f890f26bae4dff77fd1bb563e1d70b08542c9fdde40c00c6bd00d7ae46f2ebcee80c76588f657fcd521b047e7de66c97c3aada0e4d41b44bc6d4b7170a867dc8dc7f8fecd34a2b06884849e4a55484c63fe99c38d357d51803de35690ed346f1446037367449b6f4ee0fd8881a6ae0d4cb23269420472669c854af3cf1a03111fa519db7437d3aca756a45b06379f3f70696adbce849130f9d4f8473e05cd6cc8b6104ce885a60cf43610b1945c404022574554fa81e606cc735359379a81bc9da77bd82b17a36f19f9e438eb654a317304c49cd390b962e3cdf50e0258f3f2a89f14573aa1969390b0f47cc6b7de8e9e6fad2efc671360595c5789a663eebeaba4b7dd869cbea0a4e9364b1de9b5f27d7051b621445a53115c2a81ff865276f2129f5eda9f880c79563c6fd8ec2d39cb5842b15d84ed", "94fbca08dfb4e83f0b76ec92773da59a221da8f78d50b02b43603db4ac8c310d52dfe65cc4ad449c7b17af190b9fb926b3bfc4a6f877bb53da65b26968d6ded0a2a6c4e8c74d63e8e5bea4dc09becb2fc3b817e4e03a1bb3aa185941f2708a9d94b5e18064956f86a40ea262ada4f6f8e8b342f61bcdd3d70f657e8e39eb6ead3c8f29810e0d0ccbff3083bf04e56e743bf33bd798f831dae866f417303238c00f32eb0d273726488595ad571e9b2b8348922bbf2e057fccae4fec901ec31ba8f6d75f0d9008b88aaf4930d58de24ff5452919aadc53a448e52053fe32b131adf43dc93ef9ad3d5cb2420544b9f1b92c67364af036e5f1477de20602b1377471c219b166f088d582809a17421fa3dd8c1f2399bd48ab3143245e37774cdd002ba4b636404e57bc7abdf48f0e0314ed3b38e5702b21aed94bab6c0288536dc13aad1a022974b191709a4befabe2b9453f140cc398e10f02a4e0cfa50b2e33c1373a1a9a89351d778b8f36a436a9cac2e14911a846f2321d2ac1ecd44ecab3d3b79ba8e6d3eeb0b35d4829b8a7295363365222109e9c4270a7bd2f84321e12b1f4fa7ecee4120e625281aaf4c38f1d459a55e84e5455ee3d0a4aa752c38a050dd60c3b761bc061c1f48fddb69a634b7a23", "a6bd7aa2def6c9c330d6f25372e496dc3ea98ceb78da995ee0f95cf9a5311134a819fd6985508fe2b73e9c62e991127d992d08e4a11dcdf1a121df5a88e715698aa9bb53131dad0bf779a420771019c6e6fcb4a943e5eba5eb6f9ed8ad66b694a64299cff7d69291750e2e250b16a6b7376468e7f26d04b2ab709ab9a554b6e6d0184dadd74fa200bea56dff6d794a983866f97d09f75f749996313b013de519b34e5050e71e7f2bfbcef342906830c96061701ada82353f29d64db44cb92c00edf8a86372e212fe2e02cfaf644caafa296b0ca3ba68cabf07cf3420b3499f4c9b994026244e5b974b1ac4a20f345d0b02f31c9cbe1280bf8814e0bb5ae91ed953e2d13fb6688a89537052c765b472b8538ef74c9ff0557b40dfc8b99387598d771f92fa6164fb194a72b98da449da395abaeb155508aceca279ade7604edc3d9da7b0f2089ed79dc3d9118349c251d66ddf5bec16a6b7b5e66a4439560a4db5917a2bcdb5af39d21394691eebb76c660174aa0a157fd72f1d6fc8770777f49d1068b97f4ccdbf47a2ec2655b9a717c65f3bf4a1c80f139056a8669b38cc91589fa04ae0de791cc11a794f4381bef8ba", "b6e7c0a6f2858e602a48302f64508728bb66f455ead7dc69cb641ef3c5e0e57d2f89942458870cc934d518df5f6743faa7025f627da02256d8ce35e3edd33e667da10f7d66b98ebd68eb22fd70bad9cbc05b6c28938d960c5a95da9aac80bb47a71a04ca46bf66a292b48749921e50e4828645c9083227e54f6ab92968f8aeaabb50359a9e06076c7f4e75c49e3dbedb4677ae390f6a09ac15dbcf3b90658f007354edea3b912a6959a1a8cc3d8a7ef605dc66129cfaa29d841c81722251c6477e03368078ca423f1d430a5ca0e304fb0dc5bd9b11e6bd5c2a65175e1a0059da7833560ffd78034a8f788d1fbdb551dc00bfcfab29de2848dbd9c0e463bcd317e3485a6356dde697f9f882d51cab86bb2acde0a847792f0156e0c1ea0a4812ab47eafcdba9699b667681f454e0819fe31658ba963ad69e091b26b560092cacea7072568acb4c36b1ebcdfd4b4661aabf39f7074392b4e15b5e7e758c61f7be3bfc159aa48f2cffbf0be397e55507ed63678ccf20d266caabaccd0716ccedd5831bb49f7bbafaf5e54be5aeb0243665c5", "8b2c9176df500d08347727c83274cb5eeeab8790e52bbe0a987bc753e9bb72b2debe0cd6544c896f3cb6458f9a495875a47d88bc296bfbbf86eecf28eaf93845e7258e8c47cbc68a1feaa30fad09783b34775b9f2adb1d720edd15b683a273d899cdf495b56ba0581d5c9a97ce6cf17d53a9f0e739168762464b7dee22a10637accf7735cdca99414e765f596561d1be260d49f7064ab0d3a26828961b06ea6a11ae684e6a4c670c4caf7827625b7a7637f03d3f40bf030c4c32d20f6dfbe65e5cb98f79228f159dc6eb9a3d8875c6b02f426b095cc8aea23de9497e420e8f72d4fbc9342c52a76b9358ed44013686244363fc48bac0d0bb523fee8c9dc3a9dc3252636fcc48c191b7af67fd1d00a1e806fabe40e5958810d6a87fb0abbb60964f1a3a85c52f4279d7bf2bd5a9da4a425ff7b6280c7ad7f0a28cc6cd13f498667a3827c3d362dd23cb343635154fec7b2d85bdecbcaaa48f53919f4348d62dd0703249bc61563eda59bdb1ae9fa6e685", "a588d68043e1e9235304b7a462f5b0587dd90f1f7596ddde4d011cfcbb45ff7925087cfb4d6f1a556327077c3aa9415d837d01102dd22a0226d35e7b0ce500dfa73e15f5c30b8f3c8ae12bf8fa08d02c7b59a73f8483c9dea1cb23003d8a982e8a14c29e6b4e602b8d67e905486e16a3a3c312327624d46e724e4f412318a4cdd1db5d4c5918f6a92ae14316923a067a5080ead64b0d21655f4b10386a1aa8c257024617fbd3c67b10dbff59889c51ea576172cdfefadc043c8f445404062c7a4e5be8db6d015d6b341583585b70373265f1ba9f2e45580ca5b74f71991f68517780ed90a1415d19363ac3ba42ebf86a2abf204fac725dd1751d30723a78a99d0416a6a2acd29c824480eb8d2f2c266c1dc9396cd3797c9d1bee317d2efc9e91849579ccd098928151eb54e53a3862cc067ebe0fc1ff78f56847239f4db45222b1cd2a9db800fdc7c62c15754fc4f521"],
            ["88385208846afdbf0ecf3c7f75508d44aa9818d8f5c92bacaf08709b5324bd71fb0b63d5bdc5957a9942c3712ef56ab98c51224f6c4212d8cd91efa848e61adb37859ab703415568efc7a9438cd559f2b5d8a0a3f7ba9d3799188dd98f15424c920690a23bd5ebf486535d7982da06cfbea746515efe8e61c34e1509f326e1de1716d4d45e1ba2d844af7bcb40df1197172782f5569a6e448b4e2cd3550be005f90953324aa5d033677601eb17e7104d4e667d3ada7eb8d65a5d5ee063e03fafc2fb1a1fbb8942b9539bb51310b55c932c2134871bc2bb1ac3ab3deb2ec2f92e1e4fbf571efed5c5928136f4a53204fc09d1d495b82bcc8a0421af1f831aee4a9a460c3c4cd41704f31193989e34bb296b7d8ac3179ebbf7d0feff3c4e82c884e9ba9f3512fea6e8ad4e70cb35277a134209f5cb805076e11421da521c37e0bdeb0eaf8d186f6d723ed0332ed10888253a38c02da5fb39f9f18e6bcd3d6d6f112da0b7f56ede1f820ce63bd59288f71924033d74fe97a47bdd84a4b9c97dd642a89dec6d93ac61ddda2267f239aa40623f18cc714d8c9da770f7d71f309ead13fb399f5222897845b5def2b3cd7b593b5b251708241fc9e693638ca03ce86a7ffa4aeeb0e29865dce11df6cd0e2f2c96407302052413dd7bd1986913c57d8c2ecca71f05458bcc48124dfa3d59f9230d", "a6ec0ff44a549657a3e4fe962cea84c0023d81abe77cc318d45d9fc031f63c14bd162bf8c860429282b57a51c481c9e4801ed67333a68fafd79ea263252f01f3b53e8781eb6d3ba8e4fe7b95ef74b4360392e7cc33e6998f6ed7c2ca5af0e44eac97f0c38e42289005fac41ac875b8db6b969e9d18c5b3c4f42761cabea29f21b6af82358bdddbe9e2a5b735be2de2432eacc78d54762e76baec6fe08fd27a575b67d297858172dce5b1f7c219094d7f1aceb4523c4d70ff8e329f11e2e32a97e6f580e0cd59da8712af48e9bbf632c234c86bb0d0f643e38f0e979b1a65386b7babb8fb860b5d28ae1cf605c040c28e59f60b99be1a87500a369f9d92982dfdff389ac4b753b23e1c84c0b3c703a6491250b0398e7286c8da7ca84108c1e3ba69f0d22897b979e2a9ef60ac9b529ab42ec4b0b3796f777b6dc283f4dac3cab5b24e2c31ddf35fc2751c3ce8b771725f1e224b59875d306278f3543672750c51a94605461bc7ea410bb9ce812e34097018bb2a90976804235b97672fbdba6738870603683721764f6816866dba5175783618a53ccbaadff5f231dcca475c369db3f7e66acacb90f2ceb2cd880ce4fd824ee0996b0cd45afb318395c136a8fbed590e61c5104dde77aabb83bd6c20d803", "ad10294e6dced5abaab48df66ebacd02c0b1527953ccaa4ed300f5ba3883c0fa1e613290843f131af9f6f65474db380089c8c88f0f9b0ad8294682cdd1bd9cf9c2cf4abb8db9cdb4c74599ede71a858fa8a8ee674bf545e18de8cdb2b659061c8ef77561e4fb47477f54b831f2077191c227bcc0a969475f007c53d6dd4175d4a9d1630774d8c2b014fd633a426e0d22342c021c953d33b5db5f48cae0c7a13596e11d1a6b67aad9de5c287e0af76bbf2694d289481ba09643010478af66d3db34c1e85ebcc5ee6c270d8fb12a0843ab6126628d1c29629fceaccf1e34b2cbf5ad7517d06abeba001d003bc8f7338e6b56664fc33976c0d2c343ff02db3e15b918ba8d4b2718910abe4f197a93651159040c5de0e4028e03e4077e1d1478fb486134e3c0eeadb97a4c6566db393f95da207a8a891d83ce2bc5074f15bc9f6173d8259ff05ae443b15e16a277568d7c286d38806abb3fe9d023328974ee06eeb9e87222a0b556b27722ec6cf0f034126d3277e5377fada2aba869d74f458cafcb89828e75a7c28b7412a4434098f1e23a34454a72dfced7a74e1bc30dc6932a45d6ef45f127f98c206b54da4f2f2407bd", "b05decd74392048a016ac91f42857a98064b76121c52436997f318f50155cef7a30b80728def22951c402533b34da1b1b0a9fcb9fea610828f816ba8e7101e20c47278bc0f4ca216c236fca8b6a76e5c73f1b1ef7608658b143017b856738be7a27e3620ce39c24d631467b74d2d2b3c568573c5411d22d38eefcb5bbad2b5607ada0513e19c076db7cb11a456ca4e9a1f6794a0b1a97810ace73f75700e99ca6432e36b9dd591ae1376d3a0419850224c1d9ad24982b70379c463f7e3feaad671d1efe1f652df37b8b01a1b801a8da46e5f87ea476f6cac3199058c485b0c907380c002668950aeb0df7caf37d4ad1729bcd34725d0ece7cb80f8dc3a00dae7a0283cfeedd1efa0386241792ddbaf0a430ec891ea694871b07e53ef279efe26b2a3d87629689849813274b10d81813b4a8185b7389ad1dd85f31194dbb19948674e82a931f5d488d9851edee1dc3418466aec7f96c1ff0179de01c5fec279ce19a961e484e585f6a1fc368729a8070e13812bd653fd296c3cc9f24bea9f27a3a531641489c8fc1ece609456f33b02d3", "8807e9ff2679c99dae4ba237fb0b3f6f1d155abb1d2e5b541b9754355f2cd2829f6ea40f15efda0faf302fd39f54fa5ab88be036b1dba68925b005ddf2facd93a11b40b4841743979bd1cba89a3e8e5de2d00cfed7e3ec5dec39eb7735d1aae6b1131b5f8152b057d75098ae0d998a6ed15bc98c603061c66ea7ec8e5e2bd432c1bcf643ae7922289eae6de3eea77252348660b18409475d53d432249804a6f18d5ba7974bf0a243a46b80da9030164f40f7c4abf277f601d1876f92a4f78ff1097cc4ef899fc3add332c466fe0b6d580b6a80bf46a2364ef4c518cab518053d4e43bafcf0143510cc3bbe3b77983ce5535a5c0d3ee2edc058c2e2fd916fe2b8886b9edca38179a63d5deb29bee0e9195c4e254d26fd9dc35e37753dcde139f29b5b6af23d31b8b9db2d6ba5c868308308b2d34237c1dc2fd217e8a7d7578b11a4f1c706f66771b90e602c730be9613d6ce34436bb1382f633827674e18cf7a73edcc93b8571de43f2863ac6cfe8b765", "95f856336ee63e5943c8630ab8eb1b78ef0d7d18798c26871544ba7b9536d24a23df4de254e526e87373f9b358050fe4b88dbf9c62e2073c284dfdbc096c8d718c9e08635ee8ca538f47a46be2ca3d4a42f6aa5e8f66dba81b618024c977a4d6945a0656939c679cb8f609a15146b4547606837d779fd5df56d11667b4fe63c45d8dd4c67124513f95fa495cbf6cec840acacaf1562e5ce010f359ebdcf3eb565483ad270635aee59e6dff310e19f42e06a3400da6b390e9a81c7efba3242c2b9856745dcac98a29938165f0626603294916b80ee15ac0d7601d6113028ff7fe3b11802bab446f0ac33cbae22e067b1352933ee13203b5ceee9363a9fd2bbd5d02552ca0b3a7357b5d2f3977796b64035b0b39f372f0f736554c94353259b2eedd802166ed2250bb473d6447088e910e21cd9b73ec78177ec3e0ffcb0c74ad10c8d8974b3aee95a08577f6b870733c14"],
            ["ab2ff97b16ac6d4bc2f2ee43fc494de94bfb5ab7f088ca24e822d11186164c7cc584abf1cc2511e77d12a31d54cf7a328b1f6d6968413a23d46fab44cb59f7ec43b5f5e596e039743c3ffe25a2b33f76fa3c71bc4f99018fb680a09fef53846da2046a492269c8c637893dd71921759f14859a61628cfdb6aadfb43ed652a94eea277d75fe7704cfc3f758e3a44c780b67ffe69ab2762c82ca8ed47f1c0be96f1e007fba91b258c3af975ef4a003952d66a65e89b4ad5d88790799a5f4f8718075fcc9be171f1ff61ada4a28610778cf5f8c595fd0888d095a100df4da38c26ec1ee67603c3d3ab273c030742470bab329d199672b8028b658e6942146462b2f2d61bbe4fce0b31eae7bfcfe25f361941046a13b660b01a7c0ddb936bc29170c0ad26de19e8d49d6dac50cada876040d060023818767a84c325f5245b325e277836a76aec62851e5b443e811a68ba0812aebc029b0bb2a8c12ce97de79a9dbba38c51f283552c2c442478a47031f088f41e2295f79d0587163a6d49159f5ce97aa76bbaf8c71121cb93d336273e70938085da2559f5b9f30a475e1b29214c41ebd7822e623a65e1677f81ec104834afc04fba79985718b4bb7e8fd4671255064abf5b4d58211606793c09ffdcc8be8280f7dbf473ddabaf22ef09a4bf96783084687d78feeb889778d33ab4921d8f62d", "b45857477113f0344949b89f8e866ab8bb5fdf252a06dd4ccd1cf25b82d300eac75c70ddeffe241522692872abf436a499447784dc382181512e20781596a212cc44392b37cf04de0160ad8ca49331c9e83bf4aea26336adff5841fba9807205b55b9d4fa957116d8f315f99e8649381efb96e38b00bcb178b350cd2c6a570839a78494841c74e227082743a7fcb11191d19ff9624978133817bc43721ceb260585206002a4519ea50ae14ca372a389d00dc32cabd0a4bc167abcdf091de172fc27b2d44239ff004a88c332248055b4d52e9b0c8f46ff3f59e76f90c0511f0ab84682b0d6e596e603c61153cf6dd4fdf2192c9762d2d6edd814aff8f3f71cca305fdc8651ae20c0909e97c57974fc0f025aa5c7297beccaf62aea289a8d8e61b554f133e11fe041611f863e0b95dbd9a05124bc476251644f451d8c02457bdbbe880d2ed7d57866c7f7d415561a7989d43dcb872f81993a9ac5898854bfedacdc8ca1eb89cb450f3e23f032c5c7cf8a6361449bab84dcb1ed26e75268f63a4aa8fd5943467ca80a29331e0837b33a47746a8eef61536cf42e18fc70e4922eb413417726aa4212ef2e2eef155f34642eb13fcbdf59209731222a5907805e54a2f6a2d6567ea259bba7a82a18c5d581bcf", "8560083469ef8bdfc92c5f608d966f68d93675a2e01402bab0a8b60bd3c2c22160791a9b0738c6287e3f1aeaf8da2f7b89b38be6c9a4a051caf7f50ff06288d92d02f92641453b196cdb3f6fbce04a4f402b76e217871af536fa8a1da934385186f5dcccb238faecdf26dbd2f386602e483f0adb6df1fcd666bbd44b3ed016e3be618f34144a29dc6edb56db4ce1063642d67b4e2efb406f3913a8cab5115c20aeb385aa1834b61d577ffc2624ff44e86ec65110bca5500eefec6aa820b66bec3eefb3aed67c232084ef2b9e960f525420b98457fbd30c5baca7ef1ee9bdec4c0ba8d8bbe17543db25c006711141753427a88abaaf04a60c71fc26af6bb132a16abc2f722b3edb105c283c3ddb3990f95af04071b9dc81bbebbd559c6fcde03e05ccfb34e470d7ad338c3a9ce7449f8c12d4fc97368ee96ecca98d578929c49c6eba53bc0862c4e42d7c53c01e071e4308b02407df3ebf9d15ec24386d0e2f0d4f54c04016a4c3299307e7ff9602d364413494b877fd87055f7064413e63cc338eae36b31a1c3b2d4e35064913f1896142d3128388bf95893d15ce2917237f1b847c8581635cbd014ea19a70f185ec85", "b2c2faf39c2f6cc65921a5e9c6bbc440d8015d86c7317505f0459c823c232f207192da57ad3b9e635ed5807e78497ceb904d3bc3792ce344befee763f8fe6b2409f7e3ce2172240e667c509944ae88872ef49f1728b6755d88d82100b19a3807a1eaad1c8ce848fe8f9edfdc381f4b6c0155bb54696ada543b050ae4868bc03ccf3dd10674e2e0ae4643d134d619f337431ea367ec7545917a5c807d0fb1c936a10ab11ac208a509dd45c4909316945922e9cf9643f375376fbc322daf57733708f4b3999974c431e84ad05c715cac0939d1540439f118372f461d7116e35cc1cdfbe05468f75c332ff98df9bd6df8140d4038558271d54a08d66950587d5c4b6a6b4b21c451513430e968abde4867e71a56f333e0ad03d87c9f859a3f8033d7f7b7e9bd30e0a76ee3943c0ab9845dbd1285464620fe7794df2ee0f46c8b6a2797605e0807d113bd8918b87945d7d01101ee633e041b028ce6b35033b08408a0252db608a9f8032b618520c77d8fbb9e30d26d76a8ed20a64bce6bcad3dc28626ac61db63fd339d3b137ef44fe7ffc86", "8b5985bb1084533ccb9cb8203e4147275c84d2c0173adab7b56e18faa59b609ab58e944abef8c290fd636b4d176a29c98a0dead3b6630bad90fd7ccac91b5aa50356206c3925aee66964a323c1bc524fc39d1ae921b7b92038492f4626f4ad3a8043e2862fd0b241cb3188c0ff8a2db2c9b6c29680f4bdabba6a8f3909bbdb9f3fe58acb0eeaba612c1ccdadb1a77294450cd4840da7b599758e604e6c064419dc52b08809c126fa44201be3e9d110222a251b413d30eac418697959f13fa4b17fb1a13b1aa6b6bef3f1e1839193ad2f58671aabdd545a253747bea71c9cde96f3aa0692056f8f20d5530f61b4495f883bc67bfc08508ef329192cc6b39bd3daa513d5b446d918050770eb96e4cc84c7101baebbf287013ef4c23db29a73032642bd93dc231699f7409850ad99cd13de522f6f84e22c7b9a15404d55f06be2d56d6657ebb834b2fb1aaf49a9e3a9cf5540c2007b19ac240a4e33f529201af8c74c6504c1f3e6fcdc29b6134b0a7552f4", "a3e3554980399649c37ba350a0f330eb54833955c769f46aed3667ef3d3c1207ad45a43e42048fba52205e9158ef7a8aa518b7583860a9cff65fd26014666073b3f82e56fc3cf56bd317b0e4d0a52d413ff5903f873d93918b97b26858769bb982d1e495b6c86d418448035e1dc2a0725813dfce7f8f0ff0201e360d9ea9b8504f5d01e37156049a28ee519b3a4e3b525109900c107c34bfa7db5ecebf29837edf75d1ce93900e44e37257c8efb615296e81a7054616b5b113785d98435ad8bef9653caeecc37c79fd826ef047ba734f1c1a32c2ba5a0eafae4752c006d74697a059cb2e1b927af992ca657f05faea7c59a568365e864b1440a54ccc48ef57860b73e9af30c1f338c85c0b45ae6c792c207ab6b243bbdee1f9afda68db59ec9c51c1029271bb42efa1ba13e004d912a41243779c9e139f825b4118033edb59db25ba2f36931e19a873eae36a4a8fdda8"],
        ];

    for i in 0..TEST_KEY_INFOS.len() {
        let pk = PublicKey::from(
            &SecretKey::new(KEY_GEN_SEED.as_ref(), TEST_KEY_INFOS[i].as_ref())
                .expect("secret key generation failed"),
        );
        let gens = Generators::new(
            GLOBAL_BLIND_VALUE_GENERATOR_SEED,
            GLOBAL_SIG_DOMAIN_GENERATOR_SEED,
            GLOBAL_MESSAGE_GENERATOR_SEED,
            test_atts.len(),
        )
        .expect("generators creation failed");
        let signature = Signature::from_octets(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(
            signature
                .verify(&pk, Some(&HEADER), &gens, &test_atts)
                .unwrap(),
            true
        );
        // start with all hidden messages
        let mut proof_msgs: Vec<ProofMessage> = test_atts
            .iter()
            .map(|a| {
                ProofMessage::Hidden(HiddenMessage::ProofSpecificBlinding(*a))
            })
            .collect();

        let mut proof_values: Vec<String> = Vec::new();

        // Reveal 1 message at a time
        for j in 0..proof_msgs.len() {
            let mut pok = PokSignature::init_with_rng(
                &pk,
                &signature,
                Some(&HEADER),
                &gens,
                proof_msgs.as_slice(),
                &mut rng,
            )
            .expect("Signature PoK init failed");

            let challenge = pok
                .compute_challenge(&pk, Some(PRESENTATION_MESSAGE))
                .expect("Signature PoK challenge computation failed");

            let proof = pok
                .generate_proof(challenge)
                .expect("PoK proof generation failed");

            let expected_proof = hex::decode(expected_proofs[i][j]).expect(
                "expected
             proof test data decoding failed",
            );
            assert_eq!(proof.to_octets(), expected_proof);
            proof_values.push(hex::encode(proof.to_octets()));
            let mut revealed_msgs = Vec::new();
            for k in 0..j {
                revealed_msgs.push((k as usize, TEST_CLAIMS[k].to_vec()));
            }

            assert_eq!(
                verify_proof(BbsVerifyProofRequest {
                    public_key: pk.point_to_octets().to_vec(),
                    header: Some(HEADER.to_vec()),
                    presentation_message: Some(PRESENTATION_MESSAGE.to_vec()),
                    proof: proof.to_octets().to_vec(),
                    total_message_count: test_atts.len(),
                    messages: Some(revealed_msgs.as_slice().to_vec()),
                })
                .expect("proof verification failed"),
                true
            );
            proof_msgs[j] = ProofMessage::Revealed(test_atts[j]);
        }
        // println!("{:?},", proof_values);
    }
}
