use core::convert::TryFrom;
use digest::{ExtendableOutput, Update, XofReader};
use pairing_crypto::bls12_381::{
    bbs, Challenge, HiddenMessage, Message, PresentationMessage, ProofMessage,
};

const TEST_KEYS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const PRESENTATION_MESSAGE: &[u8; 20] = b"e8gxekZpmeZTU0VDL9MV";

const EXPECTED_SIGS: [&str; 7] = [
"b6fbba2938433819c56fcdd54622085a0c5c27234ce1653832dc372803c4cc9b076cc9d2addf0c53e8b532639465428e3e2b8316c42a79ce9b567655403b8fcb2d091c85441f95c9473317f05e8d1bc56309b322a467ceedda700da7d09cacd380a0058e0d5e580b6be8d02550865a2b",
"a5582c36299070118196b12cfc11adfb99dba1609ab6a4008adf77e460308a014bf2ded471a7cca533d3b3ec5eca933c2fe0d510be050a7ae6ecf22c7ea115c48f554a72b784a52200878edd75352dc1056e1911d001e0fee08a6089e0fc6dd15ba81a525345c2e0054289ed34b020e7",
"ae2df35f3ff0256735fa4a43b9f303a920e9a09e5e02028297e97ae9d487fa73266d6dc3f975742a3a19f4ac31a1ae1a666b00b4774105c276f23a70ef8e0087c0746a4c8953cb9a9e32f2ba45c3eeb32bf682419f2dc9e1c8fabaf9e833266aad4dce473d70631daeecf4bf641acb24",
"b9e4676b356a24f353bd30acdd0789b9f56861f34e1486cce7ec506b2fa853a2009dae6b99b4cf1973dfa6bdb16d07c3635867cc1a80fc1653cbd7dbbb5b74694c212bf2368921ba4a967af65bd516f46f691d278b0911d007f5ef46856b3789661276468896f635153952ca63a6ca09",
"8164165f59425877b49944e0dcd86dd966b86d68f3c4cb8da9469d57bff0d410c0eb5e16036e70132446f7b7701995594a8153a5d313f6628c9b132a8b4470609aca62762307a5d31a82117503bd78280e392d7397ab0481131d12d4bcbb49aba9c943500e4c6d96a39c33de19c97e16",
"97934727401b6847f9ec5e703dad99a74fee2adc56ef0bf3480ea221db4d6e997325276668a4518103648f569fc3594535936e98f0dc801c6206a228dde9d75134a7c7ef44f7456e71a1ad82f152ff9006b7d02001a8f874f8850e22fc2d88df26e0cff07859c856a7b63137cc3dcd26",
"8c2edadebc6f8324f416904b72914e2cfe403836efd5d9c7b1c58488f58063e324d6e08560937f56c41739abff1f779d22fcf8b677b3bd365a5cb69fa91478cfdf9602f11b2674992f79e0143ad84bf34b3c993c9979c43abfc45fd59415fd538839890258b676e0690bfc18d1cb1340",
];

#[test]
fn signing() {
    // TODO these test vectors need to be swapped to use the correct secret key
    use pairing_crypto::bls12_381::bls::SECRET_KEY_SALT;

    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b))
        .collect::<Vec<Message>>();

    for i in 0..TEST_KEYS.len() {
        let sk_opt = bbs::SecretKey::new(SECRET_KEY_SALT, Some(TEST_KEYS[i].to_vec()));
        assert!(sk_opt.is_some());
        let sk = sk_opt.unwrap();
        let pk = bbs::PublicKey::from(&sk);
        let gens = bbs::MessageGenerators::from_public_key(pk, test_atts.len());
        let sig_res = bbs::Signature::new(&sk, &gens, &test_atts);
        assert!(sig_res.is_ok());

        let sig = sig_res.unwrap();
        let cte_sig = bbs::Signature::from_bytes(
            &<[u8; bbs::Signature::BYTES]>::try_from(hex::decode(EXPECTED_SIGS[i]).unwrap())
                .unwrap(),
        );
        let e_sig = cte_sig.unwrap();
        assert_eq!(sig, e_sig);
    }
}

#[test]
fn proofs() {
    // TODO these test vectors need to be swapped to use the correct secret key
    use pairing_crypto::bls12_381::bbs::*;
    use pairing_crypto::bls12_381::bls::SECRET_KEY_SALT;
    use pairing_crypto::MockRng;
    use rand::SeedableRng;
    let mut rng = MockRng::from_seed([1u8; 16]);
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b))
        .collect::<Vec<Message>>();

    let expected_proofs = [
        ["823a7608249606f116e167960de09cc998ec51f2eaaf4ed72b8e9f4c2eb9bef6df41a29764b726fc1b15510f4ad922ae8bfedfccd815fc7501a1bc973d0e70295b3ace3bbdeb03ad4a3e3e242694379c5c678ffca1f05d098e6dadf675ec1adc85d5577ce30ef56f0db4e71bdeaf5577b952becdba4293d0fdad9750102fcf92c68b64c5f92a4f8ab52a5aa6b4043f9830a330526245060b720e9503eeb9e9a492f53e1f85ba3803901ee1db99b9c44853309451b8dbd8223372d2be903d71d4a358d4ea81b7e4d4d6644e75c693e32f2a3404185c0501e7e335b92d20f2b9aa5108bd90eca7c46becdea5e3f3f270643f1a444b35d71d31b47483ddb00f368f61b76ddc428ff0184e18e2439deba7180bf990add812d35d58b76c996fd6609d9d1a2884db7bca39633b96f7468286624fc302f149c245bfe2cec23026fadafb3cc48216f47c423b9c9c34d58562707a455f712e909b5662731b8f11cc7bb7ca6c397ff8006ec7b217c48d25fd7d7bfd1b01f672fd1d59272b7004373d9bd78069a37439b9c79be9f874c94e541ef9745e7be8757d16d0726feffae16009b566bec3e649b2d6426b1f04ce9ecbf847606e829e3b1d4889069ef2721995f80bd590474cbac35b6cddd0c888cdfecadbe76678f284a9b185298a95753d0ffc0853e170668a716a49fe34c17e1b18d4f65a", "83a4d06385e6e729307863688e2123d61cb29feb25c8399a6818fd4f8fa417790d0ce24d77258faabc7492507a9dd97882a9d0cb64e8b881d46e5b7b363e4c2975cc95dacbe7e78e7594b5524b6920de04a06b7c198331727c28d8348ceaebb386b0acaa0e9212123a26694cbc0247831cad3188dec719ffb133129f1cb71282f57d8c1788e8bf417a99e31764273f6b20a158522d74b2517cefc643ff0535c98227f90aae2a569d6fdd2df53d98c20f6dc1e21ae3c40a9d91aa1243e3b1a5add6e426f090185938d5c8871f7ea5200f351092f10caca02cfdec33f4a60a9d4a8b21221e50aa6c8e82a6b1288bac95ff0c11e65b6fb4256ab8f3b75a4c3478706703e0895ee8656d5a2254e9f07f2027030014ba2f7558b23b02cade0d92fa59aca5d7965175da508bfaeb1a5c9ca716187379aee0093d0c6add9dbfa55d9fa540cba6bf903596ea01afd2fbadb36375342d4bd81c58920ca0a3f9158df277d65408110b5af9e36affcf0cc453c991462d1b1b02185c195e4bd102f9265c50f403e46f3391ac9ee5e511868a0cd22d4141d80f0b2ad1c4947196cc6bb7be7c1b32b515015469b6f384f840d713fbb8135a97e0bb6e0c712a773e6de04252fcbe0f9c5000ab6ec8b053362db75b7a531c", "b16200e66dae61e3ce920b48ee7afeada6abf665dd76131e59215e7f4fe0c66c8be1d03cb13914f946aa23d0f3074d2fb21a7f7193635ea5c8e7f20519b63d8111a50ef684fd07e00d0ce76a7a10e2854d8728eef1deb60ae748d582a1bf460994978760c93f40e6ada6a1e6d00631122c62a38989a54a562ded035cb82d4b78804f06e9a614b2f5c4591936e2624b641a684727350f6df169539bdadab80d296d494fc794b55f06813b940e9ed74479479aaa6fbaff54367d5581ae74e086284eef4a9e5947f87e17a3db3c27d9992c0f274421532e09e7b8afacd909a283b6e543a1d47cd98fe0df6233be992d8594360be6773781fb4e95a9f114a810489363cb58d5e0a6412bad388e6f80ff05204478f4047781c3060f88ca171acfebea78078ea0e29d93ff49865fb7095a633315c2214b5365cdf2d60ec93233055b11e7d9f79cbef1b2664fc2187ac511abae3b846f3dd99ca01378e9c8a3900f2d7719194c0f5befe331c42a0e25bc9169042dee50a28a6be5d9afac5cd42559f86a675fab22f0b3d7337e6b0fe20866a04d73322bfd3c79674899b7a5ab9db1aefe23893f23ec50d0f80ff9680639a1d31a", "a6b10714a7013df7d1bb50a87161e5b0269ed04af029719bcf3533e16b7baea315d0e06c20473badfd17424fe4c4457c8e56a48bf475884a247e4570d2d77ac874631de23ddf0b3fd923428f43bedeb0b50c64aa2b46bfdc3d56baaa5bead7a3a0b665acac23a67f61adc24b5c948b0c4653dff38193bb1a6f5a94a3dd50efb0cf32dee1dba60c29f27d5492b7aac41f18d1ac3c54c4e68d25e245d0609a065e2210979ad5bb5cb9ec3fbda10449a7023bfc4d1790fe62a215cecd82ed636ae99bf99ebd708ede848c64dbd1e96b4c7c2672f4aa9feade7801d9cfc6798cf4282c1556c84ed75eb211c010d89db82e905c17cf946b06bd4ff0e5085faddbb44f04906c4d68bc088235fa96b31eb893b12311081059a5dfb419fa984563ee36c39d16abd44062c29a87c15e4aa2a6d85055a1ac68e44eb05f3efe17bc6ed568986d1b43301f47a2ba3a283a3165bd4b3b24f66e67cde5aed0ca4075a4b9d0684b9fe19eaa6597a986554f5a9d26296c4a581201c4c8da05cd8e957c2b7c12be19b9c596c2a51dd1f3706b1c96f30ff008", "8f2abaa571e3bf363c9c4f308f23665b110134a153fd0631ee0d41968fc5ee4b87a4c00d0ee017c0eb446cd72f5df8938a36969710948b9bfc2d209869ad090f90de5197c4271b1cca32b5a7366de38e3e186663873dbcfd419ccf3808914bd4ae724b8acf058c298aa7680beee901cb842109ac3a3b8f5d29844acad4ea920dabcc28666accc1148cfc1778271f093f1a162cd73b8c8664a384a6bef6a584445aad61aeafb1e7155745bc6686662913297332c4a082344cc923db219e07d5cfa9c8c5d201e2ba20c59509a15456e80622a8e9d671778a3300d28c8ff0b0af0b99218865e35a8ca3461e388eb0f758776d363cf3e778f8918640aa3cca65e6968a3ceef098ff21eff4733cfbec109f92651b10bb1c6497b0c007a0424ccb697045b7eb0a5d541c9febe399a74673686a43a45830e6598883dc67f701e826f5ff5a781a0788f00beb6ea6b3aea289126e6c785bb3cac9ffcd591ace074462c9b2a1c39b87eaabf6eff2cc5a490a679ab9", "a31e715c12863c386fdaec598dc713bd5c6bf9d88fcdfee5a65d1782810a6b01ca3b95d74f98f80cfd9f68fa4d38736893606d101dd227e55ed0e8579bcd2ce213a4759a3cfa923ba2b1a31c3caef193e1080bc54fb61a8fa1f07a740a933e4bab05bf250552b440f76a57965cb9eb0ba277afa4d7073c08924bd538eaee583744b4b478c798a583c2617d131bedf1fe0b03cce99f549b9b8de44dcdca4bd2c121fc7587d48347436e61ed61a77ea74b32fe5d6c78fb3d9555bf69f8d5d0222e5136b2940215a1c34132e7341021eb501ccc86861f64840b0cf5b2bcd16f3af4f67c4388055ddb095ebbc8f47881d6510672f817ac8323be2e00929497596294b0a7302f500e6d878613ab003ef71ea763a405c4a18d41512057ee1fe0c0f2ba7886327bfc271b36b3ad79a6ebbf1f3f2055417d59b31f500a2323b2f486b8c4d3c5aab4a2faea7fb7e3266c7f352801"],
        ["b0ce8741fe11d06814d66093f880049f1c7f2da90f6e0ac11ea22bd4549aa02f33e57d1c1d09e86e6a9f14cb10bb287da744b5cc799629f520daab546c667dc606741a7dd22e8db3d5eb655bd7e4cd2b71e4a4e2f41b11712d9762466b36bfbc8d6a99ce85071abc8271a887250061fdf5889c18eab51c8602dda5ceff7eb3c1592cb198b2a3d5c16954f95e477929481e0775b60f73b40f57893506e1abf9eba66f792b2f707757c6f47ec3298f9f516b8e233117c970e4c5bcc80e13645ce3ed59053fcba41efbccd664eaad165b9b048e0afa2a1404b5f5a5f5b9045555c2062144cc68b71586b4c43dd10b225faa5b5482b98f16caf12e7d6eab1d15ddb64bb2a93a1ccf869ac06624dd4198d82907b8e38a14610af8cc18af6fbf2ad9e0a4194bbf935db1ff7a61bf122e7eca031218a6b2f635fe984f744e8722759e9c7f0e2f30d2fed2f90161cf105f60a5d42160d860d50652090443b95c001fc5422db528899fcb7a0365fdbd43f18e2cc126a7208f7d90435e838a6e47f72c550ad59f061c79b1ac41555ca12471e8eed32c3a0a878ccf53815de6dcfd51fb8621fc1cfafb9b539010a883229ca39d93c745fc8c36ce80b2cc48ecbe948637990a0be2d8519595009a98a34da92d2177300931be998c4bbf0eda13ca4f8b47f942d40bee2a360faf96749a766537a624e4", "b8f78e14e7a56188677e76d066fb624935bf147b0e4a9d1c51ac0fd433dcaf144d4482df429b4dfd238ed8392526fa5c845a3751395325cbe503e7d54435b2aad20cf9d4979f9e55c2aa41178174d697da144ac1f6621772f2caed8f180f9e8aaa34c7db06c1468d368a22029b32e0140e4315bf1bfd7df1b0222c696b1fd5346d9d4f352a1d3037c6a0a1358b13d0770f32625069f60d54cffc5ce324189c14365ed960184f2e8a36cf37a4446562cd2bef6dfa55e3fde7b7fec25e288a51bda3d5d484b1a966bff1953d6a16b5b29f5cc325f29dd5ab2f4569c968a92b1ef7762000af141a87819ce85eaa7905027e540624c7bf7cd1c87f4cfc251470538279008653e60f60ff5fffd5b1d8fa7b632d1bed60886a0ca27aa34363d599bc196bb614b2ca5abb4444efc60cd2216c7d54b8b64080481dca41136d2442e66a5bddaf4b8dba6d04d67b0da244d035cdfe23a952996137f08e02e7dc18395876019b6bcb4bfd03769d1e0d7f76513705ff652a4340d577b7c064af54578d30e38b43eda04ec9a9590226ee4454f1f6b2116239d829e65404f8b84e68666f6504f8acde3e9038b0b7a0308a96593d24d3392711ac1e234459ba50e24495ceecccbcee5cf05c3e8c6b31c08082557aa95e46", "8f6c64401033464cd58a8f31d9651f2f13628e0c4e22e144daed92c8d6d86026161d52c2b65511a1bbe63e2b91fbc40a97aa2eea36a13c1966a3878eb489919a873ab5b36428a8d268314be08b5d0e5cd85c4ac2c08b9fa477727cb100f74635a2afa7c82743251f643d3784a59182dead8d88d01447421a33fd704d6add3671d99a219aa3d82a3f5cc073bbb6f47dd82edbe5a126ab66476a54ec592cd1ac8c788ec2f4d229777e0c5cf0a9739319916bde088314ae1c7fee6fe06fb5b54f49f1946d73bf4302387617bb63c2080d6e40f4dccc33996497093d1dbc98f8269e064b5f48f5d4d62220ef5ebe82b8507e32829473c5f51a13ee687b55f82880e894c06cc392047d8042ba3409e31d500c49d54adb9ec838818bcba88f8f64794e152f10dbe858ee0cda7fa88a22c564a70daedc0a2112b685c9580a9fd0ed800527f75a8f21f05a44aaf9b6e17b9a31421b14f26bbbdce9a91aa0dbd58241a9dcad00bb5e7c6caac91529edf3601b53523a38c84df51c16935df46ee756a84a99c2bc5f2c0c2e48d254930dc307972d2b08041537badae65cbcee56b580191513cf898792aa0d0598fc47d00951148f70", "a6890def6b6d70e1361ed9ffdfcf77177963b445ab40c2a515b560e3884761c43629405b0f3e97c7b70af58ecd2a44aeac39946e4c077fc593ebd83fc2103c4591d5907c0571ea33e82228a44df4ded531141603e1d790d7bba8c73c7893aca1a33d33df89e1386e3ca3d7d467f72da9c2f6395122067b8d9ec01941901c04b17fb55bdf5378ad7eec9a06c11fd790300652cbe909533e06131a18f0f486b052771f5cb957bcac7236145a5d7dc07000364c8a61ddec608fd54fbb4939ae87c2fd6d2e38b51584c16bcde1546d71967e6d2ef8dc45670285422906475a1b53f634aedbea01baf5deaeb844f830a6488b3e7256dc84630ab3df1fd6b091d012e95e1866a1c4cb81c3f8d4fe16f22955854b804dde4dee7292623da18f236fe057406be3958c7f0508e9bb3d997b83480607d5890da58a7b7a67cd6dbbe0108f7a150714e839d720a5fe7b8995113a86d14c932ce092e5c38b629c4b2cd99eca9ac1a152abe5f3e0e6ed0a1bcf894e57ee608508e22bd1515b50731dc981f0ce97ff0bc6b08788ed4ba745196905f4ee11", "af707d724df04f49bce2eebb70dc9e4e7de272e73c5aa00dca614a41b2da2b1c0912c457619fed19cfce7fde86fb7609a1b437d51d3da255dd90e688456a00094c52ab5e63a009da8407713c3bfb38a866353446ee44132b3544781b98b4dba7881c9a15ead956bfc9bf97a71037edfb70b8f6bde431dbd8c86e0c468a72b0c91e84d39f81dafbcd9ab46003b25a746a11826cb51f0e362e770937ac504877f2daed61cb60deae43e6baaf80f83b158d6b6392328533ebaaf0c0efa18c6708746b6314ac0ac0c12005037ad795837ef11fcaae05bf993355ec826d1a292d3225d22f31a3da938ce462f90f2894e27416006a4b0d71b4535b7401345bad43ec411d564d359179c27f12e42ed234f687604cf4d2daa04b16e3380feb75e3bb39584cc4b5949c9d7dd276be07031bb1c604007cfe76c07d0a6f7897c218801bda19ffab5ba39c63ca62b9915bd8269e4c4d56b40b563a63d7d34120820d6680b7acdc1d8084e7e63424238a36ff1e44d536", "96aea7de925ba5977aafcda54b5388f5cd5fc36b4f6fb71eefebbbb71093e2b029b16a81bd330ecb0ed544d50d53db19930ab614a353f9692b56aac8a277bcd521a66996c32d16fbb36abdb859b075ce07bb30cfb3f8921ed01b8bf5838fb164a094f37e2a064bdff3535c53c6c18dfc4d48d6588c8b5754a00cda789d8e1216defedd665b54aae316ff91e322fddf4447854441d48396a151adc55afde778a94226ad59488272f31e132d0e8c7e5c8d3887c52f8885231170577e475d563750d581975efd0149af336f6c1333849d55284baab54fa2a93cd03d494e7c725bcbe24f00d17aef32963c3895f8d27bb40442a45b17f96fcc49339d1529d4bbc24f6bc203ce7d8c18e18b5a35d39afbbbdb3bfa07a5ee6434b60187fba3760b92524d68a7b2eac48c04e06b8463011b61ad077a9c7f0e6c6d121322af97d767e0d0e0d5ca2145a9057b42035cc635f6c68d"],
        ["85aa19bca1a5a854d220834b91d62180bbd59494b41c6e6773803de0c7927fb84acddb1e9ab1baff17ebfeeef349eed8b6d62e8e2f96329e123478805f727385655ab4ef45261da36551f8f7e60ec4779cc86d9e3c760b1bf2137d62e1df6bad95bd6ffe3ecad090cf0cfa31e76b6a6ad16d4a5481c71266104c148dee5935951dd0750384f068e88fb804f303bf27096d7421bf8be16dcb2a32f91dd63c1980a30c619c783739d66323dbfd9ce08f93366e0088dcb0540fa018d0c5a81b553b30fac839d8df6a6ca9d97f77d15528ff02fff2265d7eac70133cafa10fea780df0a67953ac023bc337f906ec400204657177b0528d6b0c349083af2e8e5fd243c56445bd04e607eddd5ac01bc3b364c859c05dc0d6ffe272242b87cc88ae89001df7d23c305ade6459e05473baae5ec257a190057e51fafa79caa638c3cf85e10232988877fb274eeec7a2f9fab3c0cc46f0e0050415df63b59bc7fc4e3c1728bdb187064184c571aca6348b2d786ec22299da29650f264e35b20db8e738e04893b78b455bca68e04ce09f51804ee0d211f8f9a0ee031f213dd3918d5067869e0ff234b42c9f3f705564ecc8b7ee51111cefbcd275e10ac03cc4a57a123963d85832d80ada39d4efe71905071a942a9942b99275c324a7cbe1f964c8977883baf92a2edf7f9876eb24cf0bcd31956e96", "80cf87fece8c172c8c0a0324b934ce7c1e0b839fa706e885eee18a28be08d80a6c2ae7e87b3d62d90bdd54a5eda47f0b8ec8a2f482de491810a9e7dcfd595229bba896b564c0454a53b3488a89960dd43703195b5ccaae82d241ae2a3ee21e4ea638687d075180e74787a520d3a6136aa3a89ef257e590a576d11aa14e98894ed883095b5757407ca049567483ba721043c327f5aca6d2ce4b6f0f5be2918bc7e611505a92b631f4119b3e9e5e3b9a901b3ebc01aa7ea0c6c6eef6ee7e76403d39236d5884e8be557e9b5b45142ce835002a3991e414b9d62eaa9224bf6197fb5a31bf13bfae4ddc3e36157eaf47cb544bd2dfd8b5156724027a1111ab9f883e9a9e78e57f75bc82442c21abbfe76ee66a35fd97331fbfea89d653ea28cfe8c9e62bd3e8ec81d5663a6177bfa29079fa489557ba49bba43a1547e677eea63b33d9fd302b15001d41b5485bd15c04dde8283d3526ad7a687a6466671a34bc75287a57d1f34dc34fab7ecfd796965f53a504104a0c15fc1b10f95db74b03ca069bfb06c58ea7c94321daf70dc74805036c240992fc5d9d90a35a1babd0267b719eadff109db9203d7978bc85f88f748c2266e80ee4cf68b28f7e5d77b87c16ae976b014ebae6100c49a26d86fefc63de59", "8c0bd0388bd35a681d7d8d8c399f8ed5554dfe4ea18ac99b39a55c86b5c5471e0b5bd05acfe1ea14df73c9e6f60587e3a51ec133283922bbd609e84a62617e85ba49d63d60e099588d6c04bd1939d28ee081f892217593bea77fd71020c191358295bf13c0a441679e4e456538ecf53b0d625206c1941944953797f64e227bd7081daf07437ca63493344b8fe6362043402cc32d14325c3c1c430872ac15fa04cc501f75067bd7d9296d226a312163bb15d38dfa982969b9b518f13d110011fe7c494c8c6d896e3f2c73c9aa548e743f67449101c5714ae784c9d46f2728a73e4afa406085379029a6ad1fd95d02d8bd384147b1c9115652b109b523686416027ca0399962a3876eeb7adf75bf68557b259bca4643876422b3a0dbcddb8bb984148b27c12ca7f652e48ad44cfc26a971130433f87510426090f2aeebbaf7b823f41767e89c6e78ea8810fb2df084197d4437861da2e2972976d6796f2d0631c0023aa5c032a94b8cb8718f62682fa82b19eddb26a2529d88dcc870abde386a4569f256663f226a570017d9c5d99589562756aed21d2e29037c83a64a67d787f0b440732d582b533279a52c9511d4e3f9", "b0db06478cc010d809872e0258f9ed5ba40984b32d03176257efd153b53dd05bcc79cd244e4463bd0f9be1d0d6315987af759ab4f26aa0f3dbea68c57d43642600d132258053eaf437331b079f8c2e2d1705bb3dbfe12d045fe8fb8adb1b2a4cb2eea51f3f1fb9f1bccb8b48160b13b9312bc26b3b3f28f2448dcee45b9b4a567528f18389be802e56b8f0fa06ccb2042f9de9cad8863b06d65b71eb7ab70dc067fa794f95c966002feb2848afa77f623c7177a817d367460c6f6e0e067e66d62f52bb9f4c34015a23a2d6e21f24c6651917e95a4865284421bb6349ac42b933e82024f1422f141feb902a6e921d3ada65f66677c195a1f15bb1ca3a6b17bca7ed23ede12454c8c792fbe0c88a63d3b833d31b8543080571b7da79d765d72a26c98c7eaea04e62536b345f03891f285b1c5333c026fbf677fb8a527f978001bfa57fb09a287da427dd64cf8232b174e5226bc4c93cb3843d4530b0ce8b112e300152635936c0adf57534f735869d4e156b10c064934c315c0e0d3ea5ca769e9408e2e63e278d1528fbb1a25b39fdb13d", "8a9fd9b593a0d27363182324734dd792f727a3699f95fa6d6b468e2fafcd9e8bc78cb1872e51ebe43e726f57797a4639a41196281babc892c8ed200cc9754119ba23cb2ac5699f3937b96184157b99d3a57154c730575502fff460c25a85ea3c85da7d32c23a821f87d2189950b9817716bd2e65ad8eb2d9563082dbe8b4f799b37a030280b573bed8f8595d2c81c973181de0e52afe4098f064f3b28448e60106895a7cf5a1955f98fd773867be0512463624c853d6354c13f8138acf2fd6886959652fa255012a16e9f28c7d46edfb6f60a8ff68142b84c7de4bb812e088032d27552959298b7b57750b12ffe9711432a00def25325af8937fe60a4e957dc98ed755ef2af697ff461b7aa96006330271a1021a5113a09f8d650584f85eae5a168fafb64ee0f8d9a6ef2cd66debef8a0cb12f3c6f8ec0c23520bfe2be8ddcdb9d4ed6c38843a798d745e9cf9470b08a0e43deaf00ef2b99a2dab4c90cbd852561997580cd09a583ee067d1303ba0aeb", "9334f75243aac596a84a09b5e9dfc534e3f407a325d9f4ac3a5f34a057ac6edf547254feb7ab9bde77305d2863e56bf0845e92dac40698e138eaf5d5e0d399fe469d826ab79ff9219b51c8ff917b0a9d7f5ac19f0e8ed5823fc16cca182610d5a467bcee582d0094cc7c4570c9a254f2d07dd116214b591ff1ea0411365e5f03747abbbc8b25dfa3e9f459e8984881695c39f3c4c8a915aa651f85d0868d31e5dfe281b61e3b6794be38d8cac83c7a104bdb9ae517b5946f7ca88c95de5a56deab858a023c79c65d74f5a17aa50428e71093bf9073d48b7757f866683dd1c25c6e17d10f76ce6668d2665ca2761cbab104bbe3cc365673cba36a298cfabdaee0f0ca748033f318e99894f6666deefc756201367d729116f43f7c9263f14a098c60f30ad21c769eb845a2a2b6cad0ce2f4010bd185598ab0566e5477a20f727f92f50fe2056672fa5e5dfbc4146366ec2"],
        ["adfe4d742a94d1d7042cae56a168b0c8fb743928cfac99223d2dcd3b4598d09f40b47dea73651f9ee2660ff6427645c99060f8ddfbce314ae4a97465a246ffdf5e37eca67ded37740d4041baab1bb646d90c65acc516540b9126556c9bdd76888c6fb8d6b4908190867b65c561f6410eeeaf89140430c5343dcdac19c5441e42cb92f9aa097389db240070a89d785334695749849ea849ed723dce1f6fe2cdce63fc66d305e30d73e5ded9739c9bab0273d7b8fa307a6c5b6f49253aaae2d720e04a954d50c82c3ecd0877a90867e022044da63884022730e8fac7e961a40857ca6f490bb21dba2f6a50ceeb7d5975bc1f8bd80e2e7e8bb3cf2d123323104ed24e1ffe4d5d7b4d672fbebe71cc0faa1c39882f8a3d5ff41b393580d328dc271d363dde691e58070861b07b78715ec4e323b65e8f484b4e852a8ee8d4e82280ae881276d972c962bc03792b74be0a9df26fbb720f6b7b844d6200ca57419c9d6461fe5ea8d98f02e7f3af57a3b1e3f7a4451d00eb9f629567393ba1dad4700efd5ba70453a48c7914bfb3be2d7e5b93a017da19feab0b378d1b5f0cbe20503f3aab3c41b2aaa3fff2dce2582906f01bb865924d4004d22a005cb5c0a6a047e7216dcb5747aa1a70b2aa29d97ac8fbfbf7332966a3f46407bac353f636af76f51d4297210362a6d3f9a23fa18a148da250", "b1dc361e076a12d9b2ac4c05dac063c64ee0a2eda403be764f917ced1b8cf04adf249eb3a3358aa80e4f0b4db19da38ca3cae60abec8ce299d7e79ca8bfaece4491954c75f461f116eea5429c54fd7c49c7560e4eb9ff2d97fddd503dedd3edb834283f94205f21dffd8a733bf5dbeea78bffb3d72b2eb3db540c33df0acbbe3808b85bc749784e7de6006ffb089e6e45131390bbfb4acd4a3f148b23660c11a3a8fb50932d6344e9b6d05d88ae8dbe2159e355956bc9de2abfb32863932688b90777e5a2d10977342cac6ab35a7d2fd5d3da0de4a7f89256c7cc94f1fde24624407ad1c772af72fa3721b48029f60a14f8118ed7f031576fe0a68c4036f114be45602909231148b6ac736726de5db285b0484d004570a0b4e871051d81fe1b33abce1e54f2967936891b316b58d30306a84d94761f31e5de284eecf3a3c3ba667e19bfeb386a693125fbcb8b679843e2b8924b17866362b0d61d2fc64a1df170caba1aabb416badcc44ba2e045239da48ece9d07edf00a14db4a023bfc09739e2885ec71a0c3a7a5665a81db3b8f1cc4e201c970ca5dc9cd82a6c99bf4a9bcda4035a83c2e868f988ab3176e1644b9a2700bebde0e0821197ef3987f51eac1939dc5bb69202d8b8a17bbc3f8ecd5a96", "afb1ceb4255268af04b84e4a7993b26ffad5ef4dca6bdf98ee09e2abb5f3531680f701601fee28a95d9aabbb51b1af768612db4a8aeb28cb478cfbc0781d70b7bd19fc0a15c35c86fee74553526e2b289c5a222845e32bc472faeeea2ee743f1b8d1a402278b9509fd9fb8f788a450a8c57c71b1696b43862ade9aac337f506175709080445651e6b2be2d7f9ac496e933f1c280f1a0d24163fe30cfe962e82408e9752639634cf514364f54702c944a0a833cdec87e8507a6a326b9f1e0a839d11a819af8d695d69a8d0dfa193a48f26c52318515dfd724f9794c0c7090c3052391aaf8e73d23ed03e46b8233b8c47c5b077e0c420d0ea3b7096f2f83b0303e31575a096762d48227b70fa2721bfcbf6169495be134204ff63a1fb84b970232e225bc9035b57eb38907e569edc3db47241bf1a52cb1dd8d8a3bdc393e3138fe4d60b21f57f3d8d004fa71a8dbbed98d264bfe231021a7b544ab1c64f672a75ca75b8b10fc802293d5a586465199bc9b05766f785c13875a47d064f541bbac9ff7cbd0d5a73be2c0cac1c1e9a9b8d74b360be87008e4b00e2cdb626531046a2a308ce2832c176b2535a355da8cd0384a", "ae84484575b3f28e37b2a47488c1e3a4a9e3cfec856e77d75ad52b5daabe0cd7703dd38f115729ece76c9037bd28f6ce80c7ebf9f99ba5e9f4f21e8ad4a307830eae97968477405eea26019f02442614c16ec8acb11cea419cd3af3c833f376b88d684e487897544a5dd79b777e72781dbe6f80e7f915f5e09a795373a9ec32d88b459e8ac1c6ab9cfd543b6eb094f66714043c3303ce7a9ef04e41c0a3f67e433d0eb4a97b2eb93bcbb72157a7a21634325ebe815dba78e71b52e7dd72c8b686adbcba3d7440c34cbea22e4f533a1c43bfa8ba12941df3dac9905c122ef69f77d855d60c8e7834d34d4f70d12eda1a06625242db2427e8ae316f1b4f02a6001815a31ce4e14350d8baf9adcdbb1aa4d0299be1743cd0bcc053499c249d1140368b1c24b6970fda6769e221c121e3b306375cea407a50f183acf3064ebea31eeb9ec63eef4649c3dab2b182031099f3b1e1b48f74985e1cc58461b7a8ca30e7801dc66071d8af9d9601cb78084b917b233bcc288b3e503f12af655e78e59135f273dba76d8f5a324fdeea77e5586827d", "b0349feb877b404c8e696ba31d0a6dbf407bb8953e48903e08c86ef5e8b3750f0079494657ec14c0c31b2199d45826b9b25bb9d7ae400a5cd4c11977231309ef5b121b7708dda2555f45f7c2e4fb422119f73afd1893bc1cccf7423dcad1b6fdaafb0dced232b7f6f7860dafb4622d1803daf5cd5e7f0216571f6be5de7dda3a203239da8447ca1ad0fdea57e48dbcc51cbdf691a41164caf905165a4a2ca0b664e6a1eb51b533e68c519e41773e96d1345feaff72022762f225d924b169f9998c2066f0e11dae75d1f15598be061edb6515248686a1e1a2c02040d0fc47bf0cb7393e098afcf57fcab98aa97372e5983e49867b841421fcb070442e5ebe2ae14403ce8118329ad5ab831e407647325749352c10870b21c946fad85d75cffc3b0e903d90174b09ee4a2c6d6e9b90c2ab592b2fd612e9671871f84578381926ce13f48dacd6c621f8fa2351a2652bddb845389e4babc4269c14ac70881b28406153b229ca99fb1f4d1a6d9661dec165a7", "874608ee1ee9f3e27b16d4f102c994a9e39858dc1e4aefb66d4741e680d25eacf3b589a559187a2fa02584912ba14248a38ac67daa2fb87bac042f52779bc3e39cb6896bf0ca818a448a9a58f176ca7fc7ea078682ec577f3cc9b151b33a754eb5219d4bda861ce281970410ee97985afdd475f68fa3e83bcce06f3f0471d51a73b8a33d3bf6b096886b2e54d37f74e32780afc74363cd0db720b634a5253c53cafbb2f1114b77ea8ea72b7a900bbd380b0a319654c4432eadb78952a30307c3cd58f0f89180c4f640c49fbfb54f09b7529db0fbccda47500d3d90683e38bbf3e3036e6b83a5084f5b73a647a7eeed4c0f904716f7a69f785fb97fae788407f6458576ff42d9fef1d414ba05001a1db36f068f209e2805d461dd02a422924b23c56a90b5de52b1566c59abf61ef0a4fc5492f11a651fab3a2b43763dc7f35b008407848e3601508c61f4d5221b73405b"],
        ["82bdb616a497895f7779c9abc64180bb30e813498f33986ed7d88df46bda7ff562fd95aae79bab27b8e80a372bdd6efd83fbc212acc03f274944bc761f7c0b1fbe000fdd65a459868b73d07d9992fd81c2854e5c48ed69281b11fdc2d6cfe09ea963c421772bdc31c1c83130470bc49560eff463de4015001c662bcaaf036721698d7024fa2afa8ccb428a991f21ea9e5e3652ade40f36aa41d567fea12202e4059b339b2f73f3f11a63fffb92d1faf82e218e3019e83dc0402a709c2eacd1914127cd77596b068cf512f210e34659f53899eb89daf1ccc6b62c2e4b0ee203eea18a78f0cf9c2946cfb8eba750e851360282a515a24f4c5fabb6a840c3b03d1367768dc8071ed827e846670e8d5f3c39030ce454e3255f12e7c9c0c0cc0400ec84fe141fa45519f4aff9199502df438c362321946e4a83f9fc94e85e31e8906f1098d3f46e31d94203632f8c619468805491168748701d4b1bf88927000886a25797785e0ceb873b730590743452a05725d488256cfa37552147837aae3c6e5a2cffcd10f378f0285416c1621f035fe4100b4c52fb1985bb007c953a787054aa9e662818175f877e6846eae4d4ef0cf720b18d0c4d1f16a636bc681e5b26d7cb52bb72a7329c6141ffcc2310ae4c93bb066355e8e82071d3121e2aa4d1c08d02aeef1f12a91dd42f5b5bab5566c48b39", "8a07ff385c60674abe9341b69d75865614c34f671bf94e583e0ef221c070782996efc4d159c270aec9bb3e3c97ea026d8660a53133b67b886fd645c80f1647d23818edc67b3fe51aa05332298b0b25a8acba6b732b1ea2aa5e20a599e3ea05898b52cfeba21cfdeda59bb67970d1b6a6ec231abde77aeacaa7a1d87183dbd580213cce39031b89698cd40fd65e4408d738971cb12e6b3c0fee6e5fe90144e1bfa163d85cb272c3f5ed8d16c068b9c2da65c2a32e9511c33f0b8b8b431c390c85e99ec0062b4270a9fd4fb99854297ff66614940549931831e3a4ee0181227f9a2163ca089fa3ed65da88dee6b4da5fce5e2ea6e8e67a20c165352e59a0428c3aa2205c82d1881af3001cd99ba8ef99443a5e04a5b2cd063077d62e4f5af6d40bd65619dc9ba23cffa360b3af140043c9503003f987ccb634fc340afab2ee0ffa00bccdc12a986a1006e6175347f79d20385158e7088c1922fbfe5b4883639d23e3ff812b114515b3745e3e9f450cb6ca463e3312255416ec9b2680f5657e879ca987c880a74d948142030e3779aaa5d72983a478595c7933162fe5d7da2ffec24ffe2b8ad7ca709b33f7d62065ec88c5240b910506052295bf248612974b7b1fea43fa9092ac1d1dbb71e412f3b33e11", "b9f2d2d5b21839f72a78a1e7306e978c34f8a3ce226bbf01d2f7cf070cb788532bec58f638318ca15602cd87427647acab11281a939f8ae64bf529df619f1e48d97130a52cdf4d065e68c99cdaa65274116c9875b10a96953ae908f23e0a83beb67621e728d8084beb9619f963375c6728f9b0f2ed4b555e1bc09ba4e123e8e4250f15119309442daa20f6993a5b87c24de5558560cbfadb09663d0a561da413d88707d220c26c340663b510378571e444d0afd3a9f31f06473fc19cf93836368717c34381db9855ddf3d4928d53d4690fd57a71db4845c54e6533997bf84ca478b72a46d639dfdfd1a0a38aaa2dcdd64a5d6475b7b05613ade92d720b9d5d13e6f0525203de43cfdd4350b6700ef1c70c609e2ef79891be0585d2eb5336d3710f2f4a5455dc286c7b0609ceec039b3c22d54afc03a4086b32a82b1123320959aacd5142e213300612edd773d0923baa70925f333d973a47ad04e1f1f38298c3f3b131a918fa9d72aaa78a5d87ae01fa1121796f80833bc24a1989bc49b9100aa338f049ded6598b79590f1ebaf79e7e1d3a703925c0a43bbcb67591394c3071c24313d980ab3d89f001e1f7ee62a766", "85fb843f6a85aeeaceba0b2e9ef8c08cac156ad37c75e8b2fa90f18423982dc757223a3a9faa1de700843286895f3111946d2ed25601d7ba04edf0e16384987d7fe0f09506fb871a414b0d49befbc16363bd1ed6663dc44287390db7040d66ed933f024a1939b4e3740f1f3ff96f3a4d032dda24ebb6d3aa1c6a549579f367d355f3d0b5e4a7d0509d2642fd547e5a7b5414597e19746aa4bf042cfa2f0aae2c5375e43d5f3ec036bc186cea463245551d624e83e6e8b753b7b03088ccc0ee56d0b65e60d749a073d8bd1d89609942d13520992fbd0f09c4dcfc299a01720a1819632fff65a901bdc9da6f7494c5860f108c10d71af228d7085fb929aca77055b62bc03b5f2a5d2e3e6d8645029a2fa45352991048488563e544108c25018326be99429e6a8094e004de672680ef113033897c847ba8f97e29cc4c1daa37bd91c19bf1751016645fe0556b819231d82c609d799467644171fc845033bee7540da93b007fade61629ebac75b965feff1c3137961d58f84c602de490cc626aa056cee760c852db1be32cbf1ec2c82bc530", "98be1f85d195f13dabe2847004fc6a3554b8a8f65878f1930875c0707e5f564bc0c943ae828d0ab668521851bd73e5d7afc2d54e58ea6675ee64b892e1172439431c8a121759b85680ce4a83d391730237059cba5968d8c7f59f87a630eb4acc8b53cfc02a61e3f8175804aba62c36a48572f3658a60732df05936a37a6dcfff6e7538d163ffab46f10167a4e68848851dc2e94fa0d5f03e5eb313a7cbb19b1da813a625474cdae5148cb3242b9b70a10468695860c9f0acf020d007191266db470fd1ede67b17f875dd3e4ca4864381007eb473e95b606a97c8ea7641d0bd7f53559f2e48616a9390b04f1727b57fe135cd6c0b1bc0350079f0d2f55a644fca059c3893ee302e4ba4dac70a74c5b97b2c9ab949ccdf93fc01740b1fad00ef6d32a73776dfee504bf5ccfa7a5bb0e71b597eb197d721dab76a4eac4f4a547bb4213d9d58c6e333537773161606ff03970a7a64a184b9681b0272dfe0d1c559889b165392281e3972d6e1e5beb4c73944", "a3ecd77ca11e2c875ccac010295d74be8fa71dbbf956279fca4d813c64df8756e608d299ffb17ed5472cd17aca9081e783f4ede52ef5dc1e82965b501d1b914d98d2ad0c545643402f6c7a9b9684ab61ba4bc05b198058dca4cdd6193bddd5e7b0dd827f6fb31d812666752a0848e89c21f7bea087f681266d2ad15d89f42b19aba4cae5d17afd0be2916ccecae7269e1251d2e2a1f1672a0897b5241cccf047a8746e0214a00bad077f424e6a81bf1f28ee8a6c49cc3c1adb45ad152329f1918172afa82a5bfc0c40d6e691247570384045d0336c351aeda8cbe42c8ce2707baca771783b343c960f9cea85d413e7d20ed93fe07de89e4df3aa5efb76b42d5c8f5de737bb08e8971e207c2aa4d9d22c0d4cdad0abf069df635e1e180f9ba6850d0becd5134fee8f8c1baeae3dd2f1ce40a9d851f07fb10ecd6c4b5755d7d8c8d080a9e3fe0d763e722d00edf1afcc4b"],
        ["8567c544947b6e40b5110fd5519508432b8af8e4783b6aa704058cab7cc7c3e7bf35a868ea57795fb698acd5a506c4dda92b492a68c765ca34b6b55e0b0a99637ee34e81ebf034b6654300f0884cd982cda47c185d2c617bea3f736ae45b26c49404867ec0f538490978f29419ad9d9cb75b8f1bb9ae249db08a7b7d66d69b9b30d7ed5fc51f856d62ca003ebb99ccfd4833a7fc95ad4fa460b41406a1030ad5c283bd569c1e3547dd9bb0fc8156cfde6bda6a7dbca8415906359e9b4d7d65ca5afef4e906b2b5c6501dd5132fec422d1fc912c4d9fa84a9a761064133e20d18a8146d83a9ea36d8baec16f2525c703709c0cf4cb8d97eac503dfa6c12786e31fbdfb6eda629476598aae8d6fae2bbc53d9ee26adc10c29a458939b4855c56249e9b7ad169d76bf9a0995149ffbab9b11b58d1499d9d690e0cb745142cce747158ee81d7e2136b86aa43af81f1663fc968b854af89f11cba6eff3e3fd0e3e265f82509670e14b569abbd4845499920b52dca70fdebcd9faee06b50895fd0f59664aaea3f0e9093aa4efd68da47f40e9654d9a215249f355b249b73a81d50126c6a2af41445ade983de9268dad7e292541d47264d32db28760ce1648e5108a2a8f0abe319a54fd45e5021c7139ae107860dd3b8f43a9448d4f413f019c7c400347e01ad6f2b30811a7b5f56db058de1e4", "963877b6cf2ad5bd4979fd38c779ec28c43b3405ca776436ed49ebbad228a4723b50b18bf813b2f923cd5f65daa71a1c86649f69557cba9383d95062587022fcec080ee4412e72ee0e8a5e1824c11807952e4f62261450d962a6e64df33e2212a76b8d01b112dda93f05213bf968ebe67d4d5fcdc002bb79fabdf2ea10f17ade8b036b1751b1d48a5599dcc0d9d6924b11a1513035f0c2405fdae79267a303c61c153b1eec19b6651b10357b0766c8464228f24f1ca93095c407e4249621a8230c21cddb73df73853807dde9e4d70e3b5f4c2243f94232911afde2a5fab6b0834f90e071027ff21a0c24cc6f2263e3e628754e5578191c947ee1e8169b5db4da5f68101b20509fd06b767de288d6b7325732997ac85374adf102e5fda18f6a97de752f74f453345a9d469ea1ac5e898617db839d5710d488247e10e8b23aa634f251bb3405f4585b0af92e47d4fa7a3a08d97754c99e0a622ea9a90d96cbae380e080238aece975ec1b30463f3b3d82f6254820051bf809196dc6d39ae1bffdc80699646d96f62a3067cd7fc2311a928049f53638169dbe3a7da2f0a42f98479435dfed5cd1621940739932bf2bd789f295f22134200464dda7860fdf2a542d9401b6b3b5b00ed24855ecf4b2692b25b", "97e774925278941d9748f1d824620d6dc16bbd4f1722049c0420bcd3fcf3d42d0c6e00918533fd2b38feec3572e0562ea2c2fa780f98681b3de857625e1eac71a186e2fd36d0e8aff1ddd2124b18e2cad18d6eb0ad3ce7ee2b24ad8bf40cbfbd856985188ad25110acb352502088c34a06295c87ec59db0cb29092222550a622d7e25b2d41f07db99f6bd0c7fb42423268394ea02440afe89dc429bf7deb345f9f696f741c13375238b3e302a8f4901e31b720c1a552277f7407202f73a4ed8cbc8fcf8917df63e07503f8e9ef8f61eb043c119d9ef87446e1841fd3398b00b653b7c838a6bdc94329c5510457d11c6c40f0efe642e01c29688aedf2d0805f158cc431ce4a0921ce3f85a18ce5e6271c20e0a01e79847e40d157f3428bac22669fc3392fd4f3b58327da477aa0b79b0e20c2fae1178152c9e7ecb5269f850786c0e0b9d68ef0f860ab734294d9578b9150422258758c919caa978c1b18030750f88beca911785e0992cfe3f650d138cb2e0eb370f9a1086e8b55c6301f19bb5deddf59c139c627097f289c6c2752ac8133e31246b640146a148b461afa472a36625a637701d31aa81a5c90bdc7b16a29", "a3d12b550bb620d6dbf78284a926b1ea1424c639ecf44bb51cb4715be051a5999eee7c9f2e163202ccd44d08598f0d398b0e248d061fdbdadb5fb321ac288539f6026f03d39dd0e69e56fecf859df6c79cbcdcd258a81639079e1ab9683101d392990668bf31f156b3d2b96d3079351d4b9fd27839b383f694a5d91f2c4cfbb675fd878d55350600e27dbf97cb506cda41cbf844c21bdfced2adfd5cba76f3c05036db0ba328d2497dd9ff2cb1967b162164f8340eabe65ffafcc25788b160017fa60a5a411862abf13415181fc9b8e06bed03d360088266f4c4dece397a1e3df99eb74e8e3c885782550fcd533961fc4e7a43b058d450174017494c0029efd401db0e0a1cabb188cf51e76f261e971d272d35c4b63f6a49378d634052a71ad251a3e6ea1f1f8faf882ab0e0ef0c0b3d199ec1a403972b07b05778ea470fb8597a1d9f0c62d24374bcb9fa32dacc602b5bf8ae491349335fe98c496707e89c3236b7e335638cb8e8c2d848b6f5dd01c443b4872d0a936e5fa6b7cff6ffab24c10e7bc9b1bc860c71b6d2b3e9dd5ce96d", "a947388509fe550002ca485435ff578762c24f7ac6e47f62206e3ec5f67bb06f37f0f8f36976eaa1b94eca0c7491bd6e8cd92f6eb3bfbe8c8a0710c284876d1654d22a2fa46f6b8ea58714a776cb6edd4c87725d903ee1de1bdc85b7cd56ab05a7223fba32039dc3d487a557d0fc732b88f0fda091ae81a58cd0d9884498010cf254d4a558b2ad66b1363423e247216870e73a85f80bf31a4b00fff6a84443b2d677bc760043b0d166017288c2bf616e2a91b02a7da10844aa74b19f82898694e43403976ba2917837a9cd57a0ff242d6bae7f7ead000e60876d056c10d956c60bc7a0a6145dfc50c18ed68feb29e19f730863477eb4ded1bc1497352947ea629fe1a45db66a7cee6e7f1ba853290a00280059666bd6d912adafd428307031d72c0a7fa5decfc751aba2afb61bc64f3b18d556c3741ea770bce6107996a93f6d2a63d924f4c3572676d15ef23068ab2d234a8599051fa089e566dbc8b87fab0db5678846e5d39214eb0b20fb24ae6403", "a6c412ae8eb1b85bc5181f61dee64d28092b8f4bffff8813a60168d9c9b74e640f16ee5a1680db7d796046136d5ea98292b404be4d02fdb8789b99fa1067ae18baffe51b24b911f1684ef513e5949d86eb830eea072ee8de433f12f3fe114d6bb5a52d432d06b59c8e5186a6cd7e72627189158210d302b7dad82cfd4232769242ccae607056e43d0b1a57dc60b0069a0e70d755979766b34743af8b903d654287eecb2a9ae37982c0f720cf2bd2864a3098dc5e0adf7b5000df5efaeffff7bb7998503152d560d952d1d8e9ab6ed642636bd8d53f6ad721573eb528658ec775a1e7cf31820ade85433a3f3b06b0d3b4294885ab4bfea0c9e2728bc000145021a19bf989c9773ed4a458987af7118be84e806ff75e644e62c14677be7c152ec4bdc91cbe97f5f75cffae6cc11eba90ce2086f6f74736027fa76fa2fa45e8cadde072f3312d5a5cdeea4183c9418020b5"],
        ["b57206a3a482892f7f25f8f31e27881ac0a5c4562a88233fc94c30f770c5e663035fa229d9775eff9544bac73cde319e9384bb29714abbf425058f9cfc73f0ea55be3b7a26074f99c8cb44f1004f2e81cd2ff39a3a80bd5ebf4c83018145009994b2be33db072a57428c12b868d683fab118d095955a7bcc4e557e38b26a6f9b9ff7bf7f6db26cbeb7a3b4383797f510431192d1ad6b8c04303bf1a66ba60969604f744445c8a83041c1a3869e9d80a42e87d59562c0b18030781a5bbda6f8dd7970272cdef5460491daa801b62f651a4c63ee0529f57f183702875883949e499e7bd4fb233713175ca3fc49c764b4933217020f6e012c460ce125d4f653aef60709d0cbb95eb4de78f449c423e1faae44a8269b0b8ea445727792a62cdc3c35903cd9a8219ec541e9b8163c67e927cb22249e9aa0d1b53cd3888b0c4fce3af9179a0cbdc67e17cbd79c6aba1ae129900da6e7494a012c044b5a1771414d7279c686e7cb8d2234bb3c56419a8815755c7299a1aba56b5ca9d365a9484546b9e5cc154cc9ad19ef71412f4f78a600b2463bed986e3979b393ab7d5c63f4e8a2f26f2d7b35010c565643362f97e818d26f1167c89c3ad6fc0cfbc7bb627fba6d3f7b134724143755bca2e645ed1d40521116bc985efaf67409d3d10794961d6760717472f0440f4e0069470dfe15ead3d0", "ac79c326da8055776583cf1bd292c76593a43393025f7acfcf7813861e93fc17124b17616e3d7139c900d190fb20bcc8b935aba9d14140c5c1e408467eb1659f6d1184ca87930d28147ca02354d5012f3157f4cef9aa5a89b7f996e94960c454b7715b0a78c127e0443499302108be5764b35c87418c65a27ab27d0151995eb2dfbd9d5b19ba638c563504b34120793d73480c97f0336783672d4e646b20317b4ae66170980950b22760bb8ebadcf720357881df20095e4b9de8ee060e9ef33a4d4f7e4a5aab5a629c224329797275c5008e8a95914aaa93b264c3e1f8820bf6e2bca53d70b2f9f706dacbc9e4546b753b1d0ecd814dd076535d934acc8528e33d31a5cf47369ccdd899127b6bf2dc5a1bd1a9dfd0308cf27766f87eeecfaddc6260ce1a87699ffc48208d218dc6b4401a3ff08ef94537a9c2a6a40bab351d87dd6e59952e1e5e5c487cbad93b25733340a607be73a90950c9c56dac95cbc0843f35e7f8bf2c996bb3b7b25ae7a203ce3c920fa35027ec0b42eadf0f029e0fdaa36f2b2a1d12993f1661eac207ce67d119c3d7cd17bcfdc9adcf3c5e5a20c9bf89da6117894f7b6fd0f3518e96a54104483f0247705be3d229f5afc0170d09580eb4b6126bd9970c79f95d27ba8e2f15", "870e1e8d3debaf6322169740cd0a54211be5df7571262e75cd650a10f3cc77904ecb3d6ec4a13113949489ace9d53e3b895ca26fb6fe0e7b68a91ff4d880d79ebb94f0f727e7e525a70de5d6c3c320d8539bf0e7eb7ac32568b0da9433fcd89081002fe82f407b1a25f9b38f101e5b4678a155aa0f8b03470e28c636aceed8c07d8e9b5215ecf87ff4cf5e8e27f0181d03cfd525b93adbd33012c549aad37a986b6e3ff4f514c9ecad69bca72374673256a6d4c7c06b00c74f009eab66a466d72222f110b74f5acefa39c983fa5bbfaa48effc277be2ac853b5b798ef521e0bf85c9164c51ff7022ae9f190dcf85520624382be895726e557ad87bd8f946c78e50a4c98d7369ea2fb16628b4235edfd9210e1944dfd064be1e931ca9b13f556bc5042f24059874b186deed7f0e552afb02c9867cf7af66878aeebb1b3194532e0a2422341cd38834d078ba63fe70a1a1248c0cfae50d9d066f7f69cfd85eba71b6b9fbd9b4c2663a56a97a0649b126333c84fa841a77c05219e6c6a64f46dc867f233cc627cbb33e01773dbcad1132977023468b8eae75dddf920d91b546ac616427e13b003f54434e4ce7fe326faeb6", "930db3c896ad19818d5a4159ae50a02264833c004a3f43160ada3ea7fb7e9809703014383b22e3c56b78d0d09d1a94ce822cbc7f9e8d1359dcd698ed42e442de066f7cf0fd62624ad81589d8b0be14cc63c5c9b82ac92b594d2b4d8da63164a2a2e0dad0803892a83c43053c17c7ae27ad721d55ac8f7563ba34a1d3100f210bae7b2d65e3ae45ea4d60ab0c5d9c4f0123ba1b8936a5e09a4bcb1fb107547fa4bd355111b3497478c3fa962196c458bc3b8a3e6ab464bffa1e883d5ee42895c15858b12f3aaab486039b7c7422b2546b152576a667298e03c74e52341415f158249e15377cd5d7660c499851a46196115fa8fc62190d598381ebb4ed7c93c9bbbefe638444b9f4bddecf6f43b671d06f68202e5c936fc6233974447beef693aede539efc01f6c4ca850d6d508e295ee4692f42da02b3aa5759918e780af3aed7c0b9e40caade57731967d71e1fae99be62c918375de8a75e67c7b50001e8f7b43efc22b9050d54111cd3534c1ed4f8713a5a5bddc9e629389034b4de5ae68039529589f7a757dbf04353bead05c68a9b", "a1f52e241bbfde0c2c968409449689f554286d6b504c56f7eb82f55d64723501fdaf3d3406efacd6306aceaec5511b92a0bf6de3a931d5b4e66416fc89d26f2d869e1c1b3a4291641f0fc939b0d025837c2697849e1dc81da49c53fc013e5336a9b848368e5347f134e51105b85563c4b5dd8a0b33bcf5e9e3831ff4d3c5848aa5e53c553b97cb5d5e848164fe8b053234bb030a0ce0acb73bd6f5cff48b58ec380c6cc4c429febf648a5eb29e18b7b7220adf9f1591d6f074191747cb7cf84ff16c466b4be43e3fea24185e21bfa1082c636e7bfecfe39013c5f859a94a00ed9414226d786aa8903f50b95eee30100d2976ae2d2a290d428f21fdca14fee6923b071b3120ad62afb9fc219920c5b1fb476035adf015774e27d6f3107cf18b2b2b5eb8cca29bb488f0688a9953803f72571f2b9fea547f6845aa76cb1b8fc508d157b931ab1c6f6163b1fa82d669c0ec0b79003a42fc99138ffbc0c132009be64a6c1a70ddee109ec1ad3f70e8b8bc2d", "8ed361d19da7953073dcbeabe785561c5caf185b6d24d65e2d93af2f3d296baf094f76dfe1b15af84a49970ebc79655ca7bc8984906d13117634e8e489db75c6ec9604ad194c27ea05cec9cff2c7da64c6a77cc078483ac70cbe76d35cb3625a98fd833b12277dc01ddcb2765ab5caec11b8ee26cf5f4048e4aa9e7f0784b9e5420dcdacd8d14e335fd37453b2d8722c234519d8b67c6697c4881f2c24e85feb50b4157fb0ca343f7516cd548b6cb09004bca5f2ebac8b5b7cf70e9cc3cba765372da6cb5c27c8d5a7cc6a859149154162924ced3c3d6d5366df08d419297987befb6270ba0feccb1c2969729b97f27941f5cfe02aa5a0db1bdb153f24c89754ade2bc45f1a70a58fd5a25a27f137a172ab59d8f8ec8043921443596732d9d58694233d671ca709b0d727a60e16a2dd344d4fc046fc5fa18752f8119a2f3ecf3e24692c221d4f74e32d7653f7d97066f"]
    ];
    // No presentation message
    let presentation_message = PresentationMessage::hash(PRESENTATION_MESSAGE);

    for i in 0..TEST_KEYS.len() {
        let pk = bbs::PublicKey::from(
            &bbs::SecretKey::new(SECRET_KEY_SALT, Some(TEST_KEYS[i].to_vec())).unwrap(),
        );
        let gens = bbs::MessageGenerators::from_public_key(pk, test_atts.len());
        let sig = bbs::Signature::from_bytes(
            &<[u8; bbs::Signature::BYTES]>::try_from(hex::decode(EXPECTED_SIGS[i]).unwrap())
                .unwrap(),
        )
        .unwrap();
        // start with all hidden messages
        let mut proof_msgs: Vec<ProofMessage> = test_atts
            .iter()
            .map(|a| ProofMessage::Hidden(HiddenMessage::ProofSpecificBlinding(*a)))
            .collect();

        let mut proof_values: Vec<String> = Vec::new();

        // Reveal 1 message at a time
        for j in 0..proof_msgs.len() {
            let res = bbs::PokSignature::init_with_rng(sig, &gens, proof_msgs.as_slice(), &mut rng);
            assert!(res.is_ok());
            let mut pok = res.unwrap();
            let mut hasher = sha3::Shake256::default();
            pok.add_proof_contribution(&mut hasher);
            hasher.update(presentation_message.to_bytes());
            let mut reader = hasher.finalize_xof();
            let mut data = [0u8; 48];
            reader.read(&mut data[..]);
            let challenge = Challenge::from_okm(&data);
            let res = pok.generate_proof(challenge);
            assert!(res.is_ok());

            let proof = res.unwrap();
            let e_proof = hex::decode(expected_proofs[i][j]).unwrap();
            proof_msgs[j] = ProofMessage::Revealed(test_atts[j]);
            proof_values.push(hex::encode(proof.to_bytes()));
            assert_eq!(proof.to_bytes(), e_proof);
            let mut revealed_msgs = Vec::new();
            for k in 0..j {
                revealed_msgs.push((k as usize, TEST_CLAIMS[k].to_vec()));
            }

            assert_eq!(
                verify_proof(BbsVerifyProofRequest {
                    public_key: pk.to_bytes().to_vec(),
                    presentation_message: PRESENTATION_MESSAGE.to_vec(),
                    proof: proof.to_bytes().to_vec(),
                    total_message_count: test_atts.len(),
                    messages: revealed_msgs.as_slice().to_vec()
                })
                .unwrap(),
                true
            );
        }
    }
}
