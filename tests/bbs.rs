use core::convert::TryFrom;
use digest::{ExtendableOutput, Update, XofReader};
use pairing_crypto::bbs::ciphersuites::bls12_381::{
    verify_proof,
    BbsVerifyProofRequest,
    Challenge,
    HiddenMessage,
    Message,
    MessageGenerators,
    PokSignature,
    PresentationMessage,
    ProofMessage,
    PublicKey,
    SecretKey,
    Signature,
    SECRET_KEY_SALT,
};

const TEST_KEYS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const PRESENTATION_MESSAGE: &[u8; 20] = b"e8gxekZpmeZTU0VDL9MV";

const EXPECTED_SIGS: [&str; 7] = [
"85950ae7395c3b13b9ba02524c4f9c03d669125bca9478ea89879f01a802583d83e994b2896ba3a4c4759d38e08177233f8a9320bfd3181e0f2daba9e5775c6972fc4623b82475e452962a52ebe083183e677d0f6228c0ef0dc7ce95346311832dd61805381e2a31fc03c18701756e4b",
"84fb205f9ee7db2c0be912bface041a703926cd86950e6779e7e8f741721e04481fe51a7ce1f69c542ecda66285743fc6fb1fdc721af339ea4899506409e36414425dc1d16fd6229cfbf22c025349ceb55deadb7be62457cd1dad9b86e678f87f64ba86f224504c2e14b853178d55606",
"9201e98e04e4ba30a1f730b415bcc5d1a346290be92a355772fee0e757e90a7e509731e79f9deda1eba0cc975a01991c17ce0ecb7d102fc1793b82efbbcf5a7d90cf4d5d26d3c755b0a6e0f78a0d2f415af0af5826e8d39031ff0ee4090739b53250599c38d5ceeedc50b97f729c4838",
"92d15c097b55266c08e6de7d54234973b6f63b8ec7baaadc3fd33ba27afe95f79eb4d724cd5803fed90bb807ac5df37d17b182bc244dbcf57724272da9291073069f32f627a5358ea67b457478597d1b724d9fff1680ca6f3d3e2ed4f1f5e844e11f6446392ee56c90cbcd06c299e483",
"888e31e15e1c87f0c4f08c582004e361088cdd9602de8435b6b6708c67976620be86b7e3302323b804c2a77729feaa675a3a0c501a7db1c84b5883169074b010c8752a4d58a8c2a36a89be6ac5e30ee417a8a594487b3ca13123c8a3480710ff0c9f675582763b32a291232f06031ee8",
"9552584a06233f1d5f1e4298c1e2dc7e8ec88b7d87c5541fe31bf84bbd637343de7066618f578073f0575e78531319ec7320bfa36a2782b3cb4a4bed2c370d54f2bfb4ad226fc4efba2bd2a4b5069da34185959574073cb1fc542e26b94807bd61eb805d50f30fa49ecef173c4eab172",
"8c8c4807b81d54c384bff4c230e91dc042bf9bef6f65d5e607d846ea14df47e7a8983d74a75f1a12219edc3087fc7beb46cb8d1712b0377fd6724e14b1886bc594025fc5b1804d5dfa2cbaab0453d79c123dd042c5ae67c83d9fa00936cc387445739a3d75daf1805aefc327ac57dadc",
];

#[test]
fn signing() {
    // TODO these test vectors need to be swapped to use the correct secret key

    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b))
        .collect::<Vec<Message>>();

    for i in 0..TEST_KEYS.len() {
        let sk_opt = SecretKey::new(SECRET_KEY_SALT, TEST_KEYS[i].to_vec());
        assert!(sk_opt.is_some());
        let sk = sk_opt.unwrap();
        let pk = PublicKey::from(&sk);
        let gens = MessageGenerators::from_public_key(pk, test_atts.len());
        let sig_res = Signature::new(&sk, &gens, &test_atts);
        assert!(sig_res.is_ok());

        let sig = sig_res.unwrap();
        let cte_sig = Signature::from_bytes(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).unwrap(),
            )
            .unwrap(),
        );
        let e_sig = cte_sig.unwrap();
        assert_eq!(sig, e_sig);
    }
}

#[test]
fn proofs() {
    // TODO these test vectors need to be swapped to use the correct secret key
    use pairing_crypto::MockRng;
    use rand::SeedableRng;
    let mut rng = MockRng::from_seed([1u8; 16]);
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b))
        .collect::<Vec<Message>>();

    let expected_proofs = [
        ["b4ae93a27e18921ec176810ebae3be00001699c5c5d2c26b2249b42c9ba86925a7bb5b005599c05daeab450dcf66157caffe14637ce8df51ca5ecc33b422b44934128787362b7d7d716ff7bb60ebf462f94a3bffdbc9f5a4435bfd63129aa2b5a38eaef875f90f28bb55d2deab54d69971d69b11b920992d6fbedcb6036fa2f2f491cf533a47949be480b957c32c5b146084f7e4ca23a2e8e24e5ce3e644121c8f4cbdd2d37c923194265d571860bd4945830c7ee4d48c2ec9064dd7e01475a6b2ff1e94b4315765e7314f7e2350421742d5081c08584595c1987756a854c39e9d273cfdb5d1e2f2e1f9fe7343717cb91f7b92c9c3422fe1ec1b10b622e90498ab1131e965ad32cda2cdbda302968ca347c9c605f14f27145ab0fb421a3cd13675389d8dde71fbf1f0673061dd40d1131a42f06cc0733409d1bced18b2903d63ee1bbc2fcbaca45a05577a88177ded9230f2b328254b5101674dfbb7f11622e16870770e7e7fa2fa0b3154e8d6c437b05d8f14403aefd4d96f5b25592efa80e528f2a9fd9a32bb3c97aba8fc825f69e04910dab4406c1bd8c06180af916a57f5b498da7179b0fa86ea851e41a5a318ba03d6172faaaae09d0bbb00cd1271eaf45f7522c3913ce769540deafcea9cdd431e3b550e75f809a6c32581edef2fa93ef63b336f2a037fa855c67c22d8a67fd0", "84ef99cc2b37a4fc09fba883fcacd5afaea97490da49fe50db54e4537fb6b2519231067ca9f0b37e1810362b0653268d908a2f46fe2684449a59f9fa37cf42d63cffc018510ae9f3c363c744d3268268b7b2e2a08916f9c7daba11e68ef7aab8abe555f25442ef403587aa1270400fd9be11f22007b3be1fb34382f3ca8d205371a7a41dce3c46f4e1e6b32bc8e154a125bdfd28d32bc1b5d86f6175a76f664b519aca91cf72da4cdf85b40698ccf876009dd29979f587cf2400a9ef42a4e8fb562bb5c54ab0068888b6101d877dc27a6a41a90115a3f551439ecf8171e3e931808da8c6e47145dab4cc475aca0e7daa71556293851300891d5ea43983f92c763fe397f719e758762aa12af1b01ae17362a4e39bd1fdd879ba3ef240fc85f296a336e159f797335c8964ade865d894553a6aba1e78038fa6670d3011870a1664f43a08961bcbddf1b5e9e088df00f9765abf0cffa57ee002a3bc6ce9472c7776d9ef08dce09a7dc9ddd17bc2ae07993a678cdd34ac2580364dd579a50a5174773bca4ea1b2469fe9386e11c67e975dc26b6c0b6f6fa4b023b364bd6db1ff3d011c4a9e2f75b8d034c3cdb4c84e7bbbc0094dcf92f59cf21010365d457d1257e86e135be11ec5f953dbfabd28c4407cb4", "b37de83296a4a44142222b3f07d54f183852c0ee09ad2490dd95c98ad834d1afb6206ccf5697bf57dfec7910b44172bba89aabe9003e758530ce2bba274b6d7f44697e66425e39626971342278aba6a70b125cfb714aec9644156e01f543d678a594e0725c03d3db32abe4046c9d2dab09d69d0d259908406da9e6020a08794f7d6f0684d55eccb6c046d22bf832c8b95a47a7fdfae1bf56916bf04d7dfb99b33533e3a26b5a501b4d979154de3fdd1902d394b18dc1b6a3aa4b4a39ed7301ab6fdd885361e19bdae77d0911f2bcc5ef009f2ee1aa0137a1f4d3fd9fa54a7ed1be90ac3ee81a9efd4d10b17d9b9dce8811350fc68e4d2cd0fa63d9d88bcf502f5dd33f3ab0b41e43b5bcd63a6c68fb6d6853fef0ebfa61212bb6858e82d7e633afd34d12263e442ad17b63026b7a7d882fa5630b42fe306b406cf334bafa1c9bce6a14ca634e3414147c73f2e1f98ca0683698e03e55ab5fa22f24e23f333fe7df153eac3db7b5b6b787a9e31c3715001036b8f8fd626593bc8f2b99511e83bc94d20e3e87936340d75d4b9ddabff6ac0704d0c4d49f9770461aa6b9f4d2ba2d6220ff8321075089793ba0bb1bcb2c08", "aabb7aa368caa0a43228a1c462f74550a92f9457c6b376bb92f24212406666713f99976b0482d2dd0571eac110aa340798dce946816ad8576bfc3ff7e0f9794ce0c052de6fe965b8653692af0cff096f81618d55ba5f14c2145bd152cb39b822aeeee844e4ec0f18836cedc61f97130287f8a0ed1be98ae250ebe2d0b83b2374d4268b13ea1eee02cde1ab8f699a800f175c88da8dc7c941c9edeab965f29904b715541483e464b3cec00a24050b8e9e53bbce948f56a2ad814b7ea0317570f17bba01819a293e75cabddeea6cd1d79513668ae4f8f71a03fb1d32b7de4280162b9004dd8d5e3a0f4eafbcd9267b83b85aebca7bab5eb13ade3edb3585a80c15babd04e2ccf70b188ce36bad6e7a45312358ad85ec478780777aa91333f2692e175832972a89554899d5e0545d1e321f312894d686df76730319f4cd57a70eecc82f9479a5343c8f271d30a7f4f5ccd31b09b054c4a2f8c44d09a4b35e14162193b6b0be927d00cc1a2332291db12d95642cd5d857107b02e3bffc262ff8f4550fae53183d88b42f1e58130df4092086", "b9be63c38b11d5bb37c6682f33e8d4e7c3fffe998ae55741603a3cf2dfccb924ead4f5d18f8443d9503b52011c46ad6585f0014b667655fcf9fb76216e1cfc25cf9b344ca47e62c27fba443ee43089e62925f2cfce22e6636951e75fa352798c85a092a6f13f8a9093aab7e7280de68ccdbbc57aa48b4701936c36bbaa292b0a9fa4a93c134d965854b4cd9f606dfdfc40481e9826c2288cdabde14c6ce6053edd46f69bad6bbe06943a6ff87cfb9bac580977d6229a55fa60764a41ea9982a33fbeabe0e0469e654038b01f5dbb9e6f41504664d473020693710b3469e2efbda402db08d0e09dff8a266178b048292a18b12cd6a8658f4e3bd6c71806d86e91efe5028970a462f8f738eda99b3d23d16733fef3feea6647e9291828fc129797ac17365c1d30a70777df2fd05eb234fb6211dc79c5f4d42dfa55a2a2f6ada45c3d3055c966fdd2e04ed8a20729aa14f25c573cb1ee38baa4688c392ddb2eaec9605f6b5e70fea6c30a377cb00c987e05", "b878e9376bac3959316078a72b3ee3497d23e8f73c4ee81aa8f6c58d404a81ff2f584f4f5225a636dab360fc0f180f30a5a866f4dc6a95cb347b0165a67eab55d1115fc75ef2495f32e96283d752e033cb3c8d9bacc4a5a1a569a755bba59e79aaee1adefd66e50c82b1de3899d882c8b69cf7b69f7a4c318c26db5a9394b9676b64378993307dc4e412c4053f11a88027bb03865ac514116a64cce272b23485f7a66661d1b061fa47332c8387a66a6467dd8663947256b5dd0b9f223e080b76a67d4358cb4f8cd9f7998245aa7db1d20df9ea4565150fe4421c8a7ca34380b37e5da2eb482d745051b814755539f202424944bf6b63d5b730132c629a95ab710bcd0f0cc42c50563a7228577a76e5866701441c198c7a817d749dc8ecf3e631ee9e6e2b2c1245594d2dee35b2275b8b04f3f7422f047e04e05d20a808ed73bacec1138ac7a5c7b723a9a542facf4907"],
        ["a935ed44f8af81a0a31031e48dabdf1bd317312de4b8ed5d5b496407ee190ea2fa2c4d072c314cbce2443f0fd42d53bc8274c879130f50d39132148f9b1ab24acc33c30aec1733248b81bc115b7cddf21674122dac7c0cd47c8c2d79e1a07f11855e51bf9f9c97a7bb4b6285fa421f8ae65eca5ffd9223e494ea36127f8973d1c9b766f1daee29e6f2200e728cef662f349820eac89a3a59fdb8b50cb07ba7dc37e624656387da0fd31dd6fc33370b8b65486d9a8c93e22828c6e01fb58f3f3cbccd62660d9131faad686c173337101a1440310435ae3a6662c4ddb1be3e0d57fc46b1b457a29c0a866925e6c424bf09132581b03be447c06fb05fc11c915b8e1859668a46f54567a46ee2472588d8c12b30e983011ea955195ce8541ab898e207dd0ac6f27fc87622ad8fb75221dcb8577756329d8ce8700fdb4f6d6d151f8f3eaee142eea877bf87c174e8046bb926140d5621210291a900f6ff12d0c3533a7074442a488b0b52465999dbf3a062852fcfdc79144b8db91560591d9b588c524d2bdd452f89bb00a81a01aebd2fb1714ba429e987a559c9bd057d14757acd70221c3fd2f3fdb19344c5bbfb78e7050f35a8b35696e19c58b70195bb19ae154b8deae466509d814ca0f783a51b5ba0d94094cfac317cacfebbbb6030dd36e77919ca3bb95f43156bf3df9c8b0a21891e", "90b62096e2e9feccd13b5b6e3c43e058483e96c9ad1f53f240ea4d4a03c90508bf7824197fc12376cf768a4ad001fb86ac461e664e50399c3c447d2850f8fc1a4f6c1049d06adb4d335f1bca4ba02b97d47499dd826eabc88ddefe577141fbc08876853b06038418a9fec4a2e1293e716f57e2ed212a8a8a11a8126704ee77cc4ffe7b7712aed3f10f5c4b463ef5633a2463f915c392f749b07e6bebe1a699888c8e975b11326d93f0c2b819590cd4590288f7b6e8f611a457783d81828356caac7b2199cd1772346c05e454b14040322bef7901fb38758e7c74af2de28aa725da2806c56bf13af9f826e1109c7804824b3b6cad62ed23411c7ff15fa3b58fd143c44628d11063990f2484d224c429d514ec1aea9f21936476dee924be95ddb1ae77dd2e0b1b647f27e5bc1cb5c95667442a55de20a968b321855dc85eaab1a03801fbc6a5260ea32537f0555f114f9331cc6dd06aecd32827375cb0fd547b02e1b43e6baf2fc284962f7029fb46a238049135a7910a3cad3308c98e6f7a48854b694e4836a78b2377830876291b3dc60e7115316efd5b3af7ad14a1ab38b703f1fa072a5bd0f804839ecf78c3cb507c4577741de6e3d0487862d68fa1d79c586365557134b6453b2747e43cc6058595", "ae08eaba59939f2ea55d8b46e9c878063b898012537b1fbea715404c08b7556a0fe33a134f237347ad6c2327d9e3c5068b597173885a7b3f22794e617b3846cb4cd82ab6716dd4358c10697eac29b5ca904a1572359e7aaefc0d036b1f9bde66a76ff3bea16865c6338f5c4d50ea52abd592c7ddffc8c0559dbf404a054a1c4eb22383478694d0fb8a8c5550a98904ca52eac328625071311ace79a7d8bb0a92019d13b1fdcb587979bcdc455640a72953c26ce9e8a84a97683fc0fd2e61c829d1aa185502e57affda8fc2b6865f700326e7286f7884e20ab9e88736d85121e72f16e446e629067c30eb193b83cd6bb930e6a9c19864394d398f314a524aca9b1aed5952765a0de9d34f5afd27fd863e4d4a0eeeae9e812f83e02e2932aa4a258a4ebf1cd0280374270344705d52e8130a9238d9066c228d757e394349532e4a1249cccddfe0aba88f69c715b9ebb47f5a9b67bb0940277691fb944fafea66198fd038a42f64f7d60769acac0c8443ac09eef0a61d3091e9b8e941660144b3fea3c8194c001873629970d0a871aeb87203fedc52972547c1284444e4c75ef747a8ce603597b7415100904dfbb71f7a4f", "9428fc8b85c98591fcdbadcddc3cc5ebb54efe3f1c0a9b13c904076c53c4bb24ac12fd175063f3132b7b80e60981a484b9e7982c30af0d9bce4e904fb245a416a3ec7792bdc813cd29034d23d13dc5eec5ebbb4e500ee90f84204b8c1565761cb76e7d3fed7b6a75b405268a31773a473fe8ce162703d8a338058b1ccd7234b8a047a7796d39b90d34ae867e9a2dce9d36e81027b9105e3cc0d1adaf65d2657e11a68155864e5b4ffd4232121820d5d02661df91c3ca3116fdcdc6bb65a329ad75486d0cdf3d899dbfd318000ae8217151c276b33abc7f020ce6c458112a0aa63b2b5754b12c341b841074219de1e6416ac2416c56b2b52a238d88374c07ac894f304d4615b9b074416f9039d5fc2f5339910cc12e7a9d1c5fc3bb05549fc09af601995867d9ea515a9f82f7c3ef775032ca1928034424c64e71bf5ae9c3a93b9088b9f476a2bdfdeeadcc7dfec5787d17a382fb6e5cb9187d640f6b92c5a99afac6042695dbd164f8900df1501289ee2ec077cef9637c0221349ad567fdb34176573bc531a5256f3cdff1257ed402e5", "808d573f3459e6d48aac7837eac91a5c5443e7582fb61b44d099282c88823b65ac6876eacf26e1e0575bacd8e57d3543b851b9fde5384a70746530a6f77772ebc5348c225a79ebcd09d993f92a67df3479d8bf41a56d9673759e15cb82a3d13689d25bce9096c2a7e5c89a71b218b6f325491d8471ae4847d9b3519d5ce89dc003a2b31850114657230835470f33ff2044c4dcfafbdb7338ff2057fc48dfe7f5cd92920624ea66f0bdb9cfe18fa0e7016ae299c6673a25411e44871d6c4a2a6542273c7bebf51af01a8a2987375596da50de26dba090131079cadeef59741f4355c364e8dcc9237cd4f1413ee930de2d6e34f41f3d65c82ac859f4de7b4eb455599755e14c3fb7d8838781300a8de9eb0b006296db82e77fdfac20a65475e311a0b3b30ee20889a4f644f0575dd7b48b29ac7aa617b613955828b3baf2e75d2829ecd3620f5e7168e2b72e211f0135d36ab25787008a89e91b521968888f2027396df97dca1d51921d2992b5d7a65baf", "b32abb8668858971f2a3701ccc90770ceb0069bbade2b16e0dfd236005d369df5bf189b0dd6f18d7c788bee01f00f2f08a82be0f530165681fbfe5ed48cbe96e55812c45ed17f0a34a27f234cc0a3f8a54ad06684204f1e276347b1e003014ce90ff99045d608cc50aeceb5c1eddc0dfbd93d9f3bc064f23f360d4a80bbd1b3a6c1c51a183de6cef3fb936b6d452840f2296d4854702d77c2be12e6c5eb6cc383ced5660a9d0b1f636841b059f07dc74517f67d6b10ea2fb82ce2da175dfde0d9810bcd11983d6e3f65c429cfc61e305655b831d771c967b8cc7cea16f8f2bdea1b80fe806644cb38e37c872af2a48ce0663407d65a81fc6a2d97ee24c34f52e532ff8d5ad134407d6f45176f15e57c80a13efc7963a720a4cf7d313050972f90de68938e9b7530fd00e520bf83dbc6a324b90eaf9dfd92e4e3fc3ddcaf38b9afa4b5b47bcaefa70615c60ab394ed47b"],
        ["b7eac8b7377f6bf779a74f73651e6fffc40f80e61b2cae95898138d3781a42fb6b1154a7ddea2e3b3c853a0fc26929c1a5b36bfd33642e71d68e85eed4dae33f7043defc687af4a17b24a92767e47c69775c5228b43d6242eec4ac9c41082f7796b9e63d8ff515e62f94eb86598823c5b9190ae328a5af83ef44f0a616eaf5faed22d9b4ac908d9ef9f095ebce514def26b2d5d08725c2c5474c14fe6970aed0a3e42155fc74fe71305f582739325d2460109fc73aa3f6e4f2d36eb60bd9fcb11c4bfece346eda4a1364a8e0cc5e89f3353552b5141c0a1160442505613c612e1546a341418e6983ad0405192c1db9c113ff950aafced8f6458919e710355c7727a8d52825759897d52f4286447f7b4c436fca5eb1be62d366819525e498604faf45b35af7d8ff6ec583484588bc20fd2326d7bb45eddddf07860cb45910e0ae77ede9522f650716296478de413acc1e4c92c4891c586e20ba065a5bf1060596053256f2af1e9a38916a2af456007d3b72a76358110e44b0abadc5ce43a33a73191e816213344d6b2362a37ab3b4a67e4797ac1ce3f3fa4a59e47ce5fa85d7675de0bdcb07df871f0fab7cde563ebd020ec3a0ffeed0b29301dafabac4f31d340212db22964d6dcc4d47ae00b81b7a3439c8452b54a212ed0835fe4b1ef1a1b4dd691cf98ab47da6475ae503b29c98d1", "97788a90f1fcf834e1bc6bb4de61d91f974b43bc27205b8cb9d365f3681a3f5a63889638b82ae391592760f2541c35e698acf4c925dddfbe4b2eeb92d9330177e3b833462f0862a2d19903955268735dff5dc885378b8db2c3879fc7c2f62b418c037831f47bf4b4d6639a8cfebd6e4b239a1e395bcb8055e8615b0e7f0a664ba184cc1dc670f041c041bc6400c5df1f2fbc477864808a11087dc44be14f7889079639df8079f4a1bdc2be988fd2724457ebabb83434297f2bdab57194657b198b11320e7035195e78755a24aeeb16e81c807e814eb9c5dc70e2777e251fe53644eb96a9d732f2cde49053b9d2ba84f0347f9a24ea9cae022811c3b6623ecbaab79fb36ddd8092daf914eaa099448dce6146d39a2804305d5e3f90a4b85df05d8ac126218f8d1637ab2e469facbb9b8a721e708a8119cd1bf62bdb97d31e8a6d334071a2c9c91272750386a35b4720a56e7ef9d23b61f163165550cc9054809659b6ca36430198e28151b351a9df01596d51f71d577c342fdc3e09bc677080505ad53aeec09a46c88a01959d34569ab719b5973c1c9a3770c188ab30d0f8525dabb5f0bb6441ea5efd7cbfca1edeed4c3f6066224ec430a9a874820e7d60a8168cdf0248950f867b07e0232e13cbef9e", "a8c10497b95d53acec82accd991a122fe541932a9c5fdb010bf33963373ebe327b5a24181409c3e3035509c205eb5438af3422b24f04f4360448f4b7657ef0292bef6f74eb921701b5461aafe1a9719b65dacf9b59f996cfacedd5d2fa286d618fa653ad5e5f5999b26095d0539be7074ff9f48fe4a9abe7ee2b8ca606c5897fcdf3a370ddc51b240294ca572a872963127b87a4d4151e5fedbb4a57bcafbf2003ad5fb0a1dfd9e9b701c87687b8356621586cc5b1117f97f50e473428cec49ae9c7311adc67ef58a45628e0e324cbce48b403b3a2c90b60d23153e369b456fa941210e5572c892f9c4830c4e15786b21f22f2776ef5aec45d9bf29ce12102a4b369a868e14e06d2833c970520c1a3084319b9607217003f3af2c8408a07fbfdc9d4158182bad34f6008c5add72581a023c4303eb0d2cff1f8d07ed485ddc3f3c33b8acbd69834074db321075296235b1e07a61a730f7a09d11048d6dfeab12081b0e2725311d24d5469f5eed158e0bb64588c7b2a0e4eea309cf5b4459c5b1b4c32ca2b6b5043b5811a0b4453cb5f4c27568085adba942c2838856d75cbd0b29909bf8decec489b08b340fa32d97871", "ad90fa6c1a9db538a13f2079877b21c10ad8ff2508d439e660db4548e1523c424c74abfa197bcdaab544b8e2de058014a02b502a5dd11af58312f6e0aaea5b78640d2f3862c6a0efc6c46b746ccd749437b96a4b7b226ffecb1a1ad9c36efc63ab94c94b9c7b3d0e4d8c5ab624e9efd5e4a58bbe43e0c7a8f15e8bd3de69f43a7090e60e1fb9a609d701390253b1f8bd157979482ef939b917dc5f0028d68aed1cb62cab8eae367a4760d5a9507b989c0e23af9361e728a61e22006a72d58f07ec0393e309097dfeaf803a70f4e8e9a000f474d917c9de437677984959ef4bd463ab52bae7df6ed1485f143cef54db991c4fe37e2ae34e678a93e3162dc97546ea2c9e4a43fa557e9f772a0c4f35ad922bb822e45c6c9a0290a32db2a7cdab748e3be96abc8355bd3d406d3c453b8be70dde3103044841bae282cd792fb2b7b72b35cc548adb5bbabc88bfa1a988bcba25b7e47f66fbd69ea820e4f039e2fc81753ed953ce19a0f36e312be645c9a87646605a94de73f164f6e0433e035eb36f891bf22fe1520fc5e9c57bd64d45cdaa", "b4882cd46ca90d2ee90becd8f27db249bdd7e303d0eb06af992e0c2f691fc30c5e548b5724d2925f89f815fab89cb172aa5924fa410755cbbf223fb378cfa83820298091231158d6ef34933ed928910e36c7d8b0e54331947ffccb5557c8d97a830b1ecbb45cc9697350ec64dfdc8d310dbaffb04612c020eced9f27e70ca8c4592318e89ff72c069916ffaa1b9fb90667094edbe88f4a915e1f196eed71d9a953c82a87385113fc15727c80c0f00b7763c3e26d01c89f5d2db31bd36791300e4c76959fcc7ae9132b56e5710764688d31507c83eb90d811954e72ad3f97a7f0f6b65ad2952e7b95edf0c05a4047612328d4c16bf500f25cb442974a869ffbe3c0658382eb80552ec34f499ed83f525449568bd16982c0d136169a530fff35d8f81d6b4d795c92ac554caa31315015e55da8a4716a1f769e5f00ac71692d25691bc7798f1fc61c5c71a8ffa4dc7a11dc46d7a7eeed116ff72e29b5c94d299aeea072c117175151f72168bdc8fa06a584", "95c87aa04630fb05bf8ebd9e08de4d813c304e9b21ee013b90a1fe539614e5a5c11e281183f3b3485c552cc1e98c8ee3941e4e1592de0828e388a00454f2cdc0583de22f9eee11c81d06a64f80dbe36274b152c0c13f4e119e408eed702a1ace8cda7a05946e451c79c33025bdee559391f827824010003115a92a9aab69274fe89c1dade9214f13d6ec7945cda04ec13d2f06f563048fa43f76155e849efbfe3916e64595b69e02f2aa085bdede095c475ba491c3609fc9a0c7bf8855be69c88156f2861e5a0d7ee1a304bf9ce3b38271eab97b5667f91707f034311e558235b93a36ad7581f13dc0a60b3804d63d7100a3b8bf475d5b10efd3ea2246ff5bae9b4e5f9af59217e485f47a5c04fbc5c5696abe173cb20ef7f4e4f46359145b3cc7fecdc33b1d1aa942b58937dceec18332db62341aca4bb1ebea1a5f0dfa2eb5cf54dd1ab50133c60639fdce00aa3512"],
        ["a075050fff576ac31fb197c4510127769d23e797a78e44615287d5428bdd0f201faf1e6dbe0e77188018814656d6e62583bea3c1b47b358a429a5f4445869ac7e66c98a993d5f0a6e94ee91c6461c9e223e853c4d75473d21573ff493e9afb6b8f0b63846d4f67e2efd9a8692f62c59217d1536bdfb5915da647a997fb5b75b1792ffc8f0d94c08b8428ce01e99338704bfd6ea2f37c53da39a07c662503d06436b7aba87866b3eadf6cbcba5976d9cd5476dd1d969db422e236f13441914ed386fd0f9ea91aea167f0242039890109739983e26ae3f6a8f3952f4900b25a757093b6fc8d4a6bca67d10678047bf217f21b75af3e705cc8c37c224b0dc71fcb1b276577351041e4d0d28334ddcbe2ae2534c9754ae49fa5f852b1d5b325be2621fb8090cce7299585920459e0d99c17007da7e7f4937f03ef6797d57801dc5e26b36ca4dd31efbc57ff50d5021de5eb21ce4769776ff1854a79502c8bf43e405f1d346cb6687c8f7ce0807753e7b32741d6d7b5c601e0fce21e69decbbe6346cd481e7e98ef0227bd2ab145781667a5d36fc02bc03a54a21505fce89a1d23f3152ba74accb0abe49419102616f3be3042201197733fda623f1aa937e7491837e3ee995b8dc9a7954a67aac1f3ae88a8624fb6486324901840a5a99e5249f1a14cbeb3cd2047888f9450ca715067ae4d4", "8cab3864fc104cfa75d3bd1771b3f28cdecf47db6c678d5e612f2c5f013ca71ee4b1befd8247cd9f907a6ac1eb6ee83e925355e0055fc91fecdcdb28656bb48ec25a455956c99904ee7c9b987b33f3185da0718e74d177403358d1b5277f06a59991a5e789a91ed9a2e36f737f6cb55ebbf8e0696c1496bf450851cfd1277328cdbe748310057f2488aa9e21807b97db093a8f405223d2f2330cf218a7198caab0fa67c581eb6ad094172546063e4d71586b913c2b416ba90521c3b24211e6b8ec75d5eecf27ec6b07b5d956cff795a625b4bd9a1697fff18ceaca8bfe6205d35255b10fff66736099aac9bfda64b34c13a63ce1daa21b36d118cfff99de19e7efdc7a2f801dd62fa256a00113dd9f850ca71a49259559a0991f0cb86ce8dd7bf5692afb6e36054ea686c001dcd83f322cf538e242bb055ae4130196a282717ef645962fbca73c88964074510e14b70b4c5da563faaca1794e0087c7163984449267e1282074110bc1f64df1b4fe9788107da4fe4a0dcf4b62154140d336823dcd931d39f5aaa43300415e87e95eb5281bdcbb8709cbab304b1f3e3587df5c387094a1663a7771ff608abd9b8584433a4e962b3c1565789fea1ddf4a3dcdec240657f9daa21c0a74dd523072fdeec63b", "8e5f90a6359f552712e25d877d3872221342b7b81bc2b064c19e4315cb80cb4690c438f3823b33513aef286e9e9ab363881c1fd22bbb5402c95ad34f2fdd36dd943266e26624e19b3126402fced9d58bb586143c5989a421b597b3e11832cc4193e1ad61d8dcd1442e62d1eaef6d262dc3a13333221d7ee00f72b1041bbdd054dc5736160eabeb85208781ed5db7eaac470cec887c2f15450ac411da21ed9ed5c3485ea9678f0a5db7889bb4b6b9859b2b975bf1b932d46ca25763ecd168d5b5c73336d834b9f5209a5b7e3dab9f369420cceb43e4997fcca8b204904cfd422693b5b1624c686e44b30e4628f216f71025c47a9d1baecf0d8032df98cb440887d82be60fec2b8a29313c9d5578c2d5251a7bd30165cdce1a93bef810d9bd7da0d3108dc56b3340589d013533de85d4eb5e991e194f9641124ad7ea9e1d4529350deaf8d3acb0e83e2a37e902f0a142f16d6fa95d3a8e3d6a10bcc702d9ad3efee377b8c1bd412849bc6f488bad60544d245d09ff2487f182d2b69945339e834c932ebc2aac5c9e325a9caf9d808259026e7ee70130fc7bc027101580b76044d73b134967026ae92ac09cdc80f09685cf", "9647eed6cba0d2804eb7ee1ad32b553d0325ce8be018132a5a395659aea86a138e4f2a4dc2a4fac3fc9aae45f0a474e386d0dfd4d945cde410ba8ad4dd6ece38effca9afe4a9f9fc9fbbd8b016714f7717dad95f64256277f45199e118bbd51e948b2ce2a42cd8de58209160775fdf4f6091cb9c2d002403743d05f9de4928f7f97001bd466b4b8707c205f7e80959400e1b68c6eae025f5af81eb60bff9da9230e9190dfe06206aad4ee63a51b9ee9154cfc15e54fc2fe6e0d00773270c8dc5955332b3ba700354c1c99f26ffc278fa38bf906145781dc6480ddf4b37e5f3ec084af8a3721a1451401fca117dcd25b4493eca8c863e4167e4128d823b10abc8e5dcbe782f1eacc07378c134753ef9ad0b02186676209adc8adc3d389e215da99e6bf332ec439a7c5209a5071dbd16ed531f50289ef2256a2e1c6399aaa0c6c9d10d0ad58298a35fb2bb377ba0876f144244c04cd11809a803af2123a72b77bbd1f39b0c48be6ca8137fc5af1545c31504aabb91abcbf79e8df79158627aaca90d95a5b9b03982cb7d77801b324fdd82", "9850e717f6b50b292b7cf590f0234b1e43c025c9f24281823890caf60fc320c5203327b9974629a9d7af6e717373dba89019976547cb320b302774c2e111de0d30da826f07776019442a29c4295d88c15da7b0005e807b0c2dbf2d4ffe608cc3b62fd2d5d68f7a27e3b88fcd01e24e3ef1ec40ef295d6cd8ca0379e76a2136c246ebaeb6226da2c6f9944d73c22f61f04a407a0bedb71b3c937e21fed714c42b7d74c47438ae283a58edfba0a85ca20a61812c6c0fdad930403c43d3f802ffbd5a6151d3dc68beff0a960f3d9ec7b5f967e82038210ad1cd5ca55945b8350913adbdca2c6027e3a7914e6975729327d60bb9784cf9b224b4902d029db7a8a7d0dac7b4c1e954d1db676078e0458edac55335f5249c7b6c424fcbfc83378cf4ed0afadcea57fa94cb38ebc81d0e4fc8202a45aff1d326ad158331c49ed814d3066ad2261db17fbaa41652e9650a0242503c0f73e9fbd687c715287faa76e8c66870d3950233e5de3820a4fed3fa4d352a", "8e5612519233cefdd40281726a5bf7e869a11898791e50c20849de2923ba756c8f3c5ca21872020e10608341b94f5917a8a6f4012c530693ece7d6cdf0242f72e725d6b013138b54933c836aed1a05f6cf9844b5772854d7e3552a3ebac131ddae31d3db545f81a585b7b4205c9f55e2975788a31b54ead3b196319444361875958ad8fa2630b879849a637661701aea2fb5aa79ae218d72dfc14fa3a0dcfd3f7fa8fa365f9dca37021db36775cab7765d9b690773efbc5ef2abdfc2f2327eec700d690ffea1e8518acca09c17aa9ac665f20f0e0d1dfb79b810726f531b5ecb87cc6a5b5eebfd4aab08beb4a438b18b5ba3e7121d62e7262edf06bda519a4e50fcf620347f4a8bf8e6e1477b52c92cc69b6d51fe97989cccec53ae26731c3c429b01f9dd99fe88aa52214e253c264866bdc452b6b2a5d5ca363c023c0693b9e5fe10e39bd84adcaae940deb40d98126"],
        ["a9c5e03b5e69a8cd71f36fcd18fb270e731c67de199609d5b90fd409879ef0fc37296e25f99480e1e5d4f8f829482f0e846a539a43741beb983ae8ebf3d6a860a34633024270cf706ef33e1b90f9a54a37be4329bdde20aa2777695df986f9a6923a1060acb7b0761b8f4ab39d9e680c9c58882723a4feea7224ccc480b0bfe2fd08bff2c4b054d7957a7d09ac48cc5517e6950fa365de5c21247c72bbe8ac54a07c4178448df45b690c14d42cdc419f5ee585c6eee63d08939df840b65d0e2bf85dd78a2960beba1f693fb6e8e671763ed1ed463a6b6c66598ee7f203cb8cf5518afb4ced5c7d977d0b972addcc74d314b110b0f651ad1185977ed51218d4f7a93d576e8526af0c77b0f52d53ddc1580140468a19444ca489a7a72ce57c46010833c8c0e68f3f3e12af5219a4724d2068cf8d502f6115aab62b3e4d200bb9cc320b01e05ffc19309c340ba903529df3515f9567f1ae04b9253dbf0f8f31b8a9b70bc0409596269e6da628487cf8846661506e9a07780e15467763fd51c0cb36acb8e848f44e4d66b33f85c50b096fc94e189ac7cb950f47a7dc50c81271da65fe61fdfb849baadc1f70f57e3547ad0f06f99fcfe825acc4baa73a1c6e823eddef5bb2b706d85dcf966cf92c4e7380b40fd033934a08caa238bfd7b41f285798c39c70fa8cdb3b79ba7bdba604364b1c", "b8c90545fba7481a345cb31fafe6164b63881bb483366d9e11940801ea76e6cea571d8c73e252ebd7dcfe137d724a53c84215997e02d06a7e33bd9a66c64afc465fee89e1367efc231657cc775ab7ed1ed404679210cee03a401a632e5c7da53a8dcb0fc1c7723dffd6b1d44bc66510393ed0dfe0c8f2902a78f774e08d19cfcaa0d5653b71d44b316d848de8f5ec2d41f15f12839d866d8d6ab4a31a898801b91b7189b32a845e1fb81c20e9322a2af267cd1cf9772106c90141d676398c7de92a95260dd74ce34120bc43f704459c65b29e692ff57027bec82300a92f47f8d8fe3087bc58fd0e45a0acd0ad2fad2290de63d19128f21f941bfab1b135dc6944edcfe348c96e00bbcc1fbe39f56fcd3169ba0db08d57ca87aaccb7ee6bf2be819b29b421d4fef02ca5efe5d6613dff76b261b497ca9b704de523831ef85b7cc0154af8b12d2b8cff04bfd958b52bd9d50d8eed516ba3ad1d5891434cb5fe938c3a6495a2a423942683ef40c6c87b1876366e8d3bb371c6798a00cd6ceb9a4c769bff51e6e9a1f49b8225ee8b3b1996052123d829336e6314a2b9d086a1517400149e9a5104ff25cfef12d7a5c1e54d914b34e1eaad57f5f349d3a5935e26fbd541bc68517d73eb2ca4dacb1e87ff358", "804ce415436ba2c6f76b8d45bf402beb019e6ae9d9ce8f44acda259d52a4ad36daed29ad63a5a0ec89ecdca0c2708bff91160fb8a2233b5ace8bbe32d36e8b6f815c21376c7d909a7c82d9c6776f17ebbfe3ab015862982cf981bac7b067188891f8ccc9d6f2e7cbfff994e56bad2f8de05f695e265d2ac8f7ad54917a57f16c14128ce0843fb5c5100dde4350cd874c38d2410e6a4d3030c8090b54a3dc23b8ad3ba2fa7ea76de31162a13a2f38b98170dd94aa4829ecc4399638856ab92e633d98e8ee71ec6ae364081a5bcd8039f8549a3c7269a48cda0707099b80c0996d16859bef521b1d81123537c6a04df2d03317c55e994338c4b6c7deadbc956fd2b09c61c438d464a1433c294a8690a3bc0825aa386e106fa26276eed50352d52bdb97390aaf8552636f568ad2cdfca48d3f8fbfc5863feb6c1dd1ad27630173ed2def16d0951bbbf6ce96f5427d37ac876021f7a942c519fce8b1a0f00fd226c2b940c413ffc879dcb93273daff88710e014638ef121311b6bfd7c9640c69e55fb83f6ae56087d4827b177c84f7affa1957d46e6a72822f1d83f46913f9985657656d3de9f8b986081e89bc314d9d7660", "8e8b3309c943c4705366723bd2d659d30d052ff75eacac53b512f52dab7dcf853e7d444db749843d19680635479df4858598700521dcbd01bdb99ef6e2de06684c4dfab1962da0ec0912ce7eca168c8caf88add055d3163ef994db891b9e43c2b5ff8900548e128a3ac296eeab37dcb0ce7630e0258ba771840ba1ab421199fd2a02e55ae117825125c483d53dd1cc72660253953f37e5c8ba85d94f14203e7afebf4201583e253d8abfd747d3c43104715e2aeb90458b8c974ce0044101a3d0372e171d0230cf4963099f19b12585134b27a159316ce676b54133bd68dac2109ef97ac56d603f97424ab1781a48e2db5ca87d2dbe7b6cb7b5dddf71abfa451189389a8eca06651066eb8609bca5f5226d7cddb60fc18f003a940ef9ed0e4754f4928deef5149e756733d414a2e5110b2714ff72575d8b6765a61b20b338ea9a11cf38a865ba2d13341d65d202e7864925da098c430d6d3ee767484b15ee32864f2b43c6a1463657392332c0a087160c5e02537bbf326ff5a4d01174d11beea5eac9011471625eb007d19691a644aa5f", "9795ee5bbf927de084e9e7fae3cc4d3c15787de3dedddfef7f447a4298a46a3232c552903b6a3ce9d486607af41d1c7a8b3ae4afb320c86ea49608a7a48cc97613ba9cc23e1ce6eff25346e1d14fd5ab6c3b834f5d2afdc275df1b0f24b39ac78c967990dba076fdfd0ae351f1f1b9e08a5694c0e6e4df4dffc5699b43d22c74601db50930afbab71654fc5f6b2f175d1396b91df62af1744de92e7657f131720393cf14f75ebaa096c228dfba4dab96248d7feeb176e2826cca276a3a86d1b9d2af70c47dcda8ae52dfda8dfe353686580a5f69359859b09ccbd9843c1577eda5633ba8c47571dd7023b1835a330dbc2bf681069b445fbac88623203b859a7893d85e3f183cc7e8cf55330ab2829893431279ec2d22b22388900a4180b7ec3081f209ba99edeffa8e0f82e15277ef0b2c6b3d494e1596ca277dd0b0a69b12b521d6f9a4f9709e32b8877f6e02a5e22b182946ad84ad616f6d0d1c65c248724f7b53f98b2a019d6f0e2f5f2dd663bd60", "a1d55c1f89822a79fb75acc3474e988f1369b1637dc016ae0af22c2854d4a996ad623acf380bbb307df0d6db9e325a268037fea128cfe39053aa6c5c034983228263754173adf67e574b2ac425ce303ee15f6ff276d3ba619f2eac71d2be212b922afe56e866644f3ae9412d7242e5e91eb54d9293f0b2c6aaa2c20b78ff24511af9b92d74a971c98ebefa55005513710885b896aff3c67ff1048b1a28bee951b84383d0ad6ff4120a3ac0e12264aca12f8e33ba09decc3776de0e2ef1cdb444f4783c2def2e0509a3be4f7d26b5cf21691f8aeb7100b2ceb4b79a2fec4377fce112b4c9fe8a22a84446cff14b973c624393387eb345abb697d7058825d6fa51cdecd6a856725afa9b9b79a7a4a0de9b3dc1d0187009bdd373dd11d5659c7590a603b9cccbee3550b87c76dce0dbb5ba30f9f8a0cdc439ac01397b2363941a8a1621f51c5fa0d4c2ab5e913a1364a669"],
        ["b24d0ebe1b07f3f3dfb036988980edf20c5dadb4915b3f6c2c7c455eae9c98ea40bf34b3a12ab257fc32a1aa61711d588e2c9e174d00c37c1971e5a2c46e5bbd1dadc96b8427b0a325f153d9a576539b6e993ae76eddf00d7a5da947414ea41bb9c5886d03cd2adbf53c54d8dc557d65b0a3183192b597244d0a95699641acfbd651021ae19c452c2c564693b96d92f425f2c7a1d03036ed05ff4e5dfa5e187f83621d662048f3e10f1eaf82151439ea37c63d88163f18842f8472a03f69cbccd4e67f594bec92e54d32034ea0b73f586affe7a5fd913ae58bfd63906106a5f12b4fac892ce1129bdd5990d46b7592393c3c60664d91558dff499388346e779291017e3dd0e7529d0d982d2ff471e8ea5fe700028747a00b2b2c2cd836de5fa365a72a0d4b72eefd2d6e3ac07fc3b9b52111dc0c2659e8c4ed0ce05c5a51af9f65ae45d80fcd3d1e8ec354cf14eef3a92eebc344f0c73546b046706c246d65d87768f41eef2a0dd564a2148015ca56f32cf0ec977c16e967a4c48d9a056f47d55ecc03ca1507e634004e47a7da8a3cea7098ee118cdfe1572341108df411a970dc3eaf416c1a7b2e2180bfa1ab2540ae16fe7fae84a14335553a64c1baa72a70a311407cef53fd476c750def96f7780e66df3234b462ef8d995bdb9d6a0db5e411e6b40a15e5b90d11e59010d171413f", "82e52e298e84cb4b3c1e74354113c5e52a0012de4bf6508beb930f3734f8ecce69a4e900f2a289c7fecfde2b30d3110383686e4dccd5b9ac6cb9dee504a5ee10a7a0b0f5dbd8ae4ce3c4815026aeddf4d6aed1ee8935f99135da4a79ea760fa1b4706b455323a2217265e5194249260791728f520e6901eb519bdb3167fb650157bfa0a570eb6cd3d32425ce9c816e493c2821a4a0f83f18f20160d06ac0a8e1d1aa614c9ac3688aff80ef4c17be84a86f721bfffbd49e07d7268c45924ff84ddb71d2cf95b090b96e77e2f0fbf0680d558e434a716d3a60987bdaf9877e08c037b2aa8c6c7f3ba9cb87e56f5b39ee567221d4de72835ea44c3f12ba189da8e5a1239500251c7d4ddf84c65e1056a60a1e47cbc75995692e1e22076d930e4d42061047ba7e82637ba81ec75e1bccbd6b69587f18eb242795ad3c5e0588d4822b32ed9d6b82857764f1e4ff006d873bc81be6c06568d9b42e1b99433fa72e3a8ab626f7f1176fecbef13679080829b9b2053ba050e2967e9426626120fb985a2b469e07979071d87e5e092ca4b231422d251d4d59fe0794fa32a118dd14a419202090f59bd6cf137d0417e6faa0fc5b5f36e491e9f564290d90c6bcb51093190a9ceb9a00dc2038b1c42052527633bfaa", "894049c365882e766dcfdc0aa88dbcbd5d26931792da891c00a456eabaf0ccc69dc7f7e4bffe0c57b361c4e7c5d8a43e981f9141ea0a6000c8e2a91588b89c662be202d26eeef321eb4ddf527c74360de78eb785f91d9d2ec08c7681e0687a4ba92752274806a6e37d037498992c7942e257e7656527fd9a0e3354cc5309840284acd51f670bbe77da4a4ac39eecbf3269761298d4d2a7cf33cf8425fc3917c039b3c4c45084921970da81274e54d3d2018cf5f7894d0877c37235d3af9a837a3e8141968c6a1c42436c726d0f9327882154a8b0dcc71a58fdef6b7b5662ea2a1a9e8535e2b177a803cc19737a91d58e02dd3880a2528d529aeffea7b42e11fdf6dbe6ba8025af1bf92b402b37a6fd142f8cef922491e8a04b015dad5db9a159570bcd0ca5a4b4f6f93353f6435c8676179e0900af2bffcb7f308c53f66760ecc1c4725ab4c75b2df73b155f2bad5dc91f9fc28ed0df38ea74ed149dfac6834d737c43675e08c9ba50481c98b1376ed76077f6e1f8a90511b2cd0ac97402f4d88a62687ced19d1f770126cd500e1b469503a1fd179638b810141888814ffb2752daf8fcc7764c7ad8f139174a06e7ef2", "8461acb2a22d336d784d41859786d81f20a691559c515473452cd35a93ebe09e35d9732924f5ef9ec1d434f6ec32a582af0e5d7cafc61b1ee46ee5489fc135a6b773decb97fa01fe67599cc41bb9fdcd9e4d7b91f10aaa9c988240c7533bdd888c14f809d4d7fc6c7f43224a2aa0942310471a50ac3911729312ea1458a1dcab5180656d3890d19ac5c7bac748287c4064e6273c47efd76234c8620fb8a41884369c52eeff16983eab5876572e29845912a391f339ef0f55c17452345edcb3e48098261740062eb7219ad3d63757c94124004751dc135ad159f966fdbf49713bbc1dcd967096ed75b136059cacbb3f892d675ba7646d002f6db0c4690ac7c70189bfbdf2ff99bb23257d58d645d5e40c325366e068c9f121b6dc76bf10c4610cd12b2969897e6569854c6d7ce48e19d60b124dcac6b5e7d49144d61e97b65978a3a58504d6936739216ebb653886bf300a62f2855d777ea15d8efbc5d18b4fed03756341cad0317ebbf05716b6a08b0530b518cff36d1ea29ebb64113c70f8926a411252a3fb0ba944aa9be10ed2823e", "9644ddb7415e0ab91031401f512437c49f7a519a98a8dca9ff1a8380ea2aff30dab2c53ae3ed17072c3eaca54a9086ee954133f351970adc9f746b48ec23c40911d6ad78c11c843088324b7ba6b7dc394dd3c58fa4faae502705809ae1ab1a1b84dbbbfbcf73a4f5b192a976ba24fa644cda0ff3c1762e290503e3e0c6bd15461116736bd89a25990fef45b1315458cd222f771a0d8a1dff010c81bfc1a934e1dbcc7035f75642c73f836396e80f52c703ce0af75faefa2d6e7b4c4a02bcf2e5105e7d3bac14b8b4eaa7b9617306d187123a734c65e84e2f1cf3150fde501418e0a619e06b109a63e9abf652dc316f623a8b27940c9ec2322a1b754da339aad4db67a64b0b10d49c885651356cf02c4611966a47e24bf50690a51fa4d41da98263697816116bb2e497fb18db3f05e6f852fe969f1bf41bf5f278e99c736e6da4c038d5afa34337989c68acc97f74f4a4528b727f2093c0eac23b4d3576e39bb9971c5e58d5a8274bc0ea3f41b97e2bbf", "8c8bf29237d928cde8fc210a134464d17400ece9d2d6f7e4e96daabdd7846f3140bdfd1883920fa0843f857d21c1fb6fb8a432b73b0f99c1a2719874d075a21f6014d5ec4cfda25575493dd43800010af452af678ddf2ea35a8024fc5ead3173a756790f872b5e766dc6fe3b110e8223d14727d6e911e81d0b101808748ec52c46fd04fb0f3814a4c5780e0b4e269e472c6f12e316d66639d4e866baba5c273afbf519b1b4ad93691f4d3f30004c677e6d51e2dd27fb377162c0e1cc331f3816391756b51392000f3e2482b322461c9d01bf0b5652182639bcc6d9b508c9db2595cd27efcbb32ecb87314df35d77d1ae0b4231a3acf1a3ab5aaac9fb4f7ba81da22935ee62c4d9dfff7776c2e5c95fd50aba6a9ed0efa6103fbbdb9eb0bead4e0b8ac8c7bdea2d4075ad93d5325e68fd0fa9bf32d352de97c074e334112b0d31b660a0245029ea9eef75f3ca1b4ac213"],
        ["acb4fa7b797b4155042614fde6c143d9a39d29c6f71f7be6de563e8081c4fa03b39756a873349e774d058d1514ffcbfaaeac93c74f6d748d9ad9d2f81f1800d80db460464ac6d4597d01085b79a7097f60c968b5d853bc3da319ada000c085bcab29e579b81fa5e8e88aa69e808b32c2582b9c9afb5c0498588732be98b29a4982457d3204946052abe9502cdb4a680a062be30ad6b7cb58249e21ff6b446fd377e1114afa8f5b93314bbbc41636bd814f2fa34fc5743d6abadbdb091af84d82018eacb9531f3bdd6cc3eede91ec56a71924849eb7b69e25c7ec2f8144a062ee6ab8d7d036cfb3a71d50eacf4d6ffcb93737fc34d0077cb24a853c15d5b2e6db32a4384dbe8153cc44e657228977c03f17a5e5411fe1129125b7c882913475cf5e29f8a0cd771d5684f77fadb05b0ac4512283491f179693c5ee7c4f3295d9ae4f5151ee66468f19629d9a7aed857d316440b62ebfcff4f3699550b311edfd6e2ba5fc7018366a022928e47516238cf726c5e1382087310a48337cea7ba3912e8d862d7793a98dbecb0314747c75a81c6cbddf295b106a93f6632c8a00e2fa4d9c8dc137c44d3c4a80bf3e5f5ebb8ede5e9b785bc1d75e687f290e1653486defd18b5892f7ee7355d4ab62ffdc156dbe489ce6097c07b3f601e03591d8a7241be4795fd8e2c7ba8a28d1593712e071db", "8cc5a79a136113231be411d1cf2a955f18e46cac2cb2ea2824e681c077d6638c1faa016cc087427d26f993c6e7e7ef1e875ea0459f997a262aa50fdbdfe84511a86f40509ef7b62af807de7e77eb370c09f3e76d062f3e457a76c779581a6e37ab315b330933a91031f312dbdf67cf2d9ff947bfd10516467b2f92d0aa76dfad3ea846acd460de6c63080091b7c2dc7e195229f414005d379950da92e856dcb21c5444e36f785e59161802e07bfeadc82faae7fe1687862f092eb54d3e56f95c2237febbcc4794717b60f81b1b2340a240bddf1fd85dd7f00450a6022b97a5a04baac0fb02d15cfb59f955779f2676dd33c3d8fe18282fc333c4ea55da4081ea27077e8ba26095a1a4c099b39d3819352a437c9347e0481e1b0db742e174e20e6939b72ba3cd7444b8ecb395a304d62c1258f4beeab87aa07aae14442f9ddc4df11534f777cac91c5e3bcd1720bf14dc6a3838857ba01c0bc48692fc7bad79283bebc709f8bd91b67ee6b4a7d80731656c9004db73d2f4b95dc7467291d61239923a04f52a2dfa050cb6ab352748f9483012e8dad07e417f9606c7fdcad7b0347b5840f70ccd532f82c16e3a5931f69053da05e0023cd943a290042e9b3f5d0f3b53ee6092bc41762f675c4d5673d61a", "b503ef7ed004ff6934a0334ae2ee879ebce72b839006d1e1e0bc61b06b5c25710c7a68f984b8d7a79a55ced2d3e87921a633c7f4f00bf818bf3826d6df863c0002910df90d952a4364fbaef8aa9483cf2b51293977afb7e814c4f5a16cd182f79875afa30cb56fa2d15340a2b5bed364fd48383da2c92814f540e5bf4e7c2640ed5f4e1b81db99b3ed2d087804e0581607d621bdf27bfc5b323264c1236175dc307d138b0dd77648b12f8a631e9644195eaa6b9756418b56fed2fd18ffeb4d886cfb7553ed9c9eff28e2d6b4c396049c3c61bb8840738fbee3fbcf9536c7a09c8f8ea83e4c05ffd5fdb82c87dcaff4fd4a2e97e1930c9f6194ec4eb8b40d6f17e860eb9b36c779fc064493df40cd04c15645f514dc7822b8acb8699c5762e31c03d0235211f141dabaad3f334aa8ad10172067ee602c9e7bc2ccf087cfa89445b87c5e4943f7ed4bf849f9d4ad1481222cda1c3d5d521b8ffa929812b685d19fb47d7a3bdaf552c90d93294825dcd4ee67a7f9e7cef8f68580aa4a17bcb77b6938a8ad2f933b16039e9d26205ad77f7a23a3fdb0b5083f01b9ad57d0ccd1a44946076066d9c4b8b818089d408e20720e", "87c08660e463a0ab22a54cacd30d3737fbb4a88b096a9bb085b8c226eb24a960dba02f7d6917c08bf6a9ef1301e469d09151136e456dec4cd8b4ad22450aa515a7212b6a55b676680cce05d0cf5038018d40ecc0d55ff3be19c2d55e656ac4cb90822abce49d4f0bef015ee3561702af00ec008932fcdefef80fd0fa8071652c6d7f65591730ee28b8575dd8e49e66fc728f6727bab1be6880ccce72793d621606ee2c1fd465f522ca716251407f40a44dc035381853a2654beb9936fef03fad22f471d48bc8695953f46f8a478c1ad87375915dd6c69f4c02d81e99fadb648f90e960b77391c28cabd8ecac1388bc540dbc61dd434ca326eac5eb79958a184b1836263ce0e4a9dbe77596700e86391404e91547ab4ceda81f3db20165bbee472756b728382d8caf4c084eea8e000d2046f15f7b286de799c956831d2034d49e33899f2d485c2cdb87216b766ac49ee74ef1bb87ee68e9cf3060940a9fe8bb09db61d1fec06f92a468a6c0df771ffc422303d42b59140c8586f94e4d8392890fab916fbe89b8ae4e8f54553c4a8dd177", "8f2ec579fc35da9439bb627afc702b8723440f66ccabfcb68a06c1016457f4a0d1a546db23d6b2a7820eff076f7174abb73a93825b25442706077eeb7aa5a7f1245092a03ab47b78c528c55402c8bceef1853edff345ae9e7688752f2bc1d14b9475e922aaf5167cca37927d06f3a01f53216e88425121e4926dec8d4f8e1448c7f667e70d630a98bfcc7b897d45cb795701f5fe33f0e48c9579cb2778e159c9f0c2a4ec8e7ecedb8fa51b76a0398db24a11654d6b6145185a7543d7746cbb995c31a0f6ad0e8dbb77c1a5702398c24339f527d2debc15852a41b34d6c3faa8d282ed065107af095e1c03d80e9f695874f93127399be90a0880918807e08ba26ba9a1b86f443a21b5563e8690f0423e6443e5d2e2083f0aa5ea29d160b8f6841997e092f2bb80d5ae59d28b04b8d3e10431fa2819fe3e4253a9978f27dd3114e345abc62276db99d8e09f3a529e2d661275bad86581138daffd1bc3e994fd37f0778e938ed9c8efc3847c925b8f511fb", "ae1254d048f15a4ac1251bb18a9dad465c9fb949e753358d46bc24566f4b8c462a27630f7d95c23ca781a7efeb25efcdb1ca9640ef58771d8ea945a69758d7932c98c5af2b3ec5f943fdbd47e41b0e096b41a7490763b5d4e68afe44eef8d3fcb4cdcbb0d2ee18f4d3c16e4583c165d4ed2a3fd19564988362dbfedd0bfc5cff31f70f9bcc6dd7fe18b18bb5e57e13e13677b14128122fcdd8771b66b0e28e2be75f5c951363c6d57b6ae524ad63d1101119d898792dc686e02f7d1ce672e36ce38d6893fdf4d190f97a14e2c0dac1033243d5e2f451faafab0ed499207c65df8973b9aaa558be5f1ad37153fe377b6922b616d4cdb6f9176535c44f3d16bfe8ef2bb4bec2bc4319a3db067bf362f9275e4887885559269244367237b5d7b0062f316acaeb1be98140c446e0233066a92770ede7cdfb7cd73818cb206173c41012f1294e01f04edb82d3080951019d96"]
    ];
    // No presentation message
    let presentation_message = PresentationMessage::hash(PRESENTATION_MESSAGE);

    for i in 0..TEST_KEYS.len() {
        let pk = PublicKey::from(
            &SecretKey::new(SECRET_KEY_SALT, TEST_KEYS[i].to_vec()).unwrap(),
        );
        let gens = MessageGenerators::from_public_key(pk, test_atts.len());
        let sig = Signature::from_bytes(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).unwrap(),
            )
            .unwrap(),
        )
        .unwrap();
        // start with all hidden messages
        let mut proof_msgs: Vec<ProofMessage> = test_atts
            .iter()
            .map(|a| {
                ProofMessage::Hidden(HiddenMessage::ProofSpecificBlinding(*a))
            })
            .collect();

        let mut proof_values: Vec<String> = Vec::new();

        // Reveal 1 message at a time
        for j in 0..proof_msgs.len() {
            let res = PokSignature::init_with_rng(
                sig,
                &gens,
                proof_msgs.as_slice(),
                &mut rng,
            );
            assert!(res.is_ok());
            let mut pok = res.unwrap();
            let mut hasher = sha3::Shake256::default();
            pok.add_proof_contribution(&mut hasher);
            hasher.update(presentation_message.to_bytes());
            let mut reader = hasher.finalize_xof();
            let mut data = [0u8; 48];
            reader.read(&mut data[..]);
            let challenge = Challenge::from_okm(&data);
            let res = pok.generate_proof(challenge);
            assert!(res.is_ok());

            let proof = res.unwrap();
            let e_proof = hex::decode(expected_proofs[i][j]).unwrap();
            proof_msgs[j] = ProofMessage::Revealed(test_atts[j]);
            proof_values.push(hex::encode(proof.to_bytes()));
            assert_eq!(proof.to_bytes(), e_proof);
            let mut revealed_msgs = Vec::new();
            for k in 0..j {
                revealed_msgs.push((k as usize, TEST_CLAIMS[k].to_vec()));
            }

            assert_eq!(
                verify_proof(BbsVerifyProofRequest {
                    public_key: pk.to_bytes().to_vec(),
                    presentation_message: PRESENTATION_MESSAGE.to_vec(),
                    proof: proof.to_bytes().to_vec(),
                    total_message_count: test_atts.len(),
                    messages: revealed_msgs.as_slice().to_vec()
                })
                .unwrap(),
                true
            );
        }
    }
}
