use core::convert::TryFrom;
use digest::{ExtendableOutput, Update, XofReader};
use pairing_crypto::bbs::ciphersuites::bls12_381::{
    verify_proof, BbsVerifyProofRequest, Challenge, HiddenMessage, Message,
    MessageGenerators, PokSignature, PresentationMessage, ProofMessage,
    PublicKey, SecretKey, Signature, APP_MESSAGE_DST,
};

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const PRESENTATION_MESSAGE: &[u8; 20] = b"e8gxekZpmeZTU0VDL9MV";

const EXPECTED_SIGS: [&str; 7] = [
"aac27f3cde3da6149c9db4536d9c8012a8e9781114dfad9b58ce9ce2d27126fbcbf6d18010dc132ad97c84901fb93c7251d7877d54f42a16f8916f4a2cd26bcd8c8ebf200a685c9fa2818a47f079461d5255e840e8f92737a64b26deb2ddff8813d16565e68d212cfd81548be8720d09",
"9681405ff1c67bffd560c6fda7a9a888691863089f22dd95dc605dc70941dc43b3bad89604c1bed2bcf2efc8b461b89aec486a233496e3f117cbfe4d38afa829d7c69d206c66db171f9092f5d73ecb4067c2d9e359344eb2e33093c930e94d30d7606b047e5d687b26476df535370c13",
"a98fda26b116e43c77f88e79e563aaf630843e2261671618354982070f019df71900a8c1b9c8a2d47d4aed9936626cf6afb223a2f67cb7d97b269dd0e232533d3a500c5e81621f676b9218bb789dc353bd20d5860023eed8e36fba7127e57c447f5d7d1625c284af32aa3f2945c2e06e",
"a8bd27100576b708ad8811fb4d230caca8fd97f60b82d4a8ec71931eba3883d6c979a107715ae3b8a0b31b5be91c01e6f7b3f6d49457f249507f8d1258162cc150f95506c3d4710815b205b4c4e4c9143745197eef730953b43ee19fa43d0870dea34d29567c487b7549335a7e49bb41",
"91f6fce8f20f98ae8240865f4c8ffb7f0c80cb28d710970dcaa43cc03d5e1ab5a4cdb556f9996191890c4d8fdf6fe92fea5824c0b3113ccc341ae13a19b95518df8b7eb5e17d7c349f19a9bd03960f04acb5d4e353bb40de63c3e4f384f5fbad5961b4f1fa2ae7ebb540c93fe726955d",
"b8aff05ff98b56658809f58daa1c85c497ee520e4fd5aa619587d96aee49093a2155f3e79bc1b4edfa3b5cf31797c8a5d5e08036f5886dc8aa3d0a41affc0d5c9415cba3f14c77896ff74c607ae26c041448f29f49ac264b5ca3a71bf10d76758c76c84574f4022b50273c20667b8f6a",
"8941d594e32e045c120784415d59b61883adc3badb16c8e7b767541b62af55d69a1125bcdc2d1539c696ff364fc22289e860778894ee4657140adeda789562225ebfddc279451261bd1da5f27d4afe11e8bcd70a67fd5fc901521926f1d6a6671930fb94934a14385ff2d1428cd98e06",
];

#[test]
fn signing() {
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b, APP_MESSAGE_DST))
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    for i in 0..TEST_KEY_INFOS.len() {
        let sk = SecretKey::new(KEY_GEN_SEED, TEST_KEY_INFOS[i].to_vec())
            .expect("secret key generation failed");
        let pk = PublicKey::from(&sk);
        let gens = MessageGenerators::from_public_key(pk, test_atts.len());
        let signature =
            Signature::new(&sk, &gens, &test_atts).expect("signing failed");
        // println!("sig {:?} = {:?}", i, hex::encode(sig.to_bytes()));

        let expected_signature = Signature::from_bytes(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        assert_eq!(signature, expected_signature);
    }
}

#[test]
fn proofs() {
    use pairing_crypto::MockRng;
    use rand::SeedableRng;
    let mut rng = MockRng::from_seed([1u8; 16]);
    let test_atts = TEST_CLAIMS
        .iter()
        .map(|b| Message::hash(b, APP_MESSAGE_DST))
        .collect::<Result<Vec<Message>, _>>()
        .expect("claims to `Message` conversion failed");

    let expected_proofs = [
        ["85b75215af0676944105ecaf113b7347bbae3ef16a7a7dbc14c86f5429a0c4fea9174447a540ed43ad47f392dcedb94da9660973f443170dc930735082b3ca8f2eddc543bac8c9909a488d969ca9617f5acdda07913ff6d1b280cd82761b0fe48f4790b23072f8a1648987489b989ada88fc9505a75686e1a31f25f58e15758257f252b9ba2b522091fb35e38f8f662356d0f83dbed9fd353049ad8ca379d547d7bacf1c31ee5fec6eafd0eb05af618f4e39daba49bbd624e169e7f1db72ae08db2ca9db849c99f95f7445eefcc1630c5f8a31a79ac97bf813d7cb70c7590b8c508c4a0a0313e3d64b49aaa0e44659833e667cd6a43767ca7e7f09ef4363447e1edbffad860f98f1ac8fd004f6f9f64512bc6464edb332148c7c1bfd91bc5a8696d1368b654a3b7cd9e0a72f5f0ad48446d2557368fdcbd27a0df57bc673079d8ee37c9d4fcb3c757c219f196ba421637035420247529572ea149eecf82b436a3f8f0120d2c995feb219689e52646f880eb8ab29d8cfe1c43f757283582168aad196c33a4ecd4ad1ec41c8ba34f1c15b61e06ec7e0a65b2d0b2ebf043815315fde473c02c57555c0e23affa5fbbd3b4006e33da9b4cf96aa4c9459ba34a6b9b1c3a97495937fb098acd91c3998b073a2204f092b2a7ec544eefa0cfdbeae7308b5a866df916bb3a60be184310648ee33", "82130ec6d495997e4389943ec5238586ddc7cd81b9bf1b29f3b55fc5dc6f350e818ca906df3f273beb9dd7f72bd0ed8db37e7ee9b94302d59a33f74c06c612e378bd0030cdb35712918c34b0207d51005a69f64f6260fcbef29e2dd9e04afae081ff06dd6daa1b1dd256a3b44f319ef5e128325c15ad6df4365530bb99b3494ed03c4f241336eddc5da684440032eb2e172dfde1f15a4b13c264729905f5cbad86d6a3ddbb831632c04becbeff70415349f968060d77434c4ae4f3a0b1ce9280c138526365db9180be2aa12fbbb5a1292d8a12d6e69597a86e9a842d4988a0371c68860419c9b06fb67e0fca315b4b523242879492d1a5a6d6a09502b15608c8491c98c0da79fd1eb72ce98af94835085085f039ae249bd9a22ecf885fdac6a1792df9ddbecf01c6b4ba176c60015c7904d0ff987e41b65de11b6075efa1e26b255447c87a567ba9edc7d7253debdab55ba3c8e46e4aa72143816a6f462533944e980172459d2b975b341ad00c9013714ceb0793cbcb5d4c9c7318155712820f28ea20395a42cd3c10a0401dd52e143e286f4f32734d881f820507146600a23e9093f2b6dc47b4b12a61afb5c482f85e4f52d0c673e1656ddf46bddd2dd122a66bca47dbf7c0a0c28bdb58becb9ab587", "a92c279ccc938174935fdf5fd83980c06e167978a955f8913092d9e2b8a960b423c6f5a634e584a25481e59939a57072aaf3d81f072d6f98814ee48667b94ad03fd9597cfa5471c1279cb1b59ae7a27c7604bfda767f1a3139dbc86ddb03f49c8403a38e0d35962ea5adf933ce4039f076736fceee7aa6e9a3a65ae72044a76d16fdec9aee843601b84d3cfcbebe009a3d1c0f4f82506c596b096bd04e1e6923d571da008194994773f4035c2ab5b29f1bde75e25d99d5731ec6bc6a654d1a877ec159d394aaa9bd54acd0a85a1a508067f870bfb8d81d24474ac054c03ac44019b5f32fbaa43fc1274a06b35d41227111a831c0517fd6ff1b5bebc886739b39523dd1373587b43f90271ec18e600934483dc00b3e03ae3ff9ad182e544975a13e851a15c9cac78353fafe5f5b358eaf3d14bdcab777d75d4b01fd71c5ef07078ea4ad1f1f7f0b217851a089773e3bab5d74e61ce6fa86d5891c36e78cbfe59f2fcad52147167df565a3cd9f88483bab585142b2ed89af52912fb2fca719fff4a38f894dfbd310825c660bce0068f6a41e3e4889b48d2bd46df250eb599b0fabf3a582233c75afaa9cc2a5dfc0652d8f", "81943aff3b2f3443457947872422585154c89eb4a83e1859968f5ba1195a9021a0240c811d6accd9d067451bbc78c34aa01b90d7e3e89f0113ada012343459849ba85ae94e8f00f33fb8c4e2a570a956080b36daa9e51c06c6b746b3789b65d194f1cb6ca14219d4a9faf69e70c1e629609377936019f30001d75eca8fae576b2d202a0467cb0bc731040790916fb92434c70eb958d608ec4e90601578923898ba0b3e1aff220274cd6eabe0589dde3a38dbf62caa9535b562a2ad951e7e40a02269925d6bf07a3230550f004d0b04146b8326fa0f49dbeac2d70b8707616248009ff9f1bf3f565c3fe0a1168824e5bb197dae3173bb4e8e15f12e71faa0be5bf1c0b3b035c764d8101d9367c8ff71134224530b8e938cdb42c9d29891b7e3f1951e191b86562d832a7f5c0e9da4048e62a7f2126bbec7fef96d9e78aaa580e5cc00cc9190f454ecf319bf2a5d95ba8269a302951708199385a508fb45bb956e03ffa26b62a7ad19d45456aca006708c30d90c13b10c9670f710ead63fabc5bd46144c8bb09b7fe86759dd358e8b33e9", "96591e75733b43d020c0cf78f84ac4e0c6844fccec56b4dd5574af022a3a71eac8dea14696832c98ced80d5bb6694ded94d27d69d62d9797ef1ec5fc7dbeaaea86e6c5be260a7de527996d4d90321cfb2573c06eee7e73a2eee869477964a68a908293c83d1568b533574cc20634c9c3857005857a68c7e61c872f9a20e1ecc5c6842acac03117edd148944deb3dd1cc5ce8fb499c7222ba34cb892c2e44c4e8e80ddc42d7c94f848f75622b85e418e24679366d72ac2dd43d10e71ba85e29d487ca41515c42df89ce6813da40a2df142d66eb34fbf508b8403dd57bd41ba62ac0b70e4408e1a84722031dbcf229f43710fa1ce91c26330eec1ae5ddc30a6ec0ca842fc43e7281170197558f98da326350ef512a5851bff550b850f4238077842beaa3603afcc539195459ea99a8458910734c71ed3e6a8f4d6349bedb2912d43b515768052ca47ccf61ef833cc9127a72f544a9183b370f62831e77d550aebc365941a6de51e915b43bacbb5100b1f9", "ab6a00aebb69334eed396124ab9650e26ab5ac48e34fa1ff7a4bfb51e1165ecc1e80fbf0d930a26234983ddacae33173a79dbaee0f84c641084942f4abc40d0a9a2f9c0722d750fef6012c46f1b810b6189ff5e3620ffa50325b508fca36f311a20b4b2a28af083baebcdd57091ef134b50a83320fbb01d122ce9d747b2e459277fae94682190bd1c35e65c38ea3f4fe2d87c845301c9c2c852fdd58b5ccbb033ff6b00db4351c3d4df26b0fb21b1b2c63930e5d769cdee4eb2ba40b2100bcfe02ec91267d0d8ddd85a55223002e376d0fed56ca47511e96c376e641225c9ea3681adcb34c9376d3f4187185c425ce071b984b574a993a91523e10dddfd2c050562b96be004486b5e616ae35271134cd55d92afdc47e5c8b0ab1c302f99fa75f1ef954b73351ea1f23c10234487baf97615b672ad733fe9b0098a4619d09c63d864d6d8b0fb97773429564b3f1b30594"],
        ["b6c0a8525aad767e79378d95a4eda43da880de56d5ce46368430895e36de368d515fd09a16ba778a8b1cee38cbe4c12396529466726f71592374c44c18332b5c3c4f740395d38fbe6b169764393e04bb98ef051506785ade679624fcf5d1bbfda76e23fedf6588f05d84a49031f454fc8471ebc67373dd16e45fde4e8b864b4eedb14bb29acb88db2e2aaf8f78ea47a8024cf7e525e363894eb3bf59d9206b73dfdad5a1fbf63e5041a353cdbe81d44245ddd3ca204d77b2c233fadf6663c31a7f672e50b3eea7bc1c636195912bd0cf1387a942a9d4a03c2fa9438cd53b44995b097c250a42234c2cbdd511f20058cf4c2c3a5e581f498ca77e3823429a62ec7fe29c911f9144fa017e40961464f08c6a456b5082de1555b1d4e2e969f2d0509bb83a425ad3fe0c0ef7283057872ef8696f5386bff4997a3059843a2b0e13b9acf925a6c9787710d46df53e2fd02c5f4bfd666577e5455a7de6960f0e4f00f589429a3d68a583008b39464bb0b6756534375c1a47aeff28f080aa481379a691434050429392fc3e049812bee7a7b1bf1cf7eb42441a49fd35274e4a115aa5e97f835d4085462bbd727a0043b9cfd4381805f2839425a2c1458d5c005e6d2fd82956eacd607bb4df4a086e4f0089ea55385a7ff0146034084b8aff2f31662aa6c9d3398c6a70d8041d942a23c8f83b52", "9722a88976bb90164bf7c22a6ea10e17af73a593628189fd9c7d9606069208ca597552b2da252b795a06795e7fac85f0b7c0ab15f400dc86f08801ee781bd492f87736d676208e4c024775bb1ad91aadc5918d9e079ba2a0ea1fe77ef10cb1edad6e050e92523ec067476a6cbb229a1574708d11ba2efd85f49f49eba49342f9fbc85a8b57429947c34d2dfa462b51fd389220c33bc001b830064a27796ed477ae331be40c6307ebfb762d1297f343086169803f00fd27489ec15a0583810e603c0c22a578d6005be52ee147577fa63b1cbf2a155fa145dcca3b43f99c26d96263cdf7f7057dca1b450017d8f0ff2f24388890474687fc8b5fe6b6d3d56ade03005d93a18f781fae03418938fe94a399014a9f2f8f2f4c0b093606c3d4bcc47b20bc6b6e78d0d9683f65530f41ad77016ba9af533f5e868d3562d651bfb6d20afa278bd5cc11387a7b93e222e9e3ff256cf5a4e4136cb88e5c7d392c92bc4a39cec92fee587da931367f5b3f6e806669720891336a123e3a3ef313cbaa4d86d8fabf783858383fa8fc4e84de9678c95d4448cd4316e4e483a1c2f773475e22a5a047f3c50cd02e6b14e25c674123420c4e5e4c5cf49cec76cb18434d7e3c0ccd9c0551ebf44f92b66035ecc689e43ea9", "85af2acf1ddab40bdf467d3ef6c80ff027dbd47d7426d54c6483340322f41d7825ff2f19f1c7fcfaf492c917445154ed8f62534e476773272be4856ff6c4a4421dcd1a372e66eb7e66cb48635a5312426ce78d43a8c54e35ea9facee80425c2b8cb129df163b0258eb26f85a4f3da2c59b3329eeba0880eb55a738262c19ede89437315e7d15fa2f26495afa17e36bb427eff870966a86b5e25a14ed95e3147c6553439e1b91e4558e950beb89ebf371633019e186b8e5e93c0917ef2b51007cced54932ed7ac0e1da16236724567e751ed71d4db8c72be997f1520ea2a9121fdbf3994b6b92ade9cf1d969c4f98d53733b72991669ff45a0e89fdca89642ebfa4e5a8ec9ce90b1791b314bd52322ece39a67ece6b48ab7fa78580b0b665958bad94fe08f706e44d3b430343de7f82ab35effbd6ef7695a5d1263477ad2271d01efe72586313cd11e06147735f2f9b422d278ffac628b8b77c2ee2e6f7d89cd013edc668c7297525cdd86db519b3b4ec096af458e3b8e965492e5cceafbdfcd8658efa1a72d7b410556a593e04717307416a9d6d91ad1658a5e9d136e5bcc1bf3dc9e1d3da1f14e67a534ae9bba96e79", "96334bcd7f1454e3036c20b79044024448a182ecfdb6a626d9226f3c27360346da84392e2087b5e25d855c4e666c2387b6a9d7874ec8da70ffce22552e73970d557a0dc2635e23315583458553f27e0177c58698aea33f83529d665c4edfec4184e639d842aca2320029eba530a6ff834aef1ad50f9d9d9c396bac8f441755a69c4d600ec9b9d6aa64e8f6771a8801c7049938b677253f926b7d4c5aa9c3946f4b363a1161c1f53b21878ce5f24bdb7f73a51357467ff7e14bdab62fea9a57d5bb7ed8897444565b6ad319b490fd296203b766bdaa16005f0a018a452fa145c274a9456d0ff3df0538f5a90628f6bade37b3d05ba7c448368589fca324994ab98010b48b33e37acbb50ca0a41606043314e9e2a98e52e2b3977dfee2d14a864dbbc32ac458047b7d462b2d73393302a61b5ea5d878b2e2b3133c900c4e61241a9977fdc9b0d6ee72f57879b5b6ed1aa46d873edee46d7e2cfcc4678ef18e5a4df819ce8aef5af3a5c61a4b96ad93f2f24f5e3c0ad37617470401eb28fb165fc85b4c6899383818a049cba2c495276536", "8d8598319d8c64c1e7040593584aedffc1dcd14761c5ec31d4fa34ba80d2462503e0d87f951eb18d463ff7d4d5c64b3bb898cd42f55bcc2670b7efff294361753afab147ccfa16aa82f78997a5c73d24edbed91dca993923c81dffa902977901a2879aff844a0ef0741c4c77028037adffb90b2420b2a59746c93eef586710f208e6447230adecbf902589c18159ddbd06febf68f14260b1418d85c9f280d76f0db62f48a4aafdc31aab4d9b1e97572c3fa92f0450829f535fff566d72c254b02aa1a14eb4afd06cd30241ce139159b14bb92e09ca58dcca0447e565fe693e532b9f290ba032a6e00fa896d190a5f04f2a5563306cbbe1d0d51acb671852fedee7d2dbb58dbf2f29a68bca1544619c34491b94554c9c303aa25d6170d60f5d4f68668028cf6eb4575849b886a5a9e06f30ff64456f7499aa0b797afb37b70b851b0e20f46ca8508e2b0827197ddc220d0a204d4a540f9196270fbb0862794457f0b6361d5847f90a00131c8d2bf45b35", "933498e064a0fc7276ac9b5b85ef0f2926e9d847f029eb61325d94bac3a3e0cbf40811e70ddfafccdfe38515e324470d9580160fc4c5710e0f13b19e6d46fd06b754447505a888c95a33e358dbb7b02947a61e6b756ddad8b3c5d371d8f8b2ad841f6fadb16852dea4094d9bb3fe37b97addcd391f5bf69cc0cead12615fc72dc73c9131f592bfc25aecb967dd18903d3e0eec7247bc27bc0fc4746e93317ec246a5bc24b3d194b06ee3b7976cf6ca1f20eac0f8adb27d7bf5982a0f3868b5686710708e020f8c6841e0570d92ded71513f4c85e090ade1c14e209bb5dc710021d7feb5c845297c1885ef3d09614c1ca1a3b1c59165495cefa6bd807084f569a8c14155ec847319ca542e0757289ebb07388d5f591b6bcdd01c8fc543c6403ab851a8fa48ace9be207a6b0db66075ae37094206d9b4a21760f4961906aa7054b1bd712d7292c915d7e3166f8d2dc26b0"],
        ["a7da5e675b747f6927d096281d50ff9a4e31bc87da59f8b733a8e318b5de2546877fbe4c63d3f9f517e08caf12e90c81a57820e164ab8fb4692e6941405378a3b64afd865763bd2cb7d2fdc44fd242e474c3cffe0f95a640d29043ddaeb7aebf8e3c6ff7ae39557826e627a66a91a7222786c18e82eaecc9e1585e2657229e58359e097d5d55641baa36502455a4f01d5d1a2fc5c0173eda2a4131fb1f487f6357ecc04b569910bbb30f29fb3e3c3cdc11496688dae328a9dcfd5de05b16dce0b4c822bba854ad934f5f1335db61a6c912ef4ee5f1702ab720c1e746abe0251a14c4c49dd92df4fbfc05f3f8b815690b19101db94fb52a59843c88a0af34c8b9d99d251cec637d3bba39bb246feca8c4143cd0a24e28c950d4c820454d10fcd75844a34c0e02f3596e7aee26d941ac11538227f8107d85653a0a633262553685c4b2af1c9b4cede315c635e4b9e1f2c51e5ae492190c5f9127b3ec335a500f6b0f68f8cf987bdd7f375b10f358f338623f29f4a5db8228fd62c5b76654104bada03301062d8d1329192b47fd5b5d0a1905ba334b3403f721aa5295c81e66e516944a4b7ff92685125c40cf24203862ea3b4562e5c6ffa8edcc27507cb03eb4a7409ad379b1c24867421fad277de1460b08be87f579009f05a863ed1bd87c114877a1b29f808500581977e57c7c0efa59", "969f9caeb8ec7bd1feaf3a38a565a3c9bda6dfd862a8816ab7d8a9d32eb558a3b76b8d12c205fe94f7b635d5f2ee630b944ca80ae53e3b9e80580bb19de9fdaaa1b78e7fcc84b36191b789ccb21450a0372a3b1c1ca06c97a91b61ffd5cd67ed945d598e31133c96e79f5e72fb8e802c2ac8e208ea031f3e4fb5f8265e26bec48ecd22885298445a3a170e6a8a99984935ff8ca81ac9b7222b15e5ea7a4fd1ebe5a0d479338f757372ac393136492e1f15c41b952363849aab1e40e36f35fb66dd93f118da846573a1fa97b718f73d4c10dd6d6974859e4a81f3e5e48199da69f02b32e33498e50a81d7d23225a351eb2e5f01dfa1ee72ced893f74310c9380ae7426c6952409b97f72ffd177a280e2f216685cc223759d9a80832c1927274fd77094f455bf37501d55922143daf0069279b59bc889248926c903ee594273f71e5b06c1ad5495a38308072017f3b5b3725a6c5ecd80d241100531251ddcd671f82b49d9727170232e7c482d52f8cfb7f011abef650ed0828e5abcc67e80c02bbabf9ac16f8953dc1cce62a33464fdc9002babacd37151a0c95713a2717116007d093455fcdf9810668f1af477152a84b67a54fc7ede51e3fbe6d5b56c4705f6dbb1009e48957fcaa9bbd2abf2dce9dd0", "aa8d43493b514303f77310f9d7c521644a5698c7560a0f0feaeb444b9bca3ed5318e0e388f2b10f63a86202db6a33822892f0fd35c042e5a64dc8837782eaffb4a660014adfce9538dda5c1d478fb9a2477ef5736e0459e1baf281249c883186879195ef255e5321ecdc6adaa66702906d8aa04d8455b38bee37d25a5efe9bdfe5c5d66a90e3fdfc465866908edc80fc4a504f7d73101fe5ff4814e1a13572bc14cf20a64c558e9af420d80c7aad4b7a6e596478f127a4b0e79a38e4df17007eb9bd9f7b4cf9d8e43883d7171fcdb44937ad54b526874b44b239050dd538b1f4da9aea90cf50c85b45cb85c299fd84ad196ced2fe33d294a81818d32bd9279f0b4d486a5d194e3fb4ef336764c06c51307df77abf7994981542a28d52cbdf37ee1a140e7e01dfca235a50571d284a12d15ab157159e3cd69aeea59e85281a0be95e701399829d9128bdbd793a67bb88b3a980bbe7e985cb72998874a8c2dadee1937e59ebc7637aec8da4671c22b17ba1f356ba76d096d698008e836045e1c3d349ce51b0b26c3e73ff5ac08c8ab347c35de0870f39f306d31ae4e6f093ceefdec1a72c6e8e0f0ae254751c58caf6c89", "8f0397ec71cbfadc5e8fe878d1c94e020089a17d59bd1736175bb0895979983694fcb4d5c9b11cbe608f65f0efb8e71d8466819b3fb986bd5dca2818e7aa7966c4f86001534b6fa22410560340274e1e63d9eb36f6fc90aa45dd479798f26a4880569f0c38665855386a99e469412685818d198ae325a70daab414270e01217d9f0d9e05b782fe69b3fc51b5d7b0f61420192898eb65991a92b4dbbba3f0788f3b3c1aea3674f480e345cead9236db1d125a6a73fd62f155f6315b8b9c7b9b4d5f101c018ac4ce5a31612287dc8a5ce56e3e900eda037850754efc294fbc56838d19ea6129eae1a95ee45e3e2e3ddd7628f0587776ae57eb556e0295bddff35a81be833e57f2933bf61fabe59c83dafb1852086ae0c7996aa551d433c2d99eda77aa0acce35511c46fac4ff9c4a6daab4de37d85fcfd8d5318500b9e949492265f62cf8b063abfa68ebaa03888eb6116342f7d00de1c665b6b1febc8ed9d890bc2b5e03f6558a78ae0cb6c2873070e18408739b645750cc04de5112646b60ed793b25be60eb924a8b907b3331b16062f", "b9f8dbcabae4d3ac46232d02bbf27f16eb206fd600e633ea9fd1c233efd1b5da561de5ac2f2bf5729bd956fd7ab73c72ac1d287dd74a9261ad9ad73c351b59e5d46d49741d9a6ddb6038f23b3bb5a9b61d4a3e92fd4634c80dc4bc228597a9428539e1ef2ba2a55ecccd74241a93ab350842e17f61daa0d09f54a63225b5a6475fade8625eb2bd07ece7c5a4dba52158367019a2d91f01657d50003e754c8e06aead049e1b38e02941e8e5a6a8f9a9715c6d55ac8ff72b5178761e808cf533f9b2094a1cea8594aeab094fda4d7008c858bee3ce1e08fa50d12a5be76d0149c0f511057f615fe93c6e0b87a2739aee90367bbdc194c226c29e143b64125e5cf3742c49e8a55bb14dafbe88d180871b8427dfacff1bda2a4d43b642ea46ded464d3154bab2f4d5b25226619be3a2d037f1f2befbd97ab0b585125e70a345df135c9f2f41740628bb98bbe65eed6f1af9727f42509f3aa5db393a758c893add9f5fb882ade7a0f3e04b43b49e6abf2e607", "8ec105232c6fb1759774bb668ce755f531e67a6c6c62a6cc66d595e43509cab695c5874f4020433c947b989f365d64ff909478749e02d6b46ac615e94f0506386465fd558ad26cb470e772ad5187b9c6318c210ccb74d54705ee163f30288a929629414873e9ee07558a0c08529a97d4a807699d641abc99307c2adcc6054f6ef6a80b893bee26cdb46e3e4797e1a60307deae924a8e1fcc44440aa3b9fd7259bcd85c0657068e0a971e18d96495f59940b75cf665c3791c7954c09f0f78c57dcab8b2d1a8a26df06996fd29a0b2a24436081d5033d60d82b18992147cc3cb52e62b1e57116e3f70c7b53f2fdab519106ddeb22650bfeed228e3bdbe877bb5c19ee1e1552a22c6fe0f64f8e1809cbceb4860eba0f1a0c4a11c3be36525e6e2dc87aef29d9a2cd854dfba2c41e80ea0840d6cff3faa20a67d2af18bd273d82652ce0f6663933a5fc946009d694d3bfa0c"],
        ["b07df53331d1de41e8bc07f82dc9aa5343d7c42d7ef8497ba8b24af6b2751bc4a9328e83ebe072731c8e0cbe0f9c643883c50202445b0b9c41465563d2dd979be3ab693f7a7d88cce2014828e3e077435696042f5724b4e47f4efeb6b1e6324b8e993a6915cd3e095b48440c834718a877677b700cb12715faab6702ba228241863c2fff2a742d13d8aab5c15ff7de7f3de2d3395419d49f6811b377455b147e16d8ace9a95f33271146ec2cff3e180c11418911405dd114d17ca4247e27ce652df43de60384ae81031785dd67a032641b17410c319548260b17b3cf8b5f04816828549a4be55fe089689f419e226db044f73d5c4c5655457ed69829c9b07afc945fe9fe5ce3f56cf520679d4d1fa77d01586d0520a262b11adb0d84fd123fb851f9edf601b4a8d926a76b85adac767a636fd6f5416de77f8456ea16c511fc2fb1acd7961b4ed6dde308ff2afa3b6e6949a87b53cef4f2ca76343c46a4047dadebb8f8b8da2cb07e30644215f510608855ea4579683622e3019b8b888235fe80dd466f17b9aad105eb05a2e55c3790c00a15d2a918306022c4ffa3e074e144a183554316b5a8870d763b52909e486cc34937b600f735e4c1a84859a1b11bb32f8a316a816583adbe080e67f88caef5f96d991096076694ab073bb6bb41f64de10c7590f4281be26b23d7b3775e9f9900", "b0c7d1e33d633842559e34a78c4b5e72a006ab4696fe7e9cb219dc840630fa5b70c5b0b4c2b110e9370fde0ce9061592a70222403070fad6205b1527e0ab01418ef0b04741164c424d8bc16929fc605df582a3b84a2ec1783ef3ba4391ccb9d69321d341654b0953461b6928bc6092419091781ad9d90ff3bb997358abf1a5680c20c91479c38357f2194ec4f26474a60aa7737b8a5974541115706c2201d9dea32abc963d0fb29d2eca72bd028ce5725e131773b23e6c67d64e9ded014a004180ef02aafc9ddf12e16f1a99a71aec2f0e16d99def8354b16f57c85d62bf6ef92fe266fb7d9be764d67a376e66b4be411ed8711cacf0daba4bb66b5774e88666037a4be0ed2dfdf2c667f110284a5f0a6fa01fcb70964b72f72a3e918d042c64d98d7f41f5b550cbcdf4e67ae1a23fc424f1883932cb32d87c86dc539427350f4516551ee12a54dd470247d36224d6625f6a7d1498904ad8d78ccdcb1e3edeaf8927e6cce24332639364301485cc445d42204ae90c09621ec5e94de62378fc09771b1cdadff41148e7770048a954f96e42bed24225cf66b2501859520eb4f949c2d6c3cf03d50ca700aa18972b02a639599a165975ab5f7f53f91c9de4dd88ef9ccd54cf97633bf6fad3e5e0002ffdf2", "9623ea6449af36f583d78fb08b10ec10d9e7e96e765fbe691131432f14fe92d275f6e3676bd0caa7ee608774b691a497b9d2de92f51b79e1ca9edef2f00035aeb9ff73be20729601c1c2ebf1b8d5b12f6a665ad1e1df0bd1c206826ff06ff668902ab45b83c3fe35866c8749fb61ad92bc74ec47d9ae3d6da6d7118215db517a5309880033cfde906b0d53694848dcca5015e1610da3cf680d6cfd533fd4e8c70633c49bab1358f9d7edea636eccd8d75655c745775a3007fd01dfa094beb5ce8a4ff8df725c8f1e52d4f81b40287cf319b9878a7daea7183ffc7e066ebd3344177f9010131a5b498fc837d24cdee13762441120497ba727475b5d648329792c8bd24e3d6c25d14073a1ebbdc57d74674997cde24453be62a249762a3e839f74a7ccf39b5f3c3c2f8a7dc28ed80a19164fb18e90540ccf47b0316c757236cc2466eb6bd1aab7fa6215cee990ddb9cea052f8acef689e5b7a06195b703428a92680e8d55034f3fa9ca0749c331d943d9154abbd3169ac3d5060217dc628b3b7e4b6d71391110310da850cf7f80be11624191984df1df6de35c75031c74bae663eaa3d077e4eabc492c540c7fc212bcd75", "947e115fea51fbb91cd52a93e412c7594519ceca8feb8388a4b989082b3f9c9c5a56ed13bf2fea7c40763f5819a3f19fae42e1bd8f2c9ae48e7d1af5d6fbaeb57c32e0d01099a1ed1454a123d72909710817ac45ccdb5beed27169089cf24e5c9641044dd78fec1b699996aeefc7784f7b8c8f4251753689f5bedb71c0f0ee6bcc316881b703d399beea50204dccf7ca38709e9b48fe2eefd934c7b166da4d04186fb365d2e595da207dbedd6730b3526528726370386e89d3e56a063fbec07088126a6f817b6d5be98dd2bf2e06c692647b9688c4425b8eab586748115bca03d267cdb51c542ac42bef62dc502a233e3a7b61c23e4ce1ac599933c1eb64cf65a14084693065d381b698cccfa5b2ec1f589193e3eaaddb5c172dc45f8a9e3b886e9e17d4754698ccc46b00b5c3b19a140a1e30344f96fcc0a43fc00179c6a028e40378867255419d109c63d7da9cb9ad59122eb811884ce9ecba38f90d874cfe56a456fb885793b78b2b0497194698aa34476ecdc6cf24a9564aab8c8fb9c9421e1ce4bffcfa75f55e9d6bd83732e8ab", "b8d2465be604eeb48f9a311d95faf37f475205ddaafe33945c75aee3d1c47af804128d332a31b8d3d9b92915228308f599f63887884813cebceeccf458e3bd37f7e78b8b01f6114e1233ff590b1cea32af03141944836385e4e5e6159db1d790a89726318d6f74a9906a9dd5e8b747a400c5f3dcc9889751d93a0c9b64b0efc1ac0c407223f61401272449fd81c4554941d5109953a804ae65e5ce5b5adad97a1aa4fdc10326cfa374df494bb81c14034366f110498c7b8efc45beedf63f604cd14b438ef44f531d59fc777424fc226f43faed05c06c23adbeef60290e434c4bd255f3e98ca48b21b23d5f0cb3c00e8c1415ebcfc7de88e3e85cea4cac873efeeaf954b3232f66201da3aa8b49d8496f3c84ce5f7b416e4a04b9ace7b532e00362b693e87a0a1a8b3735937d6621c6e1074083de0fcbaf6060b232390e70f1681580981624450014a6c09d5e7787dd2f1b603b54ad8b0d9a76dd95ead37c997d5392a80199629e9e09adb74fa7c07326", "805bd9b1f8b0d35bb53b69138f5d119855fd1984e75960f2fadba9b55ed1089d946294fef0868f6413a9a42542e007d0a8a7bd80da8d0a3c96c6b4ce8fde47e5bee3817b38931deb535dcbf3a07180609509a11f857dd29f3fab1a0f037770968734c4c326bec85739cc50879751ce2cd14c6408d9cf00e80176246658f0fc598664783dfadfd937a3a3278ecaeeb9554a9f5d3a9d4c384e3d5169ed8f86cc6001c41d35d6df1e94ed6706b3ffcf21a54e5047cee41a3d824fe5fc3edb86c0c74c5c312297a4b5cf3e10195f9ca306f319cf38a694c71ff11c8beb6cee37416e801fad84bc12ae41d75be0ec8b83e2f75d8f5560b5a748d56036ffa81225cbf3ac1937ad1efb87024b6b600512c41bdb374f61dc91ba0efcdeaf5f7cdd851fa6f51e8d8cb8b1eaf7c5d27c562d0ad56d5d49e665631ef6a7e42c71f90aff059e70439b74b36007d69c8e1174626bde06"],
        ["a17ee5930a4f3de72b88db9a50039598f9977cf6662e6eda43667f52c1c92ab0f0931a27e266cd87ec562483b0d2e90d812fcdd730ec8ade3f730d4d787af9fd40a421034e534c1339bd6ed225d1870c4f54053e4da207fc06e7eb873f9135b1a548f8b622c7d0a3d8a1b9cc18c6eb8ecfb28c7d8911da430508c7c002413328b5f85c961458583717ede551f078a13f66977c926736deca060d128cff76392ba05a63011add7a6ac5182510dc8915d53de147fd881e29dd1d97a1c1f8a4694bdc6ef8bb622fa5764a0480bb3221049a719c1b5574bbab339b8e52384874a9e34e5bd80785508bf9d26732f79138f3a227922fd9c00021aad4923742cc463fd5b1575fd8c7616616b10724af6347da181b56ea7a8f4b12e017fabf0feffb7a9515aab50856aa7b56bc7f21dde68696191d209ecf6de3519307cd800cb8dad82b8eb8ab05f94d4d688d6bafa35fd3f29f3e54a7eab83ba9f8db1e4cdc02c864c0ecc1ab5acf787fa2676c79b449b417e700bfd2e2175706791d54ca42e417fe5c4f5bd939cfa4a5cef58439489c821f5508f528c5e6822c164d83dfe1480295bd0340a2717c3145e83473e38ea86ee6540b6e42fabc361892f217d08adf98adf870a8dbdf6890eafc43669ade3f61b24202af65224b8df14ad13e24bdffb2772e5db5bd028e10dec00481ea4ed13b1283", "9381095873c19d68b3861d01b9fa80fb4bc7de9cf786bfbbbebda067bcb9b38c061d7aa284db961320707a517d7e8530a21320192842496376ab1ef465100f4a622f084197c88e235225910515c3cb1460f05eabe0125b1f1234b3c2f535664894c09d543ff8a62f9758d878f37b0e3978bf189b87f2e73cc9a683800d39c5e1c8c3be89b7eeba90839e4a0b53a8f1a55b25c6642db04045971d641c148e58b35512d7caac110d78fe6addbb512ecc6c4422d5445c397c2342fac19f02d3a46fae7238ca084d5344013862ddeb3ea4d831af8cdacda6335121137bf3ea4ab60bc2ec98c60134a9c695a73a444c8a4130611271542e6a3d63f2bd75a45cc05f1d60dce442d72cb73fca2579c7731e273f67b265d75f117169e390c2cd0203b17ce613aa0031d659a100b4c9dfb39da28f59ade1de4fc0fdcc92cf81b21dee180c8eee13c48e7cf9c9c37fbd4d93beda5b6c5541264fbd1c7e754d5bb7980a96d330930cc86001a0c6df70b76d961323af4b1acb5eebd967ce633a6341f97d474df2bd85a6b2f14c86522914d3addabe1c4398a2e06f07572efec28c47ff9165d56980b395041daba5e203343af22ef8c147e505a3b39f7ae54666c1474f9f77e947a841ebd09d7a0c3207d26522a7e455", "81c1f9204255eecd06378f78465085f319d3a6ae9c256d7402f5a91c7fc2c9d947103fa82d8ab3c5625a8ceb2a41b831a0895a2f3c38e467e2fcce292c41c4dd4770c3041a91d3d92bff1162231d66452d481776c551221cc1ba6fa768970fb7a0258c22d5a56b3540e24346027bb68b1ff9b27e704c7c167c4049e678340b9c181964d3ea09833241963ca243fd1c473c0c216a5e1b55fec7d3ec5d2bd409b9191ed3aca1167165d65d66856e955ce1345a85b6ef8d8aa5b9524efae4787b4c50a77e708bb82aead1bd89deda2ad9bd38258805ab806cc8149370a82eb72bafb78e482d1bc9d2c798d1b958b53e57e72bcb29a2a445839d39ee96482709bfece62a767cfb63039d331522f46c9c9bee2599fbc14db2227c72154a84491140c347093f809d180c3b301b6296c793585032369a6945f4b5f897d3765a4ce89d0ad60a63cc591900a76c13a80186e2dfba70762a381a667a8370b556486d8952b0bcddc32279b5b56c3f41c1fee764e0af4919a0df49d97bc12641e86544f63531097b044ee6da9d181c6324a683b88870062fb2824cd4110fc8a0d4b0794f9b6f362e9dae6a42a9a369cd5c4862857f3b", "9556b5a33767de1fe98154c7455edb3158b4e4023f9d136203d5990865f4f8980bb9ddeba80dff0af68880d0fb4fe5c0b56ddea7e7f204ea86aef37380cfa8e2a1f65ab70341494e678cb7736a388a2031fbb1033e6f41a64adc175ce1fbf916b7d0c9153c48e71383be7200c9eb5230e38d8d506d423ca095e103f9a6dbd68599212e2e6ecb9f7366ddf89bfa1c02a413ababaf936f5d6e0c6db226a1ec334b0276d2f8e11961a540ff3b9d8d5cebe4344d00487fde3d082414f97b5aba0e0134eb170780879fdbf8c7b5a5d42021e41eaa75083fbc50414018973663f6e63e22fdc12481758bfdf857237ced9cf77818662e61b7eb55d67ac8f8d12f3e7e7db8678bfac988f5f96ed0947a5de9cbdc5e62b14dbbf2bcb0885a4625e561c301fe518337e1976701e813d707cda44bea5b4fbacba1aeb5a84a1b30218374d9b1191afb8a9901543cf4823eb5c55557ec62aaee4c8df4a061030c89fd16136e62b48f16e317371fb520f08d2ca09146d820c81e39dbb3b6096f7bbebe5cde4c9238fa9a063a06448bef1c0dee63cfef1c", "8710fae53ccc8b938e58f0429f234a9a01513f2d3f640132000d1b55e138f1077d95748d573bf88d5f60d3716994778b875332749c31c0cc9874cd5631031c5b6e14977040875e97acd65133dedf79e9790136173df2954a619dfcd841f006f0b4407339106645d44f2c28d5f4eb068b5988704fddff3163692c011f4a2a6e88afe2b178557d6420cc74caa5f1e635dc0a0bc5c750f4dfff50750a95b0642ae59b03ebe7a7633d700c752c74b6ce57c51083f35ffa62e9541bf474384296f4ec8116f9e1cbff1bb04dacba4fc064d8b66711c0f52895b6f2a7183b884795d96d68fcef65d24eeae804a5991a751675e538108f59539375fdf74d6edde352b3e54787015d12ece40b54793bfc4f10331b212fdc932faedc7e98cf8ce9f20d8b258fbec43e881fb6b79191ba7082d6664f49948f32af7ed7972f8126a65fb0651ca9e4595268545cbe71544fd1f4300374544b3c6b08fdf1f344b2d9b2a4402a4b23f4ecf6156abf25b9f4f4603ad68bc8", "8cbc991abc75bddc35805d4a157e10a5c535030693c2b28a01202dd823edc0a6569f0687ffcea89b3843a748ae3ba59b9531773f6e610c2ef1b33cc7179e7fdefba049a4bcd271bfe3d34887ff11abc2062a51f8d0ce25f822bec8e09f5f80aba9508e44968cc58ac591e3ea400476f2d1b7a69165cd4d8cefc5805d545cc81a5f20d1f1f6d3e6f71d0ac745f76970f24d7bfe560a2aa1c21786dedbb30c3da13b6843d8c9925b40296c743f01179e8f0996a084dc2711b81e9aaffc823cf12ca3b77b44447daf3730b53f427f993e2e66bed7df0298afe4b97b44c160d441e91db56b342f6053a16e4d6f4be45847735abfc2f96d5d766909ec5257da5a21a6fcfb3885290c4811531e72dda0f3ca610cad38fe31bfde515153103e8e5e96b95fe8c9745e2a22ae8b514a22307ea6990fbe0ba280468c3d9f6357594a5551376d839def50d846bb1fbdeceb77985e90"],
        ["8da9563f9e511e2905d370a0307b5b1f70fc83a2e4903fa066d3fae2efe6cebeed5a510c433c8f2de321811c16bc440ab62d559a2998f42cfddac1a46fd15cab0ebacc2eb07257b9d96d20370e93716813350996a310d67b547c089bac17ce5587cf239d8a478f5ac31e4ad1d79cb30b628761749dedf7c58a12e90ec30954c62f64f959f5e09f6b0a16b3b55ccca939053887291c109465b757828a139d0298fbd1b0367146f408134de36073fec6b11cb2cf06a977583b0baeec5afaa088d2cd8c66dcb695f3fba7cdc379991afad819d3f9f9e2156291fee033080824246d28018b66bf3c2d184641f0311f429f1341717fbcd302c5c91a87d5c891739b3b621dea03995b157ead7b71ef18366dae71a8ee3f1b20d042781197a68678d6c0945e006ba6b3bd37593ed9b7fda5ff77640cd0dafe44d0af3c2d7f9143ffa55fc11393efc6550e9491d97d0a777f0d4b53598d890e179543e7c01f8ce9c438fb95fce0a764697c05dbbef2bcdb170f555455e01e510dbc123a6cea8ae22bc0adc006a527812f84fe9fe6d339817d169b40627150d1560730848c5529fefe4d6ff5d3ee9c363ee162e74bc466c2329fc638140881ff5f971e533121aacd4d379eeb9b0d05b103242595811f8b14eb45f14ea8a1d5fa93c94e429315b5e82b7fcf57e34d8f220a5c7064f8e3dac3f9c592", "863be4ff930e7537148ab5700b180a809b2cdbca40ad91056d30ffc4cf0a88f1a0db8ec4d47470b8ba31f1da9f457ed794367edf3c29689de2827a0fbf1cb5516b8a16badbe27a7d0721eace7e4568ea9af552b3867228dc9812c4f9a50edf04a9ac4927e2f2b99fcbcbd27436a6885c079f33b33960f14381b9f8e323a7976dd6a96ac1765d5bdb11c2c310c2be8bd5548b061a5ae51ffea2224f988f16c498098652607e6e9e7ab93105c0e4d441161c59143e844bf57086b747ce5d3616ee22996f93ab6aac2ebc6d3316ed91eb1837dcb4c515cd18ace2ba606c0831ab8c21cb8137714d13437f41b3ca1654124054468aeac1b0a4700b35dfeb86c5ef2ea9f8664e35cb08d5e4642b1f9491f7f8568204800b04fffb5a277758852ae8928740f74642a3cf8fbdcce3abcf8e7fc76ed5eb649a690b0e98b17987e51b92f3c1f604b54df8cdfcac722ee733128c8227bebcdc9192e555273590969cd5d61f5b559d693a659bdbdcea9616254a74b00feac7f933129b161d1652179a907e426e54fe5394cd76b81669ee7ae2f294672f6e737349381c1940dca2ff765ed8d571c19df47e50c4edc41c8ebfdc4b01e625bdae177dd48e63e756ca4237fbfc9339abb75be9898b9bacc76538864badc2", "8656e59583f14810d10c246b87b954ce051fb787f80731c85796691dc7497042eb76cb64ef72e0911d92547660f96506991ecc2b4c5296a4d7df5c3c634274a0d98231cbc77a27e7867fc4589e57a2272631c97eccd7e1bffda252b0f300bf13a42a63095733d9e9abdb300b2796d12abb3c8b4257e1d323017114b518c594c3d76e980d0d279491d7e905208a7294f84152d2c78e391380ce28f96150010e0830c6ed3c5962fe5f575f3b44bde6ff8a5abd9e2cd954fc37cee68066e3c17ca2822f57aac128d930474b0ade7397083e2baa0a3434aa31cb5287262888cbff75353843e2ced97b67a8bf4dc86f757e27577a40a57bd4aa3b61070fbce8cf87303b668e81907e9bd83a1a614038c1816f2cf92deb971e32f01f61755bfe84245206d81580f796f95fabac4ae899b943392ee23225e48bd7a64b6a069c523045fcf6eacc3bf7849e6395060cd0c9531b9c4e2173773080e0a2a219990174f32cc1513acf4c9bfcbdde2f8855eee5fa1d8d40515fa2a8ff5844c518a71d615fdc322eaf75ee8c8fce5d3ab7c82a69319ce75d834f1966cad1ef95024decf62c62df7bce8f185dd6807bdb8ba10de3ae6a6b", "b8ac4d19504407f9f867bae3e4a851b6be9873d100f16740255d58320e94c612382904e18903e3e3e45f4245166e9b61a12cf0c43cae196c0b32b65e5dd451815633d849df074d6d6f9692141fdce63ac1902b10b9194de44735f93383f7e93d8fdbd4ea043f12b887bdccd81fa9ef98bbc1a1567a8d95d97bd4a805bfe076b344f7b8464e1348366965ff0988af7ba75a188bd9d85a5abbceac656f6c77ef42e58e91ecf461a1739e2614b34533d60c5cc11c2a2ebd1d87273d8772fb78bca12589412e552c35998397ae36657106a6358af4c016c58a0e504fd9e41d08e9e1f42052d131bf03441483ecda423d47614768a10e12e8f920ec659c4bdebd29aa296d0067e5fb0c648db247b2da8bb1b16b88028122d58bfebeae49586a7d3c51deadbaaabb79408209d8cd167276cda35cee0f132b5986b63111d0d3bc5b3757787911b7f99dd6b351b3c3ad902994896e32a39051c6735a7469d8fee3ef4b86483d8bf92fd385673abb0644d0438bf908e2cb1931c3b7697838a6068531802f9c8022243e2be7262b2ad86a5e7bcc23", "86aff635cce0f338b0354c7849e11779637363a98128d973e33245a14294953fcf2e3585e71c10a021b51a3da664affa913a08e858a0e0ce01a6f95982ef5499a157b59364908ca9c17ce4d03a25d30f14c34d6fb45ed66170f840c76e27d48db4823a778b199effa8ada8029d394f7f7d00118cb4963d876c86b7a06a5cf775b94d18b4615608bc4dc8a93ff88d7e232c14db17f8b991efce9a373f7e10f698a49b716bf5d1cd37229c95a98ce45a7e2d1d1e576470df4022fdf526adff8ec14320465b2daddcdd53757abe6108b2042ed96d0dea0092b168e476933b1b3f0bdcb2e7b0d1a65881ca0970fbdcbd72cc35aa9931b827e2756c3ab4a6c0df49946a5016bfa2138d939aa7ac9367fe3ef96e14dd30b42f24f5e52a3a8361d069dede5d896e21421077edd99d4aef9dfcab590fcc92fba46be75032b9d84d906aaf38ad855c4c04e3e131398e9054e49ef42a748d5b64902ab3f502a320c7d97f3d86c69e4a6fb0c1ebf898f0c674e4b575", "83783799460bb8b0630255931582250578917aecb8ec87b9ded4ba606136cab4b575d00186cb14b6921e7c7841d15b98907e944c46fdeb5ca8cf70bddcb22626cfa7280292467f0d685b86573ac7cd0311a0da1358fd0f30c9214c6ff0da7bf2af720533660fd65aac92578ba5f3f552d709cc9901c6c40846da3ddcb7d2a5ce65e6de028e128f183b427db50ebe0645531dc83e16c795be063b579d448b960fe156db2a1c1aebbff12ab2d02522c00a0e82ba13ce93b4ab0aed71edc8e00e49cb8f14e00b67a31c1b27b153a3770c604357ffcb3995a6904985140e50e165de7554466e5df72d3f42e8228144cd33a915ece038e616391ddc18508fa6a746e809c1757af95f8dc44266d2b80184b4082742bdbc3027277dd07ebc2968b30ec66c6b88a94233c6723b63d3d615275f751fd98009eaa1ef6c29cc2108ccb1e7cb7794ce0ac9f29ef8bb2e2311e3db3b75"],
        ["93f33dd2e7b0a933b211be701a89985dd276b32b7b39e4983993490e0972c5c1e500d48ab631fc6a766fc4f002895420aab82edef8077c04c94ee082425378528e516306a080036fbf8622f7cb3a892b9e12aa5e9626795f66bbb2c14f1a0b069323e989abc877d7739876d7310c7a685430b1623c7d2e6b850b53077e5969ef89538e903332c5029c426ed2675665d1369d2f7322008f2572749c1d1cbd521025a8cd240ef623cdb927ebc0eb3fc96106bf3a4a2c69dacf0848fcbe9a98b80345975af5174c5d6ee619dd794260835732b254f34c5b5286b3de60189a4b7304fd82feca5ec5e63c852386b424721e013056f91b2463ccd4315f1329f329862f623a206461b9bc7307c83e93a225a1f1324762b3876f54bdb1153010f1198fc8cd2f86e0fd04b46f30e00b735400d15b0ae88a8a7fc134cf44f78a65b49995656001aa2e827fbe22347c15fd11d881a6369440f66d0d1defa790314a4c78c4e33b27243e5bdb1e6ec171c4a4f5d0639506a35230b8a5fb138087b70990c9588365a4a19708e5108be067f792aa253d8122721e7cfef0cd6a7993c67fd8549e596e4e0624c918727527d3e7a49bc78ea316cd307733e9292b18d391f403a62e3d141499b9579f406dd11e71f38ced3a366bda1870affd7fb2ac1dd3df6e01ef63b6d505d2cc2fc8a0258dac9d2804985c", "acdf17512445951a2ce20a1671d0ce462a57ad13f572c656b4e0bfe31ccb78dc6e6449a17eb165b01e5c57b5c37da1da8e72334e079fbfee34232cf6b9d36900653fd9e86988a5007ec53b293c11241879b15ca96ec4865692947f5dbd45a94da45b52ff97d08718f68456c9a7755488932221cc60853bc77989b883b8449f746fb93e2306c5a19a6fa61b199ea9290438cfa4bbab7c67ea54c4640d9056f086d18eabcc14b65685af29e25294bf627b2719abaa479dbdd9ed687835cb0e5eac30c59c90b9f7e0f24ac37af9faffb2880a05934dcc20a3e962c094f1ff555b8a20827958ba6f34154b6c46f803a10c2f5cef414e4f378a04e5fb9ba15718216ed25aa1571eb0b4cdbe86b5b95e8a6d99569dbebb45730789d680dda6b6f7425c9e749e6c12a160ae3742c02ebbf33f8a2e5f6a584b089199de986e9c6234438de1c607d288c059a37cd35db1510317dc5b1c23bd7459abd6af26e1ce39a6d79147a6e490619badb288de40b174c2e5fd612db47b7501dc799a09e312e1c8ff0a87884030d2ee4e1bf2656dcb7d9d807f1e7912f38a72c14cb95d88b46efd2421110575f860826107cbfc3855d916cfab1509f4e9b42718daa409c0669f8d8bc058ac09dcde041ae20dee88ccaf05d25c", "8fc69365b3e274cc6fe423a8ed2b51a565aaf9d32bfa931f1230f7b36fe691b9c5adf3739e2c0e01b0f6d9626a38e1f2a28de4b34e7db5c330f655ccd9be4a6259817e4556f5dff793927f8b79fac0e3d970aba29b81775fa3fc1d95135ed43f8eb083cfaa3358d9f17867a60100d8080137c8580d391a5710342ef3136813e220f11483465d50ac0aaa75ba310b6c493ae310c6a2f7112f4513d18a60440e002c1cc459beacca010b2c4ab6a94ccc3b3d7e177f6f339a8e2efb6f6beed8f6960c1ee9856d2ed47323a415bf998fa53463d8880913fc105b0fb35f118ab0e181e1d3c9e87086ad133daa4bc83b39a5ac3661a1d61a332a87a917b88c576da37e33f43dd7077749727c0d0fe9b382997722bcfdbd7f8f29edc734fe7ce5ec3033649db901ab2c55fe7120faaaa85bd73c374c45b68be150599c38ea033173d0d9a37c896b3ffd4a850f0c38a56c9c85062ee41e3fe3588c4c6a9ea2f03208f3be3ed8bf2737406289d005bf8a48006f8b30b0a2b39b61ea560d3ab094dbf844e0a02ade21eee7c31116595bf24beaee425f7424770cb4ee377bd5d302209eed87dd3ccadad235693a99844b37387a683c", "84566c1e6acf690be552acf2267a1d15e2ec9bdb10e0c08a4137405558d113c1bfb6d32ffa816d6f279665e9607785b485b0c8bb1c8d58b3cc5f773d657e7ca4946c9bb2ef5615e5124b7ce95e82aaa52fc02c6952cb1461c22b44561dbbfd3988b06bd323c577338fb76b325d90c4c250250561193a0abbca541938b4b767422f99d305f9ebd53a83b244d1416a25e457ad6c2c0d13c450573abf527cf4b199451106f3b908aa404625d2e3e80541796e1bbf5c7f0827c15b4cb2f1c41ef6cc3bc21e56e7e3f2002768dab9cc25ff6d004c4a58db896c619bdb7f54da93cdc04a6c23caa317d16d99f586ee5356194719073f2259079f3eea6223397966994c0b3da63e5c890618dae0229125ed00f143eab63fdf934272fdf0689c37fb5bc1cd854c309ed7deb959f1cab8ae7b173010bbd0904ef462fad18ca2a67b8754cf54e2ac1ceb7874f2167216f7ef7102e51e0f4d18f078138a9c870f7e85403fe34df80f52fc73a000dd8bca113cb7c11a4ee1e97309e77acae82346697c982b18b763534e192e39aad64c0dc7ed5cdf1a", "8f2280919f63dcb353bc1a3f0317eeef2c1987a564afcfdceb52cd8bfc3b5d4f4024b3adcf904e655f130a48bcbc409f80895dbd26c7abab49afc6fadd615b98e8c3b6c8854a8ae16fa89e744701345fa20b6e6d3fc96c576e457908175eb8f5ab1b42fabe79970d5e9d6d5b9c811c2f31c3c20098b62bc80371403b526fdebfabbf91bba16603f911b8cb5f23eff24f1955212ae9efbf805a08d5d227a2116b0d8a1b101968958ba8ac709f2775622053d13254b28e04956a581123d19738d2c30bda2d4fe6026068b0e5de6c2ec7e9604e57cab13a1f7d1674949e69116912638792ec8464725719f581f6bd9f018b3791782342326292d446866914840a9ecbb4642d91a8b0b7cad070ac9397f9d008ce73406555019a98ccb403d37260cf76a44708954bba3f6ca8fb809fff644b3e786b4feedf582ea0adec36a54ca627f40ba464af99decc4bfd85841b17b79211df7f9f7a12f9d09d35cbf619d44ef7362147213699d1acd5c236b2b7178915", "87edd65dcafe38587076faedb7fc9a0481f73a43ef35f7effc78006a65cc1180208d111b3a89ea5f7a891c90729db58f841939cfbd030c8cda038925b90bcef959b4d0cbef10efdd3519d4f32c62f79ea0c41aae2cf078eade4a4ae1a7573d25b397f4e264aff44f2e7314e1ba95ca941c13e0e14339e39c58b0df69d079e5f5820eff9e145ccc87dd44c341e998162910ab3389c85bd4974704a96116a09f3b13a4b2d681c86677a603da129523a4a5511628777b74131f8bae5c2d3d2c5147ac88a7779650e1a54ff2b487855283703ebfca831b81eceba060c009e8b7fc1ce610ccc866ab3ddd68f46c04d9d71c86144dc03e309fad2ac560889acc39bfe2ff61d5773c21a4ff3be9d110244f8be353e885a9ccd24e644f5cf5bf8852e8107b12813a130135e3865a2031ed1095ec3ca0b84d6ceeb7d50871fa77f08023198e8fd667370274fd3230039231315cd2"]
    ];
    // No presentation message
    let presentation_message =
        PresentationMessage::hash(PRESENTATION_MESSAGE, APP_MESSAGE_DST)
            .expect("presentation message conversion failed");

    for i in 0..TEST_KEY_INFOS.len() {
        let pk = PublicKey::from(
            &SecretKey::new(KEY_GEN_SEED, TEST_KEY_INFOS[i].to_vec())
                .expect("secret key generation failed"),
        );
        let gens = MessageGenerators::from_public_key(pk, test_atts.len());
        let signature = Signature::from_bytes(
            &<[u8; Signature::SIZE_BYTES]>::try_from(
                hex::decode(EXPECTED_SIGS[i]).expect("hex decoding failed"),
            )
            .expect("data conversion failed"),
        )
        .expect("signature deserialization failed");
        // start with all hidden messages
        let mut proof_msgs: Vec<ProofMessage> = test_atts
            .iter()
            .map(|a| {
                ProofMessage::Hidden(HiddenMessage::ProofSpecificBlinding(*a))
            })
            .collect();

        let mut proof_values: Vec<String> = Vec::new();

        // Reveal 1 message at a time
        for j in 0..proof_msgs.len() {
            let mut pok = PokSignature::init_with_rng(
                signature,
                &gens,
                proof_msgs.as_slice(),
                &mut rng,
            )
            .expect("Signature PoK init failed");

            let mut hasher = sha3::Shake256::default();
            pok.add_proof_contribution(&mut hasher);
            hasher.update(presentation_message.to_bytes());
            let mut reader = hasher.finalize_xof();
            let mut data = [0u8; 48];
            reader.read(&mut data[..]);
            let challenge = Challenge::hash(&data, APP_MESSAGE_DST)
                .expect("challenge conversion failed");
            let proof = pok
                .generate_proof(challenge)
                .expect("PoK proof generation failed");

            let expected_proof = hex::decode(expected_proofs[i][j])
                .expect("expected proof test data decoding failed");
            proof_msgs[j] = ProofMessage::Revealed(test_atts[j]);
            proof_values.push(hex::encode(proof.to_bytes()));
            assert_eq!(proof.to_bytes(), expected_proof);
            let mut revealed_msgs = Vec::new();
            for k in 0..j {
                revealed_msgs.push((k as usize, TEST_CLAIMS[k].to_vec()));
            }

            assert_eq!(
                verify_proof(BbsVerifyProofRequest {
                    public_key: pk.to_bytes().to_vec(),
                    presentation_message: PRESENTATION_MESSAGE.to_vec(),
                    proof: proof.to_bytes().to_vec(),
                    total_message_count: test_atts.len(),
                    messages: revealed_msgs.as_slice().to_vec()
                })
                .expect("proof verification failed"),
                true
            );
        }
        // println!("proof {} : {:?}", i, proof_values);
    }
}
