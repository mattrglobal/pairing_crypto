use bbs_fixtures_generator::mock_rng::MockRng;
use blstrs::hash_to_curve::{ExpandMsgXmd, ExpandMsgXof};
use pairing_crypto::{
    bbs::{
        ciphersuites::{
            bls12_381::{KeyPair, BBS_BLS12381G1_EXPAND_LEN},
            bls12_381_g1_sha_256::{
                ciphersuite_id as bls12_381_g1_sha_256_ciphersuite_id,
                proof_gen as bls12_381_g1_sha_256_proof_gen,
                proof_gen_with_rng as bls12_381_g1_sha_256_proof_gen_with_rng,
                proof_verify as bls12_381_g1_sha_256_proof_verify,
                sign as bls12_381_g1_sha_256_sign,
                verify as bls12_381_g1_sha_256_verify,
            },
            bls12_381_g1_shake_256::{
                ciphersuite_id as bls12_381_g1_shake_256_ciphersuite_id,
                proof_gen as bls12_381_g1_shake_256_proof_gen,
                proof_gen_with_rng as bls12_381_g1_shake_256_proof_gen_with_rng,
                proof_verify as bls12_381_g1_shake_256_proof_verify,
                sign as bls12_381_g1_shake_256_sign,
                verify as bls12_381_g1_shake_256_verify,
            },
        },
        BbsProofGenRequest,
        BbsProofGenRevealMessageRequest,
        BbsProofVerifyRequest,
        BbsSignRequest,
        BbsVerifyRequest,
    },
    Error,
};
use rand_core::OsRng;
use sha2::Sha256;
use sha3::Shake256;

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const TEST_PRESENTATION_HEADER: &[u8; 24] = b"test-presentation-header";

const EXPECTED_SIGNATURES_SHAKE_256: [&str; 7] = [
    "a3af298f47792f6268bfcc957fd2a5ab859ed5e21bbe9142c9ed58d428412c6f2342f39accfc031a879bb58b73d908243ea7102faff9f93b34b322e2707d74d61b6a90fc04e687860796f087ac0f6f37",
    "859d43ff7820029f04a0852f97bce28c7fd90804cafcd773114cc33035e6b229d60e7831fd8b92a4c7cfa556449fcf32500343e9314672aa736650b614f5344e41c98d6b114132fbc9ec9cf881e2b635",
    "8b1c3b4426d4d9faba58649852f51c229c26d1ed92475e0588febd3e94d33f5df03cd9222b8977948ee0b76c03920e114551ebb6f0e5663c01371ab5c715a0e4fd2140edbe9c1ae0729be7c29c1d2608",
    "864534d1f13ea279b9013c91ac3c7bf5aceb652edd537604c56750233ef907d1a6ec796c9f5fde0997bc45334eb725003c144ca0990ab8229bc62d1d80c5016c5abc52fb34bc5d831d502c553504e926",
    "b626d87f74da74c5eb745e8891625d22a7e76217795430471b6711916f504a901df2bb4ae58933cb5e434175f52dfb43430e3a22e989dbc1dd5ac837529f16c520fa1d892a6f9e515ec0924d5d6e1589",
    "8fd3f81c861ebf586d6f38acb1324bb900844da0d5a6fd051ca7a280156431f3d614aaa6bb2cf25f8119d7b3b0dbcb6502f6b9ed48e4feeb4bb2782aca14f8c8fed2bafafb3057a1901cb4f3f9375ce5",
    "a42ba5172b633683d9cdffd9f0b5d6d8140ee64a9afa1d286260cacb5d95b62c458f99509729c4b1f955ef147e16dcfb6881e5aa8126bb4d6d6867f0619a8a466797a964ce100bcdaa0dc1f911d79b59",
];

const EXPECTED_SIGNATURES_SHA_256: [&str; 7] = [
    "a442f47f767376c6cfeb333e8a546601092ad3b8a6fa670253e16d2165d6044b0838b2ae6c1a6aa3a2da407f4ff7074927f790313a0365ff8d711d5d21235d26c8029df4a71dd5886055abd2c9fae2ba",
    "a60cf03d48d2c4d996ee065264a42d2ef2e39c307c4761d0397cc5b5391dd0aeb530e1db0ea61b76df8a351d18a7016b5c523e57a69b613d93a2a82683d9bdee16db9eb347ab833151fe01950fd2377b",
    "aa77accee05bb023b2fec199e48b204185ce360b31addcdbfc932fb06888b262efa5dcca7a2e9257b66d055d778931ab6e42be89a3b94d6c71796b642fd1afb194c9a317d8d249c8552247b02a3cdfc2",
    "b60128e908baa956392c73c32597dbe266c7bc0b977fdb9553d7b8cdcae3c05d87931ae256143f8bf8e5dc881b042fb53dac559fbb3884b96b76f82c02c2b3c1cc1429f7333d8acdca63f82b1fa4a953",
    "8e341407cb35def08a446e0954a87756e533b8d4ed5e0072cbaec947bf5af704ebe22f96a419c89d99dea5b850c2a4de6a828bfdb61fb943007ed5762dceeb568d302dbc51c0a4ee69a628fdb5ae1451",
    "a2a900d5de82b329e786e0469358f7a12f5ebe0bf25a16dd2731866f4fd686a4bff6b7cf728c75fa15793deb08b758a368aa6b8615a7eb64f8f715e3d1070730b347e3da66e382b715c822c1119b62f1",
    "84445abf026dbd99f74ed0d156ce3bf6ea027770c57ddb13aa6fa335798ce929d9fa5a1eb7d6ac9148db5810fbabe5fc66fad68e05127105b00339b0fd4157c3e5ffd1d9ea4aa77646379ec8c4a53383",
];

const TEST_HEADER: &[u8; 16] = b"some_app_context";

macro_rules! sign_verify_e2e_nominal {
    ($sign_fn:ident, $verify_fn:ident, $signature_test_vector:ident) => {
        let header = TEST_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        for i in 0..TEST_KEY_INFOS.len() {
            let (secret_key, public_key) =
                KeyPair::new(KEY_GEN_SEED, TEST_KEY_INFOS[i])
                    .map(|key_pair| {
                        (
                            key_pair.secret_key.to_bytes(),
                            key_pair.public_key.to_octets(),
                        )
                    })
                    .expect("key generation failed");

            let signature = $sign_fn(&BbsSignRequest {
                secret_key: &secret_key,
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
            })
            .expect("signature generation failed");

            let expected_signature = hex::decode($signature_test_vector[i])
                .expect("hex decoding failed");
            assert_eq!(signature.to_vec(), expected_signature);
            // println!("{:?},", hex::encode(signature));

            assert_eq!(
                $verify_fn(&BbsVerifyRequest {
                    public_key: &public_key,
                    header: Some(header),
                    messages: Some(messages),
                    signature: &signature,
                })
                .expect("error during signature verification"),
                true
            );
        }
    };
}

#[test]
fn sign_verify_e2e_nominal() {
    sign_verify_e2e_nominal!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        EXPECTED_SIGNATURES_SHAKE_256
    );

    sign_verify_e2e_nominal!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        EXPECTED_SIGNATURES_SHA_256
    );
}

// Expected shake256 proof fixtures using MockRng.
const EXPECTED_PROOFS_SHAKE256: [[&str; 6]; 7] = [
    ["820469738884be0f8a980a48cf897723588cceeb6e0309f997f8c980ace8ada3c51c9fff4fb18cbe817016ff8caead9ba111d8f265e3c1bba3edd22d3338a8a94bff30c243aa4aae8a196301375b718136b25cebf517a1d21ccf6637adbe1eba2a977ff7c7ceb8c7cc113200f7b6fe459203d71709587ad6432ac29df341074315e258440cf4031d5a1db54130d8d39e7c43f1f792bb02e4f97a1a6ab6ac4f735a282239403cda23cc8e14422005e08b21107f005f07bf98c0c261d771572da53785d14b5c55b0dbd3b74d7b937a83a9f7b170cde364330429afb8787f37464826d29b86ce305e65dfecdf23289fb4d273df599f0d17d084fee5069efd5670df4a23c872e37e7e9e88bc6b5bb77aec88710c7e842c690c1ca7d13644f88b07f8460a5946cf7ed381f174f0ab8b33e30932cc450e8fdb5b4cca914854647b96d129f7b4e15f5c9af3fe643676238dd49368c79308b50a5b10156f65ad4612c88b4f471dce2578a127585ae981cb8ea22bf8354d1acbef1ba0242256cb782e3bc4", "8d595618442985bd171c0919ab510e7166c7860dccd04266e1e2744680cadfcb692b103fb5f25e805b2029fb38b76c19a502fddcf038104309b33715873fa4adf6f2ccde95bb9dd2af5752d2f01ededb7045af202cf15c75de72c260ce899a401453a1f56ce5e76b5bb1d4fae5fab0cf1bcc51814dffea99ec0a571274c19d724702c16170cbeb2273105f05666c99fb73d80fad7e4173c59ed8ca017626f0c221c42aa79ea8dd176807e636c6b895f44af34f1b7030905e1ca967c8d07f996e344fc4ca3f51a97232d826eb1150092e98f63d93087605d248c1c3210cf43e0269316e398fdc2025bd9548e2d4a14289c1c3742ea5fdc22955df80ad4a05348e0f1d93164cf66598da89dbec0ec4db7aa4a27b66a56a5e5cf1884123507fdcfa3060ca011b36ef9bd358687346355fb34b1254f1b0c57d0e666884cd222c19fc6726c0afae5a078bede8a74c6a1b5151fa5a6fcceab371dcb32c00be6a65079d", "83839ea13d7299793a850a7105b581ba57209009ac7fd619bc36e3f611107c2854297b28dbbdb8586af5f4a3fd20d1d1a5b9a11a17dcc55f8c46b614287044c80747f81cf20e7b89b4622d649f061d74739a5a53468deb93626cd21e422e040d30648c6743a30f0cad52d45c10e1152e13fba68ce6e36e9e8a50d1887f2475ba293beb02b1fc48a43de3adb1e7cbe331a29c2da3ec89af5358fb118c9a3b01ec25a121ed96aabf697cc61ed04a1674cff2fed09f78e6378dcbc04dd72fbee48854dabd34735903b75c346b08ebd68926c46a4c29618410536ef6bc81d94aeb6903856351033477c36cc539dc23cbd587aedcffafd55c9042838835114555123064e9bc6b1ca0bdaa36a003d0a11fdd5cb329cd362e0de7cfc35b274c2aef17995cb6b2ed29af654d7b906f44a400df2430b090e0fbfb14571b91a163ceab7f7d", "a7053cd9e5257258593766720ebbcb5cbfd3653fc16e114ec781d3da616895153804299ab66a0bde6819bb09df3be78b8476377b971e193df0acfce9cf4deb47e18c2618cdc3f67122a612a8f9a359bdc8d7d7ef82c0e6dce2092a9890ab6fef1c5eb2519a7410f6cc46e20a2d010031fc19600de83b8aefc91e8f8ba0b26d6d3b3348296e821810b7f2ec5ac4aa0088d91364bdfb62f9500acd69d15c69fb331da01ea926bd2e841c58bf5272f316af0f9a4459ab3bfe6bb6badc4133866bb1044f20ac801193b75035feaa16038f3f356515a989fd5afa73a6e96a468379010e057489aba7d43d8e511b7d3b9ca98e625081adb008ec03c02e874a52c34c8e0f6c9d7ae1996ed16a5b161a262d5b723ad71834a33af89abd04a178bea4dec2", "b76462988494580e95d832862b1509a5236eec160a2c849e98a26349d52fa534d0e6664b35dcd0f346c215270e7ff9e388b29dcc8c3bb00bc2c48dcd9bf010ecf09c3f63741cdc723ba7ddbb4af33da75b6db9af9717f659ae84bd056465116825224fe7e55fa3b1f04f5f069537db646bc98c5dd5b9f32c9bf0f60a917229c6108fe29a0bc39367576ea5620de0ef94f71be8c274ff3ae208a2e30613593e4921bf0a289e3fbe1c0ec7a8e7fa34224fb58aca62a3ac3e4ccc1bca98a2e9f517065e54f961e13f0dbc59a31601d46990a6c7869be325a69bb4e3a7be13f744c0227fdcd92f3bee2354355e58950af6ada5a09751f2fec8de99778840832ba907", "a9eef162ac5500e41933fe0218754565d69021440afdbf3b4bd1af2401df113ebfb1ee56e510b68787fa3e6bbed5b3a98e22dae3a66ac672f24882c7606b45dbec31a70a49c9400307baaa9a52f0e9eb1c924573507dff3302b838b409bb705c53fc25717f32e57e20636583e6b184819ccc307080af9bdf1fa6bb281d022c817357451f6b427148476d4a993485f47d3f56dd748f3757a4fad5a507abb32a7372ac4d7c9a750d043ee700a241796830cd9fea3cdd34585ceb64f8a0bc5dc260297436f10bcc64758180edc60b770f5d09f2ff4c62fee19219112390bc40d80a"],
    ["b28e50c340683fa3611f17f673ea42094eca356b0ca2c12f46c09fb98bf5d2c64da2fa06f74cc17ae3186086aea814c2acdeeb41b3073af8f927fb86a1806c70e5decb5dfdd40771dc28687821bb848432af6090ade4dff6f48f9ac7c75ceec636e2acd9c95870cd38af443b82965c9a6bd13f89c06ffa3c5bd8ad8ee3963e17164a847a2d094cbfabbe818f70e29011e93c1d25bf61352dff763c4ade7151b172e90e8cdc9bf95b6fd79a2c7678bb9b076a820dc76983c1835381e2c2c02d1e25ec5a8f1cde067a135b5136208b1eb94f875b45b536a8c00381ebe6c30523b005edfb2c22ac1dfdcad3e9c4dd96251294a2c6f7d737ea29ce347b5772bb30ee561beeeaf6fb3f199adaed039689fb032b9dcc2e03641b9a1fe8b0b5835952e72e3f2359ac449d610a8ac88d8c5b2bc04f3f6b1512c689b858c504c4256a33f84fc72707965ce92a248e316f20607c51eae6f2c04c953b1137560bbb3a2ea8be6e0430ccf8ff0974c9ec94fc05e1273240194fc705e7e6a80f9f1f067a1b1e59", "8d40b28321999002c232d9cef694c54a10028ae59637d8810bce3c9241ea46ab20de004a23a00a419458599d92d5c74cae08acedff163925ba26c6bf3d4b3dd6ee4d69e81591996a0afa75a6a80c29c791f386e276fd3f547cff2e2e94fc3fad479a4b704f9765fc91d3bbf1379f9153237cd9d38eee78997206ee230a269706231f9584a13be8e95c64be5fec35f7d7b565ee7d3d25dee122dfe750256c897910d4883e2ff2d5c9fb7c8636a2df99bbb71ff4a7159112e5a5ec791bdb60ec5c4a96be2c748c9a1e974e3fcc7b52a8188b3956f79425d1af50972f475d9afd5868624de422d57e27c1fe9c50a4c4bda49afad0516eeeef60145c31f30f9e65085e65e454677c77766af1a3e1e73c704dc42e8d961fbdadf786bcefae5f081b4b56f85494dd1eda0a9c102c0f5b0c84e22c010ca4fd461ad19f262ab1bd9e5ae01ab9c42b6c3520fe15cbc77e416217643b517da1ca9b859d1b046c61a25afd64", "a9b3a15e893f94cb1e89b706828a785939c2e8bc0e04e23e5bce3768a4b025dfc8617a4ac88f400a43d40480ead27377a7636d354af593547e01ef233ae89a4679af29b259279b6a35f541b626bf3a769a933e17b0010480c5c91833e59cdf4a627e833b05b962f13fe8a04fbc89fb7490a6b40ea1e7863ca9bd9f128c1033102512f687a93fb7b534d636bdceb66226b77c047a0ce0b88951ea9a5bb72e55cd20024a58b67a9c73037065fcc0e60ee94e18675d2f85c8b229329367d62cdfe1630e2b579e35556e4f64a8f9f84af47274425a9ee0239a3b4bf612424c8d22211feaff5cf82937ad1f7ad7c56429ebf303d2e0ddf5240771bb55ec3ca9ad3a256be1c3c51d6d49e257d6b6925082ba35571f2b5023e7a7db18b961742d77e9d709ccafed385e99f33dbf169520ab8dca9bbdda46b15b523fbd32af6757536210", "a11d3a76c067938effd1a477a92ffc472fb2bda49fd5b2227d5407e049514448604aebfe533274c9836e6a4675512dc1b2628e89f4882cdf5ead537d789516fb6b411688c73633c2bbb5cf69b97090eda37a43f63205eb324d2300ff66ac010f00a3ec7de37393e230acba04532ee975151c6059626d0f0374cc3e802d87d64120d4e4c0843d2e862b1d1793d105bb45078cad8878ed0864fabb54c981e209ab3077dbb3ecaea02783caac31e29ab31374c2a7054161edfc0c72005e62d80c710dcc5646367b2aefa59c34d4c7971ed752cc8242d96243a517cc66cf12da58cc3001611c29d3c86095c65c53e784e2d1297b958b01d4393b08866a24d11e53bf38b13c0ea849dd78738f0afc949f6c035c484f9d2c700f8cec6bab4938275692", "a8547f5afdada52faf06f220d1147401e0e5393063b806a5ab40f681b5d64c47cc3db0118cc77b9a0ee53198c3cd7cc09785f8ba3a6cfb0b0e16d67b743babea35592344bffe26ad0eb40596a94ae092994a1d3e34f16bd0f07dda3f49a6d5c910214be7a15812ff2266a55f7580bde6bd5bd1c71cab2a80253640a01a40c9e35daaa17bbb9b1e0639ca6dbde11998ba6961ebef4d9ee46ab2c97b7c925c277370b1c5b9b6dc5170731f1ea67286f1bca3865054cbabc5cf17f3ac26c30aa088497190e5b890106c7aed0596e49b32aa3d247374a4efa36b6e063a98790f1b3d3b155c10ea7eaf68ff6192cd759a03be8aabae85ce82b89280b51b4b24230673", "acc28ccc6f69fb79666b8a5b8d13844f9fe03d8f97c86c2b57068512dc62b33b80c0d7ed094335af98f48a14d99cc578a3978aae87f650ff06a10f74b2a696024af4740e224af63cd69054ade28990fa4c99fe4627e42a80694afbf4eeec171647d951df0b2c2ad008c25d8b906e75784b89ef9e43a723ca93848b8942080cc7316d5c052872a0cc25ba74fbf9f23684068307e5c5d774fa3f0c59224236aa661a672fc06e913f42c216bf30e37741000d1187d54ef05a0e8b186940c4969a0122eddcf1acd22cd439312fadc1b0dcba7404192d7f49474a63b868f413cfd18c"],
    ["a48a134bb719cd75fa50aed87aaad3427da785ce00b60640344096445bf52bdff96f803a763efe15cdbd39c3b6128443a1c0998258df8bf4ec8d091852e113d1be7e77c24ed1fe29a22feac74bde1af9ba6099f3f02f6c13d988a7210e26f8865fb4293b3c6b6c06e283d5e103f0131a852ff7cbd7e82067f8a8e861384d81a81d0f70c7d2efd59a7bdc4f49ae6216fe380b1ac8fa3a88e3cae6f9cec5430ac26343ece221c7a568cc121e554d3b13e8e38c687133f6593b037ab3ff48b045535ca7f7bb0330f34b71bb4a74343fee1e300821e6fc6b63dc52a4d7bd1ee0d0a910ddaa9837253a216f47e025e2314e22dcb0476c40c6c00cc420a020214285145804aca37771cea2bb7a400c4e235bc59d2039ce045bac835e93d09374bf60c01af1cb00630957151182dc5e462bc8ff1639dd1abcc20cc8e7c84fac39d28f224f54aa52ada8955150abc0127ca3f9e512fb8b723fcff5203984a777ffe217e60e0ec4a1ac5832b041ee3fa881d590d2e3411ad6f7339616b088d4d26e1a47e6", "840b98e2ae3d5db5cec9ccbbc03b8313dd37bed45275879c8bc66ad174d55564ca8c1baa691d0c8e856a8b1c4200fc988ca72156e2a4ec779f7e409746e82765b16ba8f0ae58545618a7c8e0dd1e7f8e2f092f519cc0a5801643a4c16e8011381a17fa0286d1b0fb42250dba8db7606be1032ab86e560a244072dfd10068bb8d1a0f8a672ae5488c522e3f31a5c8c7f6754042d861a33bde3692fc4476712f55088535c43f3ccf7de2faffab48843d29a167edce57d10c5e5f9c6be3dee7656b4480bc7a46de784ffa10d0bd380404e46fc62c772764309221bb20effc925a3f5e472a399ff46da736246dbb1a2f63a5db466a714c4a12bc611ac45c33c5b24a44b746ca2bf62e136be0562a17d1bfd7b69e36a7e0a06383725cb529ddc68ad61b6ada6a0040e781b7fde9b0139dca0ff09e07e7cb8cfe318656de7a8d94e0a00ab1a0cd14e9fd3d25c47228f54a13f2ec5f4e21da826a2641e0bb2bbfb27d93", "a1ea955e192f3ace764cde0a4d7849f26592b8efb3391d26e3607d4d9710d2a096dce573baa06550a2c135becab28cbe8705430288efc0578193dfdd74ea1464fd0a08567f12dac31e387bb2cf57f2dbe6543739320f96550b91a3c25ba1f6a043cb7fd7b96a2071f1e65d42d2608c576271aa863662f6b8795c4f46047873a658dca65978352d8288a4af18736c307b82fc49a3748aa7bb90ab5736d1eb1e60163e91282ffbc0b609b3cc727f273a22bcddd1c9e371a35f06202b9c3dca06d34cecf6d858c99bb0d1ca86c5d644ebf360b4f176081780cc3c929d77fdf2edc757fe4552dd433fcbd2bc39a13fb03717a463182c342691011bad3b4e4f21c8ba487b73406c74ba21409d920a5f47844050bfe9155afec24756be4cacdf79c41e66522a53764e3117beb0c5901f1a9718411ed215f49cf7daeca029b26b44d04e", "b6659f7a22b92467994603cabfb26807d127136a022c7bcbffb4dc5519998e712043c0296852408503731cef64a51793a12099ffad786e58451577a450f744ad3e908133ab3122e9eca575b554510d8053aa2525fc8378386e9db70bbb2a76b3649ac37ed8c8e6ef6a5c6ef95f7ef5eea78ca8cd9082680a8597eb31f0b6723f1e76ac67af93450286ed0f9ba2141edb50348b6813a634b410906ecbc46eaff428b202c50eb059b52ccdb65a58bece76bd325fcc960cc29bac08a5f6884dd8a869d1d4b5dce6453cd74c9bbc1015edba7a3a76bb6a0f10b091e63ed529fe1b9d10202e445aa070bb94320d56ad5d1b6f29542fc67e471876ce4bf38fb98d9ed46eb3b845f7a1b66ac57485adf5f3b03aa6b5ab7b8a41f37d16c167e1923ad067", "aefcc8d55a5ac5778f9df6dad12c96cd8133b128566e994e5e2b5bb581e60404b3dd9c14b1db3f20a912d2e5d73fe7fe8743f7d05b10ca0394f4ead0d9b00d6756c57699d5dcac79d5fc4fdb8cacf5d7ac99dc55e81e4268ea6153c24033d19957581c11faf57dbf0b3db593f4354c5ab16d0fa84ae7db704aed1533887813c62c90d6828783088911a2f0c49703ae8aa3f93e67974fbc6b9d7d914052f547945cb4e3ae8803cf248ae0d21acb10f325ee2fdd9c30300951210641a3cecdc922330897c8f8cf5037be80f8252a37e024ebb32eccfad0dd5b4c1d61ce12f8f8a62cc202442a2097b8fe9d77e2f57ee3c01b901a7f3d99b92c82b20e5d2b0db395", "95f006662c7b26044806963c731c429ff457e0b000c6d0528a05fce616a8ee0f5ef72b231d4c6606867c39c4cd80696f90f2f5e9122d362014372fe06208db26db473c13a6d85d1c0672b4756d7a53b81d4f2f790f4fe2ab55e131bb10f0f9b82506d77bb053aaaefab24198a2eff68cbbe401db765466577843fc275cdbc760024cb823626197a8b1551b745f19df587ae3fb726fe818148d44adb8b6392e0e70b76ec7dbb953ff823f3381bb99f4293ed46cf8a9c136ff15c722a2f75cccdf00e3bea190d7e0673057dcfbfab2ad032094e1f68851d1597ef11cbc62827e99"],
    ["91c54b2ffa4986ffd77d658806926b3465f9d7d97029287aa6ca882500360a9fe342cbbd5ed0cb901d90bfa9f829aadeae0de7265e9123bcadff967eddcd3899e33c19beddd5c2721b1d737066ceecb3f4cae72eb4c64dacea018123b145ed60342259b8d7f1b728bb51d738cf59eea538933e3eff6dabd03522e1b6ab2a7a6d164ef4c1d893dc8fb5b21168dffd36c5182b3b57eed2156f2961055e3cb59b026cccaf6429b3c0d546275571209253cac84555f77faed2650995f013ef6a26095ace8b2b9b5da1ed0b3ffcd7f659b99a73a207e244390391c6b052f056d0d97f102f71ba6d36102611aeb5f7117d168576449bbacb4f38990ae4f5784651a42f177a113bea08d4a58ba8fe3f7da5382c62964137a68bcb012211708a4e9a4f2627e18b2d589d32b3e24796609b4b91485c7c3638982c3d1d19b14feaacb57e6f2b631d1bfb1123c0a4690013045eece46558215099ad8332a63fc421949521e3134f44e857070d5e74896537b7f42fbf8942c3f4a25c7fb73fd4e3222aada2d1", "8d5e273bd18a4998e8e304888d41b1a38e17c4440eaaff30bc322c6965da9e3b60b8a7b4d1ccc0ef8fd4610f9f8cca7b896e63095ff74a0a92d658eb3b157b73bc424229faba4b2ce9d6514833ee82e2e1790fc2ed8da89374e9be3dc94808a11cf56a710f02f9dcb1c887dbb267e4508633a9585949083604b21cd354e8a0a844e672e1b3d2d1572e3837305839a5de75ccb92737e608a68a5e46c46071adfc1938b15ea4fd4354ae417d0bdede8250eaae758044eed37182e26e922f5b227a35319661a4693efd505fba254c03800b68b6aeac5d238676d8c3f6384b061fe90168ff8bb453082203815eaf595c3c7d8cdd75730e46a57d6e896c55b0ff523e65f6cb9227e79315ba5d9c48bb8ed788593708e3f342f3f52e609f52a37ce3c3544087be1c99fa61179004b3f475cedce70ac0debc3afb254bb35f50be62678c168b03089dc17de330ed69780a9eb1342624ad0a434264d87566c96c68caeabe", "a665da8edb04bbd375b334d708217f6531b91ae4e704043ef8b5cfe68f51fb29c91fbba49e75382b75e904c2725acd1c81d830a93bdf376b3478aab21cac0857c48574325a546f46c07d3c5898763f63ff0c229a0b10da98e6c2d1c11d91f2962da8a4676b152f8f8bb0792ed4168b51eaa377de1ecf37a2754cde4102b88dc01dfcbfb69ac7174e481c0542effdc0efc39989575375c82a6a3e579cf4823dc52230a51559c82657a5b360f3b827072b8ff7e64539fb08b2583691eb165abf7010a00436b4cc625376a41a12723551fec85dc524410e792c516dcb1bcd81cec41f1d6ded733915461abb98d00b05d65baf7aebc269a84fadb9bad9e6b7dc957c52a243f379b53e1aa497c12f16144f527ce74735731e8f7d016a955268f16aa30c36b48d0b59a5fbd561f383716cda17e79e7f5f0238d938418fe570b6b6636d", "8959cc7b57d2b1fc48593782f48391f54a4cfe8633e6b86a83eb537d529f8705bb895682e0dbb1b9249dd56d34f4dad882f3463f7437f38e567f153928ce22da726cfa512ff5f0f1e114c4b1dab209b1eb6ae9caea86756cfe9781624e947fed3a3fa4732a75e627f0d3d77d0114093725f1d1afcad41bb506bbd91eb97a483a043b7e32daed51cd789c580afe3e31356caa9707cc2a37a2873b5bb1d922dea86ffa22a337fa75d389a047667e475aaf829606094eff08911b4e5bca6f66842c3d86bcf0d1ad63122c45a2ec9521b2a4bbfaa8a1d170a3ae4c209afe8761e9481e63af17c68324685dbfba8afbd52a8f494dbdef6d747b82741c74cc81b6df3c6270394b76a24b95572c14ca96d25cd97355402970af48cf04d4ef24dcb6b157", "83fd61fad5b897417d4336619bda8701cbae32ea9d1a8058fce0727265a6a0306b237319b10c262489b9850ebb001c54b1c20b57377f7594b28f530dab017c6d8d6720cc703cb55ce700eca812abdd79067601b897f05b78b89874232d36e5ec44dacb5430c64a3e2dd948f392feb5490044e02af7e964bac3f1d1f1adbaac4323e0e8a5c292e680a55d72ab5bbdb20ab2709fb2534fca92d2e8ae21eb39f0d2593eeb34b279e751fa840d8a805c03d3f7ef17a7d07ae3b1783361bbb74ad36339f3e55d84e1c487ede5c1debf740ef51c22432bf4e3ec684d6f65470a60ebc340a90b19bb87f4b5ab43158ace3e014e158f0afb5f4330ab705e258daef7de82", "a9658ae94cf95b66955f90221ab0d3a59e09b16e0b3c5198100efc51c80ae9790e401812a8b1ef5b030338f87c9990cbad234fa802fe04de5c8da75a1fd985bd4640dfaec05ce0c1a39c7b90029120efdcc195fc88fc26ad87635da59b95612d54ad9120442dcaec8d29ca0b78659eed9490a6986dcfaaed8a9da28a45cea1072ec9d2ac8861a1ad7fe6179c4816364a1b95dff2226ab33394ceb05f30eaf48349b17552bd444e68e08488b68d9b0cb18dc3c37b97ef2af54b103cd48359668f5a89f8b1dfdc27b7829f1f7bb883015015e389c0025bdb7c7f4f6537fffa2a90"],
    ["8beef1f7bd1209e7fa9626373bb822ad96999f03f5a08b3267e515fbb2bc4c99ca14d9f295a68bb4b9229748312993e5aa637fd7df025c9026dbd475cd711221e6c42b3a2b7f482bceb1a6463f1ce9c35abb9c67426c0b76857de08dd290bebe55fce6464c3d605c3bbebb0f444bebaf67bcf8b5a904e3f85c42930c5719144b25b00c6aed6a3e1d2528d4a7e2cd99bbad716fefd8fa3aba96d20f9053fe418c2324bda5c06bc7a80d3e481472e1b03e718d458ea31af6275f51a06ed2e4c5543f016bd246d952f1d7a62dc7d203991713a68f323c82425138336e17500ca8be20cc2da574749ed26fd866e5c85cdc66fec626717248f3d8ff28789446831fa0345c204c01bacd4bb7ebf2b05d98f2e9839237e0710a59b89df92e1e9505dca30391ae09b19b504a7a4fbb8918bf3627f2308fb89cdd7f4d6c5627885dbc6deb6b47ac1c9a78deabaa8608d4e6b9fb395e568275b9aac1ae70a0fb56496d0c7e1dcedc8d6d7129741a5ba78bca34f45d3b4f134f66841dc70d1c36763e659323", "872c46498b3aebc90d4efaff76f22aa960b4fa15dd521b6335be2fb629cf8b7c51857662141d717c627864e599864b79ab695d828268e644841a96e9142f428ccb4b774318ce3c46bb80deaed59a385886c15607e0a1452fa4b9350ab554b579323b3c49a50f619616f7579a2050685d3fd636ecc16ededfe572174362fcbd8e0db55c227504fe90a938c2ae8703cc36f60c231c1575843c82f01d721f1fae174cfd50a7d4fdb2de4947126a278d183d144f053f64f1112171eeb5e3477311371c58ebfdc4c715c936e66a21412ce1c758e9ecdc702ade9133ebd8c2eb78f10b6208954d7fa1116d9017b06934babb7d28ace3be81a07f74e412982dd93cc1946494741a1fbc6e698605b1fff33717e78aada7265ae15324ad23c9f17ff3f63b4ec88556652350d37145eee91dd68dcff2c509a85710ea98a75f13ccf42a815220a6dd113e47bf88b7316a2868da1cfaaceefd9650a8514a6f14f35fe1c9be1a", "b916bf904a3a2659882f71c5264e6c6e010660650223acb4682667933c16aa400c9f9978c2e081f428588d3b86f6820ba8905978b8a0bfd0207eaf257c3359e95b7c2561071259b70e61430365adf6e59ca0f64074d9923cb4013fd8155d873f523f254d76a12caef89f0ed6c121a5523c9b5bf6c28e22bbfc0904f6f1c931cf6ace44986958bd41c073c464f25d1fe9f54b28a781bc4928ae3a10fffa6ce32c57151e9702d395e3b51271bd4bc04cf8cc9a0579499559060ae86514a556bb2432a6d8c4b182f07abb9c01f20f5e1b0bfa76a5968a7cd3f0fd1af732e0c22f7a1c542d07617a59b345c3055e843f7bed904c3853d8d1bc17035cdc38c69a8024683d557cdfab808c6da43dea0a4528b5fef7946651e9f5a827bdf83beff98dc810ede30a0c620d668192330299bc5a00b0d14ba2f00ea3b4ee7a8cf7a5527e1b", "b8463450be36103a604fa10ccc404f261dfa8efdd069ad59f0cff8af0b8f25102d769186b5ad7d868c3af67eea42225285cd3d38f5d54bcd73b10b3aed7ff22a1b6ac956fa72ebdf4989fb791530f781ed482e70bc9f6f4efd24c5abf81ff8714216f1ba725dfb427682ae716595643df5f855e22d0de7cab459a30f1dcb4f9663e414de728f71244e4cd4eaea75576c3b38fea7d1f1682775eeb469bd2f3db445595cbd092f07ea6a0497c9f6032a21639ec47e3689f34af188d4efb032454d41b774741f930a26252f0dc91ecb3ff20591059f282f851de23ecca7368168392a0ce7f33c28888f18ec977dca89db6112e6ec0cf762eaf0741004804d7d81b86a9203eaf21218adcb14c73d8fa436233c01bc4f6c55382a3e8c826e82cad469", "8f4cdb695ce8c0c886e5df8db41c03d5abf11d377f56d9ad38d0cc2dd7ad72a6122db5daab97f9f12dcd1402ff86122b8f226a1e13bac704e739f67677f84717c3af34ce331ee348925ed8b03aec725eb24303bdb9cae4e666d4d621d704a16b3cf26381f5f0e65e68fd847ccf24a8567ad50c17b54bcada00b26cab181e468b0abf4cf483a399f96f2a466efc1336b766b3b1e4f9e22e1eb8bf43ba68031b2c3381ea594cbd051ef08627adb09ee62bd030089e765c92b805f4836a1a5966414b491c0fa04e137c6560a0891720e19fb9d60e7fdc9f81ee0a87bf21a41031d91e435650142a3adf6e643a7aacc76b569c5d0e36f5f8cb0e088898900a07c271", "ad6364dbc935af9ee071e22ff12ee908915b4958f0c170022125e0e47ad7c4e7083810f11db87b243bea2684d70c179ea912b215fdb370568c62e21637108ca1706732f3c6c8bdf3203aae3ee430dcedaf73a41c4b27b40e8f90396c33c4a834147c238e8840124b493a08be4d95a6aa9cea827c9391912cdace1fa3e984d3223d6dfdfb05e0f43b1dd9db01a1974cb566ff6e122ca7074f3eb1c339f3a20a922ac54160c6ef97475ed9d14752ebfe593c25f05939f113f25f08d8882b786db9056afde40d905c3b6bfca6fa3a9d401d7472cac6da281f3189ef5f7b0268561b"],
    ["8b544cb17681e340a9a2b1bed92eeac13c66c5bd638b722959332a4909d222cb46aabfeebea6626fa05b166e7e1e0e61a51897e13347697b07b00dfdfa5df0a3b8fc203fdf9c5b9e98053dace8573d8cd368725456e2212ca8165ce0049bb24c4812fcddf15b154386e593d3a3a0331f15a5d0b610b5d170dfd7051c724d131f6eb117f269d9c987abdd306f0e8e14320f1c81c0860998b63138f5663071c1df50f060cfdbc9785203a898be50df635915632d976b4b5ecdba5d79801ebd10062266ddf0178418c0974476b0d84a10fe4fd49f38708675679b8183a43d42d72d619e318a4ef3f81634006e65f73993bb2b9c5efc4e4fe89fe6f4af659b556fae0028d0fe2f7215b2b595e4eff6c61fe802385c887f271808c6227a369d49e57d616891d2ba15f0f009d45a5966594acbc71a69dab9b92201c679e64e8147fa8f1b08a392ce339afd1b891b982a33e2425d5d36e6477f0c8fc8f27e6881458ef91b0891c007145b0f890d35c2599837b170dd2adba7830e0d822ddc597a60e8ba", "ac1c2b7448d9470fda525eb69406c900aeda994698bd998ec30b828c0451ae38374767d8dfaaba436d150410841bdb04a39e1e81a39ef185cdb5067ff632672a4188369e77805db9ff84d76fffa9a548ce7246f1b5614f5c6701e897f9de2b8806739f7199706dc6c0c60587f7bc70dc54b084ef6eeda4da1ea6d5cb9fd26afb3dc0427ea37cd9a3de6b4c521d6308b0a9728f03b41e16fd19ffce89971943d8309a6e37a8bf96cf9a4172f4715fb5cd31269d3337c2f27bd79f1ca5e37b28df5cdf0bf3abf2bc91ee3e262b414d7971889e6fffc78af35bdad807106f2eef1b483afc4fcd57df1808ee1402c42d8a842fc1632dc18d6577d2c009f35e5ec6da5d6337c15c403abd8c4d41c3bd044df155732ce526ac164659dad49421f6aeeb284f0c3c7183d15b99d5bd0339b20745b6548dc87ef1801d93788ba4711e01bb0bc182805d2b671c069e116b4019b4251c4f161719dc8a67fce65b2a259638d0", "ad240d0bd81266f69bfb8408ffadf326b1dd2b8defd9fa91729b3fda3181ee7f028bf1989cf5266d9b8ea7bd768f2c3ca2247a741ab319b51f87d9e789699f41c20d0784f648d950f11db189e57701340195924f97e4f0893a45c95d8144958f3a92aee9805ca684d0cc1d558e126c9e618d3ab82e4c46932e76df8fe81e1475425f440ef8b684b580e933864da31adde2c4ea7594702c2fefa9f16ebcfb970d05ee71d90578ee7dd3a081a462ae6b3c6d82e806a85d8b016925654ed5fb4c2425a048e45bb7761d1233596f641c00b863bc49a73ef84b2afac444744b1f971570e77e4d8c78723b71ddba6241c2894bfd81b726d94c81963256b789445005344e42c5b8b8062fb20e34901590928eda72cc7c7cef71d77815932e9efdfd8e98290bb2d33a351484736b76a0c82cd9c8f2678879f3f2dc780c4cf589f6aa14e6", "b236174c6dec262369ad8f94264e453dd6ca1f761d3812b9bab058d4f99e7b66c256e1dcd85fc145bc1295e5fb0f473eb83fb93d268a080bc88672a9b36baf616d1072592f959728a3d6d36798190ddeed648fe13236acddeb96c21bf3cabc82016242f94ffc5b354cf5fe246ecfd2888b2541e551531c5969c9c5887d3a70d409cb2da715ca20f447e5b6a9293ecd21e2d8362ba6b60d4da5a997f3ccbc09a24782fc2c8fb38e3ec90ea4e027432d1bd51754962217dbab202ff58c86dc0d680435209e9e02cb0f81e3a6bef04e7be30f1486df2aaa0bc887fc7473db2dc3973382e3bdc30bfb64882b18f5348c68f3e95bb39c87f01e9822d8d870d0e66daf399bcc44433571b7fba3007525d97c79dd4d8808e414c17edd0239f98b1c670d", "8e616d8be549e7e33f876291c423bf714548c4a32ce865cff572878f1487a9e7eb30d22c2b4b43b4568731f2f24370a0927690a73d3e3df53953ee32f958f9e708b601dd7cf0596903b8c602f7a3f24e8ed2b78dfce89376b4703915e7d37d0e68378eb20e8750f3afde1f6eed2d5f6d193d6a2ce8b1cb0abd59e7ebc5631be234a0f8e52db6f1e7bd16fab872058980259858795ac9328c5f1cf9cfe65bbe5310a3b5ca2412b6a55c1a0bb729cecb71c4204f4455a535be780a6f4a49a4962e2ae2d6e4e1d96e20825da44212ac4128ca173548af8a81ded5aff51356d27b332081d0dd71aa3108d9144c85290fd7d4dd6e19d4f261d5f7904f0784facba2ff", "8c8b82a0dd38b35be6219eb957cb2277cc3c361ad8e009b5076eb46fbc4b308ff9eb5a62518c99b6af497d5191d3f604ae9eed3a081ccf8136519428d999d67519e6b0275ee2ec160ef62fcd18938fc3422bb72f4974799170c4ca45735a70eb3a9c4b2e4b2203c4862b07d6bd74d40e0277e1366da14d87c060ee04a80fc9c02655c7ca7b647603fa90348c1b4cb420692d03baf436e6b365ae448e3edbd4c968fe0c5c48f6e84faa7d8258b91fea21b9c13a9fb92e9b99a7b20d6184095354373c8d67b6d477df1699ecf25f9dfcfd87dd7be8f0278ece261f485bbdf4cf0c"],
    ["9372dcf45f65cd54ab0dbc333c368a288f74ee505276ae4c94b3e76adefbd89487b199eec052d9cad9778de873cf8ab997312cd5e52628c760ebd0e19862aeb107d48c97df6731d9aee83ed36b8d90d330d62a802d4ef2531e4f9f492a2fae6814a553da4492cbff80004700222dbd36ec520b1cb06a6ad06ccb3f92376c4f9008c341a9480ce7e8beb388d1b8590bf9cbd313e62ab3d1d5afc6c903a235a5e2486d265f5a0f961645eafab2daadeaa6b7ba2848bc79dd57a1ae07540088d39e061f61ff6c464ececaf0df92f39e2e58e7558c1b77365da05e0b0bd2ff34773d5deacefe0eb47b4c44405982ea54bfcc531b40c7690961167c8610815027723c326aa75144c9bec9cc006b149bf074c8d08a8c7fcdb3942dd307cc474be1e45769add13a254f946876a39f31087812cb2191f429ae74fb27ee6443ef789a0253428f90d58be1a42185019de85c0510c3ffbb7827fe05528f741dc894456b2a64299ac88756efc512ac0de717d156f962faeb910167db2d14e5722d0f24904a67", "895ed150b431a615b1bc8721516e287a5b801d3ffb81a348e9f2fe8c32dcfffc12cb8310c53842bce0963050abce468a88cb844f16904d10dc04025bd27f5cdb62438053f99f92a451f0c472ac6cb79927b624bd727588d8c01c37b92a927411650bc0da021253d58745ac0629d8e38621fc7080c541d88f41e0556bde78770742a3f6984d86f30e64be8d368b9759d7f8fd51c5b1f324dad1cfdd6bbefb20c15fcf9ef9e0da7b729b8d1cff136634cfed1019dbc75723c9b0486c79d92dd7bf53a50945176d5136dd9165cc2d0f7954f11e23fac57e087a42a24ee7f5a2e08763ad97d1250ef53123bf640b572d5b723124ca0b593e264223ff33d72109a31a1ace4b7700dc16517f412eea6a92bcde2481f28181f3ad92c578dbcc771603f811c50efa2e56c9e5545bde843d205dafbb83ac26970d28f71edd2cccda8b8fbf07d6668db132a1c2df34a3d76fa6eb3fd8f9b3b80918b41613489c5c499541d5", "a9344b5457e92e5fda98a1569ad102d3c775995cd83d8d73c212f2495a94b3ee9cd5498e22b2848be43cade24cbd46a5854432650d8f0319efc136e38b2d0d4e49c3288ac13d829f1d5c2f82ab07da755be56c754a8cd1bf32ddb65b7bb292b61c63e72da927d51bfab9aa67b37fc6b1b080379f6681c28833bbf6432c0652033cd85141ddb1c2fddeb6fd376dd306e3d7133d5014492bdc80706391c30fce765a3945cd44622051b2fdcf160d7726cafe3a1c0c6713219e39d7ffc0359724b83cde99f161c04be045f0b475d0a35e93e0a9e97e93b2553e2294833fb0653f464a3a79977fdbd1a4665cdbd7e29e62c787e82bcf79aa510dd20d86fb09a4d1f74ace74c7bb09d0111174e6e0b2b6c925c57c006420942557e8df20f52441a1f324a0e69d3a2a4584fa628b9c9c10624f4a52b4e32dc9e0f2d71b4869e2c613be", "a1f13c2a73b70480cff465a0c672ec649899387e087aab4d644e8fb0f4e97fefc1b562cf8db43ac4ff0be6845d9b6eb0ae9d0bfa2c843d94a3391ac8cafadfc58b8c2a12635154c35230775034c0fa5b105f923eaec8f9d68926fcc10d492c8b6dd382c61246a407c21c11a685da64644e3307edae2639a80630bfc4607e99650dcb6461aaee513296bc8cd1c3bc9be226942aa952103a128affc25adc782a1a57f1e734c30e3bb29779ce48d1dd2aaa0b0834d5d0ebeec204c625d7246344ab598a4f7a371a3ac9fc8659cdf746e9b62aa20aba17a317d28473aeed21b2a3b004f901b485d90b1ef899ee57305f956a23fc787db6758eae23beac74799a843b200e3e30afb31dc9c8a0fd67b528279cdfee4dbc807b6fe5b89e4cad37fd511a", "98aa51737a2ed4ec3152be028e4420640ca7d4fdc50a583ed655156bb86206e54c5fa6b81af55fd5356d231ac5d3f84c8b17c8aa1d013691d4244498fe8fb3bc60467308b3a01ddb80900ce01f43e81bb0a9a4b95139a48e73b86cf7ce98ea543990ab8ddae2c1709d2b4cdf3d99f58d2b0c78faa9c230693690b39b734b9f0011750f4f7d452b4e660d7a969439a2d1b76c93701c8a4d6c6a9e8154808f933c1a7626ecfddd8178ee2d8a7a85946339ec2a6407c718cbd9bae61f013ab637744af9a1fb05e8d5a82eb2bdddd473a054f52f0b68abb98c2d63db13601cce9ee5246b1aa5d88467f268e68ff14975fabd7aca7068f5da8d163accc3547ab7e24f", "aa91fcfe07fad06fb706e92196f9a0f38fec909c7ba935f60ff630e869eece3d1106cae9b99a509c2765f248a85a9c568999b713026f235dbdf21316d5d8ca90ccb86bf79c7b76f8e22ec976a004c3d201cf3eb5b5d0daa7a3978331a97c3498279b73c9dc3e92157c4ee0e8cb5c3f879618ac0cb76933a2d3dde5b38b5d302c1ecd96df92c84a741f05447b76c70d4f58e9787048238795adb4c0286428bcf04729594dade937f68bb5c0330e582c63cc2563d77fd86c5324e0a65c3fa619232aed7e8202db809ad2b01fab258cd489381dda9770ad27a1178da965e5c00ed2"],
];

// Expected sha256 proof fixtures using MockRng.
const EXPECTED_PROOFS_SHA256: [[&str; 6]; 7] = [
    ["ae4f8ebe19659d61e5bbc9950a7b3a72efad71659c8b7ab4bf3f69d3427544f69a75a5dc20c7a929dc5ebd8bf7c9abb6817a272bbf223d10093994d32f2dceadbc28da77e17a14ac709103d9ec65e9490e38df7280ed48d3421ff8a20ae3459c6afd215a0239b62245380b6489eccdd511c1936c495207b3ccdafa71084a9eab2c487de3e54f16d7b457ad6364d291810d3d5f6a7bc92b57512af38334947ef52ed618ffe52be0648b84a165ac83fd66ff7fe4fc05f8adcda0415435bae0cfc504917dab1aac60961f6c9b7558f8bbae3fd9355e5b2709573cd420df81c877df68fbcaf0b05b2b363cb8cd4ba75d57abf9af3805c82a990f16c57884f4927d8a3e1451ad2297d0c726c00d70219f8b7495ee03e8ff4692844e1954d60fc1547165866d0c022ef17a8edca3a19044c5cf6a608525944253774fc5f869989968064e5b0840c0749cfb18baba0ed124d1d6e402851e047bc642fc5b882948940b6a1bd0cdafd340502549de298f8800f97ef25b16356734533fbd42a8d2c8677e87", "a712c4d30388bc2a41948e3329beca1885f27a3e43d67a8e72cc9d44d4d1bb14014bd7f9083b8d502271c71b79c4c0898d4095c2db61d84902fc5e013c65c7d87013f0670db7078bda7f8e3169d1f3955b4da9544a7f59f8941179e4cc36f40b1c24430229afc8ad5fda734bb7bc5229f7e3c021355b7fc9446eb797b97b7d3d73780f89ff5dc393b1fda783c66fcde9546e2d46428a31fcd54cb4ac664ce7f842bc473f116051c37890394ac3ca6a0ec8fc8c0aca4b463d3e9323aac6105cf05a4513dfd727de2c25e85ed0eccb9f1dc7d80b0aa07ed8342aa346df1127c37224b83715f6ffb565a5ffeb1b67069b61e3516e83865a11afd11c12cd9c9ef9a85e5ea084aa38641ce5cb7fcc863ba430ed485603dc66c891141012e0d36edc5e6f83daac3c511a8de634d5a3c0b4bee74cdd613703d560d39276b41babf28d530c6178e99e1da6d460d6a9c7f1119dc171578698b4b0b0b13563bf86326429f8", "a6f80bcb510c3e373b7d4bcbc3668bf33475aa9f22ef1430de8d12714971830376c3040774595485140248d701e5f203ae077b00b387a5c90b4829f106f88b2c483685bb20d520db3c6920a18065e8d0a7b887aa02b5828dc257403ef674133e3a3d8e178aba7d57acd944b4a0d10d8f26643850489a288ae9fb88c22b9cae9d682dc80367ca715bf539cb2373e232567b2b23f1f7d05707ec8b940dba8380d8132bb2d9318e95fb38c44ebe2a9f4857482223b6754e755036b7bee177206f6563f32e36df0ab31abe4bac2c72cfbba2d76f2f27ceef3debe9d3cc7267af4c3a565a0fd4e531986a4b064ef8934d89c2d9a261dbb6c51b25a3131f5bd8006976197da6a835a28d7952f749d578f2be1122af05671348eebf28a44c93c7c8bd1a101b6ca70b142940e318e62e8c8c621d891d4ccfd50b80d2fe8cc5121396b0df", "8bcf3a0be03e2daa1b5ebd16fd3fed051ab29ba11883f72e9ef6589fd02bba0ec9d0e05f3c012cff305c0c3ba468d23fb93a1b74debdeb62f70fb6b240ba1300cbb30d0008b6851b439791b248ac2f372bf8cdd1ecf7c4cdadd8972cc649c10707fac460240018ccccdb93ed82bd3402d89c9b62df3bcb3ff7cc892a3492a6c167336c619bb4d6276dff948959bbd4a5747ceb4c21f3c526e67f1c1d2a8d65ee3f50d6e188ca8daaeff569fa193a017b437fb9e40baf0c1c070f638b95473bd56974d8516387e19f6738eb0c772788a724ed1dfceeb7337f917646f4678a84873d98ad193870fedc721072ada87f3d481f3e58050d420a29ce80bdd9ba49694002fe4bfcdcdef6d9772a15d27ebbd3f25c1d94b55ad128db26f121cfa0943d70", "8d8a794c8cb88db28481db20709f09acdbadefb4dbc7142071dfdb9447391f400faeb895d6fb3d265f3d388e32996676b43c7ec5c8837cd9e04d10736cbdbc9b9bf33b172f6b778ae99c761bf8bb30b4e3e69b0068b71a1c8a2fddc161d946f728c638dd52691ea00580ea0c17f3f47fea9fa57c534b0faf592cd2111bc960e472d0495b9a0c5a6d82f8c376eccb42684ebdcf272f4f625b796aafdb123ca0d36c175e9f17abab507f383e3e1971b41b40f9d45a008d9b41a59fdab30fcaceca38360f5fd3c2c57a4a31a2a87ec58c81ff8ddc8f5dbf8a8e7ccac291567333a015dc92dbbd2f85312928c5af7f1ca282db6369533b05de678dd59fce7b67f04b", "943dc764c24ab959727dcfd8480dac43e5c7602ce72e0b973df2982b25a48dd9632151253124962400486c41f0d63721888d9322fd9a000673f7504f9a6dbf7a992e6ba499e67400359b15b3604d1843243cb71c2987f3460aa73cf88d685bc91737fed9c5bec332043efff94efc6a67f2a6d1904550229156bb4bc9b44658eb3850f8c1a0b25072499e0b6fa410676869c49b9f2a40e62d5c5b3d05921f82703c94595bb70736f0ef1e3710bcbff4d615f0f7588feb8902e648aee550647db60f981829efbdb3af78bfeef9e836d95eca26455fda06a1622172d65eec3a23d9"],
    ["a7df5c572e5050fe64321504852860df5863bed5693185faf2ef71a7a83dd46db2a505ada72435376ea8f58a90cb5a93a81af7cd24f8cbd11002c9deac5db46fa4364ba4c2938fd0b77c1c088a4d37ae08eb43e6daa843b7a6219b0e8090ae3d4460c5dde10a2c6e7cf4944a87a1e1ecd06c2e05e6c176aba468dfecbc5d745634053a0fcd63de73be4a78c487791857fb310afd0c0ff1a7bce0501d40360e9d5b6123e4e3e6cb80b4bd47404189443a5d410921175b046822cfe200e44f9b0b4c47a06f3246bc819c6b1f6630adf6c52c90a97bf5909c4c8e5876b99c379cf024edc871e7fde216f8ff6b27f647c5c19b99494016c7af4aaec8117f479ea9d64402277d95261906ac8c3d8f1fc6d6cdc776dd4b495b01433b41ca714ff14c3719d277470c5717f3707815dbf746d918fb49936e021bdd15e309d7d5928473365912a11518e556fe053c9b5dbf1c54a5087cedf6d5f1c6195240fecb01072e3a69ca3cd0f8698ffeb1045660ce8fd4f688e57ceda758ccf525b2455bfd4cceae", "a9a8c5ce38694f0a537d77fefec9af69c76374d004099aaca89627632362a68b5480cbf7fb861d1795a1be4484509888a62ac711543b2c9d576c501baf1a5f46e3461a958ac171bbb944dab5f83631916970a1ba65c63bdb1babb15519d006d80a644d449607038a024b622408e82297db68e527945d6cf52e342c90f7e994342d08264fad10dd7594b475fb1f1815eb1c67e68418030c3626e618b6985b2a3a59265e86b614e0339ba1cf45f4c3833a300fde58912ebfe9a7953919e7f446182f2f0852438a512ec75ee85466d18ef0ed4a14e57b3f2d65260ab8079d5a076e34c4e3c8112dc3d2b282e10f4c68a8371c628045db0b639cb4b0892ea1813f8528475ddf4f8bb649fcd6d43b6befda67202bf9b65959ee97699057c4a90abb4d0f58e72dae6efb92837d8857f1f0855b4a5522bc5fa01eec31b43be77284bcc6508ab5c45804128a8104e15688eebbbc035dd446c29deec492b4e3873c25847e", "a69936264ba638d8d9389d5e441cca977a7445f60595bcbf1e86d592f873a9fbcd75524d6e68a5013e7c91ed81910ea894274730d613cc767fa78002809784fde2777d329e80a23d98b636b5926dfd0ee3edd67df2e5981be8c7c06e9a70da2c4d48801c55ee0cd6c41b8aaa1de5547f2c4a4ed5dc67046e2b3f873010a8d2774fedc73616fb0f05bd81477b4b32fa895458d48169b8d4ae9911ef94eb0d48a31fc7f05f8f21674c8ba19f139ad4b766b9c5d06c590df3ad646de4d50e0ce6bb40437325727b36790cc13e9a2caab26b8e6fc710098cb494a369325396fbf37102a3ea6065f6384a625eb8d592007d4d17e512ea3b889f742e7908a63c21210a01bd1521d13ca797df3fbb363060ad7dfa6b78b15062e26257de58fa1468acbc42811b4b8c3365c4d950326ff6a115cc90128d7279f3869c6d7354235ea387e3", "8b878ec5883704544165aebacbc8c74104d2eeb8592aa5d6cde8f6add9d95d85693b5efe04edd8e9a777a188e039008482e3f30a97abf3be7d5f597a4b8e517dc89acd2e1d0c80a5ae44c267fd34612a9d86fadbc9ad18a94c878d1d1bf5515c331abb0abeadef4037e7e19caafba363dba9808d9c2e5194346262eecbfb883804098e9dfb0dde2c57390120c203cda8fb53d9ddb5f0bb3d849ecf8b2225128312c1ec7d876ea405b5f74e3ebf129247304674e5c5469d7586552d1bc01f705640fcd52d08bf51f6eff9372b2e2f537ac20c298a32f850108846cc7c60a47ea04d32847bd21a91dee2c4bf8e1a136f50096a1c1c99545b3bdc3ad30c509f94333168ec80f24e4f968fa63750501ad49c89c50eea272739c5c1ae81b366ff7489", "b4beb2af7821030d8d712a99024acafce4a8c682acf3ff4d7cfcbdaa2dd7eaac493aef82c448936328f73ca647187b2db0dd5169824c0af3a5010734f256b9f5ad95506b4b97b708434e4d3533e94064754b66a6db174866c7821c2377e54271086c2666fbbe3cfad01bef86bf2fc013cefb4ddbd420d145b18445c4263e45f071cac013769f033b699d514e55f97e9d1954f5673da9deb055ad1646a7928cff270ae6438ff99a48a7f861bb0160c14eac82c0507096a5a9bc884277f25eeb1f6023ffbb6c719c542ded40e9b2c3ef5e8112daf6159b6d27d51c1b857acbcde125e6313201c162978556ad2fcda8293934049c783d7c03d3e088fc5f8d4746ef", "a348ecb5d0af84ab645e2fce418813cacd0976aed230afa4e5ac213dc1be25f5236c470edc9096f836e50801230e903a8b8cb7336bbf4d2e10425e7ce34a5a203b0cc74a18f29cd9ce50d27c4cb1a336d3b7bfd15cea2dfc4acec6ca78b2757d3e90f9bfa4f9d1dec70284121dbfa43531e3c4620cb963dd01df5564f42984390d7457dc06027e271efa408696f9b831083fa80cff426e58e5edb7a1884b73214e7b05fdde02b24648e61ffcd6e83125ba6aacf037e79003d8223100ebf6ff42537fd68646090289d7d6c00be12fec2cc3e5ef821f24ba31adb6839e7f5aa474"],
    ["950a035f698e800957a50245fc54ca0c70eebd86f29efe2bb4517147a57a4f8500d291d0d2562df8145e0c4cda3bad1cb61ebfc20f92b12b91eabe5f793d7838130807c143ccad3d879b77efb67766ea70d32db2e2559deedc5781924152008a4eba7004cab2a15c960c5a81df58152d897a7d8970e1418ad28edf005aa116f155a4184745df68be5d572adf02c6c1124455ce11338470971ad5ab14a7e1562a6c1a9a1255dfee6453e1b0fd385be297a9103b768fca0c8b53710ea5c588f5b2673175d0010726dfbf32335bc39605b510a3d3f5ee9351a6a19a2284c59225144ef6e84012e961d14d86bd0dd50fbf179745ac63e928f31ae330adaecd286519545ad12f52259593cbdb3c7c5c988e5094ddd466bb5fcb931a255a2608307cce0fb80cf0296b72eb29201f949054d8fb486cefd98e8d81d94b289f92c4b03525408147521755e9ae4a1507f8f77d268d9e0e319ba4fb4a8dad5cf9ef3e2d29f008d484372817bc6e2ee33cf092d910c84f23c9f12f2f47bb34bc097cbc6ec3af", "83cc581b23848d65f0d2dc01d05f56c1e7a44e2c3b58e4f188e4bfc1fa6d2d895710487ef1f35c59e0d0010ab728a738ab3c22f71ef624669df180b2d6f815b6d13e1300dc3fea8ea7e8f82576f5be44f720546d9e1cdaa5de56d30c7252cddf6fcf06772d71cb1a18f54d58d47adae849997578a362188ec804d60be2b2dee96182d6b800c00c9c43dc2994a84883dfbdccabb7b5a97e89d3e699a50ff5df60577a7d19a968d08924006a350229808e4f0461fc612f236f8c89cc28b0c3fdb362078f0fa9a9e9082b6eb1a8185ceb4d7cb802866fe222cf495cacbfbb2ccb2b351f6837e5a770319d90727bc20e91dbb7797e54ac0bd21d728c58b7aa05d33f49791521850ffde09999f0de39bd592b046cfd09771e22efb7ba8a9a4d71454b26f03630e2638c203fe9255b313fdaaf61b6666ef598107623219552613f4b99687a9349648ef12703b7a3074adb37592a15fd097f3c2d472a4d986ad54200b8", "b70991fae84d629fff1215e8dfe854b6c3aaddb3274e2a38314f572b89b3e98b06d73aed248f9711d0f06fbf3bae140c99820493fe8db815205bc7abee8801c46cb54f479d8d7a4f0af7a86b3a68079ef5c5dfe84ea130882f87e3229fbb8c4d24f4fdae78dca17869e17101852cdfcf1ffca1fc1d561dc9d0d14a8c183cea310571ed0bea06873e09064c16bcd57a5e00f56cb8b132d0db94bf2f8bdd83c4bb71f8df68bd227f88865ee977cab9f447796520c66b780def5b7320c13d65f22f21f2f851edf43ac1d0edd1bad80b6ed86e9357a9e3cb7ace2828d6f4301b64873a393e1db6b4ed5ee5fce23435dc85fa02da78a20fcb339af7bc1fdceb4eedb46c732950e7730fb75b6ebae68245f0b1903d6a90c757dcfecc6200909b5625c135023eb00e5e84ae30d62e6ee7fdb618d59e6c550ff3af4d9cab0e2cd807e531", "a1ae52c1918fc4adfa57ce72151d11f4f134cc9c6dd23862d111b0b4ff987d75e79245a47328f753c8ea34bd8434765eb56da2e0bd4f5f5a8336314ff2f1faf3e9ac0b0a49091b3b6712c530aa608a1ffa76a4be234cd2983553a1b81417d072504e765178d97038b8a2d142290a71bf0aaa24e003714b9a8451a3424342410e71e706d80eb8cf3a414890f734d7eb7beafc77c009fd0786e8f01b7b12e4f92a12528c589e1ce02a40ff7e07950e00f7c2473abbc79783932a3b1c8f1af1bf4352bb92f834dac28709aedfd615c28c2f88266d98362eb0ec4d64067fdee6355c69c368b64c4d45624601a25471c2224612c7e6764f5fd3cad29494d81cdef5d13ec355756489d7768ae5e922e369e294539a28315b5ee3bb562d5fb96cc1b0b2", "85b55a2dd5cb9a1178f938ddf10c7757f7b9f595b6bab46e9b0f2177993756e73caa9e240d9c0451415236622cadf2758a0f87d1296887c54d12779121c931879ca4f8926e4393cb3a62387e0cc933abab5574a00be6629abdad70bbe11c81856df01918b2545db8479953d72bb96d63f3b3a31a2ad0d3f4766560ce810d74c9692657714d142f366bdb3dc945e4ff1ffdc7c4c354bc45647b45954e65bd69652a9c833378efa86fd9f1214aff20448a9c96bc3bd7e5face010014e258942e6d3977be9bb1d4d1d39e6fe56a11c6d0694a7658dfef54fd1ef707b8da82585ff55e0817bd388a1f2223c0e9432a55060fe1e07720a93cc521cdcfc8a68cc68586", "82ea45251457a8b93cc5403438f358dcf3e3785b325db08134aca0aacc2e5bbe4b992344ce721dee18a939b3f7821e9b89b2632b8efa20e63a630a219b75125fc60f5caa6e4e790dbc20a369da80dc9a8703adfc95daf6c0ea1a0dc1ccb7ba8165a171dabe54bb7befe48d0762110ead4e7afb81b2367ed5ca48a7b8b17b72ae5e54423f9b73a0e49aa2e11b5133b1cca29b0d738cf145d72e88ac70200fb8fa3dcc92cc133b7de511fd9736547dcf5d5db9c934eaab71ed83c5e3e4a847fe6e0ee2795fbe7d1a07bd07e3d1221f45e56e52036af934f02f4d5ac71afa471445"],
    ["ab51f09e24e58f73141fbe675754b909dcc48d3c597394d1de0fa7c9fe001b28150f3f9dc1337a6310755581437378758437efc24ec8bd9536598156bab56da3fa931c2274bb5c3f85edfffd0cd4c817a3bddd54a4d3c71cb0d1e7c175bfc51e6ed35f8a6c9e5ecbc9230674297c5f1b43cda01fda4bb9e3822cc147ff1348626b7e7da39f771b1f5a42ef25153e637109100e260519c1f3efbee99e9c36528262aa1e65a1548199cc0af38e5c96a7ce2fab74e5e0906a25d50a7dc0e4167057625e082e0dfde3c6c6fd4a439bd14f169bf15368e09bf1af5c149daf935e37d4285b0c4d442ff14bdc3c395d8a98fc6015d727e7d2913912bb8160240daf0d951c04171f5afda79270737d99eb10b45e49d3834c372f4b940078e355b526a0165d367b22f283678cba839577a354fc9178141524945b6d8a92122ccf2462bdf32fd758e1e19fad48ff6ef1efcec1bf0c268b4e1873e64a9b578b1c7f49f16e835af697580e67835a9436adbd5729a639eaab9c9f258c27ab741d0d3e2b7814b4", "b438686978df475295919515057c4c7415b4a63896940e7af16aef97ceb70cf1d584a85d4435e50d87ba8a06ac8a753eaf063d84491940c50ab15f248e2e95380565b0bee946b2e05ddb2f6239d0c46d93260b7ec654a25c2fff31e03b610aa30311e8edd6ff79f8fb899c629f8f5888ee5de8338d0126a1f69633cb8d16eac0400420617a16c4771b58025a69d437fc3875649e5a64037cf90b66daf419602c715d1bbeaaf0d62a13d6e7dc06c7a5619e19e22f8f50f2aa15a83645fb8aba8022dee16bc7cc85ebb909f832281bd2845602da2984d67fe8c60d0e72e7ea23455a1fb5aa3e162586899f7b498aa6b6367efed476ae5d1addaa275b5a31d2e7fd5cedc03fc1f86503c5885805063fa676dbee6d0b0fd49efc76bb1d27abedc29f160cff3b78df815198cb536bbf4a602b62e29d20314308562fe08dd0e1ddcad0555bd14606f380b717bc8cc8b61b2983499d8934f37454d64e0a487c2f009cca", "b9bf19c0c1a369a233d7852ceea8f6cec845289605b1e2b7caac8a5322cc3032ad6f8e1157fe23601deff7664ad58f6ca8021517485dd999c2696c7d05b0b4253a58783007c1ec2d5f208b963b6f60af2f05a8a9ba1fe809dac71bb26d22a324576077c54231bf71b0260c7c8070002c67ee1c72555855c478c1cfcb1980bbda1da21d3bff685782626f63b90b4d9c22587e8575e213943a64cf5ee174d18ddc144e935573d1cae6f98e996bbfcb72a8d1e61efdc99dd2ffc028eb93b45c2a7b32ace327f26630405a3f6681f75b7df6b5d2ae294f64c31048e95ad2009fc37b46235d50a0c17811d8a2fe008391c92b3bfb7673a483c982a02897b93a626b4822aa32d8d94f46f41877cdee09f207f5d9428832b693dc464b460d364ec094db4e777c19a518b65e8062d6a54b4cbe74694a68e9962a48d14d39d32e21f42fda", "81483b09393f6a01471d5c71adac707a98015f6739781174b64ae41b60ba0bbe5feda6ab3e1b24aca01c2630fd07e5ca8a0474cbb1ebbffc5fe1ee562c8e19d4bede45d1c1e2687410a5c032deccf457112227de2b27993c7097d1809edce5444061028e5cce368004c373ae269c9df66b58f5ab57ff6352d949363f7c218b5566906376fc4224fb01d17aa91a55ce32bf5e6da042d25ce3eb9900ac7d43ac441949092c31250f8061a0e2f5c482df7cc4199fd23a7588e629230c9463f3421b723d23df3465169d731f2b6b026a42c8ea0956f200a267d5898fb4ad3e659f1b22fd2b47ae13a3731497c18e0d997060e42889e1653dad087007e05bc9f1b15f15a22254aa77ea9e847fd1bc0e7e5dca057134b82efef6418a7f39881ccb26fe", "8174422e1f348a9e56c17319bf75878aae6096f0cb4d9e0263226898756e0e180b92f1c7f0275003e5e089342b311557a53f53dfe25170d545c9bad015f525c4f1d449248a38b16c4f1963ad1e358a47033a0f9db39975159925d544d42ebbbd7195985c69c9f7d9b11bd794000cd76241e5914f459a87b1c742433d7bf4d9662b6bf79816a5d51ce8ae9d540f90adc73d72994ee4dcd5c2eaaf13d40672bdc34c99b8a5c834c32a2aab14cb339c931fb3663bae0f8bc080ea6c3d68b641b2e258a50309b44108eefa954ff83f434d1bc65b5cf927ce7564872ed0c4c01600a013b05c69784e6ad99d396d629b813fa1de701ca254a0f9641c07b7ad2a9992bd", "8b6b5b14d1fead75e39a600a37d1be8844d11ae2c46fe33c838a2bd2e9475b4ce28ecaf44df4c802879887172d14c7ebae5b2836fa8d7fc10858a0cae1e9c4014f753f2f0cdff8f3326e495afc5edc46a2117d1db76ff69c1a2414ce062dcdae3dc1d76c59c4acfc33dee0b419f3c6992c43a5c08e3a725308545d65d0d8bf1534836c3b193da2d5e89cb00763a6e4c7bda60def679ae7544a7a9482c1f1d633675a132ff98b0558b55ab718bd2776f48102b8087bae89a06509b6bda3398ed721230892b43c12fdbaa54b1ed4ef3079045a5fc3d1a1ae4ca48aff4b211ef2b0"],
    ["ac87412ddd39838da8a94dcaa49be72334f45a1f7e0c00a3c9c41df7fd37d00033fb7eaf8be53f92842e1f9e5cc87c12b5f1c735028450948b9dfe8acec5e709a54276f879b1ebc95918d8fbcb10dc9a51cc19bde570d54cded953d4baef59285b34826da95bb51960d05eca892fafca14641054064fbe04b1b98f5d8aea2d9603d032ff8980d7b96275cd4491a4ec0670a78f3e5e917fcf201242278ad49a4409958e65b6c4fb9b2d649f44841b73121258a07eed2fbf28b1a135f168e8c9a339244f17b7c9de9ad7d4ca356a22a5b4b20caaea823e1a8486b152fe81ee1048181b93c4beaf8e5237aebfc355d7f9524727ec1f313f0bdaa01043401774d7453e4cbabbf79ed16cc5ef2ad54f932d3d70d4900e2bdefade4f334ff418d161e22a8795217c21b173c2e6e804eb15480496f6fcbce8fd23ca41b4679f57e83571166197f2f93639cf5a94ed04f84d54a9fb5134ca0550deff49e69e0ca71e6797632bedd6d45d7bd834a7c4d819d3923fb1ecf457f513f84852bdc6601809945a", "a11e10dbdb5f3f607225dcbb4fe6215b9abe22b667fea17a286ab57c9f86b20c2158e963a278a8254e8d0011aeb6a103a62bd7141bf5006b89398304918520ba19837b457a4ff5d713d60514fcd3bd4ad57ddae18db57f6bb28ba31eff096f2d0eba78b694173a33d2de2ddf39da52b172aaa1c347ac6cf9bcfef90ffa9847030b7b2c9836d7b8d90cb5d0b527e80624cc3c7949dc63a9f4211b163622045a8932a649585e6ed676530309c9966aac526b12bf248b12173a528da427aab7efa82ead15c759ffbf40681468190c83103dd076ca7cc46f9f4156f3b1ff52b9496f5eca63f10cafb2d7e28874c0dfcd577853d5a35dd50530016751506eed7c7ca96142d0fa15526f1f04b6b393d8da192d2cac0939e622ee22b7b4becc2afcc89c57531e3d473ba0fadea7cc3c605192f5d3be3e6fc059a0c8187c8d025d5ad445321bdf6fdd8471249ec432dbd60c703025f61d30403a46e2e3751ae6bf942c36", "aedc4a062a7aa7abe10eef6e796376554c847eb25a7c74ca04aff0eae405b93e403f18de7138eda1fdcd8da2346fd304ae539552d378e80298de1b7935a315ff2d76c5fa9f9ba78730f656ba1f4b926a2d03580ed8df006ca524c56132778f4c378d3457a8fbf57c08000fae1e570d742f32a4df47f243be5298607de82edfd227a525e9555a197cdc13f5e5ef765725517d53d9c3546131255533e399f9603210b93da394609c0218f27c9576efd4f11fdd0f40a335df575999dde54803cd6e2fa19936b7a09bd76b19a4211d60a0f952b2a0cae2d74a51f66e5c4c4c2f58c06a8d143740b6acef2cd55942543c72ca47de5d9b28460d426d121551b6b0991c6b7ab649aefb996d74d1af705ceeb1bb2d7f1d87ecfda0b3614704dd6e3b0f54288e7cf181f9d456cfe366a7668a54bdd13bf1f3abc747cffd04b86b284f44cb", "9539e82e8fb6b8d3894fd9c2cea771ff194f148d5715d8e8143c758eb6c9e1088134e69cacc6c04b94b04a6e5e0b1a1bb87569f5a5203eaedf0aca16acbba5b46153e6db73bd6ca1f669db35daa17cbb3c59c6500cddf84d9202e0dcbd836e230d3888f89600d9475220a6db599aac7dd465308b4002b0047f567b60f349d2bd4e4868c1fdba62fb5ccdd6122f84ff341d33808edc8020514aeb4c18c329f42e262ae8eb54795b71900d7341f5af917711bfc023222d1016ad8f9faba2e96a2b7370b3079696cef722a4fd04263c5a450394b09279dd51a7acadce8db09f9b32560be9406203e432867f691a4445ee9bd9ea5c6abe4074fd802ded08600fd68f720ff4099f12536ceada92f406b230447382114df1bace5006229b0ac8b6c353", "90301c898d04780356b6e2dc98367dd0bdb0695272883259e9863daa3a8d59bf5d72e95f26f813eac105d6a2d88cfdf6ad5a49d8281c76d8aecdefe3fc0f97628d71a07572d5a55d2d0f6afeff5571b4e3358fb9c8023d88ee20790277dbff185dee75782335978065788882f56f7f5516f0b9794fb1dac745ea681727a1263d10ce7cf197088e13ad2104afe311fa8f0b14ef6e14a47fc9e41d07b74d92e2b94b9928b8e210c6f7c58c81090bc9fdc2dd279e966e825e9998ad8956c70434151b73d93d9931fbc53b07c581f5ba171c4043436a35d46cc4c4a4ddf1d97f2df93747374ce419a5c0c4c989f4cd7c0c4f1aed2ccd4aaaad4340373178e83fab0b", "8921dd9b5c3cec5b32af1171d37250c2ace6cfc490f23511bce2fd85d4d8e72fb41e4d16b4912162cbf5e13555d9f5e58ef2cb1a291858ee0ac2b5a561179f1c84d62a62eb4b937a8f44e2e74b12067f2d1a5ab0b89ce62dfc5c10fb4c97b76b605af67190d30779f26334f2e8c78426a2499aff8e1c88baad3cc2bc8ce4c9b54f70d65dc181226c6c4aa979b36d5e7048e495f2754932cd4f30a349c3d6cb132cb6aea576cea75321570395ad669c2edb309fbafe0c703c70f0aead8ac30d71262a5c13bbbf0eaaf2f59903fc7d621e44c6027eee270e8deb42e91822963179"],
    ["8b6cd8c13d60e753646ad8510e54df5dc0b0e7f7d068a057654257446a51c28aca118809bcc54de7ed3ee6c07c12967cad6626ae8dbd6819894deb4b8ee79fff578b6491c8e30649c9c9431212a4975312d74ed54a6ddd0dd605a6a154e444986ae5aebf48411326c8efbeb40f1995d21b6dcae941309001cfdaf6b1253bfedd4bdb998f4137b2526eb27fd84b515a1755b494536ea7fa2cf682d12e4aa7d0651f7473d3dcb4bd1095e03db8ef304b551d5939c854fa1e5e5c8dbc57183aa25558852291223c574abade758407323dbe47ab3fedcdf91df79b07c1167097155d540254615c4855fb0453aaa9700125850079ef70196969c27044391dc7a80e8a3e4970665c103c05afbabb5220ca8ab5f1d5bc1668ecfa7fa37931edb3231cf225fd6c0acf750ceb7d1904b78adbb4a055619b33d61d4bc0e14ac62d400956f9496d4830588ff370bfeeb82540508dddf49ef76cb64626aba19409347d2667e42c611eb83651b55332b82eae5ada9578ea83daa28f4294785b772f2b64d6e2b7", "8440a495981edc35b56b5a6a97107967131efc856589ba4ce1bb223f9663400e1068e8e52e77e6a21beed35e564c99c882c72b58e270bd2ded2068f1e8c032b010b1d657e7f19bd63c80d8fc80598162cb571d8733306b4669b807ca68b7c992130d93c792db8d8957a69ecccce20c940a106b25803e659672457dd79b1dcd99672214402afa1922617ce23575937b012b6a240a38da0a3df8162624e623c7ca68c0211b76128e9380e661b5226184a7ab6f674e1430b6d0288f17debc89edc34d8bf863e71ea376da4ec5ab6f6b9e2f36cf4824cac629acb6038c538d4efd045abd01a32d1a131b7f2c968b1040acfd00d8aa53724b568ec3d29dae0224d9fb2d3745925605fcbdd5e55b58d26861fd4da08162bf8ecbe966383e07fc07baaf03c1c1d8d8caea9831bc111e3844e935653e781573e54afe1508026ff34c73e42b688cedaf33ee326cec1d2f0f3553972b7ecd8e727878f96aeff680705e4ef3", "aac4512cfc61b2f3f967e3779f49f95190c61139da628bb72026b8c8db3d42cd2b30c46247f110c5e1d50febf47cc2c48016c5129c75eb286e45ee0cc146fe0d7505c82af569f9c6f77f2cda71d23a33b2c7877a813c85271646a73b8de25295525b24c5d22492568187ec6862aeb3afb777e874f9124ee22937ef231dcdf881426c63ef5641cf5aaf253c325ce1c55588547eb924db416cc318d1f332a6db2241afb205609bfca395d62b9fcf3aaeeea5156177c6baf2d4701ae61b1473811437b5a0509f1727ad06f489b7606a8834ded7f04f3f66ba39f3d97ea323b6e84e363e29a5712bd5d4d56bbe5afb169b481851ab2bed07e94785c0bc5d0c6c887039a76b28ee934604db59c37769b49308ba0325d683cb34b7d3b8f7480b0d9b951ff1a34040c25a099794fcc32c58aebdcfd81ba136882ee4551208ffc99696c6", "88d681dcd108f87fedf9f37595674afd54b43b9072fc6a8881c9fe8823a524c51f02509c49f4cad59bad2b69baac91ecb8b27d1169ad3c50519d7ee0a61937fde7f36b3cfe74bad37ab876ad24336c518c8065f2f3e2343b6a95849c5afcdeb749029d8e5784b5597013d0e3a6a73c7457303063d548ba8228dd79e1b0359bdb44942a4714f91ef6697932ae1fa0983ec2fa4656c85f841a40357aaa6595a5cd06223600b65056a69bcdcef6c3c05733499d9df46f4d4a551f3f61f9b11721202d6889256cf820dc0720a53224fc8cdb6f7c2a3bcc5855e8dbb8f5d3dac0313700795e537f7d5648d4475359c2c5230d2432e70122faecc2fcca3ddf3c4ac5960403d65e2b308fcb2945e5e21b90da2a8979e2062c323e82322ec285d8b18eb4", "84a0d4645267891c705a3005216877bbc8e3bf12ff60b21c3a4f68b50822cb1a111b34447f8723c6d9ad101c4c3b0fc8af9c110c752c32b90b775f9ba881f75902931ff09688d6ce94f503530a94be881c2255a2b3a1d3dbbdedb563c5c0f2b673aaf7adca0b16beb56eedf9b3d6ab1234a3bfdbd990482a50dae48f9b7a6b671058f911c309c7d0d791b378c0e0cd427b82b8287f2bdf83e8501d5d4b0b14225f516e9609e107815a01a9530953b3f33d69a891c8012756b8d9596f589402384f272300b7883a612e0fd5607471fef8c34a8a78b8ecdd4d1d35fcb5b69ffede203c267c4fcc8ea4efd1ec99d3e048422d2502cd065fbf913f2a76304b114e0a", "96145678b3163412e35af86aa9c4c04b7c5cf59901409c2172bfc78c4992ae7a4cd9d430bbaff1d54667293dfac008f6a52a2e219552bbd8df73d7960e7e175a64335e309ef747f008488b420f7d1f326990a5e661b6079f2dde432c5c3f190f0380ec95f0cbe53ad035d6cb59ff888ff81ec4431227d5f76445e7acaa88823d27cb839a5956ef41db9f09fa8690c7378d43e5b07c6ec6ee38a4b872bc838744117ed40837c235d0b1d4c3d63607c0ebe5a5c92ea3d9836687f26afb0f2bd339292929562ab3178f73084107de0ee0b1a014403f253742f83138ac0f93736f32"],
    ["8dfc46413f6ba1b1ea8f887b2d6adb57f36e7bebbae86c361e7c762030c22926c40873eae0960f9971c1e3ab22a56fdbb39339e6b94992ae1f4c48f0c97c620498cff424798600962e0eb9c7ad36f3ec6fcc517cb700258c4fc5be77d60d15296912aeae5dc14272cabb422c4cd085c8d2c376a2d853e2ce80cf884459e40f6d2be73ea1da94245c9f515b4dbd87296963eb808e98d5a50565af7513c7056d6053ff7248e98dd5f8c614548e9042017a198eec938475524737080a7d9e9755e514728d4c6c2e9d9bb22c425b7912fda68a12e1cc51e9e42dffe85c417ae95d6d262ebae44a4705eff91a14605dd072335a4ef991a429ed1382a855fe2684961340be1818ccd136520cc85b4e6181ee6f2892032f868a62d9a35ddd1424456f1e7169419ba0f2078f9ab571b930c0caa32ebc2b459c0afdc4120ea98c99a5de1236137e3f5c26deb16b59d8d90beb28431b189cbbe59c34f4e9c5ba876aaad2f92d07b8ac50da1e55a7057c2f00a2a36c23c4d40836b2367d62445dca9deff1ea", "94e8a1b19aa91de8f67c91cb16683535179e6a70eb3fef59dcd6fd8529dac53086c128347fff282caf4b73333ecc0eed85f69a3c21be8e4257bc74dead9ec7a80dfead53bbd7af0ea44b8955e0f7dc244e764dcdce72f3c381f08957d0ddccd90f60fefda78cdd09c8792c9f4472fe89cc879897f9a6a5723b18b08376c93e4602605dee4d27d03f17ee186fd4edb50752939b558f557d791cc0b18193e960c52d575aaaff8ee0d83f53b429b51b0e2676e8b979ec9500618b841d4e0a79053159a97b824c2d47df534196abcd4633b36229439f2d0c4b47dbdd80bd2ed17e3360fa3f5e9eb285751bbbf77fb7e64ea8166b979b10436dcae611fb3fa81bf75e0e50d5690d1bfc2c6037c4a2d2119cf2a088f70cee3a039bb7c7f0e93c1df9566efb5b96dfb8a65f08c9439abd893ad1e76e62a828dfe1f2e3ca1fef540765fc3ec0e19c4985f3bca0fe369da8e2254636334173331012a2730e7e5f37151f99", "96574eb791edd176dce4200dc48c8384d049790e70616f4a6456fc4e1ae0ce1973fb889aacfe66cf72fee732de0948518f6bdd583896f7933ecec758950e2a431a2b4f826c2f74994187019d1f1df33cd463fcfc01ec01a1114823f547e0cd975131c38dba72d669a1bb2e549eb0bf68336295da660c2963a0c6e585f02e411648f1ba079474fe3e0eb173b57136dc50578dba2ac715cc88b103abdd4b7738b621e7a3a1d1d6ef6b551b2220e8dd0ec02db1ce510a2299f232f93b1dde395ecd0a3f062dd395827b23f8c7ab597cbe28cabbd2b660968865493c6fa9356353cb5195718eedae905030bc2ae2710f12f77f049652eb3a400fa49e87e9a939726127a63b9969377ee7f689f55fea8a3e23e987cce125478e48c20b2d782f0d37dd3d06e781a35f172b7a91574a7fa0fa8c1bb8a52ab5b078644b5b7cfaf6b07493", "a61486c75013aac961911cf7abb9e4c08059237a82d4eca6784a787745a3147ea4bf0bc289833382f876dc9d84422609911f81f6c232c1585592eaaab1a8e130757c7717b299ff21efc8c9ccb7957727fe30a80d220028db7a815138da47d9eb38ce146ac95dd88c8324a613ce50778b84972af1395c27d7d20f155c7231265220e62beef7e6c78f6c27bf8f809623a4787c7ba1d7952cca73f8916c0eef96d212458737f7cb677d6068e0f4a62228419507e2b0312c525b678fd3ff0932fdb15401c7734593dac82f5af7d12550183445aa115a3424d4c322dc73eab5ca247e631fcb12ccfd7099b1ba8bfc795024376b0fb6f0a750f22c9e3b58dedfa6301341f3beab5c108faa2ac23a254e2e62494aeba4a5625a50812075007510a07666", "8a57923235ef20001b2f4c874f557c1ee168327c57d7fb5636de1644db8343b55b42e59b281326f07f674a36e879684e8a46eb8b42d56e36ce893f71e329fc6e3cbf05038408a1b561b8a407e5b09a25306a733433dadf16eb7573d0ecdea19b05c325692564ea237576ace3dfc23891e34adaa43c428cbb4d6fe269a1e6f7c26e09a8611360e5a671f187c5b1969a206145b96500f42c3c5f1d5d3e5d23d88736bdb81cc0f60e6c1bc7fbce00c7da16b14f3f611957e0c50fbbc227773589271e5fdc5f596de596b70cdb03953dc8d399007624df9c7994dc7baacfddad090158371d8cb4b47f9ee1e5664ad00b301ec9d3fa45f9c5ce3041c904e0bb653190", "b7db4ebdc44b81b53ae644f6a122dda1010f58fb0017a55ea93d002912d93e55da97d88eb10c859f58f2ccc8173fd53d92ecb6a975aff2a627b580a228334746a2b5e134720a9fd4a4b1a0a2cce6306a518f0d167816a27756fb601ceb5715fc67790522f4ab7d9a548a407fea9129691f9306ea9bf67c47d3d8c7533a7a655d7122a77f4a464ea7d934cd000cc58704cd79d779310b3b2af6e716a4dd59f0ea6b8b1a93330a9bfeade40ab5c5db771827155a078363495158b165f75e478e2a470c2304bd275d440553dd9260576b6f9b08c2070712fbb93f0c96939c0128ef"],
];

// dst and seed for the mocked rng used for proof generation.
const MOCKED_RNG_SEED: &str = "3.141592653589793238462643383279";
const MOCKED_RNG_DST: &str = "MOCK_RANDOM_SCALARS_DST_";

macro_rules! proof_gen_verify_e2e_nominal {
    (
        $sign_fn:ident,
        $verify_fn:ident,
        $proof_gen_with_rng_fn:ident,
        $proof_verify_fn:ident,
        $ciphersuite_id:ident,
        $expander:ty,
        $expected_proofs:ident
    ) => {
        let header = TEST_HEADER.as_ref();
        let presentation_header = TEST_PRESENTATION_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        for i in 0..TEST_KEY_INFOS.len() {
            let (secret_key, public_key) =
                KeyPair::new(KEY_GEN_SEED, TEST_KEY_INFOS[i])
                    .map(|key_pair| {
                        (
                            key_pair.secret_key.to_bytes(),
                            key_pair.public_key.to_octets(),
                        )
                    })
                    .expect("key generation failed");

            let signature = $sign_fn(&BbsSignRequest {
                secret_key: &secret_key,
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
            })
            .expect("signature generation failed");

            assert_eq!(
                $verify_fn(&BbsVerifyRequest {
                    public_key: &public_key,
                    header: Some(header),
                    messages: Some(messages),
                    signature: &signature,
                })
                .expect("error during signature verification"),
                true
            );

            // Start with all hidden messages
            let mut proof_messages: Vec<BbsProofGenRevealMessageRequest<_>> =
                messages
                    .iter()
                    .map(|value| BbsProofGenRevealMessageRequest {
                        reveal: false,
                        value: value.clone(),
                    })
                    .collect();

            let mut proof_values: Vec<String> = Vec::new();
            // Reveal 1 message at a time
            for j in 0..proof_messages.len() {
                // mocked random scalars for deterministic proof gen
                let dst =
                    &[&$ciphersuite_id(), MOCKED_RNG_DST.as_bytes()].concat();
                // number of random scalars to return from the mockRng. Note
                // that, this value will affect the value of the
                // mocked random scalars
                let rand_scalars_no = proof_messages.len() - j + 3;
                // mocked rng computation
                let mocked_rng = MockRng::<'_, $expander>::new(
                    MOCKED_RNG_SEED.as_bytes(),
                    dst,
                    rand_scalars_no,
                    Some(BBS_BLS12381G1_EXPAND_LEN),
                );

                let proof = &$proof_gen_with_rng_fn(
                    &BbsProofGenRequest {
                        public_key: &public_key,
                        header: Some(header),
                        messages: Some(&proof_messages),
                        signature: &signature,
                        presentation_header: Some(presentation_header),
                        verify_signature: None,
                    },
                    mocked_rng,
                )
                .expect("proof generation failed");
                proof_values.push(hex::encode(proof));
                assert_eq!(
                    proof.to_vec(),
                    hex::decode($expected_proofs[i][j])
                        .expect("hex decoding failed")
                );

                let mut revealed_msgs = Vec::new();
                for k in 0..j {
                    revealed_msgs.push((k as usize, TEST_CLAIMS[k]));
                }

                assert_eq!(
                    $proof_verify_fn(&BbsProofVerifyRequest {
                        public_key: &public_key,
                        header: Some(header),
                        presentation_header: Some(presentation_header),
                        proof: &proof,
                        messages: Some(revealed_msgs.as_slice()),
                    })
                    .expect("proof verification failed"),
                    true
                );
                proof_messages[j].reveal = true;
            }
            // println!("{:?},", proof_values);
        }
    };
}

#[test]
fn proof_gen_verify_e2e_nominal() {
    proof_gen_verify_e2e_nominal!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        bls12_381_g1_shake_256_proof_gen_with_rng,
        bls12_381_g1_shake_256_proof_verify,
        bls12_381_g1_shake_256_ciphersuite_id,
        ExpandMsgXof<Shake256>,
        EXPECTED_PROOFS_SHAKE256
    );

    println!("----------------------");

    proof_gen_verify_e2e_nominal!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        bls12_381_g1_sha_256_proof_gen_with_rng,
        bls12_381_g1_sha_256_proof_verify,
        bls12_381_g1_sha_256_ciphersuite_id,
        ExpandMsgXmd<Sha256>,
        EXPECTED_PROOFS_SHA256
    );
}

macro_rules! proof_gen_failure_message_modified {
    ($sign_fn:ident, $verify_fn:ident, $proof_gen_fn:ident) => {
        let num_disclosed_messages = 4;
        let header = TEST_HEADER.as_ref();
        let presentation_header = TEST_PRESENTATION_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        let (secret_key, public_key) = KeyPair::random(&mut OsRng, &[])
            .map(|key_pair| {
                (
                    key_pair.secret_key.to_bytes(),
                    key_pair.public_key.to_octets(),
                )
            })
            .expect("key generation failed");

        let signature = $sign_fn(&BbsSignRequest {
            secret_key: &secret_key,
            public_key: &public_key,
            header: Some(header),
            messages: Some(messages),
        })
        .expect("signature generation failed");

        assert_eq!(
            $verify_fn(&BbsVerifyRequest {
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
                signature: &signature,
            })
            .expect("error during signature verification"),
            true
        );

        // Start with all hidden messages
        let mut proof_messages: Vec<BbsProofGenRevealMessageRequest<_>> =
            messages
                .iter()
                .map(|value| BbsProofGenRevealMessageRequest {
                    reveal: false,
                    value: value.clone(),
                })
                .collect();

        let mut revealed_msgs = Vec::new();
        for i in 0..num_disclosed_messages {
            proof_messages[i].reveal = true;
            revealed_msgs.push((i as usize, TEST_CLAIMS[i].to_vec()));
        }

        // Modify one of the messages
        proof_messages[1].value = &[0xA; 50];

        // Proof-gen fails with tampered message when we pass `true` value for
        // `verify_signature`.
        let result = $proof_gen_fn(&BbsProofGenRequest {
            public_key: &public_key,
            header: Some(header),
            messages: Some(&proof_messages),
            signature: &signature,
            presentation_header: Some(presentation_header),
            verify_signature: Some(true),
        });
        assert_eq!(result, Err(Error::SignatureVerification));

        // Proof-gen succeeds with tampered message when we pass `false`value
        // for `verify_signature`.
        $proof_gen_fn(&BbsProofGenRequest {
            public_key: &public_key,
            header: Some(header),
            messages: Some(&proof_messages),
            signature: &signature,
            presentation_header: Some(presentation_header),
            verify_signature: Some(false),
        })
        .expect("proof should be generated for tampered messages");
    };
}

#[test]
fn proof_gen_failure_message_modified() {
    proof_gen_failure_message_modified!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        bls12_381_g1_shake_256_proof_gen
    );

    proof_gen_failure_message_modified!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        bls12_381_g1_sha_256_proof_gen
    );
}
