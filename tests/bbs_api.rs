use bbs_fixtures_generator::mock_rng::MockRng;
use blstrs::hash_to_curve::{ExpandMsgXmd, ExpandMsgXof};
use pairing_crypto::{
    bbs::{
        ciphersuites::{
            bls12_381::{KeyPair, BBS_BLS12381G1_EXPAND_LEN},
            bls12_381_g1_sha_256::{
                ciphersuite_id as bls12_381_g1_sha_256_ciphersuite_id,
                proof_gen as bls12_381_g1_sha_256_proof_gen,
                proof_gen_with_rng as bls12_381_g1_sha_256_proof_gen_with_rng,
                proof_verify as bls12_381_g1_sha_256_proof_verify,
                sign as bls12_381_g1_sha_256_sign,
                verify as bls12_381_g1_sha_256_verify,
            },
            bls12_381_g1_shake_256::{
                ciphersuite_id as bls12_381_g1_shake_256_ciphersuite_id,
                proof_gen as bls12_381_g1_shake_256_proof_gen,
                proof_gen_with_rng as bls12_381_g1_shake_256_proof_gen_with_rng,
                proof_verify as bls12_381_g1_shake_256_proof_verify,
                sign as bls12_381_g1_shake_256_sign,
                verify as bls12_381_g1_shake_256_verify,
            },
        },
        BbsProofGenRequest,
        BbsProofGenRevealMessageRequest,
        BbsProofVerifyRequest,
        BbsSignRequest,
        BbsVerifyRequest,
    },
    Error,
};
use rand_core::OsRng;
use sha2::Sha256;
use sha3::Shake256;

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const TEST_PRESENTATION_HEADER: &[u8; 24] = b"test-presentation-header";

const EXPECTED_SIGNATURES_SHAKE_256: [&str; 7] = [
    "9393543a9bca66a2691894447923d0b45b9868f514ad7b7ccf62fd5c6798cb4c17b6135e44c337fe24bd083151ce5e5150de86a1c81364043a8e099a8226010bdad2708c521f8dc002f1db74d32bc5bb",
    "97725983a655c7737fbeb3117074c596a44c9240111d8a593530601c1bd1e81302eacbe4798d1e2d75109d358c87e42631db6554a80fd85211dd6031f1b29ffe5f2a0e78ff2958aad2311faa31a72363",
    "adbe9f251c5093c2f45811a4868ee07dcb6d862b9cf518557afb51d5610049c4b8a3514eb31d6c5aaa5754cd41c73ed06b69a24f93f47fa07591d25d0b465cc90742a3dc6407eea0c5b5c2bd7964f443",
    "b758a9c4396abbc4ad086858b573d14d1ab2a9e048afe395c3f6b34237d5303110343a273366b190b0721acd731d6ef41da5852a829a5b8ac9102800bc6427070ede62400132312b5dea012f798a727c",
    "8e1e0a1ddc6fbaccca8c121879cfe2c4a87b63e68ae3796509be311d8bbcd77ebfe427088f13d30adbd3786585ec28b707292fe55a1028f9ea2939dda071437abb9aa7541e8c0b81a8d53061d55b9ef6",
    "89e02e0bb93ae723b60b0c917024c5b6e8a539148e561dca43de1f26e5e41362ab2fe63ba1cbb8cbe036559d511944ce44df3534ba61e10a24d92cec683b5d958589c7317a320ea9aed97a5f6fb16850",
    "9865b388431254c414fba8113336d7fabbba98a777e0171624ff92cbe899142b5d95d5dff69d68727669af33158dbc8047ff6583f7f3424f406f20d617744736afb42774077215497812ab658a92bc0f",
];

const EXPECTED_SIGNATURES_SHA_256: [&str; 7] = [
    "998b2528afec4adf4fe92bcda676fca11543cac7af03b78e39925149f744a543608a5867b7beca789dad08926b9d255c0860b5cf9a0e54397766bf9efc13d91d5b2e9fcffb8af79f410cc012c32c93a7",
    "abde2c51d36a13017e88ffb60f03f43d4237e8163b418233d5b6886086e8a8c78b3d92dcf6bafa75920b83d2fd43ddc9169e4142a89391272232b21eefd530567ee5744a510378524d2757133a2326ca",
    "b07591f21f4ccfc7c74328d8cbf74a67a72aa48bc90d8e36d747286d7b297ff93a04e85c056f70712e2cbf357aea34f662e0e148dc24ad3f0294dccf2e46fd51114df86984b41c463a9f3717d3f2f3b9",
    "83917d01d6474cfb900553e3682b11e6cd1fffe3012c6163433f3b8fc34be0b14cf6c3189c1276cfd900ee6721c1cc2a2b6457dc6ab0929cddc4cda238bf3749854d53988582c84dd0c841118575b49c",
    "a2088eead391a9402f9244377847568069e43c55b4c4cd59d4e2b2603a1c99e6df5b3e5286665e5d0dd457e5d30ebd113b011d0279c35af745625ab9d072c153932df34912ac25382ac7b49609819df8",
    "a90c0430c5162c9aa5146304868a08a7efe3fdf2f10de7509530c96cd5d4cd20ffb3f2e4318db7260d749423a5fd629940163a93100060df241c277f2b0c3a44c6d88aa04a9425f37eded4b87ae2c6a2",
    "94cbf99a52c498903e78b52659d834d3831c7c65dd81c5c052c3dba0c1220ea67465263590dd22cba2c657de55b0c52d19d7e35c93acbaeed9314ba6fd9e1c96b9584782b212b5f4bd84b59767d3e6af",
];

const TEST_HEADER: &[u8; 16] = b"some_app_context";

macro_rules! sign_verify_e2e_nominal {
    ($sign_fn:ident, $verify_fn:ident, $signature_test_vector:ident) => {
        let header = TEST_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        for i in 0..TEST_KEY_INFOS.len() {
            let (secret_key, public_key) =
                KeyPair::new(KEY_GEN_SEED, TEST_KEY_INFOS[i])
                    .map(|key_pair| {
                        (
                            key_pair.secret_key.to_bytes(),
                            key_pair.public_key.to_octets(),
                        )
                    })
                    .expect("key generation failed");

            let signature = $sign_fn(&BbsSignRequest {
                secret_key: &secret_key,
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
            })
            .expect("signature generation failed");

            let expected_signature = hex::decode($signature_test_vector[i])
                .expect("hex decoding failed");
            assert_eq!(signature.to_vec(), expected_signature);
            // println!("{:?},", hex::encode(signature));

            assert_eq!(
                $verify_fn(&BbsVerifyRequest {
                    public_key: &public_key,
                    header: Some(header),
                    messages: Some(messages),
                    signature: &signature,
                })
                .expect("error during signature verification"),
                true
            );
        }
    };
}

#[test]
fn sign_verify_e2e_nominal() {
    sign_verify_e2e_nominal!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        EXPECTED_SIGNATURES_SHAKE_256
    );

    sign_verify_e2e_nominal!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        EXPECTED_SIGNATURES_SHA_256
    );
}

// Expected shake256 proof fixtures using MockRng.
const EXPECTED_PROOFS_SHAKE256: [[&str; 6]; 7] = [
    ["98a6d3ec77ec2f65dec657c2a108a42d290ce271438b5096c8ebd110b96891bf4e386dcaa43aa966f9887abad01db43e9890e64c84f122018e46f3d849cc6e8d906d31af37a858907b8087ea6069a4171cfa61e33981aa8d89607426d35904591ceb648f8d853b5bc15fb2514c1059a2932c96c7163a4a6eac14ee62a271ffe4534941dfece9d6dd5fbdfe8ca3d7122ad1f7df590734377db5198708671f75052ba21ac496f5d99fb9f97e3c90e9a057d68f1c60073bd02ffeb378afddf586ad094db6f553e928c77f4c2a3ecb9529528531c92fe03e81aa2e819186b43fa12136bc44afff0323b1d5f2b54115625e2f9c454420cbb804485d82ad626fc3664d126dd6a2418d5d72115cfa59c704b0b190e2311904a024a0f4a45dac85c792e507b7443e7b916016be40b37783c0ea987c52e0dc6e02b0203fac4e50f9f6545656ffab63b62a5d4126c11b4ef925f7a4d71a489e93937f8a3e41aa6ca67bd66829f77957bebaae41ac2f84b46702f8e12be9c24305231abf8fe71e24f0315636", "ab40461bb1479276b71f00cffb14467940d5a4499994c20fd194cb20fd13d8550a3440ff04383f3f19247a15ab221ad2a4dcd35575d41b59aab59d7a0a0c6a14de01d2797c20e8ebb38d9578613f96d9c06afd7bb85ea9cc7e1f4505ab4de07c3ca6f5dd1be0725b2e6d54931b64db4fa940d27cd8ee70df0ab6f6421d4327b85eeacdf677cde8e2a939038d6202046c4d9fbfe53c7beb28c60d2e2c391088e15895703381ca0e270129cdb70530e88b973ef008bc146ba557e4c00b5389a18e66cf40bdd76c3f6397169898cafc1294540330418a2e2f59094287b4560e406b19d04a931dee7746872732bb827b80d560dfe88cec1203b6b4fa2fdc9c46b7c739f143d45680d780db2c46c8ef27b190215ccba66925cb93502053902e30a934671eabe92e3a9b9d4207e54405a6d21fb0b5a9b8ada620159413e0e7ba58a7073af0761fdcd23f9cbdd8bb2f145632a455ed2131daa57152ae9871e652ec6bf3", "8f87674dcb2614e64b2d6b914d355209fb06d80589fc4c242afa731083408271d32c735fdaa9828bc0a82f9d921adb2580aaf95fcc72e7bc5fd41131058219191b782a94a3cbbfd0f356d7aacd8dbf5e243085c027184afe8384965c91800cda3224e3544fc0311df37775dc5993b69739502110cb8fb28b39018dbd9af860c26114839a0e8d5c47d1e5f2479f22d6dc9886e560bc6222d1c89eebc9cc15121e6ee1332bde3d880b7991c398ddfe8dde5f9981112536ebdfc22afec609771449230d9e4047858f57fce47d8a71793dd4e490cce2973394d05ce356411c3ffb1d615ae25f24a6f41a72e2afe7ba342afcd0627face91c3ae4d01460921de8afb06315362e09454d613ca0aba3bdf5e3f662240890c02919190c832ae6958c5e4b46b8729aa3a7dad98c8b1121a05b2dce8b7e44a5e393e11d2f85f36054495a66", "868f089b09490d37e66384fc950109a149981b7804be5da2d5a2724b26ff6c9b0400e38cb80bff91453c1f130fc4411e8bddb166a7f05dcc443360342c664344c33d14e151bb820628b2e45a8c77a6083e478b9abac194328eacc7f58719e1a532fc9ac43e69220817b7f0e6c1f322e112ac46bcdece75bc9b59ef3fe64e059e5392b39779118ad12bf10a9d58c7c771f6724eb230c32e4facdfb50c363abfbf5ab24985c09afc87bf8201e830b26b49899de868fe32c8574f7ea04f51b35acf5f7f2da1e6899e766fce419f900e1de4ff3ca36be2c4d266924a9b4069cf66122c117b0aae67c62f81405ef1ccf9c9488919674342cddfb56cc96eda5f0a7db81e7a99e995d84edf250bb5900d88b7fa4f32f0ae5fe39eba5f6c413a8c3d2ba1", "96af7fb69e2d1797105edc22ae60ae1d87aabbdf21254fa2719dfbf81b5e8f6a9fc6c4de7b3d20c894f0d7eb66da7b4e844da25cb41350682d5f6f05e70c04a33f3bb3ab5131c5cd55943177efff392be2434d68e3f0466fb4e76f6232e4310a067775780005be259c3687a2ef32fc21c06ccbc69258deb72fab259122aedd0b5bb579887a6495296f828c9c84f71da3a2db9e6bb6cabf91ebd0f195f2fda247022b2727b8fa5c918eea1128ac0a8e999f52420ae822ddb786b1cb743fe903d8374307111c7a793e015a66f69fceee244848a653059b0b5baeae146abfdec53d66b451f65d0919123029bb1faacc3bf02e9a6b7a2ccd05f7a2896c3718111b0d", "9676bf5150389accd59c245bcdc2b3a79aaed654e0e461d77607948ea03f8010f5517848bad9f93673e9e496862e1501b110286d0d5b4da1c29299111c433f743f7caa87c18fef2e47c1e38d234278dba851db626239b51eafc3657f8ced1b7b1cf62f298084c202891ec88bff494188308b255762d930da1c0df2b191c347635b15250252cd7d030d10e04bd1ec05a3f38219526f23c54afb7929f6bc82bdfd70199d7411f53f8ffe193976577e1d9bc7cb6a108d2742aaa697fe949665f55427164f2f7d820f70a49c999f7d092ad8dac17df095288038830c65d7bb95e78c"],
    ["87e25bb9c88b7a3d962c9d97c3f07f2569423497787ab429edecb90853d2c344e21e3c83fef67cf97c5a1c0cab91d5419287ab8ef85b70907505f8c33c8825a2d4b0592071eb12b8c41469d05868826c9b1e5fa135b29563a3ef8510c34f332e04dddaf09861f7155e6673b508bfa537ad50170b6819429f8b54ce6f794a767055a0a13f49995e8df2562a9bddee01a54029d514f79c8f5a4edb644ffb677ddd296353a000f6bc663266017403d413d4026fa659a60220d64f347e220a6fa68e6f44291e2ef6f3f591e8abb426f33d1dd26894d72918d48b05c27f40a717e3d52f916b6d49ab63a9d0ecd7179181180c2094fe72263cdf284020ca31e0ac5598157ee4e5616040ef9601e23417286d6ad231986a6e41348e1e82ea46705691893a1324f31846732be5cbb002c37a710650767ea65d919dd54b2f766fd9e68a3d09e80e19a5ac0666db5a7de9e9a78c3798d66a913b99b605d131244cbb594d113b6f4fba4e21bba73197744a2d0fabd72322a04fa27fdaed6fcb650527ce7224", "945afae38635fd8639c102b2f31571b53d3a1b7112a9406d3f01c21bafcb3afc10b247615aa40024d08c8cf54656146e8ed3dd7e072e1905c19c1e995ec4e56ed468c5a0fe889ea1ed091bd4e617b29b513ad0098639532010cb3fb651e2bca0104700d98a9b04123e9ea52a6c90027362f186881074d6607e368c4e45e292156ecb3cb0756d7b57ce7e1bc9ec7e6a69aacd80dffa2f786001aafc2267155642737d633991e8cbb1a202c495e3ea2dd4632c337e70e7f4154e433942123d3e6b68723d2184def2e050715b3a2e31a868192435a80941ed7b73772182158c14f528a7a9c622de08c72b45cc90d84f925c86bd7986d83578e337c03a906ecc3dbb5fc0599f218c73cfac1fafaadff3a422f771c60bb741b698f6fdad4eadcc45c13544196dda8d92b34b69af2451d3a2e3ecea33426ca1871044492c27dd8e8ad97299247509ab2fb9dbd5af31c0412933ec0581e0d1617481c9e1ee8a534e26ad", "841ef6cd19a1de25e1aca1b402dacc5016556e3a916c20ba4c2717df9cdafc0166657dcb67c24d5affc9fb04bab52b0ba1e2407186388608789c5723140cd7c8015bfc578a41a6a28539e29990f606090f428f4192cef630e30eb4b49ce0ee863d8f22e26fa744aeaba673c1988225f9d5aa0990066df8821e77c6760bb09b684a713de6a812a16c7e99bfdf1e0f29abd9ee38fb04129b4454b7d21861f2020b63a62e35a4b2464635f7757edbc496493c94735cc1c7c2b7ae2455f44089f58f3f15c3554a496e2ab4a783b689ab45196ca165034b3d8793651fc269e99633e15b4b6e40cf1b72868f86229252e70a65015a6bb38470e58461d341dc614c47ee2853fe41c046b14c3945d8921761ffa9b5970059818e2ac8c5fd4726786038950cdb1b297e05c4fe9c2d346c9ec269f440e0eaf6aea74b3bd725cca83caf4310", "9418ab876a3e1d23b75c6d74519479f33377aed4c0c32d0a10b8fc89e9efcbcc806f51e6f1f55859d64bb7d21ce6c3d283bb8152e7c7e157f4a8d9c4ee6c8ea82eecbea69fcc7cd775056e01160028585833fd27264ba05a99e8a2ea600c8ee472f28b5ab02c34e27f279c3d3d5f0ec8e3100a3fe139e3a9258a9dce1d0de6b46dc0a33dfca5c930f048c0dad5d621f4b99a539d602f49d4a60fbe29c3bd0cb45858fa04dac833ce56c415325e97b97fb1e821ffe083a8913254f8c359ebacd1562beae3a43e1a84e403664fd9402bb42171ec85cb79d2f4f228f930c058236241e1f70fc6bd004f2127fdb2855c5cfb95fdc060419e2f8aff31e593cdd904c45c349466aa7bd4ba07389fca3fc00ce2d0d5f40356bc303d4c915b99a3c87041", "ab30508b77227b1f14dcd1d3d167ca41a0977ba3a1bd2cd816c2564c6acb93a3aecf2b94f5dc0fd16e95d9b8729bf36ab9bc31dc9f2273dbc99dd8f10ad383b9c40af23b170a7a2e6247beffc28bac3fbfbf2eb0302441268b8c07d02a6b0cca639619cab708ced0acc0ee9040a693776a57b9f337312311cc397650195f1c2753a03edfbe497d4219c59d11ec55cffa1c88fe0d3afa00bca006097e49df41075ab7d09920f295b4a0b82d6a1e28a87239a404b91c8f65b83c02385e95751eb91fff255434df8613c2934d835ac3e3b9d49a77a88a397b051f8df596b7741d455e2ca1782d9269602cd1abf066f28d2cf2f6453a24c428d35a76cf8b953b1572", "b45526bad9cc45534d74bfe20e8462884172e7fb668afb3aab5c9973cd7917446f041a16477c25d04a1e36b6683dc1caa23d6c8204bbe04cd27b94ac03841ae185481f0df922398e0bb67793d56aaced607fb8e7b67eec776e42a134a42149763b52b7100ca3b1978f0211f4982f8fdeb034a0f92b9406b136378bef6b92ec443ab59a8d4f0f834dbe71e543b677f605130af2bac29816486dc0516401f4f372472f3ebed0354438aa857d8a5f3e5d155194fdac563242f1e657d4ba051fcaf80f9c26f4aecd1134ea47ea4ba0dce7c0e4b410d39f810d03b35f98a93b694f60"],
    ["ad3132879e947c85f36d93e0e781175ba519c902618fb17f3d5c47f8face0a4f2ceb384051e70099439894efad638800898f3753333e83d86700cb975b16f8b891e70caf4b04efc467b6077790b9627ff2e5f5d096b4bd916324a87315a32f475c3b6888d7c73a775e0e33c607a64c1f0d5beee9f3164b56a3ca8f2bce52493c502aec3898d51a8658ff7ecc9abc6380772047e2edf02959271f69ffdf0837e150b7ae13cf27ff15e505f10079c856a0b97ec5fd11a84174a8de4827960106444ad5c9fc88c5716e558ee64bd9d0795570187b2fa430cb62bf7fe2858b69084200cd4085cc4fb8f5c43199ec299aea769b7710aae39c7a8c75a7881ab49d87e01fac4a4ae228360557b5d8b188436212165d999b7617f592dd9ed058971cccb03bccf510cec6413e06ee0b1667d9999c611e0f367aa5c816289d2594832f4b445f8226477a4df9b552d136342f8bc8a0b95f10e13ab3159dfd31c587e3d2e8d757d001599a1f9d9273a8a83113c5a33a57e8da18a95b67a9d8c043103bac07da", "a05c85cb5c8ee74af31f689e4c7e966f6bdd50700a14d11e8cae969b446cf46b55c78a68ec049dc02e261249647b8e608a1f1ab6ec7c52e4d2dc7baa227e66f4148ddc0ffedd28102ea860f715a9ee7e0fb182893e714318397cea5fbda151a76b2b8ffe48c0330bab766430abc1604b2fd0a0fcb94a05ce11434bb46d1f59de008f12fca1646f63877230a1af938e0e247a8e1d12240d5230e9c4b72367658446d2ea909f31a7204a67345cde357ae2360edd5474393dcd453ad2ad01b514a30b06ef8513ac4660ca2cd19408c0230d8e8925f3bed5301f07c234427bc0838261fcbd744c4d90f66ab782f4564ebc4391ec96c2cdc3cacd2aa7efaee9bda8dd6458db0ad74061febaf7a604767d9049c5418c7f00c9be887e85ad09692ef4c36fb889eb959b77db80c275a69791c0a48de9bf8415ebe9d6cfafb27e9f7f4f474e4a5fb5fc713af5ea30d8ef831e7eff6788db0fba908d075b5eb74ea0af365d", "852bfb2b17fd2bffde737790c2962b5e606b6d32760902e49ea21ad2ffd01e962edc6f1aaf74599c40c60452e7e25e0eb9aa0a29649c8bf71cfbc37defdfddeb556fc05ce2713532f38aa0abde6538443a1507da9541a571e3cd280b5d77f4f8028e546cd4fb5adc4f4e8f67e0ba057715de6ab5a96e285df37e2f50691609d20e946e536fbc435e75e56e9c6afba254dd852e896ad98c632a9a8eb5172578cd69e545683ea8968b3fc820241e8e652f8cdff121b2955621d3cc8724442836d92f8eaed07f41419af7986aa0ab81420617b944660fa28893459b98c98d0b0a3440491f9146d75294e1b8623f07116132c4c73177c4a38b3ff3cd69fcedd9757957a590fd385a9f42468f83d1f99dda34417c45feb3e71d6e0e9123f04fad48ee57fbb8917e21c9538701d4268b27b262a223c6cf9d2a2fac40aa5bc61e69832c", "97febc116a25e73861dc0a21a1b7e62dfce0c730ed5b63c6e8aa9d6b12531872d60068c1a6cde38e53934807f8e1ea4ab78f4bd025dc8a09b5790e2445ab6461a13dfbce1db727b6f9f911457e5d0860cd17f9b5d2d9f5932f15218b4ae714b2448253f8443bca40e82a569fe57a955ef2e65296f95724b636a661dc629bc69b4ce0574c4af4847c186bbd1b02ba7228aed9d77fa91e926f9889123f7f50926a5bfbe2d338d9752dae07e727202fc29b02b1e67805e46a3ce8738e68d50549e23b3b19cccd2c9aa957570359a20d400e7eff4209d264be7545308d572502d42c4b9d16f4db6e8b2a567ed7469b254dd363e982000c595995c16087abaf07165529cdccfaeafd957c15c900e6ab1bfc16880f441a3a7e83c93b285b8571240997", "8238b8435f9bf36abdb0eb97d6dafb9aa0f5380f784529de591ef1248825b95552b8fd941e47096374270c8e025e6e5089895ce9f072e05ca5d32c164948632c46391468f4ad946e1a8a7c4d152f622dcc46abedd233387218d98b8bb8f0853612ed6a4c34fc1dd0b499a4e8e5ff5ce34298c8de9a16f0354711411d3d31495a15621afa32b47c0031a4a8db810c3e97408c47771811dc483f0a63e014af640004d4449360c247b179960172585dcafc170d3b3a27119efacedd04c22a25639821c160b92b34556afde271eade2c3fe4e79d4175e38b41dd74172c0ed083ffac6924b150384ca17e71a9b391a4c8aca4b8f0aa678aa903b045d17f9ea4892d12", "863b10f87076839ca1e2cd468a9c874565afe5fdd25646a064f0a2f9d28b76491af6ab9da0dcb16b1d30d4e70c2072adb234d9503d9c79afe418a35b7270001a9d8ffeb6b865e7bb28c59df2566619ce619b2b6df238a58518ed7b4b89b5717817c6933058e610ccf69c1dbc2a2d64464c55f91dfe6046bf7b2e7bb4121fbd30546cfe9354646970437be046bc96d7cc42d944f0b962f1731d1a6e779c400a8a69b236a53e15def1c6f68b1ec53284e82e89cfa37c872a0f49a7d2c17d4191965b69bfe72581e5c20c96fe4f5ea6c1875fd81f42f6299a977880d0e0c2345a4c"],
    ["86baae4bdb3d7d175571b87976b58bc894e711b74bd22bec7891e5daa3b8ac538f4abc71ce34195138a58d69773c03f78448e96cf6610649e8aac3933b4e378213068ef5b6c2313df59f1faaf0807262ef2fc3c00e53e3f25e0d655b1b79b9bc387ae08c7e3aa1bc2995929853a6d7f183d7fd490d44663fecddc74582b6029a58ef6eae60f5e445a88e6a307d34aaf4c3308567559ab69fc146dda0ce8585670f92dea580b4379d14d38431d5c95781e8ff08f78e1a6de7b02cfdca23ab39e8632ad08913393c23b24e46ec8f26b32bcee4b3cb0d7a0291514a965db900c6aa1ef98ef65c8df47f93ad8367c8c17320547f849abb86ab41400599d3ea6b3d3662c57111d67152a703ec34df53989d42f50c06e4f48d73447dd126ab939e09b4280b61e455e1e4c2b35c1a56c48ee1a6b8c1720c6fa511f7145737af1bca95681e976ec0ea35c524f73a3f4d5edc9d0d84fb52f24199697aa256bab2ac6e350569cb7426022e385e3c781568688863431fb0e337f2b3c9a98731c7a7b86b008a", "824c7be40b0672676cc96867e330de7d3e6dd80ece82861a50b07cbc9128192c5c9b5fb8d3362920602aa3650398b8728f0db107a30a50a34395875c2fecd941b18ca144f7f0a067f60ee54251ba2a1b45db77d1e994b1fea0f78fcea99b66e20d99563d2d1f51f8ec84f0904e0e7eb7468d02a7b802f0b3b11359ceed051d9a401fbf5c3464012e876e292956d2900fa0e08a9ca375bec676008fdb869c2b1a38bc3843d2845ab6b558feacd15a0f48b01eb9c9f33b0f1de15bb219db1af41e33e3bb1461f7d2e94bb7163591e5e5de8676b443d0b7f519b646fba66264d0d333afa8d04aae0928b1c9489d82cfbb3f973c75b57bc47dfa4d04ce43700abbf234879e78d5cba50c2c978fe1d7f83c059390de937a54b1e29d8886fc9d226c3830f5414740c7acce2ef67d2f7d6d449f3efbadc57042bf9b116b27f4002012a5250f911577a38ad579a40abd6267e955b70262bfe97506e1766d6aa7fbce17dd", "987eea227f1c7fcbf6d7c7774f2303848b6d5048add62a4276ac8e55274318dd6dcc0dff2a10cf2e212f1c2862a90771a2832e44e6b121f090991fc8e4b184b223caa08a536ee90308faac8a95f7512131924e73d8dc04a13e97b02f079e48f925ad4841222534227fa22f6a1d8fccd00aaa2414ce5bd07811304c209df3109c54f45c11fa0c768e37135ddb9f663e4f2d6d41ca4132ff194b243aea894cfbe96b1fbeddab052e0ecd22d3b7edb522a78c4756fc6987575276383a97ed678886511553aef08ab0f35675d927393ee19f06648ae944ca2356d6c8eae31d46e982537425026a0e44f74bf243355c0c1a6587a13d71d05cef1d5a5f9f70518c307171aff5b2217120e7b1d3a47ec4d9fe97c6de447d0bf8b2cf78dd07040c954a0d108fabff8e53b243d7119b17d4c2b9881e0bfa76602322c86717fc2a65474a83", "a6b8eaeebd1eb3686b508ecb3f0dbfd65ac5767b93f5f44824ab4dacc8fa7c33b29d80f42d031fd57153091aa579500e806d11425bc785fe15e4ee2e3297c2add39649a42b99518acd9202604f4f368dfb9150f800de14f9f7a8baf89b4749376bcec15a8a375b10fde11c12f891d4325a673d6962572edafc1ada89e9bd6abb1af9d01cc11c99d917d996d6678cad263915cad4b137d11246654c9777e8edbc2b6ffab3f8d733112ce70a71fb238343fe5c9f9e83b3c80c8f7851fd96aebd1c6b2d8034d97c7d6173b5baa51dcae16dc4816acdc4fe0ca539d4b0f0ee315c354f3a5cba51ca79529939e1f33dfa65c39ad6c10fbd84366d4ca5df6bbdfba5bb1e37fe25bec130ca0f4448e246f00d1734a20b4529c73acb8a26cee006d2acd9", "b012e63ff90165cd2618154bf156d51ddfb148b8b42155ace6525bf28c8141c8199136fa01f397e666229e75e8883e7e85e2e5fb5e2924e48765a1e3b23be531d40555a0f6baa9983f0f43c1a6e7f0ca65c7d13429f6b77e995469f059ea93cb324c5620b2be57bcfdb63c2f3e57c1645eb14093b51eba6aab34e1ab775694520d7c9605253b0deb7e09d91db708f646ed0b8602223a29f2a0f0fbcce8bcf114375ff38bd568824a8800fba032b76f33da579082d3df40fefd67f0f5f50de0573d2ab0aeefde821e3c03e6a28f44ad3bd8bd85a11c92b9cf1c8ee0a8c4c8575d3978e499da9701be736312dea02dce9f6d1431e54693e9fcecabbdd226e95d35", "aa1b9207af9b2de592609767475061ab11ddc9fb4e2ed8c83baf0a1e68998b773ab0a43df48dffe41a4edf52ca437dfcb46870702be0dedf01aa027c43e122f9951f95c173a33de0abb00f75bbb2a6b268f05510e318862ef82d9979162e230c4b04bea31b0a0210087ec5f955bad518d47982281d845564b51719133dcf067d020b60c65ac7ccb90196427227fb5714b151e03e2bef5ec7df11610d19006991244be5df480bc5188313406ae6210c4dcd29583f15c3738d07147691ca0bb31837b4ab57766e492fdf8432e241264b865097e112adfc24b32b540a7ddcaa9189"],
    ["9862ed3dfcb4db83d1b516ce22559698d8de7a3a17fb52a638175b59fdc6724396f5175ac27c6ca5fe2fec5a66ec96b2a0f70c94da10d0471fd21b9024f1bc4556262bb85d46e972f49eb12e218c5a33fa66ee63f54bbfb2b2d3e195828033bb1b4db1770a332d0274ea579a60d103c508f7ca5828218f8a9d2a33c2718cd774399b711926705b3a8d33553985f7290cecfbeaea2fbbebb8bd235f478b775c4d116351fc349556cfaa19b8f8014e482f3b1f9c096cc58e4b47b0bc8ef6c149ef0fa6783bd3d7fba98b6654dc8ceb6b78b512a2c8a9a0452f346904039767bf4b3a2e0895b9fb73fce6b39f199ae4344155c713a793935f6b7ae2b5373bfd863e69550591f72dc523c01d05c78bee644d24b8b6327eed2d68de59bcd1159074ae5872dac1efb869bd04c966017c6ac3d496b694f045329df2a12a85778e54a497539cbe79445512bd4747780e01d5d28f21574bd69c846d84ac2434f6a11b47753164b911f42a767ff5104a13505905f08fcd4658aeb90684e2ff31f6268f2c94", "81da69ab8fbc1795479cc4167749b008baf7f75f2044fe56af991450fa59dfa2aaf067511d85495c086d45dd2cbaa2d0b88cb60d422a9f7779cedf72c3c603e985a4533cacb0255212854402ca8415e7cc5aa88ccb52cf7d80b2638f6e84ba674c2506f8af43f91b2145f78c2bed8e808a15b86d715a54127c7ae8986c81e17428ec21dc82abc0da48116617087af6cd2c3d4c4b0931116bfa2edd5fa7c76e2b4dc49f72a8856b64df0bf2f1107c1ff9ad86c0af20ef2e3333bd483a01eb5c20505c33a9d7d5fb7246b3a81ff56dde52dbf7f94b9a42f0245805442e00aa6cc040f0ac1e295e91114c5ba7beabc61507c88c44c5b9aab24fdedb5296fd72d6155a48d4590c9e93748355ac2c857ab8fd511363fdece8008a6f6d11c47df5b253214f656170ad822b18d8e2cfad3b28a830b518935760b94f08811cacddcea49438295cd96492c9aca281e93950be391edd56b7aedfe3bf48b7a74269ce0d258a", "a8e311b3f3e97a72d8acc96a349eb8d1f3041bc2b31ea601f7a62214a195392301c3400cf782aad76e4324d115d27408a52f4df7ea85f0917f56f6aa95c2c01ed6bc6c60e7b5af1326bcc360889de746454e0e36a0688aa34380404a2a8740d141b9f1a2bcf0ffadc2ce6af80231f6376ec87f9fdb93dd9882ba6e1e721c8a9d0e4976333301adcc6d265c072d61b373e6d513eaead64552cd83099450c9e0d445dda5e8fa01e68e6270a2702d30b92a588ff65b92a05280dcac82d0aecf325103ff8f28f8eab48c87ac802feff6512915f4a818a2473680f7c1bb113eb932921cd0a11aec5849927d3fa2b1942af5e6213b899e5ada242c54991521589459da6e0cba7a7709a3ada5b1b5123f53d53884d6844bccdf36e95d20fe8e33e8be63276cffbc2f376e8ba16290de971c5f426f133f199c9103168f7b347b41ae029a", "adedc19f3dbfe5def62e140b845379f5fc7442ab066a282943857d2d32ba58ecb58fbd376da1900b2e962b0dabe9a7f9958fd91e884bec51c1c12d2016c62074cb49116702b2a5d8328fc65aadf365414e3b6832a38aca670017d07c5ba1572e14eb4f5ae8dfb1b0deac21b94f4f87f7725059b0494686ddd79ec651c563aec61f0afef5caacd66a8230c4652a1e6319421fd3ecab8fd2b7a4673a0c5f7b8bca4269faa95d5a556d0202f4582cc6fee286c9ea6481618ac01eebcfd7a8165e88444a3efc31070bc43c866971e27cafa29ad478f8f12e923b06ad58922f1fbb870b2d236246b959dd58f79d32a5d9b0fc8aa6799512fab873b74f2be33ab3dc8c56098f741283c0f0244fb4b52a58296ac7020daac84271063df7dac70e55927e", "8a67456bf7cd474deb7d7ae9f76712abc2a91c8e7e441b1f4708ae49f69cbd006f904ac905ad0fcd105744db48795098a445d386ebe8dc8ff79b8f472fb00143246144b24b32f05c078304d4b6d05e58dfc287a998417d03cddf881ef96d3d5b27055ae71d820e238d029013a62e198b2582d59889ada67e901dddbc365e1ddc5bab74297c0839facbdef3b2c8c927f88a50bf6c92eff01c35b1902261aaf9f326f4b66704376d562db55da4bb85e4de4984cc4bc029caf8322e699db701b1d9492d394c4b576ab9e9b33b1d2a85eb7b6f123505d6f8427f00cd9ea8700cd41422981fff5ddd815fc6946df64463db764b2677267e2e1430c1ceb2253ffbcb51", "9718d8586ee8dfaff5c1f02523cfb7b354782dc46d99a0e30f59d21b8a04b369184f48ffac66519e0bc9a2b3b987adbf83c0b8c60ec279d93307bf47ade5a06629f7ee828f37bd6e9563b596644110c815075ec3bcd68d11dfff38375ca31d846f9f6324026c7afb8aa6fb51b4baaea0a35e288067c0e699bc1503e5d25989791cc1a6f666f9c1e5999a145c4e634bf5a2197481b540b1cb622bdbb6a2f3683713da2f76af95cb773d62fd5623fefa27b894687b4d4221bbc8482c16e5f09cf645db784ba7ba5dfa709f7729a19488b78aa4d32502f378e745e824da9ee9d93c"],
    ["909909e71682392ff0853ccc2b38e08be65024bbcff4227da5a905f66b9d6908b6118773b32d87f783badcf23122f8eea34f10b9d79bcd356844205c4092839bfab2e5e1d0b3ccaa53d508e691f688fc9152f40ceef93f9add71a2cf8c10e51c1db2ca00cd76a902cb91902b76297ff63b0d991322631675e02b0ca7a39501c3664d80d6536f80087d4d68b62a66af2f6ff57542ec4b67d6848d4f097d84ed7966ebe6020ee9713a876e7e9ae4c1a1e2de5c2d7f1fe2f637d6e6bb907866a9283801f89f675a00557c7be76d7ca4c1f0fdb70128c9a276217ccfef9bd454bbae5649e7eddc9dfcb28ad77858e9ccd043464a19a40c736261f38eeef9f49c399069f98c1e3a58de609b57018903b79b914136329a7e785c426d6d818d88319b581d0b2d9e006b54a5eeca9b421dc1d616a5d7d5d291b6c49824d2a1b2584015f94a9857ba6dc57f2db4f9150ba462de50959f58d5e672e454c4414222d824dcb2071ad7870e4548c2c59a26d7dad555bd30c153aa7bfb83e2e12f8021d6d5612d", "b0f5e90ef9b5d6a17c1c32814f453d117b857619d9189229576e0c15aa243b0825243effd7b636de4085bd1d85251649b0eabb36b00717927551ba6aaa5f2f03690eaefaabc1ec4b3e5331e5f7454cc6a0d05dc75e359693a5c34669535c69ed25bab6a09cdb2db58a17bc74c3c4b054fd595e785e41f991439a64bba2d17b9d3acddba4d395c276381fb94a9921dcd184dbe43e6306c109cefd5be85e0c7e8d3126a9a6ab2c64ccbb87021f4006131ac5606b803da62debbbe570abd6c71fd300679af24f74347b7f3aa54253e64351771af6da89ee08a17a09257f2a1409d21e1059d968a1331cc34056ade5d110f711081f92f58f214d965314d40f8b85070917d6fb963165e554d61a07fe5262caa953a750dd59890fb30f2e103c51c9655932170e75e52158f6cccb53e9a4971d7f662295a143cb885ae45c9e4cd617023430433017d17c872e5c7f9838f86893a7d84ef2576d54d10787bdeff798fa78", "8de5a0b205f137e4adfec1eeeb03e983a377696977380aca94ceb26db361deeb9f966552b1ee38e93099384262edd429a11e48d8074fcc065d44deafbb5bba3b2dde54281f8b1648e2d547e1dae46107c5dd0636fbaf0a78ecc5a234fc3780270a6c4b491f94b4e52896c4f00bf1f598c646d8521d219f38d99b5bc6c81325943e23dfbaa1eeb45c5f43900b709aa9dae297f7fd2700d2673677aad6f90032ec4fe66eb85eb65b5785b11658dd5fd954a70e635d4dbcbe53d8d2bc5e7bf7f3aa36cd2714565c30674ca18ad79203b568cefe05a05cab26dd80d0dc2783c4d4d104e3acfa63ca884ba27216a7bc8e2d0f10ae26bba413541619ffa5f4fae2233970e0ee733e94df611f2d2027f295166430534965422c228b4b5179a1252b1c832d0633d5bc98ad4ea868e0a7d4c7b466f44f6762e37568846d8fecff97a856a4", "904f1e4d52ce79958db192fceb694c7fd9f8f6a2d60cdd1b66f5c2e2460283e04c130f02cef082a99faaceaae19156d2ad21e6d95617aa439e82eb3e490c6217f3889f7d8d2afa4722ce754a3ef613377b732380c4cec461bffba25a7c40ab294c11dd9bc2d5fdd0f7f34eec7858a61d9bec2c2a0b1c408681d2e415db3d1d5e5276eb6313fe502394cc1466d987349e8e6fd14c603701c4ce458e04f6a4f6e431d80574184eb14c7023ab86582f8ddfa19e9979bc53cc953a561ae5e6fcbb4904c4f0551116585bd133548dbf8398ca84adda83a4d13e90b019b5e78b335617340f73c05a28c3471fcdad05674e12a63ca9badee8bea6659abf1d3aa35fbde3668d061a945963c8d20e6c0402e2d70cc64c7af17d6c5f234fc635ea0a76eede", "86dd0b02476bd8fb014c52c398393634c8f47319b01ba81c052acc685707b073fecaece217d86b5fbdbe11dff548fa72a42df1ef8da29ce3d0d52e0d4a5357c2c29e5faac64b7a8c5fad2f203cd6f76f0fcd43d7a75b601f3e82f5776cb7001c297f4d208364d47e23badab07e539f38e2a4a6d16602dc951168d65b724097dd6b9cdd54affa1213576aeb87b34035269aa213cf712c0b9fd5401c1a66ad61b42fcd907bcbbdcd8cd7349a6e091c8c35104f5840abca70d2f6e33010eafd14d30cbff558b2a9ed46346cf44755aff1e5cc0b53362ff713e54b8ac2c900de67084769bb3331f0b2581d20e97ad495edcf103a92094ffdedf3fe8a57b07e6b8083", "8abfc003a260d3cd9173671dae2c85dcf435b0012a6e99b083d87cf710cf16e33658dbe0b7fe800a15257d416fbf0058b3c5254ca5dc5916e413d3903f63294c486a8dbae2d52b34a55c806b6413583ad75efc2e591eb6654a2e4a276f104d835cc9d1eb53481ea7a028b65ae3af83fc7218f85a2cf4f24f3e13af5ebbd404185ebe55a9f54409db4dce646e9084cceb797403976e76fe87b2ab8f2450cb3cc011fcbafc718cb4409a94b8c650cb20c0e69e259a386d5511a668c724f844f20947ab61532e20bd46c7163c6f74bdad34fee6d8fee57d05ea9bb762f2d69728ea"],
    ["b86227c8a00c110f71b002bb0b450e1f4bfbf404487f3105f48635f5ee39bb740fc92989838b939a8ec794695ed9ed368371e84425f84eb11eae7c515e432e6900685b7a5bd14de73cd1d4fcdea7f01d925a3088d9294a14465f578d67a8b4f9588f4cd73e6d1c02aa1f6305994920527ac58318f79ef283450b644a365d5ea40b2b24aac6313a77796de786c959755bf8e2430fdddf4d81c026e1453a5742fd0f8fe1f0f8eb6367c14f7f3870022ed520fdc5e0b37372e54c1119f213259c6a112dd336c1be9599cff8dfd021dccd25919136ec05f147fc3671e7dbe00ee89420f7030fdc5723012a720fd27b965536eccf6f8fa40112c5893ce1d5932e2ee353368366866aec790a2c24f9d1e0040abdc1c4041dbcaa3c2368697f531a53d619a18999d996da7d6efa4e3da9ab0e30fa374a1bc08b64542d4869c97e2e68ba25a2a7080436be018e3bc703e065f2c6fb89a252a07b80561bcd5fc06952b125286b5d2cadea10ba67a9aba23ba8aa99bf7e8ca33b71eb7ac830fdd9bd9b6d36", "80f04c62052f47ea5739d21eb602163ccdd544c2dbea671422947d746df0a59b239d5d250347af5bf90b37ba92dfac46a65a8e12fb78f6a1d69534ee4489bfc96dfcebdfe97fa9bc58f492fa5d4c07aa1c9912f54a4ff8ea8174319414f825185d3967360994f67567cc816bc2e8b83a8c5a95d4116b0d2136e53e8bacaef4da5251ad60acd860b3310052444cbf93bdbe1cdcc8f01e03f60c47d6a5883d1b0c5a818d08601e3a6be05e67a810cb2467ff6d72b41a6493da44e357d5f610187a6700f243a550da010c1320ad5500723f2d5073828bf731536e88ec5f46bbbf9255fc74ba135d5ca29439980b30c1e29e0558f3b79febb76245213593899f774c6dd2edca370b6ba0fa39f5025738371eba24d5747eacbf37107258958e9bb2c8142ff2bf3cc2962220cb67b1b73d4ae65dcb68e8bdcba4ff30bee73253ed37993c0a888807af9684470e09171697b617d683d24948940d456bfdfa328a208577", "b249b3e956f49d64e6d16b3eeadc3d464ddae8a3aabc98fa9213d8d9c43ce1ec282d02923c7870331bbcb293a850258b995ac819cc97495ceb245053fa78a2ac587b9c8958743a40fd0817ad90e12e21d6a7021c608d09f6388f98b3101b11033a2e39245a4d1ebf74a83ee376260f857e6680bdb8c8b0b8b09fc65a89a5d2b72cbe9fefbae623ef5d251848431278864200d9b3208f4e6f9e5f4223c07ada9c31d5cf01fb94d9bb281af958e22e442c1ca091dfbbe5e64b817c69e7565b25f330c8d3ef60c3db4cb7d17dc3f20456e3fd9c83917d9c3da579ffa2e751eb052a71a490dcd894fda6864c62d461582d8886b9bdad859ed9a0e0f977556e5e0702500dc0751902a02c3f2f84b20331711f94160f12a49fe8a4babcb17859439d8166104ac383a76bd63266be12fa8c68692d805e7b364d3e3847d6f8d90ed2a25e", "a932b1e8b35ea1c318d22862039e27ecc3ca7e73aaa48e26ea35cd90c2b2374be0937057a3ee9a681b41a05777ba44818a46e264f3010a78d9c221142a83c84babd7bd91e767b964b152843a36b79204edaba5462dbce5e493581bd4a82bd8f46eb2806c32696a5ee0563c4c9c5d4ed2de2de1029310ab17982e90b93a538f38190e9ba563e83e315e0c8cf6c9173d1ec5a1e8941ef7737ceb8dc49e81d88d6e6a51289d7856a320c12d66634a6c0cf849bab7f2025a86bffedc49061b7f3b7f5629378d7e4550dbb38fc54afc2eacd178ca95cfe8a6eb44dd12253305d02cc434c6edde91d7ddb7a569101a09241c0213b219868d4d6fdc5272af4b582f335a42d1c34e00cbd1b7b1bb025528fb02af9babe8d507631ef6b64e164edea4c742", "938492463a611b278da71323befb45d608603c61d11f8e02c98cff49f98566d59c09ac1a9d514a4d03f27a98dfe9e797a75f644a3c28f067ef7fafc158b0b8491cf7a6e9c0de019657733b8448b0eea6e292d01e72698fccd7f191805c61505e657226c5ad334032b69520d5393247504889a267524ed284121ebbd9bb7ae39941c54f96cc392672b9d83e7edd5a0289691948e936245e796a62e2e2ee0e9d4d5a619a6cb9465a80d2b9ab5e72456be70fb4a598d2f66c32a8366ce9fd7324fe50f0f127d112fd4501934c2bbcd4d5803fcdc85d8a7c630dfd0abef92a49ba6972494cd36c54977add3ef9483264927e071927ab7e4b4a78ba885326b2d014b9", "a48f8fcaee85ada70cb365d7f729e2fe11e53888f9676bd6dff9230bb88150694a84d28e2d51f5f81e5fb4308a2dbd7c8d599b37150378aca0cbe9d2e967703ed116d80fdd70429500ca2281c8ee9dc6a549d741b3e47e8a98a26422a9fe40a751c564119c573e25b761bb53e05ea711ad9ea3fe85582bba8c362046813e79693858ba972d0249bd1419c3f3696865bb0db874ab79cde54c623c0f6a7851280a6678938caf9a3c4830ef459d8f50325d887d7f0da0e5c07832e41f826cbd61c34c9ca866aa5fffeb96a573d142e746762956a9662a7c71a5137f8f9798d2ad70"],
];

// Expected sha256 proof fixtures using MockRng.
const EXPECTED_PROOFS_SHA256: [[&str; 6]; 7] = [
    ["881bf5bc320887f4bf853fab60d0742ed29d028f77abc7655b8affc3ddff4948b12e35871bd3a476d43de4ce6525965d827f765c0e6f31baa4d6ef24bd06448c919d23386aeab111521ce3ff7b07cd7b3b064c2f41176554104ec68aea373a9d0f282e7c8baeadb7cdf4a7a07a416559b2c622303b48debbb2c4efd652ac2f046bb7a81483a5d1d8769624ba982776f5458a2432b1e3732f7c822984ac17a2315379ad2b207f70e4eeabf4e17a84dbc7a7731b24d1d66ab14e6332335d9c97b656bf075989d8f99ef54ba11e3916429fceebc6472765698dcba3dab7ec35aca35a185c97cfa9dfcda8f39eb14faa1bfdecf7f9ad8f63b722cad264e1fa1011e941216e02e2718a492abcb8170e09f6376509d868ff7b9c7a0fe0f3f941ccff7529188ce18024929e85f6a936439b7bcfe17c93e3f035d6951d92c97581189e780e0d36fd5d08236c8244ba7743d5702074ae3bd478aab14e2f25e43b4f1401db16309b589c3dc3d3295469149679576a152f182c0683f87c1a95233685c7cc91", "88b7eefaa0cc13dc2bd40423d614488fb292cdfca21ecde80f63ff32359faaabb569a6d5724bec279edc71ec69872065a2e6a1f721e6e75bb7455aeb9c0aa8caa35b6484c556b02bfe3ab31a3ffa2f4789f5e886b3daa8e19220bbcd8fc5e56671211b6597c088ca6b51941338f72f314ffc86348e5a0a29ac693c2e5897eb4b11b3439b86c2d83990f2c17b94f6b1bddf0c78c67bef3065fb74c7b69749656818330f8b09cfa9b387a57a975ca73371d8d08d0c9cc55d45025ccc8b5f7b4e685d52deddae57958892efb445def2f90bf015006a68c02b6453f85da20627aafb080b1b54b6eb38b45b11e4e7bbca2670e24afd469ad8e51e771d5d09b8cb7a3872f6064a8733bf9f9181a3c12599e9b63e47c70cf5047262789d9f8c960fb1710fcce462aa1df7f07c45cd09b7c70a1c21ff2ee67f390be30ecd2a2d8826a9ad0cc2f4dafe123be64d54073ed882b56c071241d6858b75004c6e50f896979abb", "931915f9a840264614677557c189281e2cd2581743718d81ab69a0a09390696fbfe192b2355e5515776dd7cb1dab0d34a8660189a35651ebf3465400617db682c6c896fb83b16eb6253e27b95e37d466cf30d747bf234a27991a94593be0591c06f616fff125f65e85b8fb58516fdb5c8dab7a21860896a22af74d78cda1c6d872b682b73bc9a5d19362748b3dc2761b558a19485941579a41d3082f24a507b52e0f57e880b587feb4a8d9f990037dd94b31c29ed3736deafa4fdcc3a30cf0fe2536c253f13ab665d420030adb8a0ed5946cb51080591a54a88375e180b9b5671d1e8881d3f5c89203993ba74cffd8779a2b8caac94bf281d3efc8dd0d6920c55d5966b54eb5e623ea6fb1796b2292c8ff8fae884f72413ebcc26cfc49648be90898a631bb3f53e1b41fed1b9261a643b57e7a7b43639c0573ebaba404a33ab8", "80d979b76b383dfb94e0ce03ebbee3a7f17ba78cacd46bf5da4b3be98a87afa47259aae10a5e89f9226bc2235cdd977f882dda25c10cd3474e9b4cae7d9ff35c88f66d37f85b93d0d10d2b4b7c7e6a18a825cf6fdf36de6aa89a4b82b2d6a46512a026bebd696b7380ba6c7732efd278166418303cf2826c166c79d61dd5607750d9915ece11babb80c641534211521c6d2637e6f500153c044998c4f4fd2ba554d1f4c67f89005e46ed91d48e925d394b66fc4ca0c1029e42a7b708981ff3a7671966236b5ace7e2e94d9c21c9a17e18a11e3d1d13b2a9b1a3812db2768851157321215a1d6ebd053a45c1e022515e73ba447e670fffd68a8df0f626b7170af6123cfa89f47f04b13de387fc288c275844183a16255dda47318eecf05d0057b", "99773b485349f4ba402970e9fd6b623f3ccea826b997daf048cc6e204eb7e5984b774d73b4615805cf35a4ee6c99ddaa87a5a34e68537a90c703d9f8230ff6d5053e7f1c18124d0c2bd4caa092cd477655b423b74b7780d2c9a6b37e3e62013931a16cad47e8925d5170a3db007e1914c0df77e514f828963b6677c3d3dea1a947c71d494631936f9dcb6e38fdf9af2c5f6da12883e9e82f91e614ad164efdc1451c1520648bc9fa7a7888fb5643d6e86d81a62b8dbe85accf045f678657b36554f49a5ea30a2671ac60959721c25484f1a4cb388b169e1c24c3cb86dccc974242d9deb844f67633b429e0fd749a788def2e27a39859a68a54c3d1282b9d3ab8", "ae68014bd82f1c9c81d913dd41337d45fcdc203a1741622a286081329456c2915e9a127a3325baef5614809fc89da485a6fb94e6ca2a28c79f8dc739c6b4d6fb26daa138f7bd47cf2097445bd6187a3e185312c8c5434f53aa05c2b671342cf040745facc4afc24095550f0cda32a8ae68220048a81dbcfd05ccacf6a0e4d3b205aff2dd39c2141dc0d89b9407dbe4a749d612e3506c1052137d71f77e31e4fe0d4b2d335e9cc1d46a2a9a3f55d0728858d4ce9704bb88ae5bc1195cc818688e1bed85bfcb1425192b019675b799c4be8697bc57a3e2268ef1e7226c86f6b597"],
    ["ab7f501ad5e0282eaf0fdfa36697c0524bae1bc219db638db079a7f650de4a6893314d91f4d82dd7f0294e262fdb7c03afa645f9ac5f8833ad661186e813c485975075f84e41273f21da363ecc940e79e654b587c8948a7f67638780466841b41924f4c0a5ac86303f98e51036623534a84089548b8de720b2add45f7e2236446ecdb5d4f3d898a3d74eae8854e9a508f265cbec3af3c6f7a6c98a7c96deb7df3b4ca0f65241cffa92d2f7e2ac685a83e3b1d9e027a13b71b3856aea4ca719e127bb0795b9f7bb47cf526da59414dfb74559d99e639495afe8711d870bfde7c05857f1533d0323eaf8ecbb539ecf0fa65e8517219c7ccc6b49e12636ef27d4795170c26b0988982683aa79584a2039eb71e4940514660bf86aafd5029653ed264d107330e04c4904b06803c16a1d6a9843be5349e469d906b388f621deb8e0cb01967c17ee7ef0d816cc32c58160092855a1913eec01f994c695fbeab172257261255da7020d22bb7da9f0ca7637e81f846600d87c708da0560469cd9fa089db", "a7abe56fc0a952276778945d6521890b94927855f75d4d5a7c2e54d5ad2d2a9fb26e490d8a6c7aa10d9cbb21eee8ca36942e03cb4d3d779c269807a7792ed166613a9fd0ed1d7dd2f037ad9b8cd39a4027d718922f3d41a19904e0e1ae33229f68420e347999994fe4a37ec859117500bf5126b6515f6de5fe68ac05ceba1b120bec2df4a597f1e8a7f8667aa912ef11a09ef45a67a2a7aa9ddc136e500149a14ca3877e266f7c2d4ebfc9a6b45553e939345cb1ab4be6177c7457b25902d8fb24f1b196771b136013754891ea381c643f87193cf036cf83235202a82d35638e4a3f046e93974aa43eb93ee36f13cc02b9aa0fe675aed1c6714639984bd63d3a3efff7f88b1467051bdb9efedd9b71b1e29922f56b15004015ea8380f662d28c383d15f541fd8d70cf860dc930d5ed0988b42fbec12b4b130f74d2585a4dcf71242169839c620c2f787ecb5b39991637039f635d16bd1d62268adf7fa53c8ae7", "92a74d80ab152e46ccc3b3541caa25d7e96b566b3c8d928144f1000a3a4b2561283dde03adb75aa542cfc6817787429cafca0f69792366b3a148553f0fad360c2505fdd3da2e565efa1021f33fc5e74ceade6fa972e3d8d36e22a008cd5bbdae6d41c29fa6ab9fbfe3025eec6ee55fa6ca5150579ef1fa22e1c2ede7fc9fb51b72a202f5bd27c734af7b2c98745a8308d0ff2a3f96ab1e5cc54abe5ee8f4bc2f1b4f05a8ac3f2b1a964b427f30a1e7b5df5890c648366771b3b7b83b3af5aa5c6d274867732de5b248e04d12c09157fb072e6d90e27d508af5dfa0429f06c3ab706c2f93d790e22855e14af80aab0fb203e375ac86a77e26dc8750910fe5c9773e1831cbbd5071bea2dd9a8b256d5ed7874b754807a1416ecf10a6027ad0f82c554cc9cefd09fa251d35c051c741f8ecef65175e074552555cab89f66395292d", "b5bb48d97acfb3c7ba6f07a67da1a7ecbc9a1883816d87ff8402805be9c8a2c7cd8fef0d7efa77d7cffdedbd0bfdb3d8878a9101f81c2f132a915e907e7a3fb8af5f7dd5c0cd83cacf3f8b538a8deea757b4219affca72e521f9a3108916a76b3b4a19a86249b39f2e831eb1c6024ca691e8b14f14ba7c4d4af5a6ac28a07bf120bcedf154259230ed17d21c2ab99ea0eff00085810a34e9824309b8080e149a6602cee54a44159bb60859bf7287325bd3ce3bbf2b3749d3ca489532684cb46d6ab9bb359481f9851d035ea37b4788feb06a54d37638f5cd63742780cb54a73a3263cc91026f5e7282cbbe6b90bb1bd1899ac7d8c7b99054bf6707f226077a2f40a206905ba6b6ae1215da65e778443c21ea1744abb5c5fcafc5a53b1fb5f7ca", "8a335858f999578263df37cdeb70983b0411a4450ae90147fc8090c023c3d495be0050d15248d1fba3e50a53aa6cfff6b30a702a96080feee2f845c8a6cf7e73e7f95aad69a3b4287c503a105d3c61f5234ca61b568680cb7bd1188647adcb8908bda917d59883b3ab7dafba3c91944529343fee6a7382946feb65e3d6f5552f4fff56145071ef6882cc17852cb0761681bc8bb8c20d5917759c45fc4316a1a76cb10a0f20c95b9dd0f2c9a240c95fbce6cf8260f403a8b00f48cdff801163c931714f6b5dd8ad28352f9f0154e67a12d4f616758f8a324eec2fc141defd25b315703e69cb2a02af50669707a423ff6c44bc7730f47cd6305ec05eb9bb102660", "a8b60114847f656599284d4f0379172fa7c0cb77eaff1428f715f9fc9dcccae73ac160e5845f4b0af3c99442fa8b24308f9e64a2acbe5db15a180ae94b1cf431005a9061e018aece6275d76301dfb6b0d88a52b8616b218750e9a86a8511663c58e3498364c477e0fac57331c20608a404da95374d874e6b70731ebc557e105157fb3d2166840fec431635e8da7daf0cd9401e820bae2680135b97b5e4e835f46c1ad956b08c79d3264b76c81e7831a5923793df393914ef7daf9f0e2662c192242c37be326639bc68ac84b86553b856b5ae714d1a7ab0d6eb24c2d8dc8b3599"],
    ["b9121787a416481a80f6fa1f40b9127b412704bd8b95b120e68f0e9deb0561e2b25944c9f2efd43ff20972f346ec4bb2a39db9353b2446ce4c48bc1aabc6a4fd9a01a58f3e3e3faf428b5726ae787ea78de665bab8e81320fc9b1e258c85ab9211de8abf8a119c9dbd1a5cce62225b36c12d4f934ef0fb74f7e05b617038e4cc085ca8fa2b931bdc3e75cfd8f18ce295bd66f8f06d15941feb02ddbf562cdd27572d65e594cf2e3040e41811631cb4bdc122877097274b869765abe1c0c7467640e276154a7f45a0346d2af0601be1dfe4e1e381a6958a3b6efc6210fcbe40220f61f70209ba77a8e03798d4fb4ccb4cdaa63e18aa9b42f350359bfd787253ce56eed28c1ec91c73801df0314509f9e6d99cfe56b0ec3acc0fb4427b5d2640a0140dba3faafe42a9146e840f843df1d4f2581c1fbe7b2fd45816267af9058ccb537bc13fdda5866bb6161b77d3ee80120d44ea29eed1f32cb6ac5d159d6cadee52a6dcdb6940533eaa3b83179433af0fd6ab28907d70a55f43a0c99e38f0cae8", "97795a3aa2167b383b8765710fb49dfcea6a4db8f45990d83b3e803b46897fce5d802d8912b6ef9ae5b492383db1b28da8129b0c02769eeba15930f8f1a81cf973e2753eb4a68e2c5e3a56702d1a6a089861e0210abbe9558336f694ae4841023f0949f0d15bb4c50f2a5e84b81168912f54f64feb0f303cdc25b9aaad97e1fa4b696a6d341eb8516717f53250e4d9765fc1dd633ac570232e8f5ccfa245fce824277e3db3bc524a65c042f7108ac9cec11e9cfc56d9e6efdfc274ede9d9cdea307f4f8f4e9f993a27691f4e001e001ce03290f604f45a68f20b8115d937be4b33a66a38e069c61a562b3bc0d87bf3f561b12af09b07de6bb6ec41cf9c685df65f856ebeea29b50e38621d28a26a439bda40814a9c1eb42ad90601f592826269052b78c9b76b2cb47738056de3beae889116dba30149386022d8e03b1f59242a7042ddc5d19ef3ae5b9121b4507569d6fc2c93a5dd1424ac9ec8abc68c736470", "aadb13f7b0cd3c1a26f58ecd8fb1e269ee23f2c05a1e00ed4937a7464ee1ceba432692a913df60ea606d5ffd7f03fddbb498e89fda620efe9fcdf52a472bf3cb5e8a86d1f0b8794e3d89f0155bf9356db7e7529b06d7f344e433e21818d6750131b4518491d43839642e1bf562d6f09a843d3dbd6fde4e8d11883128f0c3c1a81c207125566829797b51851dd5a281e159061650e14312c2313ebcb1979d861f554fd1487489eeaf228b799830af3432ad186eb3330dbb268b2531d353568f612d23498ae2089b13dfc4481aa6c7ef1147e1d8d74651c7ef6bada0cd9c4674ce33fb715999863144e7df803068683d0ad08275059bcb753a20ac15524da8f1472e2d2707561c280837a44a982b81a1dfd37d823fd90608eaf8f1cd06c81a7c1f547e306f8950b0c8f80f74fd067faf153e9fde9d4050f9bde5974a5c17b9e74c", "a8a8c77eda123939ec53169168dbe67dd31b2587ab646202e60639d95c7f54e3c30c62c6c1c3af56d93446450a3cb58a8b6099dc743a0ef10e99446ad2106e727f495bc28bb63c195021bebcf1cb9af4a0a97a2e2b462ec95257becdada13f821000f5096a0b75ae4c96102cacc9ddefeaeceac93c5720c7127d6fc8d50fdfb00789620d0caa769dae66f18879fb6ca6277697dda821023f3054410c5d90456521b4aad279e4076ca2245c0ced575bb487217f262f225a8a0b947ab302f6ab4d65977af4517df8f293cc7f07fb9deaf9c57f0f17fa513ba9b67d0f417e17f6512fc5f7c391f730cfba29cb2d6a4b4f012b71b394341092a81f2fd74660999ff63ec4791e366c3faab20b7bfe5a5f1c3b705313d10d0251864d44d9251954b6b6", "b53c9170e382b2866b37f820a3fc33fd5ed6998cac295c9df02dc0df72d104120780fd37457bdec0eeb9a250334864129494bcd4744c2fd90885ceba6396d9a0339aa19904111a12dc3ef59e3a5d7d28f5fd777c4b775d374ea7c4ffe47ae12c3305a7468211f1f999a1809ee2e1d9b8c44ec824ffef2cbd2adeed442718147a576afb03cab4d021489350bf93acfa763a3d98063bcce89446f0ca915c2468b104e5f174de6080324d59a3acf1ce0a3e0a2099c1f9872aed5ca274152d540806175adab2a52dbf8498ac3291fb2e1778ebb46dd2eef042f1235f82afc1d17c4e1844ebb7edbecd1653822ff33049ab5f8869f6daf04bf07b2d565a0e4c40379f", "901af6179af4e45d9859779b56332c413f317ec689d83ac24fab6a9e2d9acf1e3c10a6cd71d15057e1dfa04d720fff2092d7f74a2fe310eb13155bdf6369e61b61b7e6f13f4246b623ece59640be646d70cd80ffbf99a8e28fb95b126548cba249fa42419cce1b891ab5e70c0c40a693d7f1867f9a22161a1003636dafc673871702aee4ee826ff92d7c376284224b45b6af7e9c044783114ceb46df76d97d304a559fc51db9ec03667047665583bfe2bdfdfdbccda3a0d88ae7809ba3c745aa565340fb765cf6d8b5d765613c198283c1e4a2f6b31661efcdcc559492a85827"],
    ["8d4b1fb281b1fc784f5729201023e8651412d873069c3b812ef164df6707a7c4f74785364a84ed64b9fe7eee6939f70bb35c77109bdd9edf4a0eab165f8698397ed13af0f1997497afde19fbef61f7b379e82f6d20e02a1d16fe55711301df83596eb9bcada2dba7046b551c435c10a9be0c68eb9aeb6fd932a6418d63d892db61105fcdb211426bac27b1f2dbd6b56313fe7c9496bcb9c4c16613dd235fdc3d6abab97908b34477fbf951b8169dc0584c81adb566ec1624850932df994c977f0d2ed75fece8b94c0dda028589036fda13fee4b809e704547cb25ca7a147ec7a1492372321070371da86b8468348de065609a0d26ce3ede3d934d9aa7c9e778b3a7585b2e6cb5cc1d2a236bbde9893a8e725f134450ca86c28b004954c407465738c257b89969780f928c1a5922d2215b2c25a1ea705c8fe22ecb28731e7fa8c09c0b0eefa609945b51141fa83e8ecdd9f4bd650228e2c3f6affc21e8bd3c98f188acdd621223dec663ada0e61d5eb44dda13ad677c3b8d277444b644747cb8f", "8a9b2409685381d4d86144b3b9527d15168b799489f6b9f06bcee5bda07b6cd0e022d846e0c431f4ec4cd0c0313b296b885db1b69605c027e4e5260ac84d7891e90e4caeec3b425d0527378f18777ca6f66782eee54dc67fb7468d455240310842d6da7ef735d3634c030bcf07d7e1efbf9719901baa5fe10fbc9e19869902e82e1d8d315e5eb6d0de907ab2d3ad57dace9ce00f22002cc915c539d2caf2a6911507c5b6dac8ce5384db044b1e1cafd08579e101b9e38b4cc2d0d7f9d12daca04a00c6ad40a626224aa3c82f3c7f183eeccbe2a5470f6db24f92532dde3a6b430e02fd1d580577a67de3f7a99e7aa29c5b975d1c49f5c617a406be8409062b52180f06d453918ef06afa53dbb2d3d1dbc10a6ca533ec700c4012c323aebfce9a2d4b81cbeff97dd501da42783d8b7c1461994cf200a5335031b8ba877661bbc54e9c5c9a54288ba9cf4431504d39f51f38cd54a6d1f353cec0270e27d4ae2eb6", "813f4435a99d8b91c48f8222151b4c3fa352fff358d8944ea258ee7a396dec11b4af795d890ee145d520c390941fcf64869eff7ca8eacb33347cb89b31d00bac414ba6145c3f9751fa82d1d59e4c34b4e1ad0a713e41c61c16dc8b878c5ce5b756dde8839836294b1fb1f0cc3a05994173ec56ce753fda25bb4c2008283f331a0a3c863216c6010bc92a38e4ba7b2ae73915751c5860a7d2fd812356de816f2f02db862610f4565d3304ada09a9ef854b956266c7c12c82c31c5cdd29d69a9d32c45e2072c7f894cb21635fc44cf3836d7d6d61c03e7775eb8ab73bddcd6d6ad39003178b2441f91988fa792ece54369b1059bac445b1f1fb6125c6a792c80293aa03ac853bc02cd795ec9138a4d5d039b190ec3d6f0454f89b5173e574742154babf55a3d025174477be9512476b0f1ae66a971be3df5741990aabee0f23dad", "b47adedb221a80301eea3cf31f729d91e7a88b2f896f38e9c46a61288575c1fc4133eb3c625bde4a09daa64c0b21e4d6b8a9f2f9c8d9c9b601e3e65633cd5ce3322bcd805a56a34aeae8e06213a7ba3da732a6821f7563b26ad249f109e99e3019df43bb8d22da2e5a3f0a829e682f159fad5aac3e8bf67397171fa28e37c35a6db85409087f2172c1b562b49d10d893c95548dc7480d4aae255ba616b243c1f3def088575c6e2e06c1af32f37bfef9b363a15c4734f1c9157d864ddb6854abb4090259d11227bd22adb785b38ac4714bde20d6e4fcf84c564ede390071dd957347571ff668df38517d625a8c1c8d918a398a8a83e5011cdbd5d545b092b38b0420d443057d873b8fd34d5e5779c8fab6735b78f035d432ed6004496ca98a188", "a2ef06cfe17c564ada5a5a5ba837b7f32365244412178cf85b8398b007ec92c660e9d346566d641a7cb1c79395fd2152a2674fff9a82ad2ad58899270e19b6784127d551f2e4627c8427c745f898ae798fcd90587a3586af5ff8972a2227f61a21edf062c4996d0decdb19ef738a6efb7a1bbc1677348ebd554873c13608ac383278421e775c5902e0bf1ff0f6d874aebbf761e8a56eaa36a6debf9f511a45f06d0c689ceceab16f7bb9d072cb4274443917cba3ec3fa079c16d3d6f6c8c49f03982acaea7b58f3a336108a95bf19730176f079cdc82d0e15d250f70859a6733198a8fe9cafd8cad2f5ff3af5848ef28802c041b5daab467228062545d23bb8a", "9896d2110bb1a84b44631631d9b84874b866c81934e68efcd40e89c4bad3c200c3cbb2a1beaa25ce5821bffcd211daf1871bbea91ac397b7d28a1c590ad38e35b8a81f5fd5756663866fff53b1fd129fb5d8e8d02121cd664ef40ff2f709683970d2e27f3ee58271ae86448df56294148d9fda037435094fc4c547a54cfaad460592de10d0df97d855385c7c7415637fc09754734ae0428cfb136c0f7c099cb231d53c8c63fa883a6b2dd990b5274dad642f2632303eec44351a0dd2e2e35c400678bed2358c3e1e62da3b5c18284fdc6ad613fedc3a4b8787a67ef1031c01af"],
    ["88eccdc78ba51d86955852f89f7affe6d21df417ae119afc183a44a72aff4d05b5cc8d924ce02b465b0327ce7cdcea5f8ca4cebd6752b878a126428b1afe7f1d71d33f0c4e508d1a3522130550eb5b5e7fecf7ece1eff44993420d3f8612e5441dcf259f609a793ec1976261d20e784d35053a30c8cf343d17c5d27be81194803fba2fd976cc125fddb88d751e5e98463834a6de3483c48bc16218a4ace7a53003bd54ff9c775896ba3175c7fd52fd213b489df264bc2e7fa3946e37173326293e5e1afae1b1c11b03d1a1bdad70b7bdf021cfaa381034ac8fe47eca3986948300aee0cd24b9a2b028499f3a0b14ae9df4311db2a8f6d63c511708e97c7fa29425687833ca299f5fc45f12e3d840c47b32f97a969d8cebc479f2698ccea46ead43f259bca8b1be5cac412c6e10b41c28bc7cb38c08e9a887ccebadf39d454c07526ac41b9495f3e7910e16554cf6569ac4c36e04a1fc925ccc6f7b9538868cba41fae7e2b06bf1dd6fd6c1e9f8f7a26049978fcbd5552b1f112462a00267fc28", "aa11b936e818dfbb1bf9cb043d55276c79bcd332e64b69166c83cf4bacfd6aba22487ad9b927bbf5860a2d0eec38df75b206452c7f51938b13f71dc0b366e609099ae4b011c047b7753e64d6a9c3c21a509eb941d9fe04c95c24d0b12f9bc44e72391dfbf889935c9471d4a48f2063bbb042b2874f2af21142c1c81b1de449a63ce466cde210e9c3d62313bb94d39adf27dac6b5fb3b2de95d88c93377447da3242236afe96053ea1917b4a8d9d0f46a9d74a998b05b2e688321c314b1787d0827dcb71e899e8477b4892e91e93ab059ce1cb4c0390efeece3b7924377f03d254e9857405503f96ef59c3a5879c42c6d2b651ef919ea8662de262c682a5685245bcf507b98a28762701c9bb32da058f10d287d242d3e9204fc00b0a10163abad634f4008106c8c29a9a3c509e361325d91368c25ddf77a4e3213bcd29f327fad375b39d3d640dd497419339ce1a617ed3d418bd46b885883cbd30eb916acc7ff", "84bae4c16d4320dde967d5e37a7b3436381636fd0d562c9614a1cf191040afce69bfd1c4b917553557a6fb738a609baab31bc4fd6ffe1a80980de24522373f573c856f261e769faa638493a376b1de329deddb4f77bd7f26e1cc316b48aa99692e951aa7b7fa82d999ea2f93ce4d1c1495556d1b3376d38fced1d8de3346bb336cac1239e5b9ddb32fe73cca84d3dfb572ef7bed0f1bb9391152c9d98ee97edd4b727e3276893218a6eaec2441234bfa1ed2a8959945c2868b1815ca7266b7a12f86181cc3f487546c3df8411ba0b8f9704291aca892f5ef716a1f64e62fd09c40e71a10eda1ba4018daaf9c0f461df991f2fe79ac0042722ebb4f1a50ae39e32df6ebba531606b07958a6fa5fe03a4c90801759e88bf05fa3120fd79356e28f005e2834b7eca26018277e0957d63b37260001317e088631ad6bb39c6e29f565", "b39df6d7c382427de9cc66961f5f517439e7caeb30d12b13948bbb74ed26e055b20512ba90c584207150a19b50edfc3c893528ab54bdfff4f59886fd54668c910e49c91fc2eb943ee6fa18ad4b8e3ed8c7f30d502189d710ee4fd4e82b83c5d62a497f4955d1ff3fd1258c13b16460afe50c32c1072217d153776d3a54441d111c1f1dc953e0d8488e75f2572f045fc9cb8c13c6e07510e854fb40f66b9ea0c55f3b4e2381cc483be0ac9c7a94461d25fbad697ebb9ba93ffd9d3e3ec73129710b93ffa67f7c21c985210d72bd04be1214b5d5302ac1ac2ab278d23563aa624a5e6547a059e42912cf9490bde20a7319005bd3074e734b496a17acb519891401015ca73d6032d908ff75c4d399af664dc70ad4a53b750eec7c638cdb197b48f9", "ad06d5daa4c5a910dc3e6b8cce1905e21a42d41cd93af13b3e1252f807386ab6dfc34816249814da2ce569e5e85b1cfcb6caeebe4f316e2af8ab699442cb62f53f7ba4855e54f9f1237b5c1f3bf1f6e909d454e3713d918d273b3de34ab4e41300da0402ec8c592f8eacc1e1ba4bb642e3b2afad31a5d682429f18688992612d1b935c336b7d29b71da709d9aede4b4c5a16528e1884770af2ef4dc8a073663365a59c68b3ddde8dec4f08c03c8e0ffcd2e2052ad4a4c946f1cc140ac02d7a954c2e911446f840dfacec63f520a5b7ebd2fd3b7a7c3cecc9a6ef8c8dd4fd63b405e643f1e10250456e84ba30f8abece43f75e3c703946231aa2e62b939f9388f", "a2a8188a6ce939a9012a452c7358a34ad821a491fd1f628f8a4424519f5ab67d3f3995be0a44cbf0f2829a01f61fbbf995d8d3484dcdc56d02be72b431e6e700a5d4ff487a04571bc51f9c16c38f152eeee35b4f45c6bcd4fb53c08328cf2e96399b9b8be9711250f6c4594ba993582705cb7c18b5ab701b136baaba9980be60147d7c9514ad6f9d60c0c1b18fb218c48ca3681e72ae38260b3f8b92bce40d675aae7ab876ea91ec761cd2c4cfcf7cd0118346123adacb850f412c755d1cdd49737beafb115ccee1f8814bb6ce78e2f5aad50fdf9d42025aeb54aba3690350b8"],
    ["a3c0b59463ceab04341c26415be04c942e442b8d93dcab69d743f875066edb75cefcaa978f616b61ff239d7583bfe7dbacf890578a59561f4077dfd229adb86b916feba29b9f08abddff8aa6b33efd5793388b3031d775f315069b63a370e161309249d34547851faf97c42e3848bb86d8808792966240dc1be96226d1232a7634e72a0e44601ce3f9d434b7c3495d5673106efc62a8a74ffbccc17de7784c9662f6620d1b3858bfd1bb52c07e582d71fd8805d9b538961a3cc9c2c25c93d08b631525b0374f03119395ba869754366a37262ccbb370df368ef28e54b529edcc2d6bfbd735366820a6304ec17ad6f6a5868b8c5af636c05e5319ab0ca48c185b41131b604df65bbaeaa6e8102c2ae59988d14ddc8f2882a607d1cd8e6685f3f3124fc15db144db50680db19fb22d0972c86ad5754a87f01661c0be856cf313181f3bec63897944e9a1ad23450f9c50e70324689bd541c50ccdbfd358037c881e04e5a90c805c3ff8d3e7057a98d104843b8c6817e09a7598271751306053ce3c", "80e9c1aadfa96e278e63f210e5a74c9fd4f5ea772e572da27906884989539c45fd016184b2e9c24e7ad4227335922c9d98686432993326b9bd4e95cc289323d7b4735792da8b0765e894a7adf8a1ac77a0a2e0c23965a068e1697f4e512e9e811be4dd3957c584492ba8efac1629cb55eb10205c7f1c40b0547c934fe7b4454a553cf0e05fd5a9706fedabab6c3812c704154d2e2d14a21316ba808753557e0e09c4e22ad62f7b406e478fd9536b15a0d23ade70106a053b500d9d96b7f7f3a0279fa156bb3db30a0e13de0f505d39f14f83e656358a12dfbd2f298aeae7f9eb1d6c45d0ead6d3ff10a6b9523a7e69d7e5a9d51497c4cd2df495f6d773006ebf0c31104410fe9bc5491848f5ab4d11d944eadefd597de0d0dd70ee3c2b60a0bf16da77988d024898b5358fa5129b1fa1685af49222e514ac1ff75b028c237cc32fa6c3f4c4e14226a85ef5e4df6c4103ab6d30d3f4dcf1a95c97d9ffe4466985", "a6984b9a92d53c97d8a96bfab33d10369bf9a64438c416f028afd18beb4464a1b373545e18ab3b863b1e9d72888858e0b017a2bdd77f0069f8dee6af0cdfe28c5f3bbf06a6d3b99bdcaa9365518c0d0c644d8663153d1c3bb4b65a9be2de3ec03ae97d01b3a7df21c32e41156233d996bbc37e892880b470feebdacb5512ebfa6a469f4f1165b09a80240faa4e527e7b781d007be0540db01e4ef730aea94143573b3c14d37ecdd1fa1ef0e2408a7b6ccfbc1ccb7130de36ec4b713cbfc6c0ca5d5d18e300b6da21fafdd7945c8716ca57299522ccae412142b896140806b2f85ea1d4843395cc190061c87fdb265784a002c152d20ba8f9a5082486f8e0bc1f308cfc2d05dd25936e3802075c7ebc7c8df487560477c1948a75a6270aafd1585946f4173f372ce7a5e25b40abdc252bc2f672c15a06d3b9d9d88e372714a6f0", "abdcee45b8d19b918b31caeebe780d155325d395eeaf1084d2b554fa50c560b96cd3256f12ba64ef96d5f83a9e93ec5e990cefb7146191b1a02a3b64931cb93f64c31fe5544e1acd0f2c3b8bc1778a7a82d97c0a568fa3741899f65bcf21448e4405603664036fb4595d763639bb857c5746c5b8afa4d645b06a1ceb0270c198584a086c0f092e0acf82b8d9a3f97d4beb709b0b6cb37cef5be701e615823db13992601cbce4464721d4a714fe592c5464afcac25ecd0bac2ebdd485617ebf280ba889df26834a499506c7cdcb15d18c6c3c30530c103f5b0c2f2bcf498b86d622614739ba3f0776784744f787fe512d6c03586b366b11af6176e4acc2b8d8492a5c2b499bff21895b99286c7b257dc2a46e75268688197745a3fd9c0affff5a", "923152b9f777554796624dee101d7ee40cd399c953522958f70b33351223c4423e3de47edbc3c379ee68c0c2860678b98e2effe477e958b8c5fcd651bacf31e1a5f960eb2971e03893936b89023e04ea4b72bcb036d13195457899a03aaa86893d617d8388002795e78ada530713ac36e8774456138695c8fcd08613cc2fe65e142034a778a35dc975df69609442cc32d30e5b8aba6b8080c40484027c2ded0254cca41740d1490ded9b5747978f59e5779845ae7e4a0a50a3b95423d600194328ff2d3f0afce02ae46177208e7a7f806dd91cf4373d06a2b5f17d26cf7942ee68ab434ff5c1fd7254e277e1222f34ccf4b3a86a86b51a5dee81e92560dc00ed", "94be745ed447ee62da2c1b31a4cc1b4b28268149fe53c2bac245e56510a28334de2746607c7254d97ee5f0131776922c92fcb0ac93187913440560afd671006d7c4ed23981bb8a1c064d17e74ec67764a1a7f8528134123d934a83b78b0eb20a2c1902c671332b2dcb716f41185f60e868a32ce8cc6a73d681bcc910041a4f3156bbedfcf6fa394c014a89db094ea2f78cc6ae801d9481e334de24fe2cbed7c52ea6370deb369c72fb4edbda1748f38565f078253f8b75e2a33f65a8ce65a5605e9557bb724510cb2f9b824df375fca63534822814e3ba632a610f04a7816466"],
    ["ad11b323fb2f8695d1230e44defe1a1ec1c5d41301b201bd68372e26644dd488db4896c24119aadf7e97f0bc3fe378c6ac31e1804a92b8408156eda70c2847f806f77f21f74ca00ad17fa370d2dfc341acfdcfbbcc452296984a7dc5a04ea35d5ed477fe2445f7a71079eb6f1a29ddf1b4ae9dcc114a9890c2dfd58b7b31466a148cb395c2f0157a8c7af0fffa17096bd1048688af9c73242c2b63de11755c470562dd7cabd81d3b6399986a3d36b170f20f55f1b00cfe7a26e9ff93e8fc131c6a02af5a62af8aab88c6d7dc63add4dd58648682f5cc8f3b47df120a4a218b894f498b9a32d2bdd5ce36df73abfec773e5541f251ae8d4c22e8602729f2f85723b523aa4f3d30c74dff7fa35d882f88b3b46272ecf7c0fbd0abe89ea92d6e8985f7dd5a0c03b4c9b6f8cccf8e825ee82d47db9fccdb441642baa2c2d94512ada72a079d7bc5f6d085c6727362646ca5087e1300086f3a20d548d25f6aa950b001d96516d0f16b4c8da11e88645f6ed8a7a84b0db2cd1c77f9135ae4452ef9476", "a08ddb40dbb774daeffcd4caf70925651ebe98e98eeb0c23b1d7fc106d74d9143968219249fc896d7d2ab8356cd57452a430d547ead4f393592d092f389d396793f5ad0ff26be81d73e0a3a607eb2466ca692ef08499c94c7267fadfe6a03f1e6353733caf5a7a9ce85460043abc0209df91a27f3b6c1b8c0fc0bb44d868efdc0d04fe9bdd5c4203c5a4e38caee9ebb95c30a7ce26fba494af9bf4db0c94ebfb038828e098c043f28b705c2d05fcb19b6338ecfd5e56ffb028e19d319a323aa339e1c0a6a941c070206296f228e03b07e1e1b6d31df42b95c6d4a5b8ca12ad6f62f6c737a8b14497b6f5421a7dc41bd7f967d559ec0b9b100d7e69a2e86cc10b496e7d4e4b5fd6671a453a222f5295f549742e059a50c92d9435f1a8e0417d174d3ad4170b90e1b05d85d01f01746638ca2cc4dde8adb0925f11f603d482014b38b524fc6de5781a456451d43f3d9e2a56923707b6da180423596e4862d62b7a", "b3b48baa43eedc6916aacb151b80abf5626f52dea513aa7be5b1f28ada96464e92b96895b00b459159de3b737e0f73b4b0f3d73fa835ae37e628f62602e168c933b12d9f9c726dfd9cbe9428f846360aa844bd13f62440b23d251788021f5e0110e75848bf88019a3865d7fe06c575d6f8009e79546e4a626ff3d1a8dd17ad68595aeb1de400e518f7c284bae5a3e6bef163b3ca4b1ed1c64b10164cbdc73aa96e37cb15802a4d7c94b226931cdb118b9a3668bb5bfda1e55271fc13f84d080812639fed44d3efdf56251fa28180276ef068c803ab4efdb7895372756f574add6c39fc9d693f6041bc494ec5c9768a28b1d1f2a060279e19140dd0b109c4ddce3dcc7f8e7a036d32dca85d67e243fc5438f54b9e6a110ea9916eb71994df7ae117b0242ef4fd9d5d8228a8479fa16d5e0d99722f687db5ae777b44249c0d1abb", "906dde4d6984fff2b249f4811059f7d2aa7fb52782b8cb67ba3b873e400f7b0ebffa68d397babb6267d56181d00581278b07b5fa555988f59ab683a36ff732671e81705fa6b3020bb286e473a9777d0c81ad0d86631c359b7f596a9360cb7d3d14f90ed940d407ab6a494e62ba6e91647402115ef6fe1317a7948355dde7455a0ca2b731f20d56922f91b1e15289664705da2610fe606f1567e3d4bf6bec2d504ef7aad1abd3888f1d4f46c8387adf1a96d4bb2bb0eb779cc3f485bc24fa76463b4a0495d87ae9a061a1741a70b8a9f50a672dcee147818c0244a3d406bca71529e7b4afa3a286830b13c2a217cf70d576cc0754b8513b63020a7630b53d47c06661a20baa0499684195a4541e437221b3caf5631342c4ca8f87e86f460d2f0a", "ac9c12c718ca12cd57b01b7998bb5a3d4ae7f0ed74e7fce4da3da55507d337191b5faf7afa3b4448c48ff3c64c71ad6f89b2f56c3f1d3adaaf7b17414b79a8e83e4b01b3a18632d5192ac1f465ccbd2de244523f03024c9ce6c03c4e4b0d573a2e767cda9b463a2aa2cc1ffa734803ad14559c8dc50bc6e8ec880abaf158715524fc5093011899a5b8c9e5a1b2fd8aed0978c35589c9bb337393e062f75120a91e2466d805c49ca07b88cfbf67866a37b33ccff6faa84f8891e8427c5642c26323e37a570a893ccf0a8f9378ab5ace06535ec746f515d90f0aac268919a26e2c4fbf3cb0aac57efb96eb100c1502f334b05e7424788b9e71065c4d689a6993be", "866c985fb197237b1b406e7b297b6fa6429ccda5503f3d295d4c4d3dd3ce579063b0cb25282bb211cf334c6a061d2044a833fd9cdaecdbb42d9d8cec80631b7c2330cd2bb6a210d89ae86e023b4359d802e1c3930dce9021ffb2400c94c57aa30f486ac8b0d1170562f038e83e1cef77294621dfbf0a5ce91964273bd1a29ef3481d3b536424756acc590641f398da6ffae4a9d7ca28358cd243925d7a37e4aa49579673e84a8d670cf43bdbae136f66d7f4846adcc44507b904c8d725a8480e2556f7cddc860ebd1d9f5b8d1ab59165657c027538294cfff296a21073bdb02e"],
];

// dst and seed for the mocked rng used for proof generation.
const MOCKED_RNG_SEED: &str = "3.141592653589793238462643383279";
const MOCKED_RNG_DST: &str = "MOCK_RANDOM_SCALARS_DST_";

macro_rules! proof_gen_verify_e2e_nominal {
    (
        $sign_fn:ident,
        $verify_fn:ident,
        $proof_gen_with_rng_fn:ident,
        $proof_verify_fn:ident,
        $ciphersuite_id:ident,
        $expander:ty,
        $expected_proofs:ident
    ) => {
        let header = TEST_HEADER.as_ref();
        let presentation_header = TEST_PRESENTATION_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        for i in 0..TEST_KEY_INFOS.len() {
            let (secret_key, public_key) =
                KeyPair::new(KEY_GEN_SEED, TEST_KEY_INFOS[i])
                    .map(|key_pair| {
                        (
                            key_pair.secret_key.to_bytes(),
                            key_pair.public_key.to_octets(),
                        )
                    })
                    .expect("key generation failed");

            let signature = $sign_fn(&BbsSignRequest {
                secret_key: &secret_key,
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
            })
            .expect("signature generation failed");

            assert_eq!(
                $verify_fn(&BbsVerifyRequest {
                    public_key: &public_key,
                    header: Some(header),
                    messages: Some(messages),
                    signature: &signature,
                })
                .expect("error during signature verification"),
                true
            );

            // Start with all hidden messages
            let mut proof_messages: Vec<BbsProofGenRevealMessageRequest<_>> =
                messages
                    .iter()
                    .map(|value| BbsProofGenRevealMessageRequest {
                        reveal: false,
                        value: value.clone(),
                    })
                    .collect();

            let mut proof_values: Vec<String> = Vec::new();
            // Reveal 1 message at a time
            for j in 0..proof_messages.len() {
                // mocked random scalars for deterministic proof gen
                let dst =
                    &[&$ciphersuite_id(), MOCKED_RNG_DST.as_bytes()].concat();
                // number of random scalars to return from the mockRng. Note
                // that, this value will affect the value of the
                // mocked random scalars
                let rand_scalars_no = proof_messages.len() - j + 3;
                // mocked rng computation
                let mocked_rng = MockRng::<'_, $expander>::new(
                    MOCKED_RNG_SEED.as_bytes(),
                    dst,
                    rand_scalars_no,
                    Some(BBS_BLS12381G1_EXPAND_LEN),
                );

                let proof = &$proof_gen_with_rng_fn(
                    &BbsProofGenRequest {
                        public_key: &public_key,
                        header: Some(header),
                        messages: Some(&proof_messages),
                        signature: &signature,
                        presentation_header: Some(presentation_header),
                        verify_signature: None,
                    },
                    mocked_rng,
                )
                .expect("proof generation failed");
                proof_values.push(hex::encode(proof));
                assert_eq!(
                    proof.to_vec(),
                    hex::decode($expected_proofs[i][j])
                        .expect("hex decoding failed")
                );

                let mut revealed_msgs = Vec::new();
                for k in 0..j {
                    revealed_msgs.push((k as usize, TEST_CLAIMS[k]));
                }

                assert_eq!(
                    $proof_verify_fn(&BbsProofVerifyRequest {
                        public_key: &public_key,
                        header: Some(header),
                        presentation_header: Some(presentation_header),
                        proof: &proof,
                        messages: Some(revealed_msgs.as_slice()),
                    })
                    .expect("proof verification failed"),
                    true
                );
                proof_messages[j].reveal = true;
            }
            // println!("{:?},", proof_values);
        }
    };
}

#[test]
fn proof_gen_verify_e2e_nominal() {
    proof_gen_verify_e2e_nominal!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        bls12_381_g1_shake_256_proof_gen_with_rng,
        bls12_381_g1_shake_256_proof_verify,
        bls12_381_g1_shake_256_ciphersuite_id,
        ExpandMsgXof<Shake256>,
        EXPECTED_PROOFS_SHAKE256
    );

    println!("----------------------");

    proof_gen_verify_e2e_nominal!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        bls12_381_g1_sha_256_proof_gen_with_rng,
        bls12_381_g1_sha_256_proof_verify,
        bls12_381_g1_sha_256_ciphersuite_id,
        ExpandMsgXmd<Sha256>,
        EXPECTED_PROOFS_SHA256
    );
}

macro_rules! proof_gen_failure_message_modified {
    ($sign_fn:ident, $verify_fn:ident, $proof_gen_fn:ident) => {
        let num_disclosed_messages = 4;
        let header = TEST_HEADER.as_ref();
        let presentation_header = TEST_PRESENTATION_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        let (secret_key, public_key) = KeyPair::random(&mut OsRng, &[])
            .map(|key_pair| {
                (
                    key_pair.secret_key.to_bytes(),
                    key_pair.public_key.to_octets(),
                )
            })
            .expect("key generation failed");

        let signature = $sign_fn(&BbsSignRequest {
            secret_key: &secret_key,
            public_key: &public_key,
            header: Some(header),
            messages: Some(messages),
        })
        .expect("signature generation failed");

        assert_eq!(
            $verify_fn(&BbsVerifyRequest {
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
                signature: &signature,
            })
            .expect("error during signature verification"),
            true
        );

        // Start with all hidden messages
        let mut proof_messages: Vec<BbsProofGenRevealMessageRequest<_>> =
            messages
                .iter()
                .map(|value| BbsProofGenRevealMessageRequest {
                    reveal: false,
                    value: value.clone(),
                })
                .collect();

        let mut revealed_msgs = Vec::new();
        for i in 0..num_disclosed_messages {
            proof_messages[i].reveal = true;
            revealed_msgs.push((i as usize, TEST_CLAIMS[i].to_vec()));
        }

        // Modify one of the messages
        proof_messages[1].value = &[0xA; 50];

        // Proof-gen fails with tampered message when we pass `true` value for
        // `verify_signature`.
        let result = $proof_gen_fn(&BbsProofGenRequest {
            public_key: &public_key,
            header: Some(header),
            messages: Some(&proof_messages),
            signature: &signature,
            presentation_header: Some(presentation_header),
            verify_signature: Some(true),
        });
        assert_eq!(result, Err(Error::SignatureVerification));

        // Proof-gen succeeds with tampered message when we pass `false`value
        // for `verify_signature`.
        $proof_gen_fn(&BbsProofGenRequest {
            public_key: &public_key,
            header: Some(header),
            messages: Some(&proof_messages),
            signature: &signature,
            presentation_header: Some(presentation_header),
            verify_signature: Some(false),
        })
        .expect("proof should be generated for tampered messages");
    };
}

#[test]
fn proof_gen_failure_message_modified() {
    proof_gen_failure_message_modified!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        bls12_381_g1_shake_256_proof_gen
    );

    proof_gen_failure_message_modified!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        bls12_381_g1_sha_256_proof_gen
    );
}
