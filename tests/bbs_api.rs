use bbs_fixtures_generator::mock_rng::MockRng;
use blstrs::hash_to_curve::{ExpandMsgXmd, ExpandMsgXof};
use pairing_crypto::{
    bbs::{
        ciphersuites::{
            bls12_381::{KeyPair, BBS_BLS12381G1_EXPAND_LEN},
            bls12_381_g1_sha_256::{
                ciphersuite_id as bls12_381_g1_sha_256_ciphersuite_id,
                proof_gen as bls12_381_g1_sha_256_proof_gen,
                proof_gen_with_rng as bls12_381_g1_sha_256_proof_gen_with_rng,
                proof_verify as bls12_381_g1_sha_256_proof_verify,
                sign as bls12_381_g1_sha_256_sign,
                verify as bls12_381_g1_sha_256_verify,
            },
            bls12_381_g1_shake_256::{
                ciphersuite_id as bls12_381_g1_shake_256_ciphersuite_id,
                proof_gen as bls12_381_g1_shake_256_proof_gen,
                proof_gen_with_rng as bls12_381_g1_shake_256_proof_gen_with_rng,
                proof_verify as bls12_381_g1_shake_256_proof_verify,
                sign as bls12_381_g1_shake_256_sign,
                verify as bls12_381_g1_shake_256_verify,
            },
        },
        BbsProofGenRequest,
        BbsProofGenRevealMessageRequest,
        BbsProofVerifyRequest,
        BbsSignRequest,
        BbsVerifyRequest,
    },
    Error,
};
use rand_core::OsRng;
use sha2::Sha256;
use sha3::Shake256;

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const TEST_PRESENTATION_HEADER: &[u8; 24] = b"test-presentation-header";

const EXPECTED_SIGNATURES_SHAKE_256: [&str; 7] = [
    "89621b2e1d74cb506407a87ee882d783aa494ca6a709c1390be21a465c5e36a9381a9ca0672c06c68a47827183eca3545bc913e2bb25c87a2e77980c2f696e1224aa4f432c5fadce4f2b1f8f66369d73",
    "b936e45bf26e945d9aa47c3dd7a79070346d24380e8f8ea2bf5e4dba54f01a9250ab2216ea4cca8133c097fc9acb3a216ddb6b8ea99f54708a0445d158e6b88e6dec34bb7adda23b6c9ba054fba5b03c",
    "9613bf535eba8dc56e594e1a32626a1b3fc2792b3f6be3465cca7942cc55b6ad303498e0c11756f708d95dde6419c8fc4938a2fe43e972b7b02eb642dd7307096e7b0785fa5e12e7b8f5d2842955b604",
    "abd5f9346ae4ffc926512377d7b05b1248d365f17dfe473f440470808d05e686080fbfe730de7ef7c95601f1021b879a572e1fcf10d1dda9949866494f9c2b529985b26826a6a389cc870136a4d0fe33",
    "80db52e1ac3cbff90596a38845ec6a3d052fc5c0cddf4d6fa77580bb2c73d8be2782abc17a2d4324a5ba5241fd6e70474ac5672b5c01ffdc9a69a3ca7e78cf01e58541e2e08ed4d95fc073bb4c1fa6fe",
    "8b69d79459f3eeead5a2fc8793c6dc01186c45af57876c960caa01f93fd331983daa0b459bbeae170de7476b83da1bd03a5e8b215845f5dbc1e10d75903c2eaff52ec66307b356c987efa456b5f21e2d",
    "a933b9c6d80eaf9082ff1b2c14b958f7cdd6f73ea59c76fcfdc12f53786123ed5405091b0cf93593caa4b8a970c804ba70d2ce339f7c0c53422220d6a5f7e8d7e669023df38c2a6c92b0821acde131e5"
];

const EXPECTED_SIGNATURES_SHA_256: [&str; 7] = [
    "b0a159246f8431f2e45702c91730107982b76c16c65a1fce1b8a4e084b01a9a44322d91c10d04a27285fea258e57d57050cc32149d9ced51393fbde0338908988ab07abf442ad1356be978cea1386741",
    "8946bbacbc2c192c9f3097099250d6f2891ca85c88b1db09346d9f58a4fce3856607dc713cfd1d16186a5c583c7d7bc2228686f0dba65ff816cc57fca6bc1de38c7c8c715dfb964084115ad4f5aff45e",
    "acb10bcf01e2ec89ae099e13f21a20b787d9d745174cf097342c3478d921da9ba8d3755fce3cf3ba4172b67e588129983adb9255242f716ba9fc2e5385b7870dfcaf150d0086c5b994677bff30f5c3a1",
    "9234d03b8caf8dc6041b41d984b0c24cc7afc00c994c7c94de7b5f88395db745858acc2d5d96c4079276e78a9a0cf28408f768433a056eb3b161b1333baed867e287cb43144c705b45b007deef44b216",
    "82b4d73522a991b5c7ac665fc9052f23cc516ca710f192b84295893b704d397b393c152a1d713e5441482e97d1f3f3a670a0412afd2aff1dd6d3ad32c4395fc0f79a76c9d202757584af80ba78d7b143",
    "8a43aab44f1992efaff49964b7b53c598bc41f918bcd348f300d1977bcb121e0d9f20a1e5f993b7c68d83189e06e76f45fbf7461740f4c20bc261f871e78503499b8828dcc16e87014467a5680fc0887",
    "b21a472c7096ad3df8e2d6e5aff458ec8058c580a1ed605e65b49b6e4b22e459921df1b2fc2a3779ca5795717790a607185b9de7d09181ed3b0014e06e3567b2b128a110ef051d45cb830fb65d995b3b"
];

const TEST_HEADER: &[u8; 16] = b"some_app_context";

macro_rules! sign_verify_e2e_nominal {
    ($sign_fn:ident, $verify_fn:ident, $signature_test_vector:ident) => {
        let header = TEST_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        for i in 0..TEST_KEY_INFOS.len() {
            let (secret_key, public_key) =
                KeyPair::new(KEY_GEN_SEED, TEST_KEY_INFOS[i])
                    .map(|key_pair| {
                        (
                            key_pair.secret_key.to_bytes(),
                            key_pair.public_key.to_octets(),
                        )
                    })
                    .expect("key generation failed");

            let signature = $sign_fn(&BbsSignRequest {
                secret_key: &secret_key,
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
            })
            .expect("signature generation failed");

            let expected_signature = hex::decode($signature_test_vector[i])
                .expect("hex decoding failed");
            assert_eq!(signature.to_vec(), expected_signature);
            // println!("{:?},", hex::encode(signature));

            assert_eq!(
                $verify_fn(&BbsVerifyRequest {
                    public_key: &public_key,
                    header: Some(header),
                    messages: Some(messages),
                    signature: &signature,
                })
                .expect("error during signature verification"),
                true
            );
        }
    };
}

#[test]
fn sign_verify_e2e_nominal() {
    sign_verify_e2e_nominal!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        EXPECTED_SIGNATURES_SHAKE_256
    );

    sign_verify_e2e_nominal!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        EXPECTED_SIGNATURES_SHA_256
    );
}

// Expected shake256 proof fixtures using MockRng.
const EXPECTED_PROOFS_SHAKE256: [[&str; 6]; 7] = [
    ["a23354002f0d06121e004c2d64465f7417cd3e43d1b8817389c1c1a11cec098a3ea675f5ec67a05e55daaf66b44250b99229f0295b299a334a99301523625539c519bcc2977f261e27eed4aa4e7cad68a72d9743b85b0424f8a91d9cac37aaaa5711d9d3df61c464ef408a3545377e6e8d137824f0769d8179c4c256cde0ad3305a579d7fedd6253111d361a37b1a361a86449b222b175f2a335ef2c6e02017c1e96de4ade17c40cf44dde5e8ce046aaa3999a493b597b3a3a56491449245ace6d9492d4c140aba2b9a1f5f936884a844ed8a6147037377e15bdd292a656f1226276cc9e10088998e55b018484fee47699c4b445e51d2b88dd545cf1754759a4417b1dde2c228453f0c1b770db1066f9586d4bc7572ee4515766e2d0d18768872cfd57a2a7bed8bddf6bd272c29bdbfb0e1e615ae2544dc1aead0863fb9471a54e395946daaec558a8548ff1ffa8ad463fecdc0338abe805cf98d65cf9d0587023570df1011ea1db87d94434f657d2b84ea0af2461da71f4dfb39ae8e7472e90", "a4c30b402fbd1e3eb86d3da06f7ed077c609cb6981f4baa614226610a4572a3a4a0534735f85454b4541418b132bfa9c893e03572ecc5c402328f367fb6b7b2a02c476f467045f300b0f2b4b0941c4aaf709fb1ed592b629f78cb32fe137953f1506e2ece6f2bb68e5d54833974a102936b3c64741819b8b9a88c6cced0de8c540c30b874019f8bd57de218dcbe79752c72051e57e17a476174d13eca8c8a6d33ad7e976906ef49b347a91846ac5d771d2514533f562911a334d43356d00a3c20182c1d96358435b9c193afd959c7eb4f2e8d4a4aa3069041348f353477b74fa331ee856a396e9d1d472de15fadd151f64b57789583449c8e6efe0e51bdec9f148e609d68f868091ed41addafde1057d6c3e8a24d5dd99979d7fe74576cccf4760e897703288426cd6e35de0d89968457de427b70b898d3ca6e2b919141735e66624262ac9c296a0696f8565f28452a95cf1116f6d266b7915d4ce9e50148abb", "852b54bf717898484f6bcd2040683bb72ee2af9c3db9388cbe952b5a15029f1b8deb315072b71a7c2554adb34e16ed16930da7c768142768a0dd3949ff9b5c1a31f2749e401afceb7c46fd805add2b50ea50b971e683a8bcb8e0dbcc6b526468495afe50155e3c7d6265811c3e063ef901e605137742ecd8979457c834a23e0131b064760d88af280eb42ea6e53e9433a2d99936755a2cc7417d1ef5ec0a582f140ef04015e4d30fac3af21c7c2426ef9d9f69d2c263b22b9b4eb25d8c3cf8b35f63e689eaa3a24a95079d14d00f3ccfd5223eb4b262e1506fbc969172f44c83613d76428de26304d1e725db54d2c15444846be61eae804ca25174477ca8869e66b5bcb85277bbe42e5852558364f9fe42547f1ec77538121676e3ad80c02849176b64abf0b88caff0fca6e2845e0996c5dc92b6f05d93b77fdddd7111542ac9", "9973afb20eddae4378463a50e0ac180cd129d744c3a37cd83c56566c9f2ac29509895f8301da42ac371ddcce43045e38a115b87b53bb79d9c0204b810ec3e042091d69a4cbd20324a5a8211962d88220f6abf33b8063e52ffa15fc264de1f517512f4dc6945d414bf0c0f5bda4c6537c0c7d98a66ddc068b5bf37c8a411b11c64466e0df06dd1e2f6e0ab0cace7b6e11e45f448a5c61b88f333a6691b6a0795e0befafebd5b7329e6a8c69780428e37112e7828759cb14a066feb67011f6644c4983b4606d7189cd55c25c2880dd984c193ffa820598dccba789f6052fda92a30249da665c9a5bf384895116e04d27a59c343abbc9876c400220bffee0bcf63c15e526d3aa5513dc7c04ab64503788ea4ceb18fd131ea5575700bd32d47d329b", "a202c499fa0b4dad1b12d8b038fed8b36447e53772b0d0dd994f403b20f4f3b6e388dfbcf4c7846f76bede517dcd63b68c4120ce65b01aebac734c77c06d2f0ea328f044d58cd417de42e3f02c3b87b8c59fb30ccd72843068f2b4ee1a757ca90b92ed99aba89344ad11e79434052132208429d4b17de84bbb75d336f90e86e019641463c62017cc44b8152dce8b7f55a261628c40cd0c081ef9ff398759c1e042840bbf0005c357b75de1b4181141a794515a3f69fa9f076004c2f21f17057d62604abba83d5cb963650f919f35ad61c7df5773b31b70da6a8448dde2a21a722ead6495e0bb58dfcc976ee9e94b206b9eee7d2692d20cd36c7e88b84ef0aa8b", "86c7d0a11e68a4fb5c55f0904c43c4389eddc8990a07bb2b8efe0796926eee10284d0bfcf5a13039e65cb305f9bc0ad8ad2f8adfc56350233ec5d1e481c736473498a0032b4aa468384f5d6c628d3c098df3c2ad77ce15eeff81978babe2544550050a7e1539c6d11853a31ad9fe49cac8c18078291cdced9a0306a29d8bca570d47d68a0a3bc18d9dec44abd175db50bdd8fdd7bcdc44e10673f87a72ccbabf4cb54c0c432026e9915828424ad4cf08460b6c85b24f1b113fb7bc4a3c4451be49fa145d64275852396f14ec15548b7e9cf483fc36f12b55f969602495b79562"],
    ["8ca0288374a583288bf42c87fe95a1fd0b424f094aa005220283014bff46e463341c2b3f6504004ad66a15926443c6e1a9eb5990de674c5481381c1eb798880bb9d640c835d294781962a4233a3fc9ca6b1bc2a641a08374f35d61879cb85e4648a85de308851c7e643961deee247bef2c03b4b9369a13bf5a5120f2f61ff98c26ac4317a038d66415692cc9928428e6bfe15b4d461d27319ddcdae6de0f2bf528ad95faeeebe57359a035d85d4749c1188b92639ab686cc2b47422b1bb725151f8c14e32fa39e2abb3110640164d384897393a007b97b736256fb557fd2705c683513d889e8ebb542e48e4dd463d9c70be9433a6be97acaec2d9931c9444f0672fb3cc70c4e47ae79993039b33a6d4ca2492dc6f1988c8e4c1968e3a1b3e15e69ee6f9e8fd1b4c9d3c55790f96b464470c81236d1de9ca01087c6f3fda5b28643fc047079d2fc0ac3907c1591027e069a93270ca6b4c45453b197b2e373a2bf6c7afa5dff993a745a972602ae9d4edc4b6f18cf7e12853fcba7013393b75d28", "b5aa65829d9509cd8e05b516ab5f69c7b589ae60e3950f2616f73ebbcca6a012756f5059de13d96ead0d9ddf5d3f4962b17cb3fc2385339b1841d24190252e8580677ee2508cbe62b11c47ef4c3d73d7dfb0b3e95ac322ec3e55d8bebb331cba46262f5abbb14be59af49e30799b12567dfd85986de794eb50f0ec80a124efe60a2d1edba89e001383f1f000820d7e7087d1e2f2232feeefa64a005a77b4b63e0353f14313d76110a66215f7ecef5e35d359d2b1dc8046cce414fdab212d3ae850369c645960ec4ae39c346a3fad1901f0006044acd9322da4934b8d7e955e97239638b397e28f96c7c3600b85522c6cc130315e9a1c43541bf028cd72f58c89381d7b1b800fb9621d310e91e7ccb598bd3f0f23351d834bfad08599cda782a15fbc89a8be1fe1628eb105569b6a3fa28fe6754f46d4e387effbe9659280de5a628ffa335f55c78f79def1b0b335a9c8f5304054216c7ae8ee5cbc44b27668fa", "a9ed06d3b8d7d224df8ee04babc1390df5d9db3a4ba697ce07b55cd7018fd4ecc6dfcc5a408faf17c4cbccf69ff48e9e8caeb167e7d36b9eea70d422c414cf97c0cd3ad53cc4fedb12ac702e39eae34cb5ef169f4c3dfde69da7f1a2255a4c2c60a9c97a35d03babffeb7b3e75b0d61c9b6b24b15d726432b60df50330867c542944f834c1371a7bf1faa4c02dffb791c6ecbbafdc179c21eef9903f30a9b3ed2df587f70dc6f69b8919641f8ceeba2bbc6e955b22b82af07513a0e180c7c47758fa5436c6975106ded2aaa0e96e0a1fadb3792253ef5c6a16e079c6e542f8c23926c9e5931cb2eca6b930c216b38fd3682d2b9ca538bab739837b9d84ae0f215b4e094b088764fa61461ce79c519ee4346c87620ca25e81121b706b83d99ef537b1ff9347752ace416ada5f16d6da0f5ad42833ae25a89205058065b89d23c4", "b5edae1b3628e0df80ed9c6679e6a368f78c00ee7f8513697b39f6b1d8c6116cfa64a5db32e186bb12d6e789076431478f2bd44d3188bbcc80e1f16404cec2a80665783643e2d9298b8f3669b9467fb3c4bfd473feb94d1aecdd41f4914495864b055ba61784bea296b49deb9404e1de0966782d9ae214ec412aca578187871e6f162fb7eccb5a284293c8af4b388c389c7826799d7f7e3ab85869257145dd0f194e73bc39055090f61666cf65740ce60f69a58d494b8b445f2f622c051400c41abfaabedf7dba4b4d7a31d363c81090d6b749e650643eb4aab8481a71b596eb4e4c966bc6269fbf2b99b96648e55da460bbb80705a285de8d10723a18ae6c360f55b8387e33fef59c133e749dc49297997a725eab15afefb8d87c7e83f3a15c", "886a40222977bb1979fa1a18beb269be63623e480367af10276b88d88ba36c48bc0b0a321b6ce647813c743e307b90fb8332e15db6f33bad0cd1be63c2d590e71ade58491e90886f9e0278b04b3ffbfce3af863f11a6c8bd093520cc701b3cc2053255bb53154c60e4b6ff69e3264bfac79990405ae527995b853bd9027f3f683d7352c639823c4788a707adcd0c96946308636ab9ac1d92464367a7751bbdc8082f21425a16926f5f6dfecffa130b935e5971d6a4244f1305a944351a130067707ec961d52406344e3fc8385c8e0a9b20638f3e5222e4902215865d94e7c14900bc3663e73a2622ec892704328c7708ba6f201ce72a727b780d11627b46b0f8", "8a06b20d7a5a7d6dfd4e1b6339c2f5dc2cc8897b65073b3f37cbb9eaf9beb0cd3a91580baa6a915ed3f756caee23e44f98a37744761b9d6da641bde6d3309e3b98338cdad3ed1ae47e41f30233038c5483e9c897857d8b84db4f49282439b7ac6a1cf3aeb93728f6afed872a94fc8ad45a5f43ee982f6ab398970259a36f6c74547f3c12575da2b88344971a221f6ff3124d7c92b36e2d408ffc2c6cab1b69cb624924ceefa0951d6115863f52288361dea61897b6d3e42d7653362af31444672f7680f64311c0a7360de71a6118bf6b4ff603a3be34c210c9ace8adce8378bb"],
    ["8c6fe31cd0f7f56550b411c69fc3a9b062004f8803a5c16d3f76b159eea87140e4d4f1ec38ddb8a7f506a698ab32b6a094d1cb094f93fa71b80b366d5e05599cdc69d49985228f10a0bf26d8e53da48386151db398fc03f5b48ef1b0c98a81b14eaaf53e5314ad4abaac1b1fc26f9107ee9e5cc0fa7856d76f78c5e04e01359018c9b33ff959bd28f5975667c1374a0e756a8a4e409c7a7c9566d67a64cf3821047a6a3e67e9c9b0568d624c0f80c28335efa8743d394e5398741a464486d5901881af711171836142721e7534f7bbf54ccb61d00d957fbf6719c3455ef7f4b94ffdbb90923a015dcf30bd2e3e853091ec51173229dab6300df5783c25001fef6d065d49e682e460c94ebfb363c9e5bd500939210d4021b1cef6251b558dbb5d2472e088b73b3aea04a84be54174ebbe8e10f305593e48a76532a54756ad1985009070e4d8d0fbd1e7c62a72268133f3323a7522db1cdfca69f8284416d03df9271fbd27189c297bc78fe43113a568d0d85d9cabaf86251ce7f2ec60b0a75e33", "b7330317b98c1b7d95b10c27ba05f0dab1e0d53bdd374d7ef116a4b4ff177a24efcd762bdd4fbe3e30904b8a3b78b45c819f5e07dae8eaa679f95b76107598c189ffe5409bf2555d1d56da4aecc1da02d9c28e4c048bc07e09e4233083f805aa3351a31feefccceb803a26bab8c03a6db0a5cbb7476813d990b5aab4ecbecb8043b7673966dbea5a61cd0c18a31482e8ea5996e93d423641e5cf23afe6afc89269728557b084a7b4e946793cd08140510a40e19f4aec7736ecb5f42a802d465e467128384bedacad499f8f0d0877c438def12170aada646f0e5357b9c4f98a274d36705cdac6e4705ddd38d638e53d7c5dba19c00dc0cc6586a48a12a0fc6266168a634cf6e0a88229aba33b5d964e6f8bb719ae9c1ed5dc3d8857e16c3e301d34371ca6f2942bd6267c844e60f570dd5f5786ec493c666967bba9e0c550b7f46ba76d149a7d0e73e585571af98444847e0a6cb9bca32d6aa52638efb9d07c0a", "b5b8a5e382c3fea413d9de36857d9dab9249267872243de1c758a23a98307094e2b69125731406e745d1f02d38f3c3f68a9c529aa77c01f8e24a8fc2380aff59d3ed1f10c592417fb21b9668faee02554f080abfbd8585f47ee35c755771a6eb15040a7b06f04d59db524445107cf1814b47c737b08ef12059608a4411dbe23a6181d0929a48a1fe9dc5113f5a100c1d13b6b3a9c0b19973698a4c4aa81f83ed68221edfe1f9bb04bf4290cd707a4d42b3b9c4fa051889893b017195dcd71247655f6a818a2b12cf8772a0a7d17b75b29aa6de3ba2bc10120460905b924592a55336d687ae843d677b896459a37eb7fc8ec8fafd558532b0e3c5b1eefd42a32f2f857a29dbfa6303b3e0b5b06feee9d30151ec787580c0b237d306b29e86c500065c2925e625304ba400b774698f79aadd3ac85f8a83f8627eda7376af5b08e9", "85a4ff186ce2a41847390d803c7c1a189e600b8d9c7d7048c11ce06422beba5bb8dcd97cc62c9a4036bac9aeca67593bb6d58ea5aaa9d13abdee7ee9c725a8ff14de2f6d59b5aec69c65815890632754613dcf40c5adf71e0f4d52bcf4821b1405199145380bc1bc4e2333aa98c2a9ab522cbeb8ce6677a93d715a0e0cb2654b2e2043a90c016fe90b3fc9def596c5189dec4a262d04a8e57d5b8bc17b36de992819be9178344f8319b87612ed211f7383957221b90f5cb6549b318079a994503065461dcf5bb6b1a43821e57a8ca6426ae20717ba3b14c8b88199292830ad971174b880f93a32cace94007945b3ffe945007db73857f6cb0fe4386be399135509a45414110b7b3a561f0d2ea646a282578a85abd126f02696d82e4ecf43f4e0", "b5f2e7322f38e192745665d731762b42f0ac936c2b7a57f621c1bf1197fdb23def710a83ab2d04a11e510233e860bcbe99e501e3c9f8ea8b989d3c1a60525a2362ee19158df1d0a857aeacfec28967fa21e3a5929e36a6434f86e234ebfdf94455b71bcf12f6ec65d343f79608472f53676ab62f8482ca623f585b456e3019ce02e8f6ce12dd737ea8c4524becd90a1d523ad4e3c8eecbae4726a48183b66a6f36b755ef11c25135ef1698142fb5cceff3dcaea5dadde488a50d548164c00fae36687e5a81f3a9bcc538e60a1cc8e9bd7203eb86a543e9cf7bfb62fb93fa2b995c25533b46412669dcf28a0f25498ed87f753dfeda1e8cae8d710e59f3727525", "a2c7a77bfc0eb83f343486175fead22a784312cc70dc2d597cc9be6288eeaf52e2abc89895e1f2c6abdeb9cb3cba1863b423909d902e95f03e740f0bb8d07a5663c5c476682d10bf6c1ceb8394a3a270f6550cca0838f4b9f8f556126f3f52684c088140ecb574a07df65b297d31484e202a02d68aecb51649c95ec3875fd1591156465dc43934ec89e6335f95b519cc99fe00fb5ee8d3c582d78d5efb30f8a315615bb22ac735280fef19b11d37bec695f547eb15287477ee320517cfff8f431db64edf33c6b34e1c6d66d87a22864fa466590541c5f883d26fc11a7f731326"],
    ["8972c4d0a8cd0dadc764181045f216fbbecb4b2dc3b010045f6ca8c7b896513bfa53f2f0495c69e3bc54529935ba8f4ba33eb7ad81c8965d0de13415ee6e824c4198f2fd58eaba8c0993746a564f3a756520db593ff2d0c4b972d913cf054bf61f35f749bf7fdc1fd49ada62e3a176a4fa5b0da27b18781d8d73db9058cf96b449a83cdf635365a4d11589a3d01ca8bcd07ea5a195d2df5155cd5abed287f827279b800a62f3bbbdbfe209d4b1c3068fec4d33ab9ae8f3228681439c47e010d249be6e751259d3ab40a485cadb1ebb2072473c90edb52400dfb67ea5ae6d12c93d1db2148618dafabd34d63e9e4d7a8944ea64f17a1a4d40fc4402d735e42ec87343b2ac3c77a46323d130ff4515777053328d27e0e9df29528fd7d2744422a2003b399d4a33148cf30ebd350822e98a4837c1c72debad8e13e900d2b37b5a7a10d176c8f93054dc10cdb7b598bb2f237ee80625c2aa3f1829b89af0d187a9153043ee76a6632a2e183cd78c293592784ca5b79fcf2536ba265b15177f471325", "94afd9ccdc2d42afe0ec3670043868f17436a41819d658c5045edc688dfe32ba79c7679328feff69de9fa04ecb791d60b1ef3800bae65fe09c6d739e497c4fbbf1ca30009458b69b92e260ac47a8ff5505d55d2ca97ba2a4243303453369f8a052d841ef1bb33504f784bdefd625d892f80fa571cc6f85668cd7a5699c357c9a26e099e25ddc583b04bbdc13ce32bc978ed07901126676222d8f7fbb1960627f29c6506c1f3d897eae2ca0b306b0688a1c313e76602568e439a4954ae797d27f6e9a8bade2ed9fe84720ae415f52fbdbdd9aa65ebadc981062d761de944bd43b1125a5b91ae3a1f5cb6d0dc47d6be3a9aa829e8082e33358eb44562593909e944fbe6343f3b87a1e38cc2d01869ce3aedcdaace632177c8209e21ab23abe3f6172d862d6fa9d853aad4938a3ef2de14fb28f6ebd0c694f86f9c638e74b934ada209874bfd858aca32e6876f85766f5aaf99855a29706f4396b0b04e5fa9d69a4", "943fc8e8b28c76308ee4bd9cd103633ba8cac23821146dcfbea111f9047e40ae7a7cb1c23449c0429a6d98fdffd3a53394937cd8c2f1b1e98c9887f18912f5939475276b221222ea3964b4205aa9a6e23fa81600f3c1e11d89cfd73a3b9cda0638f248e58ea56d3d9dc08ff75d86822d3ec3ea8bb79453a3ddd8fa276f662ad42b178858fe973a86356a999ded65ad8c0e840e8b81ed0504bbefbe20efeb946261e46a0df7a7650e04f9ef378a7fab987737e5238de1af315f6e88bbdc12ee7d1c6d2efd3e3adc6da45cad72765f05124211f50345db44eff602e87e96f076f30f6d806f924875c2bc7620eb7b88ac40d6089a39f9317f43830fbcc28d466f3741f2e4b74fadd332056990b34baf2dd6c5c6cc86f42fa2b022e65cdd8744737416a0d36093ec77ba91bc052251405558ef2fabfada5dd16591b85df7ca259a26", "9531e3aa6632c9695e4853a301e1aac6cf8b0fe54957e2bc2f8de0eb485304eefe15cfe7386f2899a217d348d2515442ab8a4224d81aeee5738ed48da4240813ca8280368859514682ed706381384e3c83e9d7166720856806d1c5234ff6ceb148b72b2fd32cc63d578e96b83aaf8c3a199c64ceef601a9debfca478ad4410b92d8947b73119a8e01aa80d4bd935c39af21fcef128976ba59e2f7a8d811b5ac827d32472ba838a28cb6833635aaf50f24de94c31e51700f5693001969e856ea5537e544882c32b169a2972958c6c3edc6c2a617e7dfda52de067249954b523ae15bb37a06688c9978d49e5297abf72b0dfaf80e6b3e74ffd820446fdbc06e7ab15754dab210493ed43489038279b064e8ce0f7d9d14e08fe98dcaf7d5cb8892d", "842bec288c19212532be7a40ceddbae4a051cb3548604f251b8133755f732ba7f222e2de461bfed7924624a3d0a76110a88fc88cbe910d71e984b50fc86dbe0efe4cf31de841c5d968fc2d425d2b87fdb5cbb7303dfa96bec68ca34fa4de0b7357bf1ef5fdd69b798158968d4e1c7e12c126988f5e797cb5e76031a5c41b977c5f824a2e1fb7e450123c11605b6363c4bb7315db85cc528f5b74ce4087f0822707ce350fac2cf2a4b52d7d5626abbc5b813529264f3af796e78be41823b268083c132054e36ccb7d8ebc7c9478c43876049021cf3cfc5a070c89dcf38633b5c11dfc574e78ef1543a8ecd8b79291debdb634669764f02e4b791631526da83d5c", "9920fd23c9d471da4fc67b1013f9d7c45bb7b168141c71d00ed02910e282ed2441828a57757f4988022837c5a6ceed23a4b71df2d25750ca2b2bca5f913f80f60107745d993ea71579d1bcc219966c33874fd2dcc2fab0ba7630f492927ee9b552529ef4da55e763c0e2a35f025def0aa66c5c5eb8a680c5b706bcbd6b70256722fcf39c8ddcd996648ab88105f69d830ae1c811ac54373eb74322be9862a986427ce1422ff8d1ae47227a1aed80b03d81a940727bacfc575f66d1a5e3724dc231f9664261d34f860b6a981eebc1c40fe00c14561058e33fef1bd5934ddf7a22"],
    ["825edfbf15bb7ac8633d5d8b14767cc2de9ec704db498ccb49ed0f8d335cd237de66410e4659e0704911eee91cb3415891fd0192b12e0e215b7c23abaa8bbdae996d8219b004505b7130d303c714319581741064adf48bd923d5d61f672104604c7ddec6205959b2ea585e26b85b20bbac6ee6b4b8308c863b439252f22e7e071b7cf631e373191d5fd65e842511b2af852cccc97e1456504aad43323017b05a69aa6fd12a368af1413ffa10a05f02999aa5743b1c493c8242ccc9419b14763a3012ad867bdde25182e1a104fb654e7bbb9ff1dba19735923a60dbc432712af84178e03a2c3cceab63acba2a994f3515e29285391ad294c01a4191ff4ad35f3402b78f5807d432e658ca84c2a0036db33144c6490c5bbe8b5a90785cfcc810ac635531ace93aa59296eaa1dda297996352cef1500f6c6fc46a115b36d62bf54e55b1598b0d02f6c12d1a299c61bb6aa65c8cd377c51b759aac974738fe9ef62659c1ce263a5f1af20387abab16330001e7ddf1e12b6ed3e7f351212a6ef31a4d", "a1c3d65835753a484e3f3310856b7c65fd94eb6f1fc4c4d78fdbf5d44f1fbd901fae319303331f2eddbaafdc4bcf3303a23b494011ccb09b47a2af5be4e1586b22419c32d98fa59a21d789bae645d389f13b390c8731d0133f6d875ed49af6855ea9da9e32bf7bd3baffcdf0355d9c44d1b6b34a6e2c4957faf9cafaa94ca6dc411560c58bfb78f0c948639914ed0733464fcdc4cef723851fd17a4a2f38b50453ffca22a1de400a389233d49350f7f79c8919b728f110046f2fec2440696cf31c8bf0025d3d95b7db93af124a04f530dd8fdabd09e90b0b2784517bdbd896ef424865537bfae55ec61af57d423efe2cd6d09d91ba9e6f50e8c57ab8017eca8f2b0d7fbf18fd58f6fe0770e74f076d769861050850e1bdd748d8cc3262d0b04c15829cb6e58143e5e0c030d5d532fad69c0828408c48987ef5a80e9527f14358252a55d6d3f46307234c66722fdff74b94f8d7a68fa75f5e0bc3f939192ce2ee", "8b0ac8b9d74edb47fa30d59ec5814af66ee43349bb5dbeca4f7d308dd4f90cb52e193571f62de8c55b2de2d11ee961ea879e5b0dc3479811e99090621524a089995892e73fdf81a2efcabf53e22590c3b431fd25d5711344878739f6209e03107129d0722b3ee55695493d0945190cf5259c2f32c532e1e2f7b12b58403ef0c4333273defdf1cf0dbd716dc631cd075b0a9b7f0dfad0218464c44f260693149a5f3e9fc369d6fdffafe966bf3c679cf521c29897c2dbaae62c85b2fa63afde6137713cb615e071b4fc54c03c2434826cdf9446d8df9413129bc1cbdc7e9725e571b9810d7c29289d33d08e12ca0a66fddea9dbdf6607ad97dd9553d158519b6c0c00cff5988ecf6a7a429a4389f201a601965c4ad629c2c0639dff23829a81ca5363de799643b8a90d4c05c32d60d9ad5801e41e74f58e191d5c5099911e8fef", "952ddcc06a692d37b3566e6c507704a2f7ec7b3839c40cb6ac7614278dc2b2606de2483d1f615be5105909b946f3589aa2069f5ec11ad50c29b76cc7513d09678a336449dc5ca0e3e4d086338bcd8ad60596328159151891700a498ff08111326fbccb17031c33f9a88fcb1c2576237a9269779c434a0c975316274fad5d12735b10248f4bce47916bc4c3a9ef58f8aae97746f94911fc9645ecd89769ac80564126e04cf3fa9495a4e51020648c2ef6a5399688629f54cdf7640fd3e151eafe49e8088f2162686a03173ff34c2f44c20bd9eaa88177dcb54b6b7be88a8d6a583c629c770f5b11f6ec835771437985dd2500fb540bee137a0d971184fa8f0f2555636cea8a9af22ab8faf9a7b8d60e7fae5fd2ac23007788f468c30290297fc6", "87ca3df99ab7ec9a7ed3d799e3ffa889079990d4c66fae892c5931eb3c94c0b5691fceb467b24c3115cbaec1d2559632a554388b810587fb05274bb6163d8359b37c2227ae3394da7488d5bb71caa53a90c3b41d9ed2a6fb62e0a8b0575d76de28b2aecc769421436d901532767c81d30bb047bd501316216a12eb6b1d3b1f686e1506b7ef1e5d86d502967a03639730a84b24847ed76c27de0743200ffa29a45ae33a4e3a75a5c472a7c5248caaaa510a06fa0da064d5976bf84b422ac9275d584cb8a966123a2fecfef4fedb56b2fd444a5579e1164ab559f89813dfd822405eccec8ee878470c46396e603c1581cc922456c536238d4039b72f052dc8d54f", "a3a49965adf85adc8b0872e30ffad1dd1eb52c143a50b6341def0af2f2d9126a71958f274033927ff16c7e2ad44c768faf7e44f2fdc6d4a683e6796d587305cb97d7bee96b5a725fa0c1895e3ae78d64b5cb2b4df509453ddd9158615ccd61e2176b380118093132d1b6722f62aded2179611d70b388a7a48c02408658953c482fa53f425ab5a4eeb0dd7f5b1fbe758e94e492c5e1e198af615b520be4548092291d56ccb34fd5336113d572c6b6ef520cbd66611a516e026136dc91f183dbd539e691f7ae58ad9ecbc2899ada6bc8adcc4c9ffc3c44e62bdc97e9c629898530"],
    ["a4931fcab98fa823451c9148670edc1d9860302d7c3a4d3c5f5c30828ed68b9702497aa8c44e8f33d6942ee164740f63a4ab40daef9ebdb029b0f13050d8949844275e18727f125ac5d835b20999d5c7e89d6a4d347b27500120eecb9c9a76e427a5e8754df6837159242afa414a5279343d09cd064e436e1dd9a634b000c32b6b55706268bdd9f10fb0724366ddbb3741a98faca73aca6efb329fb81861484f3b005baf4eccb8971f1808f77579cee8c3b0bb65632a4e31d9904b35b449ea9b2e10939797a540d55393ba6f9d5d38077180a6de2708af4771b00eb9adbec0f3517c349f0bc5c9498962a75caad0c1265184f384f1cd3a9905376cf94bebce8a3f50e895a6cb98df324b6e9d7e30a8e79ddafb7535605257655c872d54c15f270bd0d37c5788c0b1f80ef23807c3440198f7725b5089610ee28d3e8db98fd5135eb04f56cace1cee5c03ccd5af9e390505cbf1f014a3320e73f9628c98de770226593a3d76a89cc13a37e3ea22314865505a721757ef4e73f9d802e9715de467", "ab010bf76016c884c9d9e719b59da4f28547cfa765f9713a4309ccd630a2d7850d19b068866896abff627f76dddb3fd7a5aa13ae5779b3abf6ceae62d104657a0990840d1a9f47df4618770baa41c9605e3f843f0f915098c6baddd08c1907e206847c065b736fceb48bb04a21671fe8a0e04b2a621b8b6c71f50903b16683c707893e378e6883715b17fc7e686a9a5dcb97c46c91de06be716510edc52fdbb01e09e9d295899359d98139caa6b9b5fceb84dfed36728f3e3be9e9297a76194b602c2f12e87140bd27b9980d97e0b9657fc64c6a91cbbb8b1d99e0420c8b163703a2575c8292c6bfbdaabde1fe2d80175e02c62fdc37ca67c26308aca3083de13e5b576dc53fe537aa5a618a2ec5a5da6f967c286279f249664bca0bd1488e044341b7c8d41e89eb29cc292c5b5ab809595c3e3658e7cf847d1f171b6f3bdd771ab80ff1e352b6fc63f51b82e45df9799536291f35207bc2dd4abaa8225706b8", "a3fdd14f1f31578317aa2dce1fb9fbac53af10f5ac21b60cef2446ce20cc417091c1651c190cac3b6337b8732b86988280ec62cc68682593aacca8e2b722a30e72520863497892a316bf871751f803c41621a2027bc1c830e8a6dad6ceff3c2a239d9c14184756bbcc5235c08d4c6c0557aa8fb162f9c90777537bd1b6a0abe115c6e7c47b56e7018e26392ecf14d6e3f95b1de1c1cc0a63dfb4f2a580df3d366ab8bacd197c0bcd08232532ddcecd35cb0fe817e310ca41038cfd7acc12a8fa47535c933ae60799f773daa3797aa2aa3c44350a2985c02b9a735209f680dfab370abfea13f9772f36d8ddcac9579c62ce3376b41eb8172591713408eb6bed7d704b6bef912910b494253a33a3483dee507b4317ce08a4b7766ebc53f5fe92f36e1a357e6652445e7997aa70507f0756ee350fc09c9d0206219cec3f4435a624", "855117dceb9d8a83513cd8ff9313d4c3c6477dac4e91992287db6fda228f606a320bb4a7b97d42e36ec586b456f04597b80150623822eeaec51d4d8177d55cf95ccb10c9220f322c1f3fe214b2da1f119f02d8e9f9ad9c5a5130351c2024cc1d3f1a2c985c9a1b482662e7bad6b8d5fdbb16ddea178e0aff7f2bc601027b910104b54d58ef6bf8836b9ab2c37ddf9852a3b14401b9e45d69c15ce631da9760ec2da3ebe0d68719af769296878317ba323da9f5c0743c68ffe126be9c9f55336d56c9da2888389d7e13a3c49649e294cb858bba798863b1f51434efaeda6e0a8a2f24255b248973e80561baf67d54a810d6be1d194a8aa0f16467cb5852ee05e46336d669b7f18de6129bc476fd33595d9a3366e2b625b774363458e618f9a17e", "875969bb8ae5e4ee3bb7f64f993d42c98d1da5389bbda382d4ce3694b3c2155c98ae0aa8110bfc2bdb43191534b190db8cbe8d4bcd23a2cfd64975ec8a78f0f8bc8bef22c80e58a402ecffe66679390c2fd098497f082f64e14062cbb63f9c3a66628c1a7bb19fe6e573130db536422e7c683819ba90e5a289c064c35921aad938610a6763db121086fbaad5c9c53365e28af84d7f536dd74b1b40e6ed8f292e2c83df26cbaa55118d761015a212b047458d3f74e4dc3872e34e8a46ed66f4f818aea7d6e426beaa769e96209088fcd328e5048926d28892d2982f0ca19bad5b3060652631a21d8e5b753a61420d53afd006b63782cb762a557711bf84b605c7", "850e68b4be83027543879bbc1d607599fedaba47b0fac2071dce98003df6cfc2ddc26bb759d882da7d9a45760a3b66d087d964d86bc62ceae070ba0967ce034ed3ee71aabcb2ed57f1cf02190ee051699d154b90c993eba9b897d9a4c146448c05699c1800b36f4d54286d40e5c4447d3af810383b6d658b685f47137304f6726847a41c66ad5a120438ee178406b666c3716184aad9f427087e5c88c044df063069524f2f9fe298bc90608c9e64afaa4be5099bb1c603cb2f4e4b793992ec1a70d8c13c2f6e3c861f7829057a15dea09ac841f0c9891f77e3a443e8c35b5578"],
    ["a4db1969171cedeebeaf9e054436fa021bf5e0e901a2c13f74665c095ba65c4a6316c7d860a2f2da812e28a9ec68dd13949addfa0251e7d545b79c43c04b899f2aa7caff16291e6974f381283eb64a66f71db1bc06f39aecd29c81b86b8d249749deae02ee946df2e8d8a73cf7366da0c9076d2d00c904783d8287d6d2b4ac2e325ca4c6299b15d2b7f43392a25491ead50c284e706fe103469a526966bac34c19b2d758f756b734dcb914264b296b562c29eb80804aad089ae3d5338f32c4681a2713acc51e3f9b97ab3eac8c1ee6e602c76ff0b4e80e18f835d5c75bc3a4a46a06bdfe8ab6e09a5765ceddcb14ccf9a6dd97f5dfd3a57b970d3d2a85accf2371177c3a55590af3b72e423c7c31ec1be2aa2ceed3cdc2ae28d682b83604579e42ac92c61164d9fb795b2ae26c56ffc0ca2271c97b29e366571a7b8042feee7e320377235be908ee87e872072f694b47abc7246fa708193d2eef8a8319efeea3007b8e90497135fae82fe2229b6ca055c885a722587c5d79eab2428c32a60e98", "87720e2e7cc4df43794fb31bc6bd9cd559ca70e979aa24b94ade82349e7aace2d8ebe6791d49c42f46f0032c4c4e3a83af58f7c921fbd1a85f61a324f8444435baf6435f9431c48d32c350bf0b02c3171cf05bbc9ce1a052f99f73c5565ff9152987c190993b1e8afa6ea37c8b6b5857683b0aad2539453eed31a4512e8919a1378d3016d2c83d209ebd2730c1614cbb41ba1608c2cae6af937ebbd8aef885a7317f4d52ec0035623cc65f176162edb34f59223e1255921eeb843dbc3b999c2961f6add55e1699a60046d6537b4858de62b3c65aa81c82281919d05d85711a766bfb86af8dce69b8e6724f27bb72c18d66ed37ac2434ef1a3ecb2a655f36f5e546830b62f8a0c863b4f04e0a2024f51b4cd6d7ba1aecbdc4d047ee3a4e3adaf72447d872347db6c6caecde4bd3995d17e1c6044700666c619a1405ff47b92103560fb21cd3ad6bf7bdd4cb58499940e102e4a9327d63b1a21af962c4939533e4", "a345f5f1fbeefe4c679d596d6c66da74add79376f6c7418e5e14a8c5583a94c20820a6fcb9f66393eff6f8a241ecc9c4afc7b621d08725c065daface086f66c348c1e4404d91d78a0f66faf85d5729a4d3dbbcbd5d87f12aed0c2bf1168f6ad24fcc2ab505751c1b401d3c5ce349ccb7ee3e7205a7614a09df4af9446b56a035308b5619b6ec04af9b12fa6a3e4fba0462e9c79def8db2dddd7c5123bdff27eb3c3f87b74b34e29a4bb7bf01cec876dfed31db7bad978b501a5eb06a3548aaa210b0cd0ccb18d0c11ba4960559afcc289fe44388bdc62c50163d303e178c3a3200b1cb9b9196892203df33d9a8cc1d7bfba2a44025ed23439fc845c61db4bce104dbbfba958db911e6e99c1cca7f09fc616e6c1be75140f82d1e1e4ddcf5b04465fed5448a2c1fea99999fe3ca484baa75ef4c710bbe80408a36c76524ddf7a6", "ad50540643b73ce40f036a4baec02196d6861d1e8258d3a4ea69ac91cc1ac7b71939e4ffe81ec5c774d9ea047cd54f38b187f0026100f12207865665bc01572de9435cf86285d412af08548aef487f4257be5de72c6041c2618e31451ff0fdd858750f440b9226293f3e2bb31486992a42dd96a64f80515296f0a23e8f7c679e5dbb8dea69faba23b3d02f43fd9235a0695e8b361392dfb41504346a176a4cb3315e6ff50557cf0fd728a1f087d838719c68f834a447643c9111d3680256157315e797217d40237c6777612ba1a06310e34e8bec843c479e9f961da27d308ec6739d286e3a1916bd59bd5ce62d338e9013407f7328c571af8a743051714e58d25ddf982dd48b876db62c64b850d6ad3f2dc938e1df902cc66f3d542291511fa6", "a5734bb3cf8e063ba327493d7ddb9938ea201ab54d79ecb607e325069394d5a8cbd49fa5dd7b41562d8641daaf036e32a2581cff956d9e4ca57b156e1dd11fa76fd04757143ac81f537e85b7566bc5cbeec1cc86c7cf82d64fb15b8b334736b25a46ea279e503deaa021f0cb23ec44c59608d1ee1465431b69985a4b6b320f773dbe12aa70f133b0837fd152be8f98254346d6d0f025998156de0de05d3eb11c1c38d10eb3846c4afd19b28834b5a6fc6140d6d027da51b3bfe7a4f35025b44d350c778551330b04c84e55448e2b010eaaf8eab641f6c830cee05b766d125ccb140f0c1d1781d8149b3418408b948c2b8346bf56c759ea6c0c13a21e3a31405f", "83e58301020c7ba97a006f04748e0fd40fca401efaa074602b4fb3890e1f6f04aefc66fd5349b8accd95706df0be7edeab31c130b20299a1f3d1a15eb2b0f6a00c008360257fc97b314d0729deeb9df9a4e35a772a90c29cd53af522cb29451958e51a0252c84604e819223085e46a57bf1fe34bdd6268b138679d5405e8d47408ee47e5f1c52cb8fe7572283d59350aa4841d38cbd458c6366bca919686551c2022880b829dc76c0e1fbed4c04fccbfb646b11f9918bd02feace28649c05380300cb4a61d7f5852a225da82a5db9332ba9bf3ca0273e8598731f4128bc131e3"],
];

// Expected sha256 proof fixtures using MockRng.
const EXPECTED_PROOFS_SHA256: [[&str; 6]; 7] = [
    ["a71af9b23062dea465a99f702dcbac3b814774763694d937221b88f1330d59b7c3789555dde3072a4a6dd98587510ea4a25c2fc669331321538b590e0eb75c74055881f70b95106c181f077c71eac7f00ea8f8d6003ab9b6afdc098357e0df7c200cc0d66e723d507f22b5ad4c63ff20c7a489be32f5c2081ba4779643448422334a82327dc258b6f94375e74684b68abca89c4cb0d6d87303d438a1c40ec5b85c036797810f41491f31e9133e4b36f0f6dfd873a1a9397bd639389a02e06ca641403d9ae74d2ad9dd2ad3a1d241c4204b3880a69a824f7be589d1463691fbd8706c86a5dd06f83e87910e4d54212b899af3691e1b2c7041ce2e4f6ae28d4c554744f6812c685f352f4ded09f3f5aa36aeb767534416666ef6f74e0fcd6c03862f46b55a89ca91590952267fe33eeff087d9f09a4b74fad5226598e11bb190cd4e59f0cfd31231043bef8d765439c005c624af1c901f4af1b21ed722fc8897cf30f206a85751d5c08c0980a567103d7a694bcf2e0aa8d04c7ac7fe77edc9e64e", "8fc93717f2a0eb2d8fe7e03b4d58cb8edea5a22dc9a0cfcd9b15a5a92e33478bf5b592b3bd7f325828f73399c4cadc818fd10bc631cf054ac72e31103d28df9c0a4913f531a0a5443a38b84e9d28af57a2bd300965e3c785e2b95176ccacfa7a095cb181497b0ef007d72c27fc213cd923bfd478ce59b82638cec7385fa55d6f56f8350638277be3976d6ec66dc4d1c179c9a9b8becf89633dfdfea7d5d3a46c73292e8e24d0db9c646b181ee72a8b27c6d9b967e42d85f697d3db91867c979a2f11c85ed0a57e1461da0126510eef69ccc796df2e378b6293ea3e09000d4350172c3cf92f11d446619aacf9a7f99641737799c956d7866281b67d0c2a8c0f8014cfa7ecb52e9e71b9a9758f5b4768e4fd34a23f140d547ec65e49471dbe4aa46e9a2e37b44743cdc11c3504a46f476069670890118e0824d44155bb7939c92117b44c8f1aa6dec07b1e65e5857b42cb89f5bc7d9b91d346f9c59ffda5ba3b42", "b0ebfb0609885f9a9fdd0e2b5aaae37117b7d463947cc5328235b66c69d764c31dae531bb4e7bb34fdde095f65154282b382f9824c7263d69f1949f8a51a5bc0403280c0f81100d6f19dbb1a758da1e5f006e77528e634f550e84489c097b63d5d96e659c15a27cab5792a5682fe60a14ea0bce6544fe3ca7fcdb1addacdc999088220314218b5fe38aba0a37f86e12d9c9ff61e8606f8014db93149253b8ad7674baffb7e5884630998742b174e7f632875ad404bfbec874a5e2ddc2934019343b37e4021fc503423dcc777b4f4df9711d6e94b4ab92d55c0784c30356637960aa7ad345fbef084783cdfe9dee6e951f778fe60490cc6748f206438a95f101812e35b165560ac69d276e08270ba6bcaab75f0b5ef079b1f96f8ea4ffdf7f57b5c19e157a6a4ff5c594b6e880d05c4018e1cce073607dca8962ca94769fb6ee2", "82499ade16343e4b6e007f678817eb983813e1abf1dcf2204f770c9c8bc3ac3f7ad78fa9a2f04659a8c8e4a3458df9ddb05694a948a97a29c30b5738ee4338bb383922efdc41c87c6e25041fb8c93f92bc3058a30f6d038e90e3dbe3ca66d6222db11196061012523b8a9df506383980eb35c1eb0ea47ac4b4caa5ac01d29fba63282436eefd93fa0fc2ffcf86657484d29cc38402e15973175250728d338cbe11a650ce501639e4b8eb9f0fac8e5e99af37a468c2f91d414b6ae51a7f232b242ec35d2a6b58d53bd4a4c1de75e137f188de46007e242ba3a353892f92473b4e0851d8f5b1fc37c898fe754efcc892a45325f86d9cb0628fb6614de685c467dc2585a289ef654c072738321e2d0390d8d1e14fdadbf3173bb513e2a439aecea0", "972da2af0035521e5e3e531d39ce83e7b5c60ce47ce50b47e1b530dc7de66f41577d752ec3a6cd62272cdbc71224f37cb5c0fcca74e68133b9eb32d37bcc1e12ff2f9ed54173e256a200e9c92344334302ef840d288c6afe3b08057e5fa935711d961566aa4e42172e2c48870333bab50f3d80c2c9247a02f615a3fa626ab4c00c612c02722c951709c37bc249cb874393d0043a7e2015a6ac15d9811d53736d733d98ed338f9907b7c216085d40d6190df603a8d0a73749b34648c40e6121b4717f6378604e14d98885a2386cc92eb9890fa2b32db83cc42d9c3fa229b473776e8b84228853b028327df3bac43fbfcf35d892769bc1a85c5ef911970d4fcf8e", "aa62fbb29d3ce83ace391f6654a7e4862612ca1f8b5d32aca8d32081218ecc7480af8c5a7e5edd04775c1dde90ca75c8ac5f3c24e5f147f18b2409c5744df01725feb178c491a8155237288a865e8e8d91840beece9faea83361390753ee653d579bc6ed1116084ebd068416f9e97381ba021fc20bb2b006cd8b4bbf164faa5268f1e39a29116d87a88e009f73500271bbb2aace146143dead08f5c309f40c265114fa57134bdb0df086fbc5d1cf244e5eb547f6689a20f1ff6ecc572b196b9c0f34f8c58a454dd48e90b631731eac340265009b48353653db53bb672646e930"],
    ["919bcea97db3748a1b9ab67f92cdbad7ad6d094c2024d4ceaac9e169f38c0598fa336976b9befe2ee3e2ae22b21bc4ee8f6cc9800e80c9745c6001c19fff60f0982bca33d9249afd91408b27ea2e1985572421c12a7544df58a30fc8b26de8dd0a461563fc53232427609253c36fb3aba724d667adcbcbb5626bf05f8f73f96326d7986cb0423aaa4d4e13645f451b343a66a91ae94571b49fecbf5360ca09213bf0490f9e0a4ebbac419a3c91a517948a11195cb8cf181a2f9fa98ee03d34e73800ed1d260c2d7fbb0565512834c5fd0757443e6a5aa4347cf6b93d741dced80d4f2a5e952d0fabb5e67de3432215b52160189584dc364a19c9517949016dd35d86c9068e51f9e611287c92be879d018b6ce133e7431f374870aa2d42bcd0f10d35c557a6987bba43e8992e89eebc5358f0a2d22198269e719f1220f85b389b2aed619a98c6d5bb435eb51081cd56763fb556caf0a5e8d9c9f5fc3f40be27ff68f39a011412592af8163c0dee69fbf8e66bdb692d0c4f00f8a0511aa51a622e", "a4cf2b6f26de5f049410bb5120b0ba06b3325b90a7509755c9f997e4d76a12acf79782c737631f3a20c6af959dea0ff690ac798c936666d8a20c787b9222b83b68c8a2da1a381ce169b8ee77ccbfe36952b2edb081dc5f5c2773cce237d1b0eb3dd10b02d98a577351ed578f2f588b138bbdc1212d6916022793e7b4a46862c328560400761d2bb23fba0e511d74540825a46494bff13cbba77ec81f06510414666689c473b805cbc9819021757b8bd1d1f795a5cf6cf905ed507ede52cb166a0cfc3b08cf4424be215e5a4c8b257a08d21938fadaf535f1213aa44db20622f543a70c4829679cdefc965673c731760f2d436225f089714d12bf98d03e72d6e3086aa0ff775ac1870e1714805885ad187d2a9fdd0f1a50d641aeb5ee670bd6844a876c1bbe1411e5f1ba1681510a2e031ffa787fff90375d4edf5efe7caa6837076fdce262131bcf98b38f2cd3a28fdaa2848218e945f3fee146083060adba2b", "95a48a5d76037356961400dcaf7d9bc7890ee1d97edcabb332998f4c36211130fcedc2b87363ddf2e7c3149bf1db549ca4e5e71ab9345bbd5cd8cf7b0b7c234b248b7aa5e82dfcc99b716797f8db6c195f0645f02d37c8a56196c112a552732d6f50a9040c831dd3bd62f52264ab59c14035612020baa048f11997db2551866030c0599c39261f4455734c41483684f8bf8a0f65255a763027a4b060fd9e42af50fad2e9a95f48e7cfa894f00466fe377f70cbaaa11ba92e3285baf48b7aaf196559a112dcfb028f888191ade4a637950c9432dba3c2f3a976f73299af0b7417358f6992b3846606c2c3ef94844d16b60e7b0f2119e66a77f18ed60ed49a7a545d1b87e3e1eca3fd904881cd9ae8276a17a8116977a67d02622b3891454bce0528744de54bd01e265ec3872b6a617ac6a2c8ce038fffb47f53ae26534eb55679", "b3ce486c4a1dda4bc1248691a57d9f1c31251710864c1ba62bf266617d3d25fb967d2b8facacf1093babc74e9b5b8f278081586ee6202b3189cc6a69f3ade2b163058451e123012c2b7e8234a6de8d999c3398e2539c0e858c4c4b87d44070d859c0a07600f97adafd519735a03e460883819d8df5df781078edbf9f9b73be55051e63e9016f089ccfb783acc39cd6232153b608ac39d827559e6b25f2973a214401643deaf459624abe80a7b94b5f4490c8922f443a8278210c65dc1a93232e3abc5300f1833cd7d4ab7ffe6bcd31340a2289c6c1959ffc7012d0221cd09ead6fc8d1450e38d450e66e9c36e3a3c7f16c42828cd7c96fc939b1fd62a551496f362442454d67eefe7d0c94f7809abcb096f9b445c76be277724cee43ca247a49", "a831d7eee9cfd5c9be850ae4ef319c761bdf99d8c74b7fcac0032b75aa3872230f4788accf33bae81d4944421ae2455a98c8a7e208da11ac5550dc43aa0b7f24d65801cff77f2eeb34d368c7a1feab0a561f0c0658e7a09f006e98cf18d784bb571e4b0d2cd7cf549ee7a27d8c5be64198c5f8752793b3e4296ce0cb14cff51321f078608fb3dd50546fc7b853c20d6a10322a1fe9a8bd43e91db9c897d16a163f1615ba3bc65a91a2fed75fe3e92c41995a1e10a01ff435a830c323f2941d5e2150fbf820d5a28194bb90120809f16f8be9c796551d7509f03d71976c77838e67a784d00c735b0867df9ecc260624c5ff24195278202fc24b7f915b4aff3a83", "8fe8b633feb51c12f855e64db9b170add25aad73962e4e4e2ff4dc13d71cf2798b7744e2f8f0bd1103564090cab8bd0da056d3cf0e9f82ab0eeae82bb55e4d0a7c2e0b287dbf5bef0cd9dc31833ed7b0bf11a22d0c5fea22c7b56dbd9252e4f1690949103e2f1faa3637a4789308e5f69c3ec529ef6a024885aa7028f2975d6e4eb91bc293a3919e737afd7226e8ddf8bd514a66fd782092eedefd0f4ee8794d6ef1347a4526ef797e05becd1ff8f7a651e9183f914ae8043cfe88b21afb937c11020b94a1073f7dabdc8678d889e94e1c1f8e3a7d718a2fbeb4b67f94d5b380"],
    ["b59746e48773a9d3975a3062a71e29ec8107cac56666d3728662dc99b87de18448dc37d026a4bd0da994d94489044bcdb04125dca3ca3dc61e03926dc005cbc3d4c81ceb018897323e14179294eeca72e084d93d2dda794cd20be817f33472d7039e6df58e52edbeef0cb853832606e6f1fdb82e36968a3dab0a295dc13df75b4bcacde169a402cce2377d578dd00f0bd533ca0dcc8ede28648166fd5208dbbd56cebcbc0fd5511a8b045ecba343b4963f6f41218058b56812aeb9b5d396fb4365c98c5748742c77de5100073e2fb80444a6588aecb2dc6ae7d3fdace1b170842dd5e36a9b40df1d1adbb218a0f5caae018553d7516ce5672458708204e1ba133d0ba388a46e5fa017bcc6b49b8d3e47b951363cf99c1e137ad6e84dfe156dd044e14a14fc322b515803dff17386dfb0cffcbc1c3c3593309980f118b9c3511613efa8cef99cbd62c4eeec8b59c99dfc02cede591026c10bef409fe758adeeed063c58f89aabb1bfe461b58684157483a87716cc39d515bc648fce74798b49e2", "b91a520ae634e71929ac13fbf3cc161e7507157fa647f128f6b86d6521f348781b1f0a441c4b9748c32d4fe30c82e67098ae75ac0ad0500cabf59228f4e6445ade417244fc3a46fbe59abb3f54a961a56049fd5bcead066c2dc444820fe8e758710f0d7ad89cf33a1ff36f12a3177db756dc6afd1d6a0eca4d2f0ee5764b03274e3e332679c31ccc268efc53d5ea47f126a88a1961d55cd26ed6b4e531a99e60108f702634ac406047e672ae16660c78caf0a27f7eabcbf1f2a7709eb688173f0a8ead56a080556db49a7c0c6ab96efe1b22bbe49b8d9b3315a58c9b494134c658eda7d0f33d59ecd0f1c91c682a514b19c202e7fdabfba7e4be92411c0af5a27033844a0cd5b0ff564ed4338bedb0222fc81cd2d19567b4f46b46eb2517bc1135b4dcda61e3bef48f080370be808e4f73833e16b2b6179d93d5bc741021a3b509b31a6a48c6323991d9bf55685976433d9da141548559cca7e96d58aa420744", "9058c79ac74d0fd3b5e117b55fadf8535ae952ea77606359245379304034684d39b3dac2d50f1babf7954c27aa3f61aea981bca92edbb31ff683678750d75eda23a5b7e2d333c70678dba9fcedefcc56e488c500e6974a08ab70ac82000994b54aedb0a4a31f1731a36d134c12b8275f0e8a3fc90e52fbb82c8872be36bf90cc065796e769d6eee0739674fa1ca5ca46a0e7887d0b6c15178148f226fb58424d4c693bc98279918aa5a2a00c7a6e696d7c40bc2338f9287bb25059e596d85e7770e8e7d83a9b19c8f462ca13b6e593b22decd95748bc3a946f45e8c452ce29670f6b7df4fd38efa2e2464b15047345835e5676668d92110e3c3ce7896f938cae07b78520cca0002d296eb8300433fe6934e6535d7930995be26d76b336cceb9228281095d968184072c29cc242b9d42dcbf1253843a7709950fde61911541238", "aa4b82aa37a643220951a25f5842567e5fe25af08538ecf0c03c89c0a1600fd0fc69d6f9dd38b75ae27656c2a4d14b2494d7ceaa0ba1501ab7ae55d955e776f5841b0c3ff4bed52ea852be3ed00ef0682170bdd5b43be555bdc209181e94fc521ca16bc1d6d84fc43accb3ef3ec9f6da20dddaeebd4103c2ac927e6a0699eb0e0e2356aec9f7211a58bd7611c3c03aa170e311c9eba00da36af7f02604a10cee590ad3ebdeeb5d9ff7c44f5c9ffef78bb7463eb4414599176891424aba7787272feb1bbef6d6409827b2ad0beb4d4de1183e71dae8b0bbb2476f2e697ac85afe34ef6677003d80915344f6a035009e558390fae45e8266c48551de621ce9e8ac47724215fdbf8d30225ee2b26dc52f7ab58197e7ccb5f60be95fad2fd6191c96", "901bb05a781bf16a082294ad3a27388b438d21baa2fd871fc6fb913bfc4d28918fbc9e58c339953386f18c59a75ce7018fb7559e2625fb27887e372c10915c667b1a265f719eb0e2278bc7251c27bab4f37ab05c3e5a789b2758e14f2265e5da4fd8993dc1d07f6413f15f656f5cbed369f2cb0ee34987f1f8ba92677c09d4f12f530cf9f7c3793c5623fa27680dcd7c8315d1e6465f56c5bf3db8b23f03b4b82365ac95abae83af5e1c4e3485ad36ff47e2f426a2f5941db4abf55cf24175f864bec6669193e79c3bd89ca148a7b9e4e768a699c37b6036ea0b6a2ed3c0592251d2d9838386bfcb663901b28458f3ead04143b0a6ede287c84fef3934c23f5d", "8049128ae7da626bc9a11fa983c5ae3bf90fe6c2e5d2e697381ad7be88a06d77c8589e5aca649acee1431ea052101876a2e59ba55cfbe42262987600e7976af539c8955699ed7a8c5d69476b2e69fd9b58fb8c1987e7b8088e9e76bb82d746bd5a742d9fa9206739df7180b329a219d28e473bd65fa1d192f0269ef6473c2c015d196743d4b25ac5b079ed441f2d34a7753212e2576278898dba40835a9dca280ca49e976443d937cb3198f3e84c425211344fd01794155c49d87f55dbe7740b54a952b0976423ce7600861d2c555b8ad76a005567acc851b00674c14f69d869"],
    ["aaeda7b2a92e3846e25a55b36510bec33ed270b0a7389f3835d6e626b24c8ff6ee40bf5953f887e7fb7f65cd38af38aca0c75fbaa879724b64c8892441e9b6654f05151cb7fb4d195d918a1e30eb74589356d79083b13b2c8d925bfdce0ba71844d8e9ed91beb1f7603e4c8761bbd17c8bc57356e2d5309bc8650845df5bdf2d668b42e7e7a3ac4f1fcdc1bb4971536e8811a839c38a41d779892fff954ade563c73f7c99d1d7830533c5c4f46413a247bfa5dde61be4828d9d112a2c6e6049f03ea3716ca6f819cd05f1e8bbdc5c7ef887810ed6e833ecc649956454f0c8b0b374ce533c58250ba9bb2b80d48aaae461c988eeb6696188f1d05fbfb8a9a017e64a08fa14e8ea4ab6852673c6508bf820c4c4d7cdbee9d6cd80a1bc4dd7f80f86136d43161544d3eac556c24a707bdaac68bf75e4245aa3ec540bdf0278f794a2606ecbbb33dd58b60119e5298573a646edebe3f556bd0862b38b22d6e6a36df04bca59731c0a380cd371e51e34afa19808c5d5fc17ed0fe66668cd1850ee0b3", "a0275e6a1f8987da07fe9ef7881f5330dbfeb49c9a56dbaf5a560ddd5e7faed9b1e75aed15a7b03626a631f4cc25bc238ae0c0f6e4d2a4f197884aee870d8e56f8cf5d0c9188f0fd380f9554b63eb117a67b45cce9c237e9e0edb4c8cb811d744ba3b1b3f29b8ab1e6d4a9a099a1c8155fd0432725b9b19ad3fc8a2f5de947ea2cf0cbbd66f1c2d53a5e34d7b8faa101067306173aa04c831e60bdf17b5909264a21acec3e7b2baff1ff3a80c7d7b517735955e7c8abe2a1b41c84bd2c7c9f2328ca1d58a8862c33096165ac31a8744bed9454a93ffd9462e5325911c7d958413775d1c49417dc33183a92b2c97ffeecbc8d23ddcfc65d43dd464928d2c3c0101e6f0ccc43288eb54d019737743ee75f3e6e638703b243279461849a1b0927432ef2278ca764b6e78bbb226e0a075813305c8e9161f51296ddc8585b254303ee70178ba0e957ebe3bdd21ddbc578f07f421e4a4eae8e7479afdda5e66f6a3fc5", "80ef2c60722edbe5efea5a3b72c72d63fe7a92f5aa428f1c1cb59a8473df32b6630b06e95f39f34dccb654b60334264db09cb361b51f0cd78719d8b1e59e0606a999f9c1b30f31bebecb807f81d2220f70d4a454b399aec695d51d485294d6910a11970bf2a06231c6fa0836d8d2b8e2fbc4f8e7c61692a82d5ae21fa0c45d53661af7dc7776785bb1b7a9d3a172e0d492a212a57c1da628a06ce68a561817804c0e930b263a70b9d1c71bfc12924f4cc8e88413f7b1c3a8a6e40c8fe581c35903b2773798eebb6c769fa178477dea22e8a16f65fbcc4bbf733e3cd2073be862618469115b4c7c9ca29f92aefc5d6871e36f57d459905cb13a869d748372dc464615890134e1c4e31892e01a4bc99a39ffa526996c5c7d14881757616081e5da5e7edb78e61c10267e03e9c3784060b45206170c8ad3775ee2703f916cfdf5fc", "90fbcf9c3940b54062c03b7d9facf2eda7d9d6422c721bf93f33f3164100de8102b07e53be1e0ea70e38fd1d5cb2c3a381f425ffc77f7d6105d3c76f72d175a48a1656fc735a65cb622cc70d116c924ff0190ac8d8901fbb5cfed73aba4c9f2c5bfbe15374c81b6784a701e948ffc2f9cab0de759ed77634b5aecbd75242c1621430d6e22a835cdc25852aa49da925d27373b65c8888a9e778dd961a1248b64309900f8d22271fb751c82dceea19a28b42336acb71af6362ae496d996e29ebfc0b26c56c148c62502ed0d58701f73c052be3db7ffb407ad5951103f6a019d9486e71e104344cc9ea26e60ca92e52a3bdc97a4eafb5c12deef79e2fdd53c6f55f6a860932e8b0081f159326009c04a2badbcb28a02146cf4240ab3cf29515045b", "a62803a838699ac9cedbb9401fb6a9a503dbbf6da2d8df38e5967e148e8dd9e4f3151c965e11981c562ee5b4e5f0dd519762565d819d7f261bf308d8991dd54ac3bc711beed7118889ebb41da1597ddc65638c5e3a53975139864615de94b25f3ea0e75689cd2511548cfa5e47fd72d1c0c44508282ed2bddd8e8fe1928e6bad6c17d2c1e7d75b43f125491ed3d74ac107888340b44de4c398822746b612e80e03f49e400947390dcc5f2c3febc040c7f88cc8fd6da6644c3a1ab9e69d15241e1ffcc26c2e2bd7e7bc258dfaa1188e393e75dff135a18419cb8b5589740a9b2c021b6243e811953c1c9a7478c1bca29de94349f05dbaecc4c5a07d859c99a00a", "939c62edc908d303483cdb06c93882e54b64a2b2edc024b6100fc0eebe180aee74eb69b99aa5b3fa0bb4de2a8e643630ab6dcad0bd48d581ad1285ee57757d97935f868b1d6898e2b1720b25b3b0491a7bd13a5244ea4432068359da8ff13d9e356b9c841cdbb9f0ffe860615fdec8fbfb26a6c0356b5991eae584b12fbd78d80c489578065c1cf55ab5ead70119569cc87e0ba30041958e30dd68efe036f0181956bbc6b0910ee2f0f50bc620ef831cb84010800e1619e6c8b4d3886d65917639d3a1eb89e5ebcca2dab64bc5cd7440a321cdb6a84ca0a08e3fe4e83a6c051a"],
    ["84ba2c35ce8ed184947653b8592a394c4b6e913ef347184aba13ec742b3013052174910f2fe2ec4eb03cc08b17eb47a2b36a37662f1b4a73db811c9134fcba945626e078856882ad285f6cbaa4d8d9fe2a162a74dd9beca74f119facbd0311f60019ebf7b9844f228492ced211564863753a0e0305be04c22167014432017f93312846e5f4eac3d88b726c78c4da2c2f91c851928ea6933d3ea77f5616f3c9126db4c932a3ee86cbb81a87832514617a0cc291094c704d93491dcc1af7f4902b164da60909d6549fe1b39c5602d45e4aae1f2dba78f5d9c6f0d2f6bf6648f3570c67b7b18cdf2032ce9f41bdaa50ff23bed982ddb7643ca8a88d5eb39cc3685455b15323747f92682192649463cba6d3bde9783f11b42fdbea37ce77345da28d180a4f66134ac3c1b5cc2474b854adeccfaca4f170308cc4e6b69dbaea68100714ad3095982039891ace1bc09d971e991784c677a357fd77a126977ccc95f99f0c349a552b57c9b97aca2a3625718284f094bfb754419874b900dc19151139ab", "99fa5751c377d6a06cb32a931d97d6778c64bb68dd6c094f4aaa0cd23cd2dcce40b12a2f42ea46a3c9b6f8dbd5b20c61a671292bf55fd4fc2efbf764eff8e9e78a35ad5f89b66e150487cad61593133d7b8a20943f9e5ceafa8fb986fbf9fc9272c699a41f320b431d78a07523f537fb105c8dad3e61f73476eee1d01dff95fa42f30520b9400fdb2124af5d0e16e98efa11c21178c893463355204ae7d329116bfc868e28f51cbd569fdd3d56feae8b82cf08e4ff98348b1cf61bb64a234ec23c1f95883d6633a290f77815e0f0b56c1794f9b821d0ae1d202eae984829aed41b8ebb52fe74517722942bca67dc92f64798496d5edc230fb6aecb14a4d4d04e3b5836697b94771a80ba120f066fc7d1a5e96252808f383fa4521755a1d2fd0f382db311dcb2919b20533c7a96bc99e80f69d1ddd127becdd15437df4fc521f4310d9f2b17fd0e1c663dce6fd2f6f3f2f240575060128aee3ac5f9feedad37ff", "b462158add002bbbcfcdc90b4df7cc3b788a545d8d2b4d0ca29fc845b0b9e5e32c6e0b8cf769ac7c821efc0edaa7ca3a80e4bddafcf46cc3ad78026420e33a132719b9fc896867f1461496f491bf5df55aa8f544e3dc406385473ae17109672820ed1d725781956bc1f27020d29665ce22ee65afee33bc9d3dc6b7ac44a34f796efe11632cc1cdf8803ecc16d26e3087f0bac6205a5efc374cb2a3da879263116708e2f6595a433e4e158019380321a551ff79c40041241c961ffc86697d293c07e360c67f5d2ce236a7a33c2359d14feb79906f77a795d91cf2983e71c1687928ef92aad01a94525507a15bcf43885d762c03ea781e6a222ded3f89d806709a5fc62f671a6f096ec37d388b92393f140d0bf2f97107105011dc92b694118cc80f3ab91694c97539231f2de64cd1033e2e199df6400f04a547e2f373f7034602", "a1e94e26184099aab178e3559c51c4c9ce5de5f87ceb3325ac1283c151caca07053cde903aeb420f709eeedc5526eb74926e760d1583a93ce3d21fb139da6cfffbd84cc4f12388473514e37add56d68290b3d9cc73574bc3e5fb26fe6203e8d26729fb69945be84d354379de949a93e93ac8d5e0fe601da687daec3c985c9fed349c8ce9883764d2ef3effae7302a540c4a151a16f500ee8f1d8ea154beff0d55a98977f871dbc3fcafc182360aae6762dacb6599dbc85b38d172361c6ecf1ca03d89e2db4bbba69297dd1144c2a0298b7079a770425565df47139d887321c622962757b1459f3d188373befe6633b6b50cf2819e6f770c70ffa73bccb3bf73560ed63c14921ab0c3a3614c70d371d3be3822b69a055e46330f627f199a34e71", "8b2db175ce2fe59bded739d11a59efd9033e4531050d931382e9e3b3e3d242053dcedb57ecb494f35894ad86ce00e7138a97f5dea6a46f6af7a153509b9ccac3b2984164af3bb4e9bc5894e7a7c2fde7957f471e819272ae5b1f28f955069c12383ba0c4d8f63396767a6c6416efdb4d90087cb8ab5701a64dc9c45f59d64bba4ba86e4a7020cb6481c64bef914462aa8077215dd3683fbc575e1cf3fba3ce340458d1c5ba1fe12807ee0cedab32c0147a642d3c0df122820e8adbbf17fc5bfb6b9f45912f25f1d292f0248e215d7a6d37e5025757ce6373bd137bc22399cff63ed556f724a319ce9a655ccb8efb70e4e546271cc775087c7e1e9f3b7a1efbef", "97fecbc46ddae7d61f0a23101a16dcd80f1c73aa7a2b0d0f253a8a2be9d44a063d2744b48e93b414a1ce1794adc209549620e6d23d457e73f68be4587f680b37cb2af83d052dcedf5754edd3afba0513f6777f562250a66063c28296113079af448544652965ddf37df8eb6629017a467ee83cb97f8da2a87653db69eb88678e68c5f0dc95cb994a34c64087b6295354bfebd39bdd5c88947f595ff21623577b258cec0067630ce8abdd1c1ac2ab9ec596f82670039cf06ef7576f641612e4ed3e9da209d8026ea19a0831e50a07280cd6cb7505ce7f0594433bd4c90e86cb58"],
    ["802cb4eda29e379482c66d2861bd1e2baf6538a4b1994537b61e877e5f079034f9bc153cf2d09d6139d2bee0ff2a25848ae2f5f12e40c0696f79bebb35c54754a2d0dfec98f92e98ea89b4e08dc7702a40c4e956d6a3bb1ffb8182e4225913c60abdab335bb4edd070c771acd6be2f33e43fa7a321cc41c4f9e635cf548e599b22a98f52df87ebecf3bfdc4309697505c32f384298ee0a28f790d2db1a275ad327beb1d1d871c5dbcd1556e5f127857e955fe582dda255955bd42517c278ccfc6882b507b24e5587a82a56d2fb98d5ee6f8c618e5a72320ed9112d7a58fabc4046aa0f1c2c9caba54c17bf34d6ea59eb92e74c609b6f1a91f9fb3d6b20dcedc727d72a4e312461df9c8623372be0c16b20128a542bf7f7e826fb765c2035c14614772e8b8a2422e04b7ef184af7dc00c0e645de5e77c1f8467e347becf366a6c313cd56573dd89e8465813587bad0bf1b02b870ff2dc38b3a981af0bec501dd3208c5ca8e0c5a554b6ea55a151e4e7ae8d737f5b824d06bf1a6ba8ad42eb11fd", "b4d66493cca9b58ddde019721f73032a5ca148739fa01a56c92b4bb4116f041e7d02b95fe01be70448b8fa5f03023ecda09426c165e78aca459a0a633d7509994fe50c259d91fcebb5bffcdd0f04d51929af0e7d020902c4e3f37311fe99257622719a25a1c4abef382b5bf9a7853c950206a5fd0c2fd420d5440f228e5d50176f183cd203a74471773e9fc9bdc17d619995a98608a303d455336a7d943b294d69a3f24a8eac2b3eecc494b550e4e495b0213a98d34df9aa9fb247646f63217f478ddbfa452bc882b2055c896de4cc9c97aa14db99a9395e033c9817d34fc3a619a47b03fd0dd36d0cab28c332fd7f0d6bd2644c2efd898bd54bacc103a38f306d6d19a8944c65375ed60c26e96dd16b26ed80e488a0ee54821bda93c90f57ad64eca3193709fe9cd43d1614db8998203f5f99c2af989ce1afcb012fb302ffe06e4e6a0c9f8cc1c8522811492570d4c9b7207c83de4f9fcc1171979635cbaf98", "8d0e45f0e9dba023233faf7cb9cf195e3b55ed35276acf5a2e5a274f4a6f44e660de2ddb27d5e2d880dfb2873767265d925ccb0bc9b4b8fff0b39687f4cc274ce2204f1e114a6d18282aa755fe185f902e6d443ed9602b64beef9bd96ea942094760aa720f57f4c2b1ed63fc092446fe68724a72b927fac80204409578ca663f0c65757e3e1e5d1c3a18db7e95575bafc69cad3f2c9b0fcd6513aa3dd611cd71337f9d325b85c603e262928062a8fddb0d56f56c703ea7aea2ad615c11fb69716dd4c9021bc0c60cfed4cf44d1008cf037f9717a80ffbe33ef06b5e4af6d3415507a59608b9ebaa29ee1f7db64cc43a59f549859f5fbb31f1c758f98c92f7d4a41c74e90d1f295641d7ab4e5adc2ae8a73aab988359b61f06fe280346b3f08f94e384a444b93cea2707fa0e132ec780ed02337e852c435ee77bc94ebdd8aca64", "8e01047b8ad112ab295d15c81417e377319206836c13cc7902a65dc98caf702f67bb5d171f994f267b22e18fad7e1931a6af6d60217c6ebcaed210907e3f938909f1e44188116f15293717ae613eeb5d39ad3164b04d1dd595fd6153af4a77ae1faf6034914e2e459fc7eac3d4950e274d04682228e8d0b15079498bacd212a8227f25b7dd9e125aa193912a81d77ac005bc71e05d575fd0828db75ff1040bc25e9cdc826a203a077dfd59fca4d2036b813b3b2705950ef6c392ba80e37c81a038ef08b13dcf3926956a4a9c3975e66a05174885a38b15f42c1bbeb8eb50edb240542d3aa613aff0fdfc89b157143d5b0b54020c6debc0f903426fead080697c6a6c8cae9b1523d767b2f7fb86692e77df626ec334acd44c396719dd8eb8f8a5", "ada1fd30c9dd36ee0323df392003b7c53c1e91460c7ddb9e2c3109017eeebf3e0abaefed6ec83fbd385d98ef30ed066b894be2289ed4ba61424130e3c06f6b40c25e03c532bbd40414e58809b34a0d063d1218ad3a4ac84714a8d216edc108c80eabc1a315ef4d1620e0c6561223fa4079e4bd19f0305a0d34b26792c88f9ae669b4469bcb0483147ca8cdb167f67962f2b7060e2f4705d08e04f381a00a0dcb361bff17dc68ed744e79b605ceff2fd83dec278fa808eb8f14a07f7c13d4c6c9119b196fc16844f8f6dfada7e46602cf4eca33b0e02a71671446f621baad139b449df3a38fd5837e2baa21654e2157147f7d7a2a20a28cb4a289ba2ddc54afc3", "b9fdd7c6fb8041cba708e4f75b3e0191ec414bb74302c218e93ed228501d8b6adc6218e86696b3dfd24f856497b96bb68133c88509d138b7095d419d0481027e06eab87da1adec83f88923d4be7530d7deda034f11fe83be93efec22aff77f8a2892eaf03075d15a94d3af9859d4d7bc351d2dc4011e49072d274c6586e87a20237fbdfef1bfd0768a3ef077fdadf1307c2035384f2503623961710f757260c10575ed9b037947982b9f2fada9e0ba35c1dd2f65194cb480e77cc3d4f8454c876d670c0ac3c54d29897d30bb45fc5fd282cfa84594d4aa67fbdd0e80a86942c4"],
    ["972e6ee1034b90393af38ad6057dde7cf1015bfa5f78003211a641712fefe609b5e31638053444dc54bd4236380ac5b5959bb1e9929e3633826d97718cfa50e76af3a5afab96231b5adf2f83286f68b1c52d83c96e44f5424db182ee01485bde6e1b902dd5d5f95a0e21ae4c634bd4cc24dac7080fbe6733fec561d0f8e0a554449ce408cbf7631bc5fadb4519433df6d123024a651dfcdb272b40ad5bcea2fa10f55af1417d24a7ba77f310faeda02d1a21fda26047ab6c47f405508212628c08c2ba52bae886206f5e7f54d9fc5a8f498ef24274b7f311beef2a3502c9a57e661b6843a578cf7a54585e7541c2f695badf461515add1df337ae7655d808ed5030fa86e9f945cbdd6a52452f250c90d0aa8b07dcea1c61c4407055788e341492c865818d7feb5a0590fb5e1bc7f59ee0f9622076ce44d1da37848b61cd399bc56874d707f253877689893cc0cd54cd60f29950f14c120412c199c366c76670e401eb6d7742565907f66803ade81da4c1c3c40bd385fe9a21239d51f838bc28e", "8e93fcb4fbdb110900f2321cf5fb8efe52e1c93394881b6af48037d5e9f5b0203147fe6101cfe48f4c4f52e230d96e8ea1805233bd7d1220e475d31aebf7465c2593ccc625b383f86fa8b4dafd1dcec6c71b489e63d56b375eaad99ceb022e9325ac434627ba051522a5cae8eeb2a2b9644a895bc5289d24d9094dd06f76f63f52cbd9dab13098298b8a2784ec158e5e0a44d963ee1b4839552d4385d57990b458fa7620499ed1878e29de7617b3888d46e7320a3c28efd58bd059123bae31ab153d71ffaa6d47c70c266f46f7fc283d5be8c73fbb98bd6ffd36336f4d20fe2f402df53e51a97dc9dc4e0716465153954396860821b70b2949cb067d09c0f2e359196b4dfd42f6e2576e8e515de7d21c51eecdf2aa42e3106658fa98eec62b52379a46fd7274b3c3578e27c5bd9b13f6c86735c8ff90d10676a192c3c142387a4413174f9ec72d0ddf553c6b79a8eede8e0426580a3161c8654226afcdf6af5c", "952a205c92a8cf0062d1c2895135c8f84286a38326689f8b44597f1f68a4901a6876bc9cabd31a9368c9cedd812733c5a03ef3ade171f752f0b8cd378ca1949600c8089a505bf514b3acc239421a9ce3b0ad8485351294a715fbe0d4016d605820f5d71934cb79b9578634e44cf6a8b2ee5266fd6626e08784a1b43814ea69ad35280e21faa644b8f05956aa676a8fc128d4f8bc318207f790de88e53fd0e038280b3df7e25e0f9c7612c96da7aad5b38361eb1a8ce943a8aef1ccd8da358e1d4a5bb60a662e983a626681e61ca0b8d9f40f32a249513db059a912bd7a3596df1684e7904ffba41c95ab0933b48570883a70140a4498de4d2acb79f296f769fe49385b8c38e0b231325c2857a6b70e390f453e255fbd682387f5cac8cae199791fd3050ac029437bdb73054dd739d00894053dc87ab915676a5bb68afec76095", "83a8ade60539e1d7da5b8b6f88b0fd46cf930dbf23ff33ea30aacf58acafcd93d983ff7e7459f6047122cd5fb9d74f02b039de4571555379c97324ef76205d3fb1f9c6f31bb36edb67148d4d7092ebb9bd26fb41de9525ab96cabee60b1e5cf0666ac024e1a02c7a355645398b2f101f2da1140890087b8dc7e8cea35008fd2e1b223dc9e9a44265373ed83977ae97e42a5478952c77cbcb58d4f982746e89fe703ee6627efb2ba8bae5d1f6efebf3ffc255d44257009bc1830bfccdedd9ef565324c0ebb7faab475347d264c817a305383b71b78a4352971afb7db4257e3e743e33e71693b004e3c93f7f62e55a619ede234d2c0f117c864e4a0aad88f06f1d1be1d524e3ff7fbdd587a3584d5c9a58c31ae3cd177a1e71a56b58e03cf001e4", "99f1f0f5c4f6b48162929a01112b3ba914097e395b95350e900b0327a68ee72f30bf2ddd4909ed172fb2b8ba7b373955891db2a634bd1b3a52affd16418c8b5da073cde5d31a6271f6b8d6dd1d754ea6d933132c2e976daa9759348eae96e4656a6c609392cd52b39337c3392444ef2748a2a34522c183b3285acc9deae2148b0bf093b031f61b277ce0294c89eba55abfe4ac925f317184b72e4a87f32e861f5f4b15e2c938d8109ea22d7b470f80ad7cdcf297003ca5b3e630526fe60ddbb92dfd534a66f935984fce7046c6d22431546dd83898b1b303dcb8e7508582eec753895775f7b591df22531008faca80491a2745631dead7d69a516f7d3ff09e06", "9814845dc04cee096f3fbf9b0a652ddc6892ba0138fcdd9dfe0a549cca8a639cf60dac9660e526ac9738673e1811b1d8ade080ee00b60d92788a1d932d394a55e3c4713fa00c4514da918969d44e8540e57e0e9fbe930aeabb372406b3ad7e580326b785230f62db520e1c472e3b496465aca8ba0903e2c2d336100dfc6444c9617ec7f4547732022a0a4a085cad324988b7f55426d7c303700506bd5920b1ca17863d11ccb799f8726cafc29c0dfc56100e5b6a8c691d7ea11493c011f0f4f34db58b8345d67ce660c70a50e04eb4550dbbe5780a4e6633e8588a1813d4e4b3"],
];

// dst and seed for the mocked rng used for proof generation.
const MOCKED_RNG_SEED: &str = "3.141592653589793238462643383279";
const MOCKED_RNG_DST: &str = "MOCK_RANDOM_SCALARS_DST_";

macro_rules! proof_gen_verify_e2e_nominal {
    (
        $sign_fn:ident,
        $verify_fn:ident,
        $proof_gen_with_rng_fn:ident,
        $proof_verify_fn:ident,
        $ciphersuite_id:ident,
        $expander:ty,
        $expected_proofs:ident
    ) => {
        let header = TEST_HEADER.as_ref();
        let presentation_header = TEST_PRESENTATION_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        for i in 0..TEST_KEY_INFOS.len() {
            let (secret_key, public_key) =
                KeyPair::new(KEY_GEN_SEED, TEST_KEY_INFOS[i])
                    .map(|key_pair| {
                        (
                            key_pair.secret_key.to_bytes(),
                            key_pair.public_key.to_octets(),
                        )
                    })
                    .expect("key generation failed");

            let signature = $sign_fn(&BbsSignRequest {
                secret_key: &secret_key,
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
            })
            .expect("signature generation failed");

            assert_eq!(
                $verify_fn(&BbsVerifyRequest {
                    public_key: &public_key,
                    header: Some(header),
                    messages: Some(messages),
                    signature: &signature,
                })
                .expect("error during signature verification"),
                true
            );

            // Start with all hidden messages
            let mut proof_messages: Vec<BbsProofGenRevealMessageRequest<_>> =
                messages
                    .iter()
                    .map(|value| BbsProofGenRevealMessageRequest {
                        reveal: false,
                        value: value.clone(),
                    })
                    .collect();

            let mut proof_values: Vec<String> = Vec::new();
            // Reveal 1 message at a time
            for j in 0..proof_messages.len() {
                // mocked random scalars for deterministic proof gen
                let dst =
                    &[&$ciphersuite_id(), MOCKED_RNG_DST.as_bytes()].concat();
                // number of random scalars to return from the mockRng. Note
                // that, this value will affect the value of the
                // mocked random scalars
                let rand_scalars_no = proof_messages.len() - j + 3;
                // mocked rng computation
                let mocked_rng = MockRng::<'_, $expander>::new(
                    MOCKED_RNG_SEED.as_bytes(),
                    dst,
                    rand_scalars_no,
                    Some(BBS_BLS12381G1_EXPAND_LEN),
                );

                let proof = &$proof_gen_with_rng_fn(
                    &BbsProofGenRequest {
                        public_key: &public_key,
                        header: Some(header),
                        messages: Some(&proof_messages),
                        signature: &signature,
                        presentation_header: Some(presentation_header),
                        verify_signature: None,
                    },
                    mocked_rng,
                )
                .expect("proof generation failed");
                proof_values.push(hex::encode(proof));
                assert_eq!(
                    proof.to_vec(),
                    hex::decode($expected_proofs[i][j])
                        .expect("hex decoding failed")
                );

                let mut revealed_msgs = Vec::new();
                for k in 0..j {
                    revealed_msgs.push((k as usize, TEST_CLAIMS[k]));
                }

                assert_eq!(
                    $proof_verify_fn(&BbsProofVerifyRequest {
                        public_key: &public_key,
                        header: Some(header),
                        presentation_header: Some(presentation_header),
                        proof: &proof,
                        messages: Some(revealed_msgs.as_slice()),
                    })
                    .expect("proof verification failed"),
                    true
                );
                proof_messages[j].reveal = true;
            }
            // println!("{:?},", proof_values);
        }
    };
}

#[test]
fn proof_gen_verify_e2e_nominal() {
    proof_gen_verify_e2e_nominal!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        bls12_381_g1_shake_256_proof_gen_with_rng,
        bls12_381_g1_shake_256_proof_verify,
        bls12_381_g1_shake_256_ciphersuite_id,
        ExpandMsgXof<Shake256>,
        EXPECTED_PROOFS_SHAKE256
    );

    println!("----------------------");

    proof_gen_verify_e2e_nominal!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        bls12_381_g1_sha_256_proof_gen_with_rng,
        bls12_381_g1_sha_256_proof_verify,
        bls12_381_g1_sha_256_ciphersuite_id,
        ExpandMsgXmd<Sha256>,
        EXPECTED_PROOFS_SHA256
    );
}

macro_rules! proof_gen_failure_message_modified {
    ($sign_fn:ident, $verify_fn:ident, $proof_gen_fn:ident) => {
        let num_disclosed_messages = 4;
        let header = TEST_HEADER.as_ref();
        let presentation_header = TEST_PRESENTATION_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        let (secret_key, public_key) = KeyPair::random(&mut OsRng, &[])
            .map(|key_pair| {
                (
                    key_pair.secret_key.to_bytes(),
                    key_pair.public_key.to_octets(),
                )
            })
            .expect("key generation failed");

        let signature = $sign_fn(&BbsSignRequest {
            secret_key: &secret_key,
            public_key: &public_key,
            header: Some(header),
            messages: Some(messages),
        })
        .expect("signature generation failed");

        assert_eq!(
            $verify_fn(&BbsVerifyRequest {
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
                signature: &signature,
            })
            .expect("error during signature verification"),
            true
        );

        // Start with all hidden messages
        let mut proof_messages: Vec<BbsProofGenRevealMessageRequest<_>> =
            messages
                .iter()
                .map(|value| BbsProofGenRevealMessageRequest {
                    reveal: false,
                    value: value.clone(),
                })
                .collect();

        let mut revealed_msgs = Vec::new();
        for i in 0..num_disclosed_messages {
            proof_messages[i].reveal = true;
            revealed_msgs.push((i as usize, TEST_CLAIMS[i].to_vec()));
        }

        // Modify one of the messages
        proof_messages[1].value = &[0xA; 50];

        // Proof-gen fails with tampered message when we pass `true` value for
        // `verify_signature`.
        let result = $proof_gen_fn(&BbsProofGenRequest {
            public_key: &public_key,
            header: Some(header),
            messages: Some(&proof_messages),
            signature: &signature,
            presentation_header: Some(presentation_header),
            verify_signature: Some(true),
        });
        assert_eq!(result, Err(Error::SignatureVerification));

        // Proof-gen succeeds with tampered message when we pass `false`value
        // for `verify_signature`.
        $proof_gen_fn(&BbsProofGenRequest {
            public_key: &public_key,
            header: Some(header),
            messages: Some(&proof_messages),
            signature: &signature,
            presentation_header: Some(presentation_header),
            verify_signature: Some(false),
        })
        .expect("proof should be generated for tampered messages");
    };
}

#[test]
fn proof_gen_failure_message_modified() {
    proof_gen_failure_message_modified!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        bls12_381_g1_shake_256_proof_gen
    );

    proof_gen_failure_message_modified!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        bls12_381_g1_sha_256_proof_gen
    );
}
