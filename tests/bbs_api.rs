use bbs_fixtures_generator::mock_rng::MockRng;
use blstrs::hash_to_curve::{ExpandMsgXmd, ExpandMsgXof};
use pairing_crypto::{
    bbs::{
        ciphersuites::{
            bls12_381::{KeyPair, BBS_BLS12381G1_EXPAND_LEN},
            bls12_381_g1_sha_256::{
                ciphersuite_id as bls12_381_g1_sha_256_ciphersuite_id,
                proof_gen as bls12_381_g1_sha_256_proof_gen,
                proof_gen_with_rng as bls12_381_g1_sha_256_proof_gen_with_rng,
                proof_verify as bls12_381_g1_sha_256_proof_verify,
                sign as bls12_381_g1_sha_256_sign,
                verify as bls12_381_g1_sha_256_verify,
            },
            bls12_381_g1_shake_256::{
                ciphersuite_id as bls12_381_g1_shake_256_ciphersuite_id,
                proof_gen as bls12_381_g1_shake_256_proof_gen,
                proof_gen_with_rng as bls12_381_g1_shake_256_proof_gen_with_rng,
                proof_verify as bls12_381_g1_shake_256_proof_verify,
                sign as bls12_381_g1_shake_256_sign,
                verify as bls12_381_g1_shake_256_verify,
            },
        },
        BbsProofGenRequest,
        BbsProofGenRevealMessageRequest,
        BbsProofVerifyRequest,
        BbsSignRequest,
        BbsVerifyRequest,
    },
    Error,
};
use rand_core::OsRng;
use sha2::Sha256;
use sha3::Shake256;

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const TEST_PRESENTATION_HEADER: &[u8; 24] = b"test-presentation-header";

const EXPECTED_SIGNATURES_SHAKE_256: [&str; 7] = [
    "925b257838bbc46d0927538e1609867dd563550e9daade709ba0b1b4642df2a1da46c481de8c44184163bd164cade2c75911e31df92a04b8a825b10275109af76f6d28fed3e8c40a7d601edf870d7899",
    "a6324bccce90bd0871d5a8f56bc32ab54fec4f58a7f36cad92d2fd8d9291b0ab621f9a636fbc835b1aa2fdb6ad7c9cc25d01fdec7e0307d844cf9d70daf0a2a326eec716660a96536bf44b6036a6204e",
    "b58586b4ce4114cbe5b2de5bc49d85d4488744ba6968e95db902c7b4489a42b0217dc3b6eabb4846f1a7382bada4778f6f18f64ddf617916a41a84ef855061a6d730b0a3effff64c3cd05ceb166c6a4e",
    "b97bca812bfe7e953fb59c3fe02cf9045d6c0e5c5ae411b83934a0f512fed68695db5bc5df8f48ef87cb13179fcca2ce239dee06d49fee691ef1aeba52992a02ed506ec0fcb404a3096d1a143e1df0b4",
    "804317f0ff0ede4a80125973f6a6d43fdb8a90f3f1544c64be977ac2ba7ab11881198a9d281efca1ca6c7b3ec279873f6c27a34d4a9ddc35ba4d71274a6050948bfab65d967fca4f5406774a045b4088",
    "af9a76d7cc2ccd9687ff7bcfd49e5147a81cab7b66ca62f6ac294af3dfab30eab610f98b1b3e62932940797ba520ce9c51517f7c75fc928a0a2c3be28b292a2f110c6baf80b025793669caa31667fac4",
    "8df37099068494eaeadae4fd782cf4aa9cc3edc4481f984ee191c9f22e42670d1235f823e8dd84f13d06e88bc8290df24315e390ec9b13d686f149d798c67622083a3ef2c3aab4c84783a7fee591e47e",
];

const EXPECTED_SIGNATURES_SHA_256: [&str; 7] = [
    "b5947ca9b9130d615eff12404b003de2517030eff82367c0614cb158cfa21b810b88ad9601a48b502042600d3110fc04279cb622cf7992d294d416aa26b433f9e0978fb532537385fc3cc4c4e68e487a",
    "8717c023ddbe6a6505608854da26fe5c84a679356dd054c92b20e2c5de892fc7e65aea1b6dcf2a1e056a4d2c16d1144204272a16601bb9e0b9a3c2d6c4c8a37ad6c9816115ee6b11e13941a834d53859",
    "b11e5bd9eb8bdb7b79ccfe753de91245fd7b1eb8fbb84499de07d4a4a0de8d4e19cc768c6300a70f411d31d0b5b973c52c4ea1b05994f6c004ca80f5b8c71bf5a7e09093c9a0aeaaa7d2d5380b410e42",
    "8e1c9c70c3e5abcb58ce169fd39114ea4e5d09db01fc874ef5e9a38c32aec70671157cc2e1bce8c54d6e1dde34fe50094170b4057104603bb1ca3bd443015d7d13e580e0ea3cf449f038ee87c35b5128",
    "b5f960170b87065ae3080d8180ef203bcba1558cdc3b7158b0e692d1dc25ff9b18c38c92eea46d811eb5fc387333e80b20f2fe33f194a747fb63505f1a489f9eadd29bc65176c96b1436ae24184737d5",
    "b957bd6369fbfb4833c736ef3ca067fcb1fe168cfe952766fa296486e8ecfc972b0b134c1790b040b91092ca94edfb380666b0829b92c80038f5e8506dd7014402618a534e85b0851a96eb0001cd8ea4",
    "82a2c8b379e4e3e82a814f83066e52df3c724ae8ddd7fdba924e2bf24f25a0dd11c0f670171466ecb9241d1759c1244c4296f609f1774a6dec4623cb70c56e3870e8264aec6a846838bf18b40939c24a",
];

const TEST_HEADER: &[u8; 16] = b"some_app_context";

macro_rules! sign_verify_e2e_nominal {
    ($sign_fn:ident, $verify_fn:ident, $signature_test_vector:ident) => {
        let header = TEST_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        for i in 0..TEST_KEY_INFOS.len() {
            let (secret_key, public_key) =
                KeyPair::new(KEY_GEN_SEED, TEST_KEY_INFOS[i])
                    .map(|key_pair| {
                        (
                            key_pair.secret_key.to_bytes(),
                            key_pair.public_key.to_octets(),
                        )
                    })
                    .expect("key generation failed");

            let signature = $sign_fn(&BbsSignRequest {
                secret_key: &secret_key,
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
            })
            .expect("signature generation failed");

            let expected_signature = hex::decode($signature_test_vector[i])
                .expect("hex decoding failed");
            assert_eq!(signature.to_vec(), expected_signature);
            // println!("{:?},", hex::encode(signature));

            assert_eq!(
                $verify_fn(&BbsVerifyRequest {
                    public_key: &public_key,
                    header: Some(header),
                    messages: Some(messages),
                    signature: &signature,
                })
                .expect("error during signature verification"),
                true
            );
        }
    };
}

#[test]
fn sign_verify_e2e_nominal() {
    sign_verify_e2e_nominal!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        EXPECTED_SIGNATURES_SHAKE_256
    );

    sign_verify_e2e_nominal!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        EXPECTED_SIGNATURES_SHA_256
    );
}

// Expected shake256 proof fixtures using MockRng.
const EXPECTED_PROOFS_SHAKE256: [[&str; 6]; 7] = [
    ["83d7301474943bd266205ae40b3eceb41eac94c54cee21a008e3597681ce28a72e7380d3526be077a2ef03aef9b6f43688534b4d98f5ac313caa7fe869d395873d6e26de0e6ff59af604829581e4fac5fdf469fbf121c8c1d3da1b60a6fc6f42229466513c6bd6a7368e0fa295d8b62e10fcb086a85882f0d07410faebf925b05f9460dd17a7ed0211b85c82d6da95eb2807032ee29d8ca11c799a5d34de3402112e79c2159e6bfa96e152a54415daee08d7640d494a71d5e7bd78f9859193e661612979e209740c9fd2b6625e18d569c661bb455963d78a0b05e66ed68287fc6e3439243b6fb23d23b75ae76df2c32a172af58270b82f9bff1fb57014871d2e5b9ff42f3aeb6e818e798979166a2add7141a285f0abfc8a1820bc60d30925885f6a8b9b336865e702cf43d3c7e0e13fc1f3800daae94f22527308873f59f2e66c01363fb7668df41bca5cf1a9a17760d0924381cab0a35fa553e0c9ea0cbabd319a1ad89ef7092cbdbc5193554b13b96fad9b7b34bfc123536ae98025dee514", "b37e9798fa5469b7df5c5ed01d970bedf438e257f6d701aac153858248e8960b5c8b65021bebd5358af4a88660aa6dc098170d4fe37afa0848bb08fa7747892217e04118b9a7bec14bac295e789fd0732309b062217e4c18bf1de527a2574ff522b130a0bc88f26c7035e428fd8cf71b7b5e3092d8705defb8d96608bcdf555344f1ddb8626922e53397b1fe4e45950aa3341063491e7f204e5c62fa101fc7a370be1a3481204adba853cb366878f18a7390b0c87095f75397afd2c5ed6c6c2d5e1b1b571dab8f6ee4008e9c0fbb7073d9833aaf5fc9231fc2bf8ed75c3c7cb66fbad90f49b993c2d18225846678c3856b3d606d8564dd9671740c489c1b0254605c0e1b31e581c2944852d56900925775267ddcf8014e38734c83562d432cf013f391081bda85d61cfa05f2680b6b56c4d2264b795817559208e41d3a8874e2026d291ee0732b96161760071ad6c442fe544dcac32740e2fec303d39433e27b", "868d0cd75a21f71fa4d3266fcabd53685e9d2e7738586d5f69befdb813be1013b7cb105edf65c2b6dbe3cc80b66948018c6a48629a27aa5002efbfce654d64bbeef7f12058fe85374538576570d201c5b17409e9cdf0a49bd38adac500e82d116bc2bbb419378b66156a7e1423baadabe95212d43144f8f98cc7b30d4bb10426464040cfa6c0cd1812b5de818926c12a89c03dd47451a7793dcbc6f51f466424347efbd84e27d7d0e4ccb3b659f778e4dde0ace8f35788912b9296b1ac9afc6d152a535895bb6b3efe97bd5af5ae8bb86b60d836dee42d3d7f699bf29e89b93437af2fe4f6bd97569de58d4f41903923aa68b528491dae44f51b90e6a314a186669ecd1d1586c8e9f2eb66b6a57d5698937981316a65a8a33f8dc25b729fefb40844bd78c3841d5056c468f108b0ffffe83da4aa12f26d45ee520421e4cd0084", "8d61c945782c36c2ebfa29d5b30253b826b153356ebff9f3dce8c4d0fca95844a294ae463eb8b7073bccc01beaec0406875e22fdad4b193ce0677ab1c2f2244a775d8ec57b26d1f47e9ef20c63408b8c59935d46779c25d42161b3a7ef1caa700b64f11e74ff0d1f3586ab830178bb4a296245d019511fd57d0aa200de2bc035666ceb1da46b3f66af57a7e141d1fb0075e84730b3de57e5d7ff3ade3e47e7ed27a0af58e17ab198e1065988d2c5f22abc08014d77dd65d72e7e991ffb44f01125222ef8582d5a39a5e46913ac5d5e889e9874d0a521e81da0d0a4378b3e453c19ca30109d099401a86e38d44bc75d5ba1a599f055243062e458ff0a40714ad211a7336598a11a35fb40b20d42f57800ee0ce81c591620fb4db181eccf7bef93", "a873f4ede35fc58d847e8632459ac273ba96881b8a9668c7b7762b76c2344108fea73d10bbf3903bca13877659b3818e8a29b3a31b09476907996bac907dcdab7f66fd341f82decf65c443bb28b0821574ee1593f97065ff3b5b0b083e206edc533fd9227e92d48827a50089c6d40695e04a11a68c1b8806e438efd61cd9f0240ac9e3909f01762f5d0a999d88a838c3954150d6743bb48e80cda4253700d63a1aedcc82d95f8af7d2c3a88483675ed7deca2269661d7eef423c4428df9979b414b0ef067135921c1b024636e7788d82e4533231d200420d879b18348514b849209668363ef11bfa84054f8c051037e132241e2eb5e31d2d90b7a0955bbe7237", "b36140fc979a794f3cbe579caa6e6f4f07d2d22016c1367744634ee216f6af1e66b233125f486e0fd80e233eee19c443acdb156c7eec962a24fae709a1af3666e582457c5acb1ec4d8783e84dadecc1ba61d5549ef07c5cf7f2d3987c9f5fe462824e17b1159bea6365cbec78f4ee4dd47428adc5a7711ff47b23cfff4d5dd985b8c1bcdd1a41a1fb486061fbcbffb8b5c0956bc81aa219867ad21fea11fbdac72f64b482e4d737f2fd3808c9ee6c205c59b918498f3b30d44521858c1b78f693efd0e02ff888737de6c1f1a5628a49976cb037016558819cbd06f2cf0c42ace"],
    ["b72b2b5e8f182966874564dcb0eba4132b7e85e0e70b09c2941d3e839b70734c7aab26c1078fb8cf647003fcb3d56700a2abc9f6dd38ab782bca7f27c36f1560d57d45ac6caa7b4180f975e117eeab7b968b429d76f6cf2b049fd3d215931172245c0f3d5aa377b2329c4caf0718db0caf9c14dd557c45cb26671dc85d65d6b301b78f3d93cd98b75d5b7ed058ab05c04e28cd99dc5ac92efd1339814aa344d26f17bfe3026f27ae23439c9d33e74ff2014750455aea67fa553a75bc5043667e73bd654a9dc28f6506530c3ae1519cbc030c6ac5098ee38792d504389be96272670ab9097b5881a578f6c52331f7d4278ff4141858ac35a983a4b36fbef68e590cb40e0f8905847d9a95e43970a5a0cc1ff4f1fd94a245e2eae508e2133ee3552b829e2c4275dad97d30576007849129416faa9b8d9338c8553dfcb07519997a59298a401b29d92231b63379a76b3e26d3b606791334224baff25111e01d14286e9075b58e45923b8de7bfb832cbc5d6d091babfae873e11d7fbd25fc759d38b", "897df143a231f36838a97eab811132262657bf248a0db1ce85ea905a8bd1b0466c7da0953dda3501f43ba69954c31dae959bc3cdd575dd3ad81c79f19ea3a4e702ff59a08e47bef126b76754639da3b01ff329e47ae15c244a26f3fef049c33c0d835e2fda4e4a3b594fc189af4aec2cb0ceb8644e2f11941a57b9a1f47b5a194c9d1b261568238e3bdce6069d735363b7cc2442d11bbb3327af813c637388115324b0b5cb5b0258747b26f4ec94533a9033867a93824fb740e649b79e744012626223f0b7032de12a95c5b7a0515b38f808b31d323d85968e897ad72ddcafcf116d486fedbd3e2650774240c41a0e69bae987b2b0132d8552d291898935fe6f061e8cf76ca3f9e50ca6a772a5a2c2d0d5839a4e159df0411a5a1f22f502cd283dbfda1f651b09e61161916a0bee040fd904c70773fb2a69daf9577c23586e9830602a1eaa37e68b2c5598ada2ce9505288ee36a335ce3d7170ca144138ce748", "8642e12904260f2ba9d2318f48d7319feb9d64f09bc8b976aefaea868b1d7aaf39fd8275d7fe603cf7b5e0a347192765a2bc1341b026b9a4c7a49a49a7a228c0198cbb2353a283f09350c2429d7e3872d53c2b331238d7f9e57afa8b76f85c281cbbd11304a555148ff3e5cca9b267758744d5a2bebe319c11dbfb770f9d7b550397d625fc420de956f551750652eb01122eeb7f58b5dc141eb2a7a32d4b181a146ddf5f6091e422317bfc57b76218a697af42b992a944c0b64931bdf7f42ed04879be02070c74f453fe836cb2089b45eb234f6bc3beb3367a9e34e3f5b429c4485d89dda3ae4ae7c66cf7abb76fcaadd8bce61beaa3fb8e1f4262f7ebd7392e7181c8e475ec6a38e66c2572ee117e7d1e51bf56c2884118dade3bd6d1553eae4e940cd5f241e0e41771a8d67effd4c2b35ee076efc599bf2a5ea8c9ebd11bc7", "81b848795c9e5cac022b4e868abaa233eeda6c73fd51d1c78e4117863a595f7c337b1f3f9ec66ebd1620a6d10d96d575b2a95ad86a569878490a7277d1c833ba2e2fcf09b9f8967fe6fd7a487484a820d6665b8eee46bff766b7a152f4e11f533d7e292e91b0897e313fc36e9c21d7ff782477543efd14dc19c28211ffb1111c1e3981647bffd44fdfbb992e9dfc7ab41ab2c8ddd94929132c1a0864dc512d064dd38f216890795a6210b6cb6ac5e196a78fe32d7502a6c84ab23089d325603c3b2b41b7862d8091a6997c4fd63e34300b53463bc008f92670c213225464fd1d411a350c192afeb1c43d0dac98716acc6f76251cef5f8dc82c637f1d479783034ed24d4751b73d8f0952a6e2b06b410d3916c925385962a81999accbde16fb23", "b5ed538e599278022c5a68ed9522a1ab489cd3f7187efb5e60934a9f1b6b55373a4a62bcba53f382f5e5577f06a87c05970cfd1331939c3c9ab4799b761408cae372ff71a4d7f66a966439277a0120e596c95f560973a3b65c62fde87b053f616af074c1270235c8185c24e7319c64dff13f5633b53973db08274fea743450bd663ccfa208d8386e50c663d6884a59240d1d9ccbe50f8fca72ed27efbc976680297172b5ae2fb046cb5a33a875d033d73008ad3ba00b1c2b8966ee882c761da36253858903c48e421c54bc67f8759b21b7cff9d9c7e94aef71daf75dcb21dc0b556cb56e21d1d8e5448b94b91a61b58fe6cc5177120c1cf6fd6543ade2099fa6", "a7b56c8ffea37f6b8834047c5a63a83323efef063f10f03e532d0672af02fd9998c9536c92c53958b82da6369c2a6a578898efbfbff581866af1d1d408d0c05417f6c79f05eabdf2a1a68ca03c9b8a15c984368b3795ae5a51e771ebdc0d1a8c4b5ec73644c8fb426adac82ff7704407c113b495676699ee8364ec378bdbee0353b7eef1f46c50ddc598900f6049f4916bb035604b4effeb58f8ce515ced3644511f4378dcba18a1b9dfce41316b727b77705734d8eaa888b8dc7db3c81a77c1577967251a8e2096acfa6bf684330923d5f4ba4458d0d7a549396ae8b2b895dc"],
    ["b3e6dbf4a404572b4df70532cf10a0460188df3bc8760f9ecd6e7a2cddabb02b7d585d84ec7021f1d4f0e3bd343a7d27a4c99f6eef3b908b543450c10289187e6f96cb8a7b1396e5dd15d1ba50de4c05366e67c4be2c899df725ac7371d05e692ae7e49bb2c7eb9ab25556348012ecb4b8fc45e592a5ac53d4ac6af6cbe96aab3d241f91ddec420fcd24184992bef2eba89ab7b473e786d52b82f93a7bc4846910e2395b906cc0130c1a2de4508fd251c76bb875b3b74cec8f64b04e37c7d5a262286d507080417a1df849c8ff28ea4530016d68e94a79e615be75de3949cb392780b1357e44a21b8987d9a687053f1d241627f90f4ade031af34b88ac0152f805dae0071bfa9fa59fe22a8efdb588695acbdb5f81e35fd82fd94f2430aed043736613ae9f5deb6affdae877d70165e409bd424c2805743bdf02b1619992e61f21b6958b5cbc2abbf4fb3d8fa1752b23cabff6c2a36bdc180b0d624214371b240b847c71cf1502782d4c445b4216110dccba54068383867faff87a5754ff913f", "8e4f1a01e568ab2ed2ccd43101b82729c0faf4a4ceec32cd82d62b2a299b2c66fcb233591e8478f28f7f3b21d6dfcf0095f27731dd794bcd990def5c3cfc7c9ff853604bdcd35619abcbc9d539c3510a7b798c9f9777a63b803ecf1efd73739e0254b71834b7325eb92a76afedbd05a491e8abdc755be801cb29079090b2197e2b37d2792c277896302443f700b2151d9e83dcfdabbea07e03ba223013a2ef1163b34808496be66453bae30abb76971ba77cb976d128b27692c0a106d1aa67f71ab891b1681815f022cb3974324995b58c1cfcb1c9aca2d9feda17a146827b785559449c027fc5b4878aa1dfe382cf81e522895179c68be17e66b0d236fa59df67bb278e68680dd719cf252208b05e5e4f05de27bcc7614bc5f9b522d89cf3cc12911ce530fb00e8c59deb171f51299ebc0f88739e24d4dbbf05d0fa324c6c061fcaecf814426067879632ef26ad8834838f04f0dca3b70a9c900b04277ec58a", "90746824513fbcdf0908f3e58726d310c421a552834b837a115bb10d96ce1cae34e92c2cc5e7dc2075af6d67bea482a9b10769f4c9408aaac90960dff184cc06894abe039e3f8b254951debbe000826d4d9549d3afa62a7d0abdaa6e150e3edc41c14c4fce27799f3842eab57a8fd8feebc0c8c2b249ce62b62869a79ada34a822478f2c6c2f0c1f36b1f8b668ee42cc4e58393c6818f6406cd4714b9c28f0892998f82286ca6d3280eab6c19b34dfae4b4534204c3fbc64b813c7fdbd2c6e845482a01d56a6b3ce158b87fc5178b459677c25ee26bc60257d36cd7ee8ae5bb82653d686be18b192bd7018dcc71efebb5b15e6dd971931ce3803d3895c00f9c52b4dfba8e6bbf087cb02f89b8f4dfaac4e13d8a3e3a204d8b5021862adc7b9f559cc3b170d905a41b7c7790bb061dd9268ca0ad95dc8164c214bf87ca4b90aa0", "97f7d6456259fa00ab7d0207c1fedb802557bce70e22ccab75abfe35b0ba25f9a6851e21d95e7c1b3fc7a0e96f6570dca6f0a032c2c80a3b93c7d25e9e7074b3c909218b1a5d98ff6cce2f0f5fbe271a39a942fb9d4311004e4b5ba960ef52da497d3f82c6340cde5312e507f9b417813a1d7029ddf96d977e15ddd48c6e5a8d38356ee7b3448c97ee0136fb5294b28deab18570e6579ab64a78079244d67e9b4cf892bbea3414bceedf0ac6dab4b41f4439614960371ead4a6a4b662cb7244f177594b0e8eb19c6f656453b22bb4494991248413e84b2dbb5e87c3defc7d04259019c615c171aeff618b92d11c83640b7bc843d2deff906c96122da6d12fe2c35795f57f074a63cb9848b0998e0cde20c2a94d82d1139ef98a9d56569927cdc", "b893d87c1b42eca33d3bfa435e09fb1bbdf3354a0bd35c839ef15dca7dd4089d9d760ea71837b61107d9c975c91fb43899860d3614b40091fa5abf1685869b28604a030382c3cb0df16d962af8e9cd49da920241aaf2fbbb689b132fca15f10d1660256bf5c6345658fce0194b34aebb33159211f9b7ca7fb65b4519d1acda900e58acd4c73857aca67daa2519d19fbb219086217ba2f8fb93b76dd5f08a44f919064a9795d4eb9c451c5fb5ee880a9a5204743003f4ef2ce9d1b818ac33483a701e02d226420e370bbfacfd57c21a5beca9b1e288faeae4f3e4e312ce99e0e9268d9e46b4dda6087eb2f80565407329425a81b11d01f51f0e1dfb1cfa7a37b9", "87cac3dcf2eb8532d5b9b54031df0e5f80c3b574af4aff5ffd5fe78b6c44da8379a7206c183c57468f264ec0871294bfaa3d1d6f96733dfbd45f4a4030947ff6c41dce11b1211b3409ea2ea6c4dbb04cfc01085168ce72c7d8bb853e1ebd4af3500ed5278062c4944083b2d81773640fdf467c0f3bc85997d16f8b600db349da0f609b3ccb17fb40404b6e47cf615fd5da68cd7fb68d45b2380847b6ee1eafe4478dc469d3a98698349a44f8bf682aecdc8b27d851ea315d5e00571dc3b22b4b240e559d725f39f54d479c84348fef440c7d3602ed3c3d2fd36de1b0372c61f2"],
    ["a1a1b00d9a814403e28c7e0711031fef0e9a297e9d25910e5933fb39ee4a3ee8b9a3d1a0692a03571084962255a1607186fb9243782ca13f4b8391a3c1824a783b2130b537c3bd74951380abd26c3da1c69b3bbe8eb58ba810cea6416d8ff2cd67fca6493bddb8e118b192d5870f224e41771853f5c653fa41fc736715603d9644fbc4750b7afc0733c5c66bb89f5bdd0706edc1d0e7e0f1773f50ab8cc83b1f30b30fbd3f6815f71711180682a891ddad4a798ee2abf6823aeac0fdaff78cab6c567872d2250ee8b2395696c170a729bf9b301d3a12d4d49db003aabbe3dff72f2c0b8a31e3a08ace332eccd91486559abb4ede1acc4a62cc4342ce743ebbc872032be744fc22cd9e02761414b5d869c8d96ca26c4f4f6e42aa3f910e4e22f73a315966840988589809d816005c1f8a727009199b836d453e7a65bc60ac295c3348dd434af5a69d7dc735a7c488216dd974fdd3129fa037611549ff858deae438bbadf873ecd02b958a9df3b73ee3d5029c113ed84997cf6389516297ced1e6", "a56d3d87e67c4313c4f4076be88f6b6da578204129281c1dbddb7617ba163c27a309d753f951baf32f918939caeee8d1a948f7a774716a78afae2667a1bbd64870adca4c9b8061455fda07ea284405a94e4334507245a19280058684afc4cc50190a7c93ed4aea5744fe31bef89f56cd82cd0fa418da0de64204958ca9adb9a828a1701a502abbca938ea4fbb8bbe3bbacaa0e75d0bd650d1da63ab15a1155340d8066dd47b7f26782fa113dad5f86258b7014022f7d6876a6010276f6abaa5d234bac83c6664efacfd21162c0070e939bcbc0e75b7cdfec9f034c1698f954e327a85577e9e66f09af56b51a2c64c1342e4bdfcc9f56a055f7b6f54aadd9ef4922951a759d9038a1a09d435dd3493f60d3e53fe037754b86e3cb9ca42bd79988257e317544bf1107b612a52887858d06992d000a915b22eed5106fee40d64401160c6156ac351f006e434f08b17128db53e7d4adb8d9b68943b287123fb7cbc3", "88c5410c387ff4e2237ed4214310faef4c7df13ae48367877e74a20216226d2199ba5ce68950cf96d3981e1e30573a26b303a92255fde3d76a24a619eef35d073e4846b0fcb5e530dcd819da48398e7924878ddaf5a051a3acc9566be7d9153d04ed3b10447f0cbbdfdd44485b0fdcdb9684512834b7dd64d62ac8f0a7e12e7b379a2a695b0b52972d27654e4b29523f15b81497d6f45472ae8531e574fc3051152c113b7b0594b47ce8a85a6cbc170844769dd5f9da61d8b22e761729d42fd405c46bf4de29a7f7c1d5a1cdcf006b761d759989fc61b1a1688748541a2a0b745fbc83d6c3189fb947bc9213dbcb8b3ad94001fc3ccd5daa0e33bed5bbb875ba4d75795a80bfa54d39daf8292463d1af67a7429dc69bbd4742d18e15b1ab74c2216d0d534142489f2f92fad175dd961dae362c17eff8a40f17be8038830a25bc", "b9b9675352973abae3dbd12f7d8d20ec1440496cff63138d86019c7f497ce520bd64b640c8157a0206dc7cab1a810072a0c16d8b9575b3abc8f2145c19389cd10cabfe77303a88e3569431d664cf8514db46b978b9343471795f4779604f293d6b2c8e45aa39c7eb09da2a47e069a4e8e106adf0223122f42cc115576138847c1732a5d6b90d3751d8a04ac1f805c5b50ab1fee36b56945507d9494d123cc91e4c77649409efd6cb225577ac3afcf472b8ad6a9731c76670c40f22a93dc2446646075140fc0fc1f289d0cf29a3f5c75cc804473572e87d885910b98075e1a04d15920d173e33cf76e890984a55da4e54a858dacaeb83b13cead78c3546d0dded3431e4cb5aa444a746ce821805536c1dac166943c68c195bb9a347bd29db9ba2", "8d049100caa123cca449eec037d9556eb447d9450a4694aa15268e70e62bc957916b62ef187a6e32182fd3ad18dbb675a0095335d288d0637ef3eab23496a26816d68e1198b1f4e5801bff99bb6704a58521e42b7f88d3d93ba03e77a40e39b56f70ce02703448ba34da7f9baf9d3f73451e8541e616aa46fc550d3d5d5b39e16b07ffbd5a5d7517328ffddf1a796922cc991bb20c99ed9f42b32fac6b269f285278a46884e154e262d7051dd64d3147c20f095cb72f4d3ce229949e868862312f5412fc590992c06f9c2971c66670425017c3e14507c6e9f581bbfe89295dae0e67fc02c0e7f5a626c55a128342ae8cdc33c16b1760dbccd6ba11afc6748d02", "b13cea42220dbaea1d14cc7dbb61f43fdea368784d8766c83f391409811a2ba52aa9cc4cf9c57183102023f7f0ef05d2b0df2860de828cffb017f98d900786b93ca7da1cd1f04a1d6a665f1d0268b71510d7e94986d2d4af933f3e3c0c9f5cca4cc3c8b07a9b5faa5224e3636b5916c8806eabbad256d97bfa9655ab838cabfb52b419697863bbb56713421b5c53e40a2ca425226fa2eab00026a251d1b1ff40214a5ff527bf38a022679e5a9c28ea43f24030acb92a28a74f648b0f4dec08c310b9a8149200f21882efcb24d42e653393dfd0a5854dbaddf4bb21e93ae2ff71"],
    ["a9bc983dc3161d5afe323d6238df154c110531636f4ae534c0d1dc59531545530912bfb73feb871142e87151806a02afaf8bf58adc425f560c28126fbebb7aa9c3d36ac8398d43d2db2b042cbbf0ebf51a48d0815ef6a64fd36e3203ca1e863f64aa4638c537c77580245b71c07879a0c7d90b4e9632da149c7c3cb48a44463b17294fa75780d838205ab815ca58a3e8241d62fb5dbd86c05160cfbb6391c40c4d5b29919a20b6516caa3e07593cded875f78c9d853cae1ba062bed0495e20ba3b4801cc28a3243f1dcf34637fc4e9db73ebc0035e18cd7bd147c41db295accb5c06529cf38ab77ef86ac07a7c6fe4a0d37e75059357097ede689fbbeb62dd0660ad4af2f1a38fea78caaab544cd1a01ec248e213be969e2f71d688f4716ffd305b913931849d1fa8d3a6f83e7498a780077374b59d77d42d81a05733b93932608dd35de544f19af933eabf5b342d31a5cba09aece26c2398c0e0b3e97314e795f98d59f3994f474604fc5d39244346a37a5879ce575f5eda44f5c1c8cf13442", "85727adeba27779aadc1ce4d79e96a338cc654e7b42a31184298a9198478dae755817a5373e159ad43e34854fbef7e219208ce7f431a94cb8d911ab6450faf8437f5dd7248656d8e4111215a863e68368d696bf8b601400f7ced954275290a5a2584981b6822bac18eb9e9bb65507a51cc166883718528f9710e14ea7a8b6b471fee226ad3dc51066eec8ae0f56214ec6b634e519ba4e7af1f9207170bf590bb115ac11d5ad9d37035ef328a655a686b734e987651004b076cc08fdc7aeae8b90260d319113a5f2e7fe2d746e4acce32858adaa09d0024bcbf578b71b85141c23aeb3c2095843aa63fdfd983e2fcb74e43025c4087e53661215d65aade9e15f104f68d665ce3de611848a357cbb7b917f003059f318987e58a7772cee2b938b964a656c210fb0102dd6b19ccb4064b08a0efdabe53ec33ef895e20d046be652e2ee1a63ab3c729b61d1b67255e9e4852756a8b25a53f22c1b2e2f780e5d5eef0", "80d7fd0730f0115fc37fa5ee683fd9b0de87e4fd27653b26499bf27e386d80470459fb79b75a4056a4ef1346d050aa35975cb5c76028d087632c101bd191a43d599a6cb5d137045555e83ec9016ec447f272af8ec64e85943b6c2e9d281a19d329bea1bde5950d3f479443608f8de07a91d00ea635d7e958085373a87c6b2bc3009273239ee0926afff058c8698922c4011feee9045267218ba82bd99b91c1ed36133bc9071ed5d43ecf0284b578713466f8c101c6aab9a05f298f042b9c4ca1494462960a92fef9a6cbde5f535966fd6f94c742f22b45a5c5afff36164982ff25e0dec0e6e3d628e8863b95d402e3f44c48434effd92e9bd2996c803299ebe4515ec6d6a7b73cabaae661a47fdfe9f7a6bfbde21384976776226061d23e31fd15f96573735c5f19a594d4cb8bfbfbd3743ccb7286f79d05af2df24172c73bef", "8053ff261bf9a7722529755c8ee658862d93498cfbae94b0e40a8f74aa5809030bc9373c44fe709cae2d6a4b827edc9499beb839329b65627094a4d72cb25494938aceccf9b1adf8a9719e1ca78b7716ff234e10d5deead5006e7b16cf8d8e1b733710270c5e78c2c2712832287c261ecd0c99b4e46bb61c7eef95525f04f0eb09a796fd6645cb12944f183cad81846a068976892bfc88833246d116cce69c5e22b52cdefb791f9ee58c8207b94f29db364441baf94945c4b9d96f8fdeca3e2a44489819ca749d9f5cb8afe6427ddfaf9c3a8bc90ecd26ce3733007270ee01b433ccca9907a317271852d6a864d91a6b4cab1ed0a9cc3d81da562d5ef56abad44d47690d08baf80999d9a225f4cc536601d1ab745214fd076db5f9e8749defce", "a3a82332fdaa0e25e0b304d4744de9d853b265845e9dfb38c764f9f679f37c8d4eba777b8c88c4f71526e5c1e3d235a3983c61fd5e7c0d591cccabce7094579e56a8a595d967c60fdceea0b9dbfa3f912233df625e3daf88f7131eae12cd936049bea3fd080b4ebc5be9ad5671d8c6af37d304232cd437aef832aefc6fd6a64a574a47ea739e6d5036c90274a9a96c302d9a5015c583aef95e59cd7b93054b6858d5078074048beb8de6ab6f46b32788c3e2e473a46a4f41425cdfae62506ae5257201b82b9dfbdc8dfcb12e55cc672361726e599113bb0a90989145fc62ba2810e1f8b264b0696abdd613dfe7a7156f93eb511b61868c4441d736548a6f1da2", "99bd2e3ec1ac2d226544cff23f7f0fe138a23bbd11b0f28c9a786f823ea81ec5bf8096011a1ae704574f5d9d18b41b9fa80678b4d1bda2f7fc935e351258e5f4ca6708f30977f2f8316ff1b33e7cf783f65ea6fc08f760b918ef0615b98d35d32818346660187eb43536a110432784a5ed8f3e34028a7942b18ac33de53bc7bb2de274c2d9f053692fea188c52cece3f149f2d774c202eaf8bbb054e1da4b95743d240936355df1f3d6f4f334d880730f9003685043d21f85956ebf4420a77701f6cbf71f6b96ef1110ca0b4ff00e133184642e91c89b5d88045bf23760eb5b4"],
    ["aea4213ea1aef7d13ca51de56bc5011367d13c64d48aefe9eeafd4e5fd03ab96ab3f59fcc257c984a01815e27622cad9a6021ecb0f2392c271347fe3b601c07cd7c83241e3d0ab31121373731d614e5c72666c9732ec457b61b32ebace5367c709240bcf8d4c45337f9c1d60ce72e2db94a2e77a67e3b06d496e885d908d8d7b0df288a7529703cd00a5ab5702bc80a64c1d723cba79cd6ac369a719339eb92461edc2433e6a762887a596894b846798ea96f8faaf6d69f64b0f45fad8116759372894f77c2737f62c515b81337ef2736d0f6aae4255e3ee4620af6c4376343661ff05be1e5bb2cf86acdb7fe78d7687596b3b1c42fea933f7ce76c65586d5245049de3ee86f348950336ed986b70f7302195211999f39c35e943a37871c3ac462b598d6492c3e3191d09e2d9d07d71b8d3872a646eab8ff75de709b655e9d416246613113e1e56a021eabf683729114db7f925937abff3829d788e6013022774bcf7fb28c9d40b8e824502bdf5c054f73228663dedae2edcccd00cf1f78b2c1", "b4968a39bdddc43d92916bd76c5e9bac3ed049d40fa483e4b409f17218c24b1197ee8e3a3e5c4a52e34b6a4bcbf1b13badcc71cf5d7b47d82de850ad859e66db2c7416ad4a2e995078acc8c7321cc310c2d003b09e0f078f91ba0a8e15b4dc215ae09089b907adae335015ad727e1cc094c609617265aced8302b0af354317ac690aaa827f09cd74033b3df02ebfac26737749a923d3da8ba6fdddecf6e5df0554d6d95589685ff34e5126997458dd47c4b516146be4d5ca196347043e5bdbb746c34b3efc31d0811a91cb0af9b2c4a3d8a3ae391c33a5c842c490b52122dbd75cdc2cca132fb7234db8ddc332fc3230864da7c6f1ef9d84121696389fd2c5bd6176405fce2daf0f0528577a7310530708f363d8c67b9b70786272d01556dca024b95457660f4d112da5042948cd33ed54dedc531832eadab34c1f01449b84001cef641dab3f7929713e77caf13f0536b9819d7b8f9483bafdb969195416db4b", "b209a2216e6e0eb15a034bb970e22b665eb936f6294c857cf3dca951d79e771115809ef39e1f8004e194e4e1c9aa27f396855b97cd8dcadf032254ccea098b89d8e675ef7ecf2ee7b111bad3cd4cadc856874be5992d97bd64e9d1a0d4d4a8626298f81eeea852c27303b87f5877112d385ae870e7a3e0212fcda0524a74a2131754d8aa152dced33b49fb66255c219859e1fd2761cf82220aa67e65304e48083705b6c78025135f3e7ee4dcfdecd441def02e2105620fbfeec5a5338d8a1f341172650545dc0678442794457746922d705f59df5a3d6c97a172772e5212929e39f289e81073ee9c560e944b601e225a61d742d7823d110952c0a4eec0a3342b56fb4c06f3ec7cdd38d078624d43227487f693a459d524db4824acf325fcd8b61290dedd613484c540c88b5603cb45faaa05b208a11090623a2dd605754de704", "8e7c82076b7c76e14d1126d8dad12260641db0addfe8cb2c1185d7709101234a17a9afcf0e10317898e45d12aebb970086788e74715c3ad752b2847ebc5294b587be68cd0bdf8ac25c30a3e80bed7d229bbdecacb1fad89e063ce020d5af7cde05af0600735aca5ff0851579cc9004e548dd4d98f995db1c3f349023cb1d3a5355fe0b22c1d07df0f6afe037db9477e2ec5e96db442171e6453416b27f004e4a24ac0fbfcf33630260cb20a4d363a7209f1fdad8fc86b3378a0222489a7e07d94cc283b3ede2d9d58a2ac8a063ffd3f67ad722c0b32ef90518bef4b789e0760e6309ac05eba93d81c09d6fce31e99bc8be6c98cae1c803db6d3a46aaf513691f5160b98a2a198e95cabef6a694366db37c2ffb219baca8044e51550f4ec6b8d2", "b238fca13f64ff69dd94eca60f2ed317b534f7f16bc15dcbdc873d15a98ce1c8d26ba5379c8ac6879569c999d17778acaa4d5c06a126aed4884b8a53a169197fdea9b973d82a5dbba08f0df9b9de8aa95f80766e4c1e9eddaef8126c3b33f04640abe2223ff4735869e3791e139fde4ee9f3dba99888d124fe2d7092e224f30d5358e89914db1a70748d19dcfd4205b249a4176b94815afb2294f15e3e6e44b2537ff31086332bb849ca43c7254e4cf50c260a8f08669e37782e7038718cac8842d5973304f3e9061d530e480e1d56f5dfc1ef857ec6449af04149f4e1f354e13fe62883db5ca15675770a72a4cd34864b8032a7f0c605018bd764977d8a6c3f", "a9de7a5f1c6b33a38b24dbacbccd429de08083399a826dff38590789e218e5b9f91d17064105effbdb1083d960511a3eb65209f2bca157c6fc3a9c4da3cddbf954826b2ae00f93f80a9b4f7b2a5492f9d1f5d93c601b9a48ed7d259401158e5917c282a1d557aa67cba8e6eb18ee9d6caa31937aa309915d17dd6d24b54aee8f721b68430757dcfea907e52599cf2a974cbb1973cd9605326589200b8a1513ec3d412dc54c026206b4ea7152b14b12c4359f85aa0ea1851a5f295a1de1301b303886a37b5e54cf666c1d45b7d4aca81502ee218d98c06056fd7798c841cc7743"],
    ["8bf759427accf2bc1d588cecf92761308dd190b6c1ce0c30cf9090e02df220335676b03921d7141590a15d46e92effb2945f7d1fea83d862c39b3cfe5090bd552ca73211c4622b76382bc99c4407798bfa326108d12c7bfca8036f61d39a1073620babae792e06c1d1caee757b84cb7c1426556c2fa3576e8757153d2924d03411bdfa0e0fac477aa393491e78d26f92c5c3de45fe1fbf7a05d185f58b11cd9134ab4013d4d73da8748dbe3d6ce4a29fd3131814c39532569eac0eccda25e0e166436080dc432813422ac5f0f1db174b2fc6ba244f691b8ce746db43afa5ae4a3f73730a1332a5ee686439096d37cad23a4eab2b0cf1524feb8ab561d5d1dac365e7769bd9e37289b51f3cdcbfb31a0c9d0f2713a7fed7da78d513ba06c355a004cbc3f8e3a31d16f8689e227d7167b3fd766ab30bc5204fa427f2378a5dc8b162156b2e5690f15d341972380e59256a3dacef539343200e0793716de6429c17049f4e0d583e317bbeb5a4e10de4d90a799c380af96f1b1f5700be25015441fe", "8cdfc2170e7c96877452281b1b1bb2ae96cc5ec6b187fee3459c49b52baf76fa2035e9013fbc290ef32a3aeab5314ee790ddc44080c3f0de2d66320f168be07f0929be3b96cc9e6e17ece2ce4c96263a431025592b5953bfb5b989e25ebc499802c9f0444ab3e5d7fa11af5a5cea780f5d2688f6acd3d01c0d547b22fa02970c50ac2d07df756bbd4ac0eb8ef23a18e2d61c7d0a905373959aff7239ab6585b0643c23c3836211e1c3ebdb892d86e468c607bd14c58474629d4f0e5826356f5b31feff0b8b914e7067c9e063e865eeb54aff741cfaab8bee7f526c2fd08ac9ce068ff9664843a8667a6e3c84acafa66f80d147fdc0c2edb57a8c3cd05b990ce1131863db00046a48eb19786f02fd64eab18d7ccefefa19ee31871d9da1cf836f30761f2ab62c51bdb53d594d04f0281ca8d8c73da541ea07f796fcc77e77b5bd09d056dee31a2a6fee34a8de5f4401c9b046167b5c54339523107d70f3209e2c", "959191969b75b9bdf591042de66c6225e88a852de51c831ca9ed86df50808745ebfe33fb5ccffaa3ba82a0bbc0797294aafd0fc3cbad2cab96ebb9c2ae9d2a853556f4ec94f575713350d13f7d553b6cb28d5fd8dac63808cdb0e5753b4876bb0c2590e13a707bdbb8d6c1fe5fb12603512b4edf3cb80a7917b2fdc81b847d90452df030eee21710042cc79a45677f49fdabbd76f59776fb04575413813198f6326306e962cbf435391cc866b9e87e1bb021c919cf4f7a39e2226121c81c5356487ec7e182331f7ed21882ec3b59ae81270ae7347a4f3f07847472d4530803b600d95af50eb503832cc92711b8248400a3adec73b50688807b1da9bacbad47632428a7c1cd3feea94842b4ed342ac59f5fa47f8c3f619616a8c649b99fc4b1450dbf340c92378f28e40a543850d3c0690400f17ceac5f4d7640110f9a13c5739", "b9ef6f5566bb29eec1620db35b8678f975fff505a7abf2594eeaf364ef161e142a9d4003331c8338bb23125395f162cbb5c94477bd7b135fd38e298a16ac432b9371e5e05ca801ade60051dfd60ce671c3a3a251e2644ad56e50c0b76bb2b7ba38a9e3e44b7581d9b526d3af49abb5c144f1a04cbb4e6dd1e85aab534be70ef501e7858b986cb470a568bf03632d7822c972489384f9eb608403f44da72eb7b072ce86031e62eee623fe446dc7d5005884a4ad9dccf9a183b27e8c092ae7c054424c2c6fcdd2287ca33042e6d5fc9637f86f8fde06aa547411fd21446c462aad52835669d9ec17edc5383beb16eb755ddb4725ec6f18aa6a35e43d74c7cd46be503004a3fe1365e014c88c9f2e544aae207555ed0f66ab79c3fdb0f59dcb8124", "8fce1f867f190525b16e5fa4aa594ab661bced66523d89c0f7649253b6d9fe356d853e6976b21fac5283452adad1cd5b91eef65f8c209e6f065031d224539280b173d1b6fb0ec163bd1ba593aa5dfaa1b543eb79411b2952e375c9ca6c8d49594e5dddd236552a66973b34a63ec36bf9defa2b9e84c0ae5a5f514e2a40f7da5b611a05d1a5cea4afc5eb4cbc2f09770f1723b2b434ae301e1c5540d51d55222053219093b6106e78b0fcc28f8cd28aa69c73d99a7663315fcc3e2c7c5d29de91516034caf9e6b8b4d126e6e0f904d9cf1254f059055cd7c15775d22fdc568ad2548cec5ff1b5a8cff116356d5f2277b4604383ee4e01c7e346933bf9ba55ad78", "96a4b4252d21fad2a93f5313a58c4212a3a390f94b5e9511967af611426b7603d910c897d74e99fbba58f8a53012cef0b5ae088aecc90edf773a6c185d9dea6939996af191e41d40bc93fa0312177cd18362279425f61fa7af0ed1f41b5a73ad4fe3de0b21ea12e0671df0a02fa2df49187cc3bb7cb2e124666fb970b6a1f4283501407aaaabeb5d7b72967f76522601fe98853fdcd9ce835f48a2488a515a322302074e968df8201322118795f47f117aaa295cfc5c88061cd0659499ebfb0a57dc3fe0275b4381e40de55d575974b2e00c6aff31ce95e4fbb7b8efa9e429ed"],
];

// Expected sha256 proof fixtures using MockRng.
const EXPECTED_PROOFS_SHA256: [[&str; 6]; 7] = [
    ["a67738e20c24f27dff6227d666591b088f3d372ef463578b600051c5bfa3445dbc48551fc7a86627e2a57917d51de7388fb9661129728f2c1e7e8e1001738e70a6c75b8f6e6dac4353d80f1dac5e55e608eb39f10d04615337a75403435f4cf463bb94b50b8880f83118d12c549c88cb0b8cb6cdcb271ed30d2a83396063fdba5f21d501a590ae3d0bf516a69eb8e5db07a8ec0361a43ac2b099340966c044dd388c7958c0d74bae50a4f541796d3282186d1293e4628870ad2d48a58d1b8d081efae5876f6535521ac993d9a5c40fe59f2fecf0ae26629d65daeac81efd2c2302d33c041ae66f20bc5db886c8553f816dcec20a7a6afed5af305790acba3bd66bc6f9b75d7a654539cdb8faca1633b1337dfa3906ff8d1a9f62297d4a2815e567e1d84a61f8ea09ecb47ebcc35989a11e21fbcfa750dc76d9e3078b5bf2fc6434e32a3855cbf1865ef6ad1cbdb860c7781a3b08c27b48bea83b8cd38f47bd5e284f2370bf3576912ba310767e73e35f2a6a1da270aea7a3c61709a59b687f00", "b23c3c9c5aa2bd43661731f6f6c9b9dd074b33fef862de44a1011c81dbb8f0faab8c994e76f40431953755ff077e0181a01408964b27d6ff089b6f45ea89574d487c301838622de1f2bd9fc1d5ff8d87fb84cef44c54efa38c18f4d84a8e18e758af3a7b12493c8535c5a0758d836e327627018c88db74ee4dc23553eb734d2109710043e84df893d341ae6c1adc5ed7bf63921517a01aa0326baa281d8382e9348daf7a4b51ef30becdac475b1e8ee7b6feb4d8ea226d7232e652c8d824004f1413b54ff7323cbfe8f48234a0328a59582f9fc9de1a047ea59d665f88ad7b8c68a6cb314bada7265ad9c9fd3a272520efd6f674243fc73e17ee6823243dbfc0520d43d4bc319477a9e6a90e057971f29b0d4b559de3cebaf720585fc1dccd5f47111c8a9dd52eb26a9d89fb93c4cea9cd18e40e2b78e8cbd37fd8611f03d4306d97e5a9e2ef1c65ddfb1871cc14fa4c0e3c258a6a31f403c417d2112e160440", "ab7daaf8de72e9fde853d66ee3282198788c67afabbf8fa91d65b405481ebdb45d1871960ce05993a333dcbade2e187c979c79ad6311057bc640d52f2ad8eed495567eaf071e2c0d26646819567bfb2214e440522978b6faf5fde15b9e21cf91247e78bff72c73e71afe0b288a782d426fd7f24e0a8affe14fcbdbc2d923f45c595d4467d25b2210876b4d6d9abd15540b8f1a62d88700817f4ee2f3156ee96326076d9170ee620c31b9287c002025724a87e012b7ae5e54f5457ad1a009557c2008db604299f30f85bf00d1ade4190b13db40ba7a4bea9aa56787eaa8c9fc455777f5fe90f5306239362bd40901303187e001e8c08b4fa8f5eb32810933d4f81cf80c35cd719de12603cae9f8887fe67931139caae04c6d11ddc2bff929a063146c39402ab53b7370772cfce2a1df557e79d0cbe92bdcd940b623ad394ff120", "988458de89993db536abaf800418023d3e2733b5c791dd7c40ac883f09464cbad4467a22d01037bf52437eb8e8fc7a6a81f84ea16bc62e06d92c25182174f5921ce474d16883e5aa431ec9d01fd90521af5dd7ec7d13bb6b1667b6b4dd010d5c389f31c3bca7034a3942f1018d30dd6b629ceebfb107282c4b71501c35e2ca52056f7858fa2fac45de719018c0ca968acaaaf647d644a8e48e3d78fc154dbdbc65642bb6cf5396046d9c0f87b88802ed4703977b75f1c0af39711ac0cabbb9fa458b8e0ea8c7d9a93065e0aaeed9c4186cd8f008b818874a28f0ed2b9ec49cb8512ebcbae2b99e9765d1ca96c0d7f977e6ac646a16baadc69b53513d7850d25f479ca8e8728003251757b1a8eab03edf7d54b8ba8d50fb8eb586eee79c43ebd2", "80a42653f5714563984b85d17012a22c4cc40f3b7e720442a80a1227ce14187fd3f33e5e3d744653bc6af42e8381ff5dab2d3bc696ab612562840aad5e078628dbebfbd65eafb690c756f31e270197fa46f8b65f1b01217e55476c7fbf9d48c53a735d13b7468e7107fab92e7eed9f1aa1b80b8beae92c745a165d688382cd351f0f88bd34f308d5325bee3ce18058bb36455617ef4df6a81a68986666d6c1295bb884e86c083cc205099f23c1a82d73dd9e525a9a69a5823e9654feeeeb55b13d77c311cec1bfda2e502a1117972a8f32ad759f114dba4c080f016fad952ab551bb1eaae7aafa00973972efbf3eadfef65c5fad9ed97ca4bf8836808f5f4c25", "b7ab67227b9bfafe1190b856b47a613b3f1504d57c368182767147c5bb2ed2e3215a9b294f73c5245f562e2148dbfb7288006edec03271c7752dc56e5973bbafd620999eb2cdef740be63b2f3bb38339ca3c4d109928aa32a934c3e7c957084c05f5c9121c850ca27130b63a4b282e073800233a3ca0d7e797ce4f51a5a4bb9f4aa05d5e80210b46e3133d654cf4b4f7e0eede3421daa9df34638ee1a87ee27e6447cfc740282a18c9c421bdf404a46ee741b49ca5d65c7a383ed060b5f06d9311a685473fa7a8a883244816c46ad9dbb5d514fa6547fe6d07bf291bb6ffd01c"],
    ["9295d4949b36da9f708c7e7fbe7067e656fec707827a63e8fec4df950bb94c4d7f046138afc2ee251d1b460d11784ca0b18cc018914725b69b3ae2a37308990bbe888bbc405c85183a2ed3ad75d623d2c826a6d2afd642a99b5d7abc8aca8eaf5c9df7423795cc6708725a24e5523f430c059a43319f812d4005c402f3358ce93c2563c11a46a4ad9a90812fb3ab5266b656c11daccb607f0338b0943c80809b651cab20f456bb6b16fb4b92db81e5318d194c71821800263930966a8fbd3ea831eb1f8cf4348f2a8fc8c3d7995c94f1ed2a6d3d65e6646dc268d2fc1936ed3342bfea987aa92d83dc78e6aed069c6b48ecb94b64602c5887b87f30003eec8fe5f6e2185848544093741bf17a11e29f010b7dbe56cd5cbb47af0ee783190d04d3eb091a54f54de9e20d6780c998dc5328613d038c5f0b14d8d4e53e2f09ad69e22c9baea555a49d12a53ca44c63fdb4c273ad57d2efbf10639ab2641624e18c63e0bf02527c50e335c62e8f0578964cbdf7fb11f6eec03486176d2e84382c306", "928c273a8630724c80a75681c7bce0b4b4a0e4a78c4a5aba2dff68f6336103726e3908ae285f63d93f94c9e9ae79cb91a3069b7c9c33e4c950c98bbacb5e2d46e4b08f462c945c3aa59f272a3e5e60682bf1293f45804909287ec402a8f9418f15795d6a6de54d87c5fe5800de96c3ed14dc804e6b4ebfe43015c0affbcb187f34bc32274541b6d5dc2db845af95654372d031be651fc8829934b57ecb029abf3855637f7108e12168875fc49931ffaf3e2aa919cd513b678deaa3679f0eac682544b1b5b6ff9de03a66c52192bbefce452f8754f5f70c9d865c4fd1823ae6773ccc52ef3384d504efbaccd6caf30a9ddcce4cb3646de458ef485c3e67aa2d8f62c8ccf84f77b9c83a2be18500c895ea9eb8331323101c041e8a201aab30aae252976e3e46fd52e5572bb29c961090dd5947dcf4bd300e48985931a5fe4fd7a25e2ab9e5c1942fab2da6855aff4a78593397676f31b4b06e9e63d33113d0de25", "8c6b1e430f9f0f4a7a46ddec05799b6e657843d799d719aec146ceb64eb7b355efed54de4f5b2f70b29fcf2ee4a5b2c9a408ed40afc4e791a07008dc58bff8b8d5cf4f57801b4e63044085337855c5b4719b007d38f01a9112c3d333fc12b7b852d659092a7220d2bc8b130a38c651938b34970f2d19325e673ab0afbd1c9fef0e7ee3140f0f10597dbf6560a5dff23e42327ad5a8d482a63325020705b45d0d1e618e7247c6e50f9be425fcc95610c7d8d1e305876078833636d806828e2d3007f5e2c1aabc4c95058c9ce58fe1d791da792b4331280bf8f565d287db296c280d30332118270ec0c642520c8dfe0b3ca1385143c1809e62fbf8ce06e26a6c2623a72f6ddebbd3fc442a2654ab4bbff34b76cef039e7704979a0f15cf4c61c875ec07355540516ac7b04700ef81bc1bc776055b29e93eb5984cb935776e3d4b8", "846f0ffbee7e5c4fdaf34473aa4681db30962da15256096a07088c1d3997d35c49a3ac98d858103b5f460109afea6c04a814ac123e8954ca577246768ae509f5c435214318f5a0be94ff8fd9e4ffefa2441b51f282ba0d49d01753423d1dc3f74e89ab0107808745b6a8130fb7fa88d1f017b6d28b5f9e8c7dbfc22ec0e44a3e0588e68f85c53397af5a359dd207eb111100c71292cac87bbc0e5bf9517fec793697ddf0e951a6ab0a1dbd8e00ee7a250b861b6b2adc1ff0a1c2e8d7f53698341c6b45bd39ec678cb25354d27c507cf6bc34b24de4f0fe8c15c1c6a342710169235a476108ffde43e014e08eb81cda4179ba966bd58cbc64c3cb5f0117fc26f3432269c0f7cb33531212fb51e5edd121fcb70a016a10b9cbe405f9b416ab2d92", "8a4f598b71d2bb47518e680d88c6ee85a4de2ccc344db04121dcf95497a00dc9c056ffa2b8ed0f8d9656224ec4d72d15a20d744676fd17525985c92428bdea33d7d5a45b5af0da65a197ee8703985b3d45983bfd499608410496467d05e47b832e9851387779f1b5ba3f41cad78c60420fc30e546ba2e037bd4296994132070d4c6601f0350251a05b7f83fc6fb1ef9bdf3d661746fde1fac392b0261e37c5fe29d1d85f8a40fddf9a7ee09fe92a57252adc2f512635c040676c9be5240f48086bb1abd9ffa67839503231547685f5fb60dce31236e0b3d5330e4ac2bb0487ea6aed4a25a7b2ff49c902ab794cd2f989a2d82d70ae36f863ef719049d5042f8d", "8e30200cf9d95c9f49cb3e1823ed18f076b845d73c49204b73519ea90b84f9e90d7d51625c66dbf4d049d037407e1212a4250be04d1dd18caf62f8e5ec4d569e69908459db315eb25854faca00fe8bcd69ca16eda6007f31e8ca7ee240829cb9090fd2c6a7a9d82a898a10f00d9857d83c9dcf1470f8f6d1a277e6d6bcec8e2117aef6716e46bdf7daad852778fed6608d8e3255dfd6e0af43bd41a5e12feb0d69c4a2ed2586ba141bdb4e119fc4390008f7063422e33185f544e7f04a41702226dc466eaebf72377d3dadf3102652180be1dd9bb131ed2369394b4268bed457"],
    ["8aee212952684b4c8f994f1d9faaa10d55987cc472cc1b848c58d1f34ee8985b5360be9e10994e8d4585b08fe733d2cfac236aaac977de63b71f8d8d661b8cba8847494eff45ac244abafd798e536c312e8accc3d66c76f3b64256e8104cb7e564256bdd022b64a7bcc1719c7b492e3f1aa2a59deb624434b390e792cc9dc5201514914b7d3f302fef7544dccced13e32a7b8d8b559c5d0556a087d629aa4445370b213618413063d5a64e1a61f72e33993b1612667b9c092b41e3dcadd1f1dd38013cd1e920286baeacc8e8bffccc85b0770782927eb0eb0cbc89124da42cad65f5f8e99435d3faf71773c3f0337804a8ad0aaa6f94ecfdc16141b9ec7812731e4e5706eb501025f16068c9f0a629d2b7c79ed6ad0707c02b9b4140c4dbcedf60fc8b68cbd502f4e949ee7a74ea3ea3c61f388d7b3b480acfeb0f54cf5f12c70ab693fcdc972fd5641d39ae483633f639e2c1e0ae9206f105545e68f1045c515e81d39ce8c610cfc90aa18ebd577a51ef278d2e4bb1dcbf2e24715b85451343", "8b899f0ea7528a61e4b933a888ad0c6c1f1f7dc5f5321bf4bd400f816ad2bd515cb74a4d9ca80df2b424ddaad372ad3db8677c5a1c24ce0f0ba3bb0afbd633072d6cff11cc919260b49ab17494a380f0f64fb05016cca5972ff83adc6cdb2e0724c15da5c31fc2bae476ae6fbcee0654b18fd4d7c20c05dbd95a0de85227c44919426247094fdac7b28c31cbd48be17153385168b312252303ca5ebf8c75e8f32ccd478344bfb266877b1034e8ab57f55676c06fc7d7938b59f7c1340a0c27b73023dc4b5cd6964350cfd53a3b8b294853344b9c21a8e7a7356390219c3355ab06320ea3dc62736e1a6aefc5dff7eeb6278cff93026ec5f3ccb4642e03e3cb294e652b8a84808e195a45bd52a082addcadebb3ad0b3c413998f4fab974da6438044c4fa89fe8d2bb60ad9bb4efd0de6a8b77cc6f946a055212a804439c5288640ff633d37df8ced308f34233a9e708e8121cc0461e0ceaca64812e058d8a718c", "b3ecdba4d0013ac91a5f880d3243e67dea6df773612adc6ee49152775a030dd82451e0fa288830e462dafbd5040f4d1e90606888cbf9076958a0da56fd4bbc0dd6b318930cf35bf5415ca95577604583786db26f93f41491640427071bbbbd5f56129b180bf151f4044c21547855d066dcfa8e53fd27f1e42c7c54e8cc15207d56b05f377cb02e4d7f64b106d253b02c395876e2d5dec7ff345e486bb7c42c096e1028e20fde3db8e1141ceafe1fb02454f06acb609b0f417aaa2a5b889194f55afc624acb266cee14e32cd6ababc26914afda5984305a52dc6cc0544349edb02a2b536f9fbc1ad3c1e5a368bb994875985f48fcdbc4680872e28b47433d547e2bae435149a7fa309be84daa7a6d1ff4d31f8937eb3b0096d78d49cc345d45f40b702c10b46cedda99a3893a09346ff6e37958d308eda588fb1b990c1c28e2c8", "8a5a758abb95bc306a2f5a61e2402f1eb04b3562aff54609bb7233b455b25baa25c09abaa2888299791c4fb5fe5413b2a51871a6923d9aee28e9c389d27f6735f1945665e01907a367d0859f961c8772508baaa69a8eb1946fd7ac2a3ba650f0436df68d20a2d1767cf037946a82400ecef3e4c5ae7a0f3e024a6ef8fe11a6af39d0a710ff7b01ac073ed18d74508613f6ca4cbc80a10506f5e23462c2a5c0001d47c8489fc4edb7e6881cf3d19b2c86fa93f2f9195114d425802c29cb9f3b1a09c0bbb70d66d3c114b4bb7bbae0abdad666d117e06a4f6116cfe71bcd49a3d520456acc5b88f182bbb46e3d007c4c0bcdcef66095ee79424a0b2e2c8b42aff452ac86d20f11189a7a60df1cfb21d6985f8106cba22af85f612ad4f0396dd630", "b0edc8bf444f5262ebecfddd799008f48ddf8205af0793a8ce7255cfe21a0f330eb6d7e5b38a87f72befac7f9a232439a92911b368adbf7acbc3a7d61de7437d2fa88862593c67becb5baac0b67b4c2a04693100a6e8e0505d42cf359f2ce7a247deb3ab67953247eecc64dd2190175e6839cc08e2ad3dd5603ab859297e76ea31530a84e38f5f2afd3babc8b989be7d4942dfe9340f88c815c3fd4d2785026a27f2f9d8e979629eecd882e3138134e83ddddd396aef378625f14f45d16b121c5e0a5a81a9dae6d346163e27a133cd8c0ee9c3c95695b1cf30945b9b5fcde0146a0138653738edf05121708ddace55dfd888c16b672d19f5893ba526cb085919", "b769191fd65fdbb407bdcedd400b9faa11e4baf5087c71d968ebf602aa1be5c7b2280a4da4585ac5b914b914a2a0d9e6992f00dd51bf4062b54ee43b56af8476a9e4d16a135df9f54c269af4a7acdca251b9e5326e33e058c37c2c3240fbccb218ab3b66cda47f4fa425612c44120dfbdb0dc188388957f0f284b241dc29b9d647775518bc7a8ef03dc80941115f316b685a2dc219165ade8e8e74734c7a900443041a485528364195ebda7980c3e587f5541030cd1df394163965783f14c0cb6a95066fdc7e3168b325e71220d91a26ab681a80040fe0b15b112377ffe77333"],
    ["a8fb111f54e2991a3825d8f086ad6c88a76cf556dd26435558fec7c78c41e8ae34fdb7be71490c9459eb3709cd13eb2181ca8287c2325245415b5b5155a5ef7938ee4d2942f1dad42d2007e6c87bfbd254982a356bac63961f1ded4f3c5dbeb22ccabc172be5da6ba4e194a4227b8e929d960965e46ce18a0b4ec740dcf3f71b091ec7a1bbc477b7b020777dcf64eb550177e321bb42aec30c5470ce689394c33376e3f63e47972a2b3924a30d3e839d1b658a01513163b78105c57e96966e552005841bd081c05c46e0b50ad5da2a9fd7460668dc259d1ed6a3413f362217c64ffd75b85829c5e323cbb2c608f5e36020a7529e7a097e01733e3908204f1b370f3222a12bb022b45c79631181445a936e52857a6850a1d6ec7db928cf5b05644fc1b6b793a47f0da32bbfb7a2339eaed6e3ab8a0102c1584d0dc302a6891f1925731ba2746e7182bc52d57f3685340d1eb25e264008c755b9fe0d7b7b132b8106987f9e7415fb28bde72ef36262dd0eb5ee8c04b028f3cb33c611cf2d046ff3", "829655a210a16a5f9185704787f05ee3923e67ab8f0411ed26f336ea6fa7261e78d681abc34b85b2629455085f7f91f385f319e7c3d610d6170b71ebd0d3a17321c81cf51a9babd0e2c276c6707a83877da58aafce711b8a010f79b0c80c53254f0d75da08dbddbf85a87b14099ef4c8f758c48f92bd648a80f21783243a67380c8b0c12dbf07a47a0fada943e2143b4d2e25406b9757384c8ce5d27878b40b33a0ed2955413e3ed3b94480471111483b0dec2af809f8a19de7c0802c3426c406771d773442f8f0491a6f5126cff0221fe81c6e5583282aa8e7747ae2b2639f6325e4f920d0de7f29478209487734545c58c20492f6ee09c6a6a39b8284680b731ec78db71a47d447493548d6e08030a978979ee15dd80b8fa0c276f0b48d0fd5d472ad83ab852a7db88e2bdf8e43fa1e1be2b782254e23532df32b719ae7e79576c6c6eda53939bd5d8f47137ec769837487029de19ad2d7d38900b499e3470", "b6aac5061e63900252a8eb132b9d627021c95020bfad435986ed252566ce84c692a35b091ae6963fbd201a50fac9cdbe827d17f59cb95ca842c1880a54b0afa14ff8f30bc988e2198cc43b88a730b86dbfa15c59f9233736ca3bf045404730493c3d2e88bb56e4206536d8231b75ef5dfbb2e0fc0046f29c14e84a7ec30c6995307d4bbb5371f8c0b9cfd5583e2ca33192f12c60625e57d348fefb20fc7be5f23112aac123dac6d0b6ec40e14ee4cef7d3fd0b7cf3e26b65a6c9ad4ee316e4875766720cb47181ebed87d5702d26774e8174b7f5ae0479ae4e7e34775c0bac173ea92dee1acc86f99da68e5a71cb25e048287adc4ebd2f8f914aa392703436b072ebdfd8b7b95271e9df684aad74627e47f003864541ed6e541e1d3a2a93a9cb2a5c646ac59349825281388b9c0c574338e40901cd871d974d7b44bf4a190874", "87ef40dec19ccb5ae3ab09ee21d11157a1e7d7076f11454f30b4bbf38b9a20a55c5d6c82fd8f3ef0cb50723bc524aea5a0addabf6469a1ea22fdcf0e3aecac491b049a11b9e50028aa503aef46a2c9f2cf9a5134d3ef2fa31bea797909afe9eb2697c9e568daa3699b27b270ae26efa79474c2f96e7f9f53ef72bc3afa0462af3e2bfc674b316af7731416da13d3d4fbb8e90f3465d0ba23a981c0ce03aaa0e64ddf1e9326a329b7803c9f45ff76711927d40d5fe74d39a92acae541ab4f64372563762d012db3f7c7fca036419f44829d67bb9dd606446bd43313c845c6ee406c9c0ebc4327d96883e3a4f3a11ee9b098b47924f2151b2cf95163ae3bd094cc37b788d37bf994411006aa60d887f2b07c2732bfa1f9e91ce16a0f243ad3f420", "82f34fb77acc868f8a592d2974cbde18c242984284c95b00a35df91a40ad18899ccc973fc70c4b5aeab9cf001a019f13a542bba389c14b9b58b5446778fc64f64af70e3349392372d3cf2bea9fe7c1e05aa474d09b234b03360aabe1acef989f52dd9aa2a69b925f84fbc102ec63d6c934e72f154fd6ef1efde3865783b9ca9b00c07a4552f6d34972d911e40b64331e8ad8da4bc29cafc16cca5c1e8beda49e53ef30691473c78e672d98ca2564dbcf232e5a8d7939434b5a2b6284571c5df13a9a2eb7f8ab55dcb9b198280f71e7dab977004007288b4f77b33212a74e806f11bcccbad8b126ac89d1c13b83d23806b00c8ba5264f2095bbaed46935a5600b", "80889ffdbe8e94bec4fc0eb088f8ca9b808d12d83d6651a7ade515efa96f4049abd78b743ecff07ec2e7a6c93f17c42792ed75ef25c08e34af098ce1096eb9a6a9c9003614ffb9511a6ab8b8b8a9997330bb3586fc0323e3bd501733aaaf4e4c3ea248d65e84d5343f9444aa2b5102d2dfb67451f860ec1e2d37bc3896571bb21d601bbfcbbecf83d447cd658d56bd6aad3670e05b674a9cfa6c4a10336d3a3f0d329848583880c8c6c10dd81aa4b03d283256fbcfe59b9a5a57b34a089137036728abd12c5dbc3a46472483a25b625fba33e7acfa2058033a797c447b76c923"],
    ["a5a21cfca36f76c5ff57ae60fff0beaa167c0e16034f9afcd94eb731799384807287825a879d1bebb62dd794c94e617ba6cc11ca98a1211ee42900bfd6fbe5e91a1cf2e2bd6408087d3085688c066e3177952b99e8560ce7d1cf55e74999c56c4d2a09d79bc30875a7bcc36028feddfd17764f35111e8dd1a7edd2c7164561140ca9e22f530afebcae58da775673bfffd3b00e4b7dc25c4f47c20ca35fc3c15733e0a94e752a323777f7c014502c76d39ef90e4d99278491e45b9a82eefa07d901535b5ddf16635775ea529c7849817a110389457843ed2fcbf13c7fd59079c810bde5143bb68a0e619c793d75dbcb645a0800496f1bb54316c9295bbf56462e4299b7fa1e2c45713688372f601c5a891c745a794311bb7ecd1c12a56013d5cd30af07cbfa65155110600057484618cb42aec96169cbab8dc06b02d4c8448aef047e4d6992c4f42b63e2a5f63ed42672442fcb01fbe681e2ab58093ca227433404a6e4a690a808d5e9cee5ec430e79a31d2137387c550f8383cdd1f6e4fb67da", "96f62e684c35548cac92a71371fafe88401f117503bbe05d14ce3b7f05df82eee75947ab68ded9c1e8c0fafa87811920aeda16a274e13a77b6c39ba75265d50a2dbe201bcd43f6b0ec2ff1ce618eed4eea0548c416d42fe2a2b1de9a584987152bdea05ef37c4db296f26720de11f41895695688669ea8b08c639c622e8d672e3a368ea70cb6acbc6f5611b71a8fe9187af534827f62f70a3a8ff6e5d0bcf5f56543aba40b966df1fa077290d7c3c73af8cacab7e9137eb4d868e642f332086601fb7c89fab82acf472220e8a4b959c77bd8603f809aee0e5bfa6c5ca729b1f3256f6d83e27d41b780351c502d97621ce5e6d357afc9d46bd9444bd1d28bb07e6acfc3be8b9827674a4ac55abf46030bae1758de72ecdace6dcfe2f7a0b85acb671f37b26290bb0eb317182b9cb92168e49f9a32a19e4c7daa3e85e3999bef41685bdd83d4653a314ad5efdfcb4db25b2fe64e02179cdf3c9277ee6763d032a1", "8c6f0f73f3e68a3a6e00f32bc8b24aa9541f3ce0600a6351ee25fa4a83d013f4837857de04f286e2fd040e7c4318d16ca6a7e823bd5da8fc5115ee2dc2f9b94643b4f8d83655ff4175bb074dfab9b391b4f34cc16fbe05dad9921b343f05daef66edac9adb6c0e8075907f761cf03cf2d353edd0c26e32b7297d04a05bcf294e00ed65399c939a5647976906f48becd19bef91481f00751b45b04df00693daf92526886e4fb2c7883fd7194ad048cabfc6bce7aff7d63d18614ff182e8323adc522339d482b3f8ecb7c83c2a7a83ab59d81164040d47c8405c7bcdacfb81ace47205750dcce2ac406f34b43ffcd6298344f027d563c76e8901fd5bd36705b29f5773e37d67fb1ab3430a5f43cd7756f82b0a7ce0a76b77e97b6423c4da2a83d80c7e594a5fdcf0db3018a132b123fc0b6a23622c541cbd2f7f2dd109c1ebea88", "b71435c13f6a77e4c149fcb45be0fe6c6611d99cc5b746e7f0bea11e08cc827c29e7a9a23a2c6b28159d916ab59634fcb6f00034f7fb0cb1c78d9a51e1750fc01f76d262dd1c03de70455438463713b881904d9a5aeb6a9111ca25a2d541c7323263dcca2758f9baca84d88d6fd722d3fb5ce3a097b7dabf5358086b993703ba2f5fa04e326b566534e4bd1214f50f92e5686ddc7c984ef15cc09aade256f1170462abf09c4777939b66ed30b995abaef8dcae49df0f026be11bac3e75593a72601a09166177eed8307e2fe2d4308c68a360e47c86f138665a7f99adfc6c5ad1220e00d7c596c83f38f49cf7825fa89dafc31b47ac5280c5a1eda85b2a9f34c605a16917be90734df0b2f75ea700bfa5a011ab13fc4affb86dda53f0d22ea842", "a312ea9491a6d60cefb6209d918e393dcbde47fe5a21a169f50457d56b2fe0dd92acb630f1ca9dfff1ce78107d339b768927d9636d6f47f9f12fd9fc8a5bc74de9b25c2f2e42eb8ab8d5c44ec4b6a2512411792ed965ce266763afc5047f59b73a8013ccbbe204510e8bddeaa5e1db911dcc66068eb20c6a4852c7435621feb62e078ee313ca5c1c9f02bb45e614d981a71c08d1fc58dffec02222cc5c09b0a552c31f29b021f41b174fabe5b140f633a84b2fb000eb0b147334f634e9ebd1633a14938db9efcb8feca809ccf3179d699fae2e20e61390ba86027bc170ff08183888abb4cb846550e69f31a743c09394e7a6eea3349d13a500c54f9a55c92cf5", "874de94d9d1333f89ac414b035d6a3add23d23a6af52e3422801eff6aafc354842714915f1d5c9791e66f7af71a30054acdf7e35f1bf3efe92eb2916de0b7afd7fc64cdcf87051ac482579c88886e824040d31137501fdbfc277a3215162d72b17ef36b3ad4e8c12b9e6521fe4d5cb030021615cd5c6d47714b70bf90ba6fd342c62ba7868551dc5aba643c0bcc928e3655299388ca68eedf7305e1f69ebd3f26d536737d2de295e5881f64deb093340442dd21b515eb03de003a5a911afda074a2aca1fd8ae989ef6278e8951699e8e3f2498adbd503ec33a68045d1d969aa3"],
    ["acb9f5a5dc13e43b2119fb2e1fad4bc87dc7d5492d3e185020fa9292f7aec12f92f4ab9f6bf6d9e6469982ef98e4acf4a5eadbde817e45c1f5ca42262f5fcd616a1ca7cefaaa909b19eb20b79989bb8aeae930b5e29e1761a005cc285fc32c202127eb4981638ecc86ef88c8fb64e83017030b41b116ad5fa83d0b05e9a6fea81091d655a531e07ac705fea0f4ca95540d2de71047989574375a512b6e6cf6ca14d1950035d3004ef48e450aed227d7fc27c9db9b69e28775f483b9cc62162f84cbd347766820d51b971df971f89e459e01474511a9a68efc8fe83f5a8a8ae995aada77b2a7d80d786195e46c7b3234e215af9395a1052bb773b0eb0006281fe2e525c76c7ceea4a7711f843fc00fd15c359d6a1fd95d5c13c919ed24b6c620b53ff75c52c5bb8bb3857352ae4494b5d3d82cc7065008a6f3cceb3863fb0bafd5a829973ffa0beaa52dd08dd6debbfa55e9980fac3b8e00209e7405b9457312b5b5d997b6f39209c4aca54568bfd78b431e82fca58e300ae86fcdf68035a7f10", "a27d87a3fdb325a4c7b390d3914ca555752eab12dee6c32a526bb6801481eca572bf229b404c0b19a5f4456593e940b7956641fff3e94ab382c53096b46e41e7c896ba73cefc61440943db732902f8c2d5afda472166604813da187a90bbe2602d40dac7f614d9037a7f705febead6f98899cd08098546b1873d7aae111f4a5f2d2d41774b605fff127e5d89ffd5d23ffbcfff9395a057cfde55f080e7d063ca0b9914789d6c0dd640628d007d176745b10a5a4e51ef228a4b2a67f7d2d7c61d6d494f3c511314b4b35a7113f6f81154cb1ede6e21276808ae4605edf9373fc224a45bf5db79efa40578a4b64ccd48b3905e6a288d0a823b51d006463f8d358b273ecdac8ce738085d14cd8e353a3c504b49401200c8844125418886fc4e940a4fe13b027e8ebbbd7f24f9e3a4c874eda6550535354c23363ea99bf102594d8624314f4730b5249dc52de21f9de30e4b1fe5fc14e52b6dbcddb4ad1619199f08", "99d476f31f55fc591d4fd4564a9b0da4b9bf64c7051fe91e9dfdfdd88eefbdd8edceaeb1af54884953c0d6d864266aaaa144c7e2ffcb4d31c467e3a4cbb20697529f987431604ad7d37aae4c07d9779ba121537b3660f6c6f2440d2565e255684cc0ecfd4e485a95eaa9c78a93bdc42d1df8460fbef10b1c1ed5b71ab64c287e5acff2dca584bbb7aae69219820c1fa53e3ffad3ed78b3d6026a0ab8c971440852d7ed5706efaf0654220a1dfc707c6cae5661a2a1f03f2723cd3b68fb1d394e20e63c6272cda0e0bdd1115a12eaef1f68f1446db66f9fa24ceab8e3de5de81f322ddd0862bba2c06392912b1f8f0645ac66078047ea27f4e9659fc900e9a6481dce268be44ed8416ceede4514b72bf27823ff9607b0a678e675ad564c3b9adc4e091987d47e117e6c2bc0a390d63dd90f07687500e60c0df9401d0748b2974d", "b32259b13ede7d89f3c887321b0a228f215a1bbd345e3ef6a054ef4ccb7674be63d4c5ccd8a01f892d7e44a80424637c80689d18e5468a5fd4330f1ca7bdb6f28d0100a9e2ca4c4ffd78edc71659a6d32cdba4656eef14bff275b6093328625b4b25f2e18f4de9e991ce30addd46424a80c8c3ea565cd3804e51722057c0eb300187fae17077d8170f7ace5e25ca462cf3dc0aff743946402adf11348bf515641fd31481f64f02c2e8ff5a0ce8fb9a6c05c18d64574ce7fa29d2b6c10b04509d30311bea12a847e8188bfc238b517bc7185ece24e88faf8aaa7cb8cf36d7776448538f0b7e1743876660778aeb1821c43ab88dea2da2d8255b6c2508fa13b69624faa5a772728f90036f77aebcdf4209308d5347acc1405682430e88a5fa9235", "ab78209c37893e0a5ce02561f701041806a7fa3e486e878fcc17c2dc97fa51111883962b124f6df4cfdf5e0493c303fb8ddc04e3ca4638aa1adc07b2f3f20618f6c2801bc14d2a4b1d226e6d4c063e58e2da63079169e27c636cc1f77ecf8b26329ea27497e04492d5a22a27524fe700a1ecb59f9363e20458457d8fa810438803a6e43c1e980f3aa72b88775cba17be9685a666e6c508e84e3b8751101f60051f9cffc990f21cacdb7365f788a949d5667588ee166ea0479155496e8251c1753b3f624e7d065f7b7b1a2f67cd782581ad32f7ebbbbf59d7738bdbd2d6e77ad046cd001c1b97e9057ad59b035934c37c1ae10f7cb6b9deb89f6cf76fcfe0918d", "a92e3e230d019a045c072e0e8f0614b967cca0bc81f589113617651a3bc9456ac454e0b0dc0f51561fde3b7ae653d15ea874b04e1d3914bc844c6cf2ff90c3f2c5edd5493ed9ad3711b0854c00e17f734b2c9d5ecdffc5e415b2b4fdf8102e8b4bb07b5f5c70d16c0e8ce5cb00470c9f0a6e80fa1730803f0cb05e72ebe2cbbe0d457e8b1a5282d3092d13778c94e9d7d589c8f4c252bb21c9089fbe903682560798633c5a1e7d2cb940ecd9296f26bfaff4439582301a36264f3b9136b87f053ee1ddaac8f9be8ff15afd85c463d534eb810ea168815bc808f2b5c369b4a902"],
    ["aac5ab25e0996f32271275ba54ab6cc1fbd2806883992e05f25659f510428dccde9c4c98963daf7817ffbcc9a8f725b2aef13f60f38dd8a55f70e78894fd59e38ccfc45c66d06a147d4bfcdd693f5210f07f13b4faf5137c79994ee5824abf9254b5577104a0f49106e8070b7a6cc6a9f651c01c3ea2a1998ebacce6f913be4a1f9b19bc14b581c51675f8573691957dbe9e8296b9a11c3113cca4155749bf372c18143a5092bdd836d0d5e37d287591a128bd5fb9cdbcb0463eedc24276ef9e062a506f9cde01dbd2ae98a58047625b009b251cadbde23f97d6ce7e0e0af4007208b381b462f42dac7366f16e8e4bcfe2bfaf99bd75443a9c0ac479a1f7f6f03c274f7c1d28711a1a98561457704ce9c4801c64aeb29c50f87b1aed77ff0f9848e4ab4d59510455d8930369fa6364d386676ae41474c14781c54ffaf42d0b8a1dee92300e65b755a08f4af0e9995e92d637462ad21c25abc778c70e48c58e2425b70c2b7acf8d7762ac1bdfe53a47805c4db0f3501fcd342c8f8c3402fbb4fb", "a98be12cfb44a6239f5a862317aecf42af98887ad7a9a780994084f02b951479f6112e9f98c4026fea81f1fd3d5a18c5b0547eec01fb3cef66bbb8e89387cbd6336ec72258e0de4edb8304c0af5f09d47987fb5bc52b519cab326d1e52400b3a4a19f5c0acb2b1b5c7d5037c6a2b307418660895ac75baee96f1fa774fc248f66bd6f8635225a4f052c231aa5ad83c3a519268bb27b0505f712a02e7e0c28bae56341ce4ebfd2b4e5e83d1fb6a0923961880b1857546c0b8eadac213e3f78fcd27ba5c19e509f0a7e01b9132e94cc76595ab0d5fc2a9117d0266d85a1382309d528968766b4320e0e65bf0b89bb45332739f362b6c91c7e7c4bbd8b850b63d6150300f29d198d211cfd18811527bd63c890d22e32426563ab85ee2824294c3052a2296489bc5d9d1844dbe1c33f63b290a17537404b6e1db6d53dfe560766667592ce746786fd695fc42d40515a0bc35848b61ccd058de3acca3e6dbd0f5eebd", "aa5c682a198728424af59b36c9c4aae9ccdac86e7e6b542f775df28d315f40fe7dc1a206a6fd73854a265cd63d8d6411a6e1932d3fac4902ecdce31c1246b0cd318609e44513288f64270096f66e5e492e92ed1864d4343e9694581133ea74fa12f96a889ebd2da7e908a4c3c9d8c46d2da39c84ccc8851cef21af73a3702fe92064d656504e836f27983f7471747c30e388a2929eb9d512ef3d0c6655bdcd620d9ad94616d3f637d5ad8048de5d23e81c061d4ada9fe0bcb32f27021966791f7312505d910eab1bd1a20f2822f3f64afc10889666d4d700302be404c9254e3466e7125df0ceeb6572ee228887893c6d66b58404c6234a791a2560663a61d3741329573ec2c09d8f766f3836221cb613593c97e73f733aaddc5d8cf5405a76ed1df9425de99a8c2c2e6fb4fb2c0a4167f60169bd9ca9402d63d2e431b7ad4bdb", "8ca05dc485720fc45bcfaba886f420d90f76fc54251a2f90f7684bd2e3459cfac7b7ece10cd6c4b109253ae75fa226b7950bd15773fbd6678fc5b8524b35fc98d2b212c7192d2a69553f009941b6e861669221a976ad7f73fd71350446b25e3b5540285832adb1bf89f51a344fe3d8d8d7b358607787d7916e6bc1c228ed8af94e124ff1cd0f27e00cf6c81adbc741dfc27ffd4cc1a62fbed6a918e2681ab56173b9b254c38c503d144d8777c58204fa4f0f6ddb3b564619f08f7b4eab1d2c845d5d97aff7d1820f718b347c285cfa674ca68e5359e8c1239b73af863990b36c500e0d06d00c9a36f59dc3b21561729bce7bad735ef23d8ebd9e09578b67cbd4474baf304bb33b55d68cabcc3c628de5c5deaf970e45c2355528a4a6523db376", "845b3868c151edc09ee546602c4ddbc14457b8f6b0248002a1beee2cdadcb0c2a6bed381929aa52fb17aef8b8372b074a09fc965f759639e1cc66829a4ef9c5115c5258afacc02c05081e1bc862b6b45bbf09b99cd87d645a55d7e0e04f0cca72d48298aae6630c876f6500ee806a64d170cf8d5652cd1b0db3c032e2da72e4e4f9ed2cb9057d567cf5e8e68cbdfc4cf673a5adb9ddab2a1357c893a2311882a4ba0a32361ccbc52166ad40b3622fb487af13e393a34ac00df8181c4bfd99bcb68a0b4c40396ef2095ddb291de18f414d910ecca53551678ac7ec066b2d4490c4fa96a486565b83ac36616ffe39fb130428efc2428bb6fd2a10c06b9911bed6c", "b93738ead0f1afeb9101a777d8ec07b9c82a0711fa83bb93040c1b8427e8283ba3bc7601fc5581cd7403a6e82531df24a8a96be9c74f13b6ab4a85548921444570784e997a2f553a3767a0f4aa29d362cec74a95c9216bcf28889e79c94f97c42689ae86cdb0a4a4310df8ea9da64e2c16f969e808c79982f0b02c5a0cc18dbc058a8496b2c5d01b6e8b5b60e41a4e9ea7260fd784993208b74f15c4f4356dcf413c78b82af462b4da9f8529ddc4596775c4ad5de53a0614af30a548c9caf58730ab4fbeb9f704ae43b50e7911f2c57582cd2dfd7ddaa93a4c936b41cbf1144d"],
];

// dst and seed for the mocked rng used for proof generation.
const MOCKED_RNG_SEED: &str = "3.141592653589793238462643383279";
const MOCKED_RNG_DST: &str = "MOCK_RANDOM_SCALARS_DST_";

macro_rules! proof_gen_verify_e2e_nominal {
    (
        $sign_fn:ident,
        $verify_fn:ident,
        $proof_gen_with_rng_fn:ident,
        $proof_verify_fn:ident,
        $ciphersuite_id:ident,
        $expander:ty,
        $expected_proofs:ident
    ) => {
        let header = TEST_HEADER.as_ref();
        let presentation_header = TEST_PRESENTATION_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        for i in 0..TEST_KEY_INFOS.len() {
            let (secret_key, public_key) =
                KeyPair::new(KEY_GEN_SEED, TEST_KEY_INFOS[i])
                    .map(|key_pair| {
                        (
                            key_pair.secret_key.to_bytes(),
                            key_pair.public_key.to_octets(),
                        )
                    })
                    .expect("key generation failed");

            let signature = $sign_fn(&BbsSignRequest {
                secret_key: &secret_key,
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
            })
            .expect("signature generation failed");

            assert_eq!(
                $verify_fn(&BbsVerifyRequest {
                    public_key: &public_key,
                    header: Some(header),
                    messages: Some(messages),
                    signature: &signature,
                })
                .expect("error during signature verification"),
                true
            );

            // Start with all hidden messages
            let mut proof_messages: Vec<BbsProofGenRevealMessageRequest<_>> =
                messages
                    .iter()
                    .map(|value| BbsProofGenRevealMessageRequest {
                        reveal: false,
                        value: value.clone(),
                    })
                    .collect();

            let mut proof_values: Vec<String> = Vec::new();
            // Reveal 1 message at a time
            for j in 0..proof_messages.len() {
                // mocked random scalars for deterministic proof gen
                let dst =
                    &[&$ciphersuite_id(), MOCKED_RNG_DST.as_bytes()].concat();
                // number of random scalars to return from the mockRng. Note
                // that, this value will affect the value of the
                // mocked random scalars
                let rand_scalars_no = proof_messages.len() - j + 3;
                // mocked rng computation
                let mocked_rng = MockRng::<'_, $expander>::new(
                    MOCKED_RNG_SEED.as_bytes(),
                    dst,
                    rand_scalars_no,
                    Some(BBS_BLS12381G1_EXPAND_LEN),
                );

                let proof = &$proof_gen_with_rng_fn(
                    &BbsProofGenRequest {
                        public_key: &public_key,
                        header: Some(header),
                        messages: Some(&proof_messages),
                        signature: &signature,
                        presentation_header: Some(presentation_header),
                        verify_signature: None,
                    },
                    mocked_rng,
                )
                .expect("proof generation failed");
                proof_values.push(hex::encode(proof));
                assert_eq!(
                    proof.to_vec(),
                    hex::decode($expected_proofs[i][j])
                        .expect("hex decoding failed")
                );

                let mut revealed_msgs = Vec::new();
                for k in 0..j {
                    revealed_msgs.push((k as usize, TEST_CLAIMS[k]));
                }

                assert_eq!(
                    $proof_verify_fn(&BbsProofVerifyRequest {
                        public_key: &public_key,
                        header: Some(header),
                        presentation_header: Some(presentation_header),
                        proof: &proof,
                        messages: Some(revealed_msgs.as_slice()),
                    })
                    .expect("proof verification failed"),
                    true
                );
                proof_messages[j].reveal = true;
            }
            // println!("{:?},", proof_values);
        }
    };
}

#[test]
fn proof_gen_verify_e2e_nominal() {
    proof_gen_verify_e2e_nominal!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        bls12_381_g1_shake_256_proof_gen_with_rng,
        bls12_381_g1_shake_256_proof_verify,
        bls12_381_g1_shake_256_ciphersuite_id,
        ExpandMsgXof<Shake256>,
        EXPECTED_PROOFS_SHAKE256
    );

    println!("----------------------");

    proof_gen_verify_e2e_nominal!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        bls12_381_g1_sha_256_proof_gen_with_rng,
        bls12_381_g1_sha_256_proof_verify,
        bls12_381_g1_sha_256_ciphersuite_id,
        ExpandMsgXmd<Sha256>,
        EXPECTED_PROOFS_SHA256
    );
}

macro_rules! proof_gen_failure_message_modified {
    ($sign_fn:ident, $verify_fn:ident, $proof_gen_fn:ident) => {
        let num_disclosed_messages = 4;
        let header = TEST_HEADER.as_ref();
        let presentation_header = TEST_PRESENTATION_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        let (secret_key, public_key) = KeyPair::random(&mut OsRng, &[])
            .map(|key_pair| {
                (
                    key_pair.secret_key.to_bytes(),
                    key_pair.public_key.to_octets(),
                )
            })
            .expect("key generation failed");

        let signature = $sign_fn(&BbsSignRequest {
            secret_key: &secret_key,
            public_key: &public_key,
            header: Some(header),
            messages: Some(messages),
        })
        .expect("signature generation failed");

        assert_eq!(
            $verify_fn(&BbsVerifyRequest {
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
                signature: &signature,
            })
            .expect("error during signature verification"),
            true
        );

        // Start with all hidden messages
        let mut proof_messages: Vec<BbsProofGenRevealMessageRequest<_>> =
            messages
                .iter()
                .map(|value| BbsProofGenRevealMessageRequest {
                    reveal: false,
                    value: value.clone(),
                })
                .collect();

        let mut revealed_msgs = Vec::new();
        for i in 0..num_disclosed_messages {
            proof_messages[i].reveal = true;
            revealed_msgs.push((i as usize, TEST_CLAIMS[i].to_vec()));
        }

        // Modify one of the messages
        proof_messages[1].value = &[0xA; 50];

        // Proof-gen fails with tampered message when we pass `true` value for
        // `verify_signature`.
        let result = $proof_gen_fn(&BbsProofGenRequest {
            public_key: &public_key,
            header: Some(header),
            messages: Some(&proof_messages),
            signature: &signature,
            presentation_header: Some(presentation_header),
            verify_signature: Some(true),
        });
        assert_eq!(result, Err(Error::SignatureVerification));

        // Proof-gen succeeds with tampered message when we pass `false`value
        // for `verify_signature`.
        $proof_gen_fn(&BbsProofGenRequest {
            public_key: &public_key,
            header: Some(header),
            messages: Some(&proof_messages),
            signature: &signature,
            presentation_header: Some(presentation_header),
            verify_signature: Some(false),
        })
        .expect("proof should be generated for tampered messages");
    };
}

#[test]
fn proof_gen_failure_message_modified() {
    proof_gen_failure_message_modified!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        bls12_381_g1_shake_256_proof_gen
    );

    proof_gen_failure_message_modified!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        bls12_381_g1_sha_256_proof_gen
    );
}
