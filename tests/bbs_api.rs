use bbs_fixtures_generator::mock_rng::MockRng;
use blstrs::hash_to_curve::{ExpandMsgXmd, ExpandMsgXof};
use pairing_crypto::{
    bbs::{
        ciphersuites::{
            bls12_381::{KeyPair, BBS_BLS12381G1_EXPAND_LEN},
            bls12_381_g1_sha_256::{
                ciphersuite_id as bls12_381_g1_sha_256_ciphersuite_id,
                proof_gen as bls12_381_g1_sha_256_proof_gen,
                proof_verify as bls12_381_g1_sha_256_proof_verify,
                proof_with_rng_and_trace as bls12_381_g1_sha_256_proof_gen_with_rng,
                sign as bls12_381_g1_sha_256_sign,
                verify as bls12_381_g1_sha_256_verify,
            },
            bls12_381_g1_shake_256::{
                ciphersuite_id as bls12_381_g1_shake_256_ciphersuite_id,
                proof_gen as bls12_381_g1_shake_256_proof_gen,
                proof_verify as bls12_381_g1_shake_256_proof_verify,
                proof_with_rng_and_trace as bls12_381_g1_shake_256_proof_gen_with_rng,
                sign as bls12_381_g1_shake_256_sign,
                verify as bls12_381_g1_shake_256_verify,
            },
        },
        BbsProofGenRequest,
        BbsProofGenRevealMessageRequest,
        BbsProofVerifyRequest,
        BbsSignRequest,
        BbsVerifyRequest,
    },
    Error,
};
use rand_core::OsRng;
use sha2::Sha256;
use sha3::Shake256;

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const TEST_PRESENTATION_HEADER: &[u8; 24] = b"test-presentation-header";

const EXPECTED_SIGNATURES_SHAKE_256: [&str; 7] = [
    "925b257838bbc46d0927538e1609867dd563550e9daade709ba0b1b4642df2a1da46c481de8c44184163bd164cade2c75911e31df92a04b8a825b10275109af76f6d28fed3e8c40a7d601edf870d7899",
    "a6324bccce90bd0871d5a8f56bc32ab54fec4f58a7f36cad92d2fd8d9291b0ab621f9a636fbc835b1aa2fdb6ad7c9cc25d01fdec7e0307d844cf9d70daf0a2a326eec716660a96536bf44b6036a6204e",
    "b58586b4ce4114cbe5b2de5bc49d85d4488744ba6968e95db902c7b4489a42b0217dc3b6eabb4846f1a7382bada4778f6f18f64ddf617916a41a84ef855061a6d730b0a3effff64c3cd05ceb166c6a4e",
    "b97bca812bfe7e953fb59c3fe02cf9045d6c0e5c5ae411b83934a0f512fed68695db5bc5df8f48ef87cb13179fcca2ce239dee06d49fee691ef1aeba52992a02ed506ec0fcb404a3096d1a143e1df0b4",
    "804317f0ff0ede4a80125973f6a6d43fdb8a90f3f1544c64be977ac2ba7ab11881198a9d281efca1ca6c7b3ec279873f6c27a34d4a9ddc35ba4d71274a6050948bfab65d967fca4f5406774a045b4088",
    "af9a76d7cc2ccd9687ff7bcfd49e5147a81cab7b66ca62f6ac294af3dfab30eab610f98b1b3e62932940797ba520ce9c51517f7c75fc928a0a2c3be28b292a2f110c6baf80b025793669caa31667fac4",
    "8df37099068494eaeadae4fd782cf4aa9cc3edc4481f984ee191c9f22e42670d1235f823e8dd84f13d06e88bc8290df24315e390ec9b13d686f149d798c67622083a3ef2c3aab4c84783a7fee591e47e",
];

const EXPECTED_SIGNATURES_SHA_256: [&str; 7] = [
    "b5947ca9b9130d615eff12404b003de2517030eff82367c0614cb158cfa21b810b88ad9601a48b502042600d3110fc04279cb622cf7992d294d416aa26b433f9e0978fb532537385fc3cc4c4e68e487a",
    "8717c023ddbe6a6505608854da26fe5c84a679356dd054c92b20e2c5de892fc7e65aea1b6dcf2a1e056a4d2c16d1144204272a16601bb9e0b9a3c2d6c4c8a37ad6c9816115ee6b11e13941a834d53859",
    "b11e5bd9eb8bdb7b79ccfe753de91245fd7b1eb8fbb84499de07d4a4a0de8d4e19cc768c6300a70f411d31d0b5b973c52c4ea1b05994f6c004ca80f5b8c71bf5a7e09093c9a0aeaaa7d2d5380b410e42",
    "8e1c9c70c3e5abcb58ce169fd39114ea4e5d09db01fc874ef5e9a38c32aec70671157cc2e1bce8c54d6e1dde34fe50094170b4057104603bb1ca3bd443015d7d13e580e0ea3cf449f038ee87c35b5128",
    "b5f960170b87065ae3080d8180ef203bcba1558cdc3b7158b0e692d1dc25ff9b18c38c92eea46d811eb5fc387333e80b20f2fe33f194a747fb63505f1a489f9eadd29bc65176c96b1436ae24184737d5",
    "b957bd6369fbfb4833c736ef3ca067fcb1fe168cfe952766fa296486e8ecfc972b0b134c1790b040b91092ca94edfb380666b0829b92c80038f5e8506dd7014402618a534e85b0851a96eb0001cd8ea4",
    "82a2c8b379e4e3e82a814f83066e52df3c724ae8ddd7fdba924e2bf24f25a0dd11c0f670171466ecb9241d1759c1244c4296f609f1774a6dec4623cb70c56e3870e8264aec6a846838bf18b40939c24a",
];

const TEST_HEADER: &[u8; 16] = b"some_app_context";

macro_rules! sign_verify_e2e_nominal {
    ($sign_fn:ident, $verify_fn:ident, $signature_test_vector:ident) => {
        let header = TEST_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        for i in 0..TEST_KEY_INFOS.len() {
            let (secret_key, public_key) =
                KeyPair::new(KEY_GEN_SEED, TEST_KEY_INFOS[i])
                    .map(|key_pair| {
                        (
                            key_pair.secret_key.to_bytes(),
                            key_pair.public_key.to_octets(),
                        )
                    })
                    .expect("key generation failed");

            let signature = $sign_fn(&BbsSignRequest {
                secret_key: &secret_key,
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
            })
            .expect("signature generation failed");

            let expected_signature = hex::decode($signature_test_vector[i])
                .expect("hex decoding failed");
            assert_eq!(signature.to_vec(), expected_signature);
            // println!("{:?},", hex::encode(signature));

            assert_eq!(
                $verify_fn(&BbsVerifyRequest {
                    public_key: &public_key,
                    header: Some(header),
                    messages: Some(messages),
                    signature: &signature,
                })
                .expect("error during signature verification"),
                true
            );
        }
    };
}

#[test]
fn sign_verify_e2e_nominal() {
    sign_verify_e2e_nominal!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        EXPECTED_SIGNATURES_SHAKE_256
    );

    sign_verify_e2e_nominal!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        EXPECTED_SIGNATURES_SHA_256
    );
}

// Expected shake256 proof fixtures using MockRng.
const EXPECTED_PROOFS_SHAKE256: [[&str; 6]; 7] = [
    ["83d7301474943bd266205ae40b3eceb41eac94c54cee21a008e3597681ce28a72e7380d3526be077a2ef03aef9b6f43688534b4d98f5ac313caa7fe869d395873d6e26de0e6ff59af604829581e4fac5fdf469fbf121c8c1d3da1b60a6fc6f42067868d08bb46eecbc89c43624b5810e1bd684b5ab45ed99e1fe750ec17d5d312528cc0582a1d5bad23cb6e30741cb1e95efee6064afc748a269f957761552f004a8770286495ba60b1b0f27bb1e3d1b201ec1408f0b8b506b30280528d85ecf2937c5dcc89f16e3a25c5108f8d66b56d18a0b1b00108a316f8cba9ef363a0000188117d80607fea0fea72231e47f0ccbf0c46cd2e534f72e8c3e3991f41e7b40706d67a05ec1a674d28edcadc6cddbe0768193123fec7846f773e34e5bfc0b4362d5b6136e7bf50013d68bad2f4e9160958f042dc21462ae48d8e4f33d484053de5abb9b7b2c5bfbc928de1fb8c19d513869fa356afd965d7910d538e3ca715415e4dec5f176d19098ef08ff762e28c3bc5792ab0b18046582c6c4945370293", "b37e9798fa5469b7df5c5ed01d970bedf438e257f6d701aac153858248e8960b5c8b65021bebd5358af4a88660aa6dc098170d4fe37afa0848bb08fa7747892217e04118b9a7bec14bac295e789fd0732309b062217e4c18bf1de527a2574ff5469456264d4baa5706247d9ecd0425190e6abfa9c4678332c30fa7bfd9a4b66148578d6b1a987c09712764042d53e97d43cc07a9e54aeccc03519fd2cebd3ee733a04b9c07eb199d3d0e08ba4d810e326220ca70ad1fc18adea7406d0cf30cb6346275030c35a7f7cffb45479b581dd8e44b050054ccf2f9caa7c6a1660280ad0e2173c33cc57ccf5b5aadbc5bf82f2ebe12b7069bb35211463fb298f1d429fd2e9d78af1ab7b98383a1b4fc125bf2fadc9ad3390912518afdfa0c2535e510bd18d303b8765838aaf5e4839884e5c20888fb948ee1279fc9d024a19d8bf708263130b6d72da24f6b56ba892048fc32ec2f6e375cc495ca700b3df8ba8a167f16", "868d0cd75a21f71fa4d3266fcabd53685e9d2e7738586d5f69befdb813be1013b7cb105edf65c2b6dbe3cc80b66948018c6a48629a27aa5002efbfce654d64bbeef7f12058fe85374538576570d201c5b17409e9cdf0a49bd38adac500e82d116d2ed9d563d095a8d08ceb88447728d8a0415ef38936b2c90edc2548b8d174f9468eb41e2c7ea1564eead0f77c1830c671e720da87a4af7572bad5f7294415ef2dd0160c45fcc7abf2ee5232a1ddcadc0a70e528bf37c16c3acb9202919660b7378d0502b41095848fa29eea1bb72ba3122eddf2bda3e0cc34bcfd093df79e7206c3dbbab80d477c519d434fe3a90cc5c1f466fcadb60bf20a78d9bada7cf547636c3f45e1f18150d2bc5a8b9f5eee8e4e9ddcc268babcc75d9ed011bd920ee364ceb7500a64f075deb23d13a2470697364dcd3f7722ac67850bb2940a072d48", "8d61c945782c36c2ebfa29d5b30253b826b153356ebff9f3dce8c4d0fca95844a294ae463eb8b7073bccc01beaec0406875e22fdad4b193ce0677ab1c2f2244a775d8ec57b26d1f47e9ef20c63408b8c59935d46779c25d42161b3a7ef1caa7020e63878338d42ef1b7739ac5aac6199cb9f70c2c7c181ba6a3307053ff9974214fb1c14dc7f7e47bfafecf1130639ab5900a486e25a941d75d2de10ccc6da472f93ff7b96d4f82085be71e8be789294eafa538920c30bdeb9cc4c7668d8ee9a6dc4b15a39a7c8407e846ca0f41f8257a1a4243b1217b3a0c784d4a51fdb2bdd0a8463b646225f4df831716b37baf33f87c93e4046d3b61fbd306ccf38d4dbcb255cba80dda46f5520e4afcd69ef376af21425fdf2f11f2986419192a96355a9", "a873f4ede35fc58d847e8632459ac273ba96881b8a9668c7b7762b76c2344108fea73d10bbf3903bca13877659b3818e8a29b3a31b09476907996bac907dcdab7f66fd341f82decf65c443bb28b0821574ee1593f97065ff3b5b0b083e206edc2810e9f773b596b7efb0414ea69bcab4127d480d7971088d75702db2230749b85c9e0ca9085b1de447852f3c87bd75f260f9a15814d37491c85f27a8e9ab332c66aade8adb9410a443c19b90ad271982b1ed813d194d3e058ac9df36863b5d6f0432a710168bc26ae50bc266831a59c2f7d496363be26ead5f4681c6f1c9bb0869691654b2827d62685ba36e3ffbdface0895a5e06d3b2e138127dbaed2fcb96", "b36140fc979a794f3cbe579caa6e6f4f07d2d22016c1367744634ee216f6af1e66b233125f486e0fd80e233eee19c443acdb156c7eec962a24fae709a1af3666e582457c5acb1ec4d8783e84dadecc1ba61d5549ef07c5cf7f2d3987c9f5fe466e4710581a820d54ec3e4957f44428ee0431bf40c872aff6e81c1724b63665cc3b3c76d3e5bb496ad3e89b48b86ef1ebceca8fa22b60e0dc7dc67dee94c187cc0f93592a6259a17fec3d5d0618f0a5cd3040194ebe71464d65b59a406d38fb7b18d49c7db0ee0f0bd1447d340b45ea80aa55d51d848a25a8331a600bc1cbe8d3"],
    ["b72b2b5e8f182966874564dcb0eba4132b7e85e0e70b09c2941d3e839b70734c7aab26c1078fb8cf647003fcb3d56700a2abc9f6dd38ab782bca7f27c36f1560d57d45ac6caa7b4180f975e117eeab7b968b429d76f6cf2b049fd3d21593117241d97da2eac28658f7121ed5d8afb289f649fadd8ff2bde58ff65b9d1ae8ff33188a5fdf5a8ed6f5cb6f124b771a75826ee11fd7ecee2727702acff454c642f73675137e1351ace80314e2d05f23d30b0369112c680a14045fed8ead2541a59153496d74f9cb53a33fdbe1420d8cb374cc31c2c0689c949a8993eee986d7806a05f0831889fc8b0fc3d7932e0bb527c01548486f0529f444cfb1a07ce12735be40b15bb24463378b60a086889a7173d5420d7bdb7b8572b29e3439eccec8530f5be459649eff4ca55efeae620915db0115af0802232fb6e3175fcd8fdad5179f2d2b89f2338f20ed049c1f2e3014740cb513a691160693061ea5aab9a5e64eed41525e010598fbdc5385cd42b246adc91da8db8e642510242cf8f4554d8b40f0", "897df143a231f36838a97eab811132262657bf248a0db1ce85ea905a8bd1b0466c7da0953dda3501f43ba69954c31dae959bc3cdd575dd3ad81c79f19ea3a4e702ff59a08e47bef126b76754639da3b01ff329e47ae15c244a26f3fef049c33c6b147c46040cbcac79149e288c1f2958ce608f2f0a97b286c8e1a2dca3d33b230e69eefbad150ecaf820b3482322b95b0f20c4ebe3e2501ddf2693610d4b6d9360676b2aecc8a06ab6b1a632c4f987a2ce2867755f0497a49d7de09180b42b7e302032820a346f3b31d2f47e971009fb14203ffeddbf26a3b9c1d0ebcd6c8b22074f15647acb240728d0ebccae0753c846f8bf28a302acf02a56e2b596d5aa7132d41dbe58ec8ad67697204643e62bfe798660fc8aeba184cd8c9d90590c56483624ff82a3d44b7371f4dd27f5a774eb22a22fb8742e727a529affada391a9442b909509dafe25506c08a4ee5e7ea1a3a1971dbd2c04e6c9baad360c8a472e28", "8642e12904260f2ba9d2318f48d7319feb9d64f09bc8b976aefaea868b1d7aaf39fd8275d7fe603cf7b5e0a347192765a2bc1341b026b9a4c7a49a49a7a228c0198cbb2353a283f09350c2429d7e3872d53c2b331238d7f9e57afa8b76f85c281a2e7d52784545777235f11608f4a39976498c03d19bf659430bdd6c2743d72b43488551cbcea0e120b13cdb16e5162c2024ca7568640a10e45a0b44e012fa43627dcda64895e15084b53476507a8e957b2467e542f28d03238deb24a8a973e15d105918173d6d3571d1fa9ed04744d09f1f065dcb7c6458ba02d56b66adc2bc4e0b18f10c10c4d91f52e78d7afffc89f4d8bf10684278bff2e17bca395f77f6417dd321415f3c11c0201c8715e43f25778c8b68567b16fd3af9e9d7c938de102460d6328ddf18620d54965487d5e773e8783ac4c34e52e2829a8d2ac92b3e89", "81b848795c9e5cac022b4e868abaa233eeda6c73fd51d1c78e4117863a595f7c337b1f3f9ec66ebd1620a6d10d96d575b2a95ad86a569878490a7277d1c833ba2e2fcf09b9f8967fe6fd7a487484a820d6665b8eee46bff766b7a152f4e11f5336ddceab4690af1c0d76b177d3ac8b73b2644940f85792f6e7d1c216abea894618ab92a3767bc91b3743a404d603a7163e81fdb2dbc1a9fc9039eea70101fd0d05e568199be0609ebf52323b57db3f3b2737a2973c148799247af66248dc9ddd0c93992aa4f13972fb275654664a91a9082673f5fe801b4d5db68997d14fb6e012104417aea1640765d596037c467092d1ab1b3fd618344ee1e884a7b31feb91088b71b01b976a237def39cd2494314f190e809d13a6ee809e72158fb1e6b559", "b5ed538e599278022c5a68ed9522a1ab489cd3f7187efb5e60934a9f1b6b55373a4a62bcba53f382f5e5577f06a87c05970cfd1331939c3c9ab4799b761408cae372ff71a4d7f66a966439277a0120e596c95f560973a3b65c62fde87b053f6172deb09adcd39519cfae37c9c95f0287816d265d8a7f9775733abfcc32f3973f622b14c59e4b929aaf161b5c4138d50987c2b532f98867877d83da7c61916e916dbc2d95e98310ea14bd95cb1a94b47ee2cfa78604d5e7dd56fdda122f51153f46d645e794fb3e271d714e94d6fee3ec0b13534c384aa7314dbb18a96831f6c970df41d8baaaf57b859db29432eeefe547bb63a83eb18bf2fe3591dccf62b92a", "a7b56c8ffea37f6b8834047c5a63a83323efef063f10f03e532d0672af02fd9998c9536c92c53958b82da6369c2a6a578898efbfbff581866af1d1d408d0c05417f6c79f05eabdf2a1a68ca03c9b8a15c984368b3795ae5a51e771ebdc0d1a8c31dfeab89f6ae731f16ded7034b68e8a15278fbb345f960b0d1fe8fe5a22567647654846a20c94e8b33c955940fc38758ec0323d60cf5f503680af5f3ea734f059d7081c781237d893032c7b8b1acf2a4400749d350f6c45274b31b3acb035bd6b934c44afd0ad4319cbb596bcba9c4a78361eb0dc5b360b859116d1b01588bf"],
    ["b3e6dbf4a404572b4df70532cf10a0460188df3bc8760f9ecd6e7a2cddabb02b7d585d84ec7021f1d4f0e3bd343a7d27a4c99f6eef3b908b543450c10289187e6f96cb8a7b1396e5dd15d1ba50de4c05366e67c4be2c899df725ac7371d05e691c8b20b4c21d92170bb18e03aa8842f4871024550a21c8102172cd26737070e060023aead42d44c4bada874510a21a6929440ccfe20f6ad86cb96139d55c354355781bdc57f820df41608fe519c080a438444f231923a3f2a0228e99a0e917c51d59422c3d68008bb9dad2228b1e4f4f91fed8ba6809dbcab9f8b18e9a7821c26d0afb6781bbf8d53f334b3283c7bc078f0b70bd38bde3fb892138eaca6907b61e5c3088e97c589be79298ed841fccafcf71a12292e7cfa804e17ae65bda9f2c00ba36e1fbd335245c2bafd69f5247db3825d4c1df12ea9c0bb0b289f08d41560b05f4e3212d1b2ae8f99dead88a7441ce8965e26cd360d949e5bc26ec750346667afc77d35467194a16f76334ac0391b888aab78cd311e5096cd2230f96eff5", "8e4f1a01e568ab2ed2ccd43101b82729c0faf4a4ceec32cd82d62b2a299b2c66fcb233591e8478f28f7f3b21d6dfcf0095f27731dd794bcd990def5c3cfc7c9ff853604bdcd35619abcbc9d539c3510a7b798c9f9777a63b803ecf1efd73739e53afdb2d28e2f2f1c29d686f117d192f41834881ba902ccbc527863b7a50ed0158b1ba303de97ebf13565e50d0de37af8ac13e9302dbe20abb92b6760840455b1fd0b3caba09163ed7b9ab5eeda4903aeb47e8ec6af73b4fb99b3fca310ec14a4e3ede78e8cc0ac56a7c7964b5dadcf427bf6617328413e49b23f802bffe4da41d55a11c06c135182cc9ccd9fea6cbbb4872796b45d268ff26885c1bf0dfdd583d8c8e79225b982934d13217a83912c6acea7cade2a6d57822ee5a8613232dd83878f116b49a514b3572cd1fedbfc25217ede7138cadfb6d375570957bcca36b3aa156c93f8ae36adfad861e78054b2262c03b1c4a839cc425e782c14631d520", "90746824513fbcdf0908f3e58726d310c421a552834b837a115bb10d96ce1cae34e92c2cc5e7dc2075af6d67bea482a9b10769f4c9408aaac90960dff184cc06894abe039e3f8b254951debbe000826d4d9549d3afa62a7d0abdaa6e150e3edc4bb103ac405da6de19a6cd222c9cc0e0540c58b5f8b4496d6c64aa18f5cc1b11456f68257800409c9146f6e5b81086c17d0802a680c4ee314cee5505072d8c3f02bccd22ae474c4e4620d66af68352d769425a82c8e2264df45b85f4869be2e762918cb07b44eab4e3a5aa0bd363c2b7ef6991d16521324caa54bf5e2bfd4f0162e0f6457f56896f8c2cf7489c2c723b4e9a283ebb00c628461eaef280307df5677095857541b1f7d2c408f048e7bcc37a60b87a3ef7d502572e19836ac0edb86534567fe890b35b374d70cb78c1b8c62c75e6d65f3379ac30d9198277d0f5aa", "97f7d6456259fa00ab7d0207c1fedb802557bce70e22ccab75abfe35b0ba25f9a6851e21d95e7c1b3fc7a0e96f6570dca6f0a032c2c80a3b93c7d25e9e7074b3c909218b1a5d98ff6cce2f0f5fbe271a39a942fb9d4311004e4b5ba960ef52da13d29d7a983948318bf92833437b9ee893b7d10e9d5d8989212b972ccf702c84278c0c4658da3a559260bb7f9c58471e8b26f340f3709d8cc9e1921953e887e06f012b90558c05abcfe0f25d97c346ff9f5701030de042b539664e3a040aa7b53ad02e2ea784873761e891a6dad76ecf9de34de36d61cc26562b887eb26f6cf90cf0539d93672fd6800cf4583bc300c8dd48dab9766cf54fd928a22970483187504bb3aa444604f4cd75aca57edd3a2b8893c3b682cbc9f12ff3c8849b2502d3", "b893d87c1b42eca33d3bfa435e09fb1bbdf3354a0bd35c839ef15dca7dd4089d9d760ea71837b61107d9c975c91fb43899860d3614b40091fa5abf1685869b28604a030382c3cb0df16d962af8e9cd49da920241aaf2fbbb689b132fca15f10d3b6e404a86c520dd52308bee194d36bd0cbf85f79df0f3f9191e6f06d6ba441b65315efdab740ca217ee7fa9583fc9085e90caeb0ccef88ac5eaa74022f79a814a0dd1de901f492fa715173c87dcc6a2137b41ac7f8fbd956eee69865cb0a95d715eb6477ae654ecee92601ad0afb19fafc70afc09cd307e330713cea6c0090c43bb001279e13be24da489db80daeef8fc1c19441bfd519a83dd40eedc6ff89a", "87cac3dcf2eb8532d5b9b54031df0e5f80c3b574af4aff5ffd5fe78b6c44da8379a7206c183c57468f264ec0871294bfaa3d1d6f96733dfbd45f4a4030947ff6c41dce11b1211b3409ea2ea6c4dbb04cfc01085168ce72c7d8bb853e1ebd4af35af65227f04441c2d2f33dcf76b48fc55b9a057b1110d9b8bdb58a088ca930da4e05ff37a412626bddf3bc25df972b7b00c15c0b8458732b8c3a84eaebf786d8022603b1246998cd1c2f749a9e8a21b781d6359f63b721f604a4a8bcddb3295f487ef6f7a89f1edfa7a2afba8f80e1008ebe16eccaa224afab5ccf67417d6dac"],
    ["a1a1b00d9a814403e28c7e0711031fef0e9a297e9d25910e5933fb39ee4a3ee8b9a3d1a0692a03571084962255a1607186fb9243782ca13f4b8391a3c1824a783b2130b537c3bd74951380abd26c3da1c69b3bbe8eb58ba810cea6416d8ff2cd1ee643d7a884e85fcf0ffacd6c7311a9a9e0f110da8b7400efb5ebf5de427a1f59ca8fab2ec8e4dafe0e2a71bf14be49421798b462593ec57870aa010922153e116bb8bff4c1b5ed4836690f7c55d049948870d84b24091b6fe9b1d714d545b6352b9713e8c2e2c282561a25ff1081a9a472e8e51711eef9df0c378e59f43e8e46130b0b6ba423a3fdd6ec8c58ff9dfe287d6891c49971300895478db9e7c2336d27f6e7fdc3e10942607d3f8bec1704dcdb8e4d5eabc7fd61397143e3b5d55945499ca8953c21209dc8723d1828419dc0750d5a7ecabe109b84bac6935642635352a78343ad9fa75d21dc1d92105390ba4d2b61d274f6ac2062b2c5cfa3997315208e12eb73feb29a3e1f9966b92325802cf25995a71a02c67b302525646614", "a56d3d87e67c4313c4f4076be88f6b6da578204129281c1dbddb7617ba163c27a309d753f951baf32f918939caeee8d1a948f7a774716a78afae2667a1bbd64870adca4c9b8061455fda07ea284405a94e4334507245a19280058684afc4cc505d6cd681232a7e7f05698532261d11bfd287f5f38a4fc29ede22145a321d44c816800c068c1c81a6db568269fbcb8aeb66407b0e8124c8f9d2102cf8518d2c6f465f3b032ce7e0ea056b99c88aeb5bbdd78d559546b910efb612c22ca5865ad83430096edf3aee125a6c53c86ddcc3b16541fe23e6024a595ff515dbc4dee589418e7a8e39fda1060ebaaa9536bb24dd9ee21834f917443d6d3c8612c254f9dd6a2edd8ca63a5a74cf9e1f7babc52db52e626e10133c4129993dbd054af18c7e1b3b1eb9eac18677962d230bd628ea2d6c4612bcbaed5dc2cc50fd8802c80b113ee8dda7c519c87b61c3485e9cb691c5ea005407ce22fd0bd6c4fb4126c05d6f", "88c5410c387ff4e2237ed4214310faef4c7df13ae48367877e74a20216226d2199ba5ce68950cf96d3981e1e30573a26b303a92255fde3d76a24a619eef35d073e4846b0fcb5e530dcd819da48398e7924878ddaf5a051a3acc9566be7d9153d58e64ceb8c0f26822b25f33fa04df694f4c7927f49abfd452e659b0a7b8dab9708e1912af2a2370ca5690ccc7a8f2cc3736e1a6994e4f9ac36cd5b3a39d3cb955242c55d8f85b407b2fba16f5bef107d8ec5a6e4549de620a2f7fb58a235c0276891754d795fee28c4c4dab4e48f76b9cc793fab40f1ef72b10a6624a8d324292c139c528a307bf6e3d7f8cff7d4c5b95167fd1e8c26e79d534cf60384ee0fb06fd78dc4656982ea7d6585942a33ee3fac9902ab42bcba5a33f1d1e16c964d916d1c59b65603832d3b28f04c62c5e93017de406356f25030ddac697f38b902bd", "b9b9675352973abae3dbd12f7d8d20ec1440496cff63138d86019c7f497ce520bd64b640c8157a0206dc7cab1a810072a0c16d8b9575b3abc8f2145c19389cd10cabfe77303a88e3569431d664cf8514db46b978b9343471795f4779604f293d6e6fffcfb2835d897a743cfffbcff54b34b1adef8ddb7dc18ef8f20156ab84da61447964f639031ea003be63bb80bba95e8e8ee2f72b09b633a576015d0aa4704ec861600275e7f5968f68712baca654f72c1f2f812b899233e5c18a90356084123d6718181a8f021128209c511d389f346f848d855b9e4cf005da7a3ebb63401ebba4107c5aeafe3973bc8f54f049cd526fc0a0e0759b574eef2310852831a94fb7a22142b886e59fdf908dc15b4abce0655d52e4ffa4a6873e82b57f575065", "8d049100caa123cca449eec037d9556eb447d9450a4694aa15268e70e62bc957916b62ef187a6e32182fd3ad18dbb675a0095335d288d0637ef3eab23496a26816d68e1198b1f4e5801bff99bb6704a58521e42b7f88d3d93ba03e77a40e39b51c7ca3a73010102f0b9e42c02d4f91bce4d3ad302bdaa80c659f5fc1d0b6668c0be0387529c13c7a64340f9589accdd201a38ed433927a235cabd30366d66bd10916be87137fde1c5d9d40a319b237ed6dd129da702d9834379082390685ff7e5788ce9646cf721a6085f23cb4e306f48a99ca7d9a95840bbc05f4a340089193278a40e5ba80c49cfd5b5f1f10c431684a68a426a06035aa3de1e3315892a6df", "b13cea42220dbaea1d14cc7dbb61f43fdea368784d8766c83f391409811a2ba52aa9cc4cf9c57183102023f7f0ef05d2b0df2860de828cffb017f98d900786b93ca7da1cd1f04a1d6a665f1d0268b71510d7e94986d2d4af933f3e3c0c9f5cca1e35c461a7a9616737ce97d5204958d6597a8828a75235e2dabd78d2634b82593f18150a66edea07fd9d4d964a332824219c6a8064c7fdbea09a729c6510eb2437b4868360458b150ec1f92a7cb6318ada48a6e2198433b0c3153199dbb6009b4399f42a8e3faf47b31e495a455b931b2cac99d3ee58ab65a3e7974f21c31e2b"],
    ["a9bc983dc3161d5afe323d6238df154c110531636f4ae534c0d1dc59531545530912bfb73feb871142e87151806a02afaf8bf58adc425f560c28126fbebb7aa9c3d36ac8398d43d2db2b042cbbf0ebf51a48d0815ef6a64fd36e3203ca1e863f1805d4ab867393fa290782ed07d5e4b16c2b49f783327e3458395961c47ec51e72e6ad466f71cac34f84b29310977c277a30817f16ff5c52c4b02987ee839c71030dff4f1e3631a549b161a06b2d474d4bf0bb1e697a354d95f1665adc2c5b6832304fac1c4672ea542f2ba897aadb9560cd89b6b8650b51ef8f54bed640a4ac51cceaa4b3ec25b3e76cd27d4a18bf81b31fa4d914ceb2b62a316aa09ba2981e194a764b7423c15a85642160f36a11d35a4647df7d856e0efa593833f267d57171012ad841fbe37f2f2686fcb879a88490cc79d2716d3780c2db51e370811a421fb364a2e21ec95cbddc1ff53024bccdf5e2690df629052a2acccb8f77cbd3c0688475e238a059a336b6579cc224b4bd3833e1d7310e32bba12c14faf34855db", "85727adeba27779aadc1ce4d79e96a338cc654e7b42a31184298a9198478dae755817a5373e159ad43e34854fbef7e219208ce7f431a94cb8d911ab6450faf8437f5dd7248656d8e4111215a863e68368d696bf8b601400f7ced954275290a5a557bf823e036cba09abfea74ca395289999787f4581816ed53c57cf73152bc8b21cd3866f3dbb7f0616b2403be371644bd10e10f0bb462b202a303462d5298d81984554c2733c24194787f41b69dd80a2c8e005388872f1c5360204d68f3befd564b03a6ac97e1d7d0f2265fd3c375a0807dbee5fc96cb64e0f4f64f8e6f9be331ef9e15b9291317c03abd2d4c35b0f3110d9af2ae0ed01f5d9b2c9b08ab26a733ef03ca38b43a3d5fc0ec72158a97e7932eaaceecd59eb9ef03de8bbac45a9c48ea893ad3151f1fcca0f834cfa89f1797db398b24370110887d6b2f9b002dd16cefd468b2f59cbfde33e37acca3f7975b46af81a427df1cc528331657dbdf64", "80d7fd0730f0115fc37fa5ee683fd9b0de87e4fd27653b26499bf27e386d80470459fb79b75a4056a4ef1346d050aa35975cb5c76028d087632c101bd191a43d599a6cb5d137045555e83ec9016ec447f272af8ec64e85943b6c2e9d281a19d312827dd3b840637c81420c172d1ec9951e3fdd82115fd268b77a30bd205a485c0dd2a40d7ecd2bca0dc51135a8bbf2eeee86b3b28875bc2101c6b6e4f63db9023b9b3a53a8b18c39258794b24e1465c9664107f3f24a3863717db6631aebcf9959c751ba77872795a863e7ca788e4287a91728b57bd69d253a373d95df711a7057501c981a73de5980ee3e4730a9130935687ff2fe7651d4c38e9fbf71e12c2c5e529766c57862148f042ac153490af9d6d45847af3193bd9c8f5f6d41248e3f6f019df448a4d726dccdeecf6d0045b199a5ab9e7776a522b1ddbb1a2acf31c0", "8053ff261bf9a7722529755c8ee658862d93498cfbae94b0e40a8f74aa5809030bc9373c44fe709cae2d6a4b827edc9499beb839329b65627094a4d72cb25494938aceccf9b1adf8a9719e1ca78b7716ff234e10d5deead5006e7b16cf8d8e1b68872d2905ddb3f8ed86e049e086ce694233039db153488d4aeac87b52f50b393afd4c995d700fa26f6063eff812c5b1d3924285223e57d2b8d1edf9af2a6bfe5958ef94ce72dae030a57fde68ece90541c82df2e53d6632df026f86fd3459830857d6a0bf59425f6cfc11704a250fd2d41016888a3f5458f18070cd1df588e45fa7641ccb1a16df855f958a4fe9b28bf8a1f39ca55bfaf046b94b57455adbaf469591d6fc15c41c323f9831399a8a9c278382da6117e5d0e655cd6cd49be9ba", "a3a82332fdaa0e25e0b304d4744de9d853b265845e9dfb38c764f9f679f37c8d4eba777b8c88c4f71526e5c1e3d235a3983c61fd5e7c0d591cccabce7094579e56a8a595d967c60fdceea0b9dbfa3f912233df625e3daf88f7131eae12cd9360234abec5dd4f50261b36e1b40a6e0913dada4952955ea2a0a94e1e49e2c6eee7297c64443909abea5eabdddcb521784c003ad1491df4663132e0ad0078e7328765f495131febd9b77aa3ec04d86a4e53ca376cddbb08be78de2d20d3cd16eebe4b28c00b98756a9131c3143dc8bea012820b13bbeebbf8ddadcabfa0645264a246cf0f1868a0c5c0e6387ec780f4b0e0d1fc831afbc6bd25b8dee2b939811e98", "99bd2e3ec1ac2d226544cff23f7f0fe138a23bbd11b0f28c9a786f823ea81ec5bf8096011a1ae704574f5d9d18b41b9fa80678b4d1bda2f7fc935e351258e5f4ca6708f30977f2f8316ff1b33e7cf783f65ea6fc08f760b918ef0615b98d35d3345a7ba337ecc2763790ec3185c0f593223060cf6c2f6d46effe44a58199320262feb185b331f4876d3bcc5dc13d8c4498b6207d0943dbcd43e2c9159d3aa1361b258093f510534bd06cd61eeadb757830363b4bdc78deb14b78cfee04bbd2e56bfb57d79c01c137b4717b0064ced8bab41500922cbac783691a908a9e0e3e9e"],
    ["aea4213ea1aef7d13ca51de56bc5011367d13c64d48aefe9eeafd4e5fd03ab96ab3f59fcc257c984a01815e27622cad9a6021ecb0f2392c271347fe3b601c07cd7c83241e3d0ab31121373731d614e5c72666c9732ec457b61b32ebace5367c7504134274f9a337ed4144916ab8ac46329ed407990001bb3c877f19c2c4ab9fe08a68003df630fee2e233e97bc4fac7d8369737918db7ae8afd39b2348093c2864e3b036df707dcd183f6637e80e18472b0791b9acb57904135fc46a6d7350d101bda6da4045a1eb4bb3cab7a66b5dbd6c8ec44ccdcb90623f4dfb770912d6886d6fc387da9b0e7da9b2a1b3350f792d5ca6d69a429f7f7caf03fc02afa9bf364bcf80fa16ee33ae1dde80a09820254aefeb86043d03056d86c9f8a5b85d125a353098178814ce91fa6a7061752430ba83bd3d190b7ab47509aca5de6850d6bc2d90d1c4d5a19e81b7f2bdb716a7f50a8e459ec18281c7278e6950a255df8b0f3281d0a79abbdac3e884dcba72977109ea163fabc2d8ea417c4fb7213811d76a", "b4968a39bdddc43d92916bd76c5e9bac3ed049d40fa483e4b409f17218c24b1197ee8e3a3e5c4a52e34b6a4bcbf1b13badcc71cf5d7b47d82de850ad859e66db2c7416ad4a2e995078acc8c7321cc310c2d003b09e0f078f91ba0a8e15b4dc215f2db52c6d60ffd7016f9a2e949d750ed9bf385fdc42620e90ee421432ee8f7e5f9aa8925e959e265bae9478b815c601fa30e4eec8d05264a6f60b45f883a496551f0a8a514182a0ca26a48afad1354eebfb144983aba737ce2307bf827f30b91a1c2e0bd3607243639c0714a9b3c8e42b655f0eb63700ff9b537ab1f99f8f2f5a3284cb902e3ec2abcde5b1045927343d684e8acfca6272ac289d4b314d3e334ef19c6b6f3ed7624e2855e0b1a087a97b9abb102eebbde74d3b389b9d84d20c0b7bebc485c0750578332dc8dc9b523888432868229d29ad58733b0335b3df1c53b9865bfcbf5541e8dac0120e0dba6c03a9aa1f57a14ccdc40ff5150d03ecbc", "b209a2216e6e0eb15a034bb970e22b665eb936f6294c857cf3dca951d79e771115809ef39e1f8004e194e4e1c9aa27f396855b97cd8dcadf032254ccea098b89d8e675ef7ecf2ee7b111bad3cd4cadc856874be5992d97bd64e9d1a0d4d4a86262d3d22da13047918b7d8ef34e6afc34c7c85315f4a62b4f0801385af87c9a783e76d65866f5d622cee69e42efb68b4ee0050cc797861785bed03a0dc130dec71d79464189a9d19440573300d5da5f2340db6d14d373ff3e399b18c95cb40aa24f76f152c12d4f24e1cc629e62a710bf626aefaf5e07ac438a632266a56368de06b23c51f278af409e1e21c9944ee001b0ec66a8ce88b2bb50dd0b386e45debc470c3c878fc55dbb2386bd8e3de847a8af9e7f406c7cdc22acc53e500a3b9a0a3da81ca51783d8b64eeb4751e05f35e8f516502963e8d54c94a799d4d47fb690", "8e7c82076b7c76e14d1126d8dad12260641db0addfe8cb2c1185d7709101234a17a9afcf0e10317898e45d12aebb970086788e74715c3ad752b2847ebc5294b587be68cd0bdf8ac25c30a3e80bed7d229bbdecacb1fad89e063ce020d5af7cde5321c14dc7fe0fa6168e2291dea0ac49065fc95c7a717b6b66433222026b8f082e47d69505fbd4629b4ee778599c807e5a2f2d7cc9ffbb1b61a86aacc48c7912391ee78be6a5f9beba71cb891223db40584bdc6452a69ebd27f3fb25ebdc81ef25363215dd6a5bd37fede18c432916b16834a144db21a0b9215e7cdb392e983e05cddb4642e77c35dc8d30720adc8c442f9d5326b0dd03011f477573e769bbee0193e70464d4bb738d75e612f52d67ffd1c41753b83fb67d0c1ed046553685a2", "b238fca13f64ff69dd94eca60f2ed317b534f7f16bc15dcbdc873d15a98ce1c8d26ba5379c8ac6879569c999d17778acaa4d5c06a126aed4884b8a53a169197fdea9b973d82a5dbba08f0df9b9de8aa95f80766e4c1e9eddaef8126c3b33f0465af578d19d4e52ea83aebb940e250ef665943f09f71a25edc9ddbc19d85ff4015fcecb7ad48e4d9b4fea31c1c1b36092179d757bfb8d974616aa528f9771257c713c71c13c94297376a367582b6798df9bfcc960dd4e573bab16677aa945b503233a11f5984aec268d1bfa90a3813eae0b8fc9ad8a898b214f687b770b52677464aa84425c560431bf9d844f3d2b34da0a3e6daea84a3db00f7c189b1063179a", "a9de7a5f1c6b33a38b24dbacbccd429de08083399a826dff38590789e218e5b9f91d17064105effbdb1083d960511a3eb65209f2bca157c6fc3a9c4da3cddbf954826b2ae00f93f80a9b4f7b2a5492f9d1f5d93c601b9a48ed7d259401158e593b9d1d63fa646756ee94f8d82aa3f9b0e14f68dcc53a846e54d3eb4ae2dd7325219e462c843a2d23a98407f2be687a44fa6f26c7ecfece2906b7f5e783f9ca8d5db440ba4ba4a24bd8ff846dc71a6b2469a8ac215d6660354b98ca63250095105b86c5f14d3387b6783933a0b5981ac404973e0cf0f64a44f506c980ceca110f"],
    ["8bf759427accf2bc1d588cecf92761308dd190b6c1ce0c30cf9090e02df220335676b03921d7141590a15d46e92effb2945f7d1fea83d862c39b3cfe5090bd552ca73211c4622b76382bc99c4407798bfa326108d12c7bfca8036f61d39a1073396f998790e97dfe25b92588544633b827a33c67d12448ad3e3150f37e52d3804c0bc7191052d98b61bc52caa57e22602ad25b815839d2a75c29f0ab14d2871106353bdd4131e4124fea3044740fff63ff762fabd703485b270ab4548356c3447247f7d3e4549ba01f0cebb9de8feda88e992d9ca3cfce39e2ea79e25560961165201ce41e156ec3cd8b8f1a535d179c399f890ea096c74167174762e13667a6396468d89e9646c1c0dd8935dfe524905f1a000d83aa3a90d840025c7a96097b21f34ae4dc0b3fac742b69b0dcb21a2580257633296d372865aeb2bafccf37e1344427365fe8e03e5d560e76365603c45f9ce2bce5ddf4e837dd2efabb5d470627713ef979d3a93fd2440c1b2b5c035fad7ee0c18b2233e9fbf64f6f991695b5", "8cdfc2170e7c96877452281b1b1bb2ae96cc5ec6b187fee3459c49b52baf76fa2035e9013fbc290ef32a3aeab5314ee790ddc44080c3f0de2d66320f168be07f0929be3b96cc9e6e17ece2ce4c96263a431025592b5953bfb5b989e25ebc49985df1fb5a31d9d1bb4ad798ef5b2a973d5fcf84bf345e9da7d8a89147119983d0298b9b08897473c9c8f1a16a098cf05bab37ccd669155267e7f0fb7fadf138086000f431c3221b5686195155e212fa44f82baee7bbe6001708ac4240e8b429b147850abf541555d430223eaa5c4cc3adeb7d803a47b51ccc79e418a19c0f58d801803c1a5235d9da6b7bd7b1c4ed1dc560973845b65067c219ae959305f5c4ee685282a99fb52a23eb9e0b55e4b1b67f1cc06c80663a66f28dd88c45dbec5690582a9a9e870f7a385b1bb5f6f47f3ea21bcb62ade4f0a288b13a2815ae3af4db27671d31d47f08a096db3bf9caecd9a594901c917ac90b1de65e729d70e1439f", "959191969b75b9bdf591042de66c6225e88a852de51c831ca9ed86df50808745ebfe33fb5ccffaa3ba82a0bbc0797294aafd0fc3cbad2cab96ebb9c2ae9d2a853556f4ec94f575713350d13f7d553b6cb28d5fd8dac63808cdb0e5753b4876bb5bb2d4b3d7b06a833f83d8ca70004082b9a76f608ec6e26231faf3a018a8335465c174ced705df991cc604db144482576371edd1d6b77c613a28e2b0704a883571ca7baa31454603b4f229f091d0e41d9139c49230fa5759d24d9109573f9b1058325a18f8755e41bf9ff7160900619a80163a26c35fce72d155a0e1cf741f68553fc8c2c3db4391976430832488e0aa81f0b8abe4141625c6073f5dcbb4a2d70d5fc17fe7497881ddda3a6ba9ac5ac5e01f94564584b241fd2bc49df8d6717b00fbfb97d055c33b949a39e44ae53928c3db724a9be1a76531149ec0207e1278", "b9ef6f5566bb29eec1620db35b8678f975fff505a7abf2594eeaf364ef161e142a9d4003331c8338bb23125395f162cbb5c94477bd7b135fd38e298a16ac432b9371e5e05ca801ade60051dfd60ce671c3a3a251e2644ad56e50c0b76bb2b7ba719addef9b2b086a1d6eb4df64146251d13c1111471655e02e7d2b1fadecc55a53780a086bcb18ec31fc1b08eb13f041bc6119b00d13b26cf656704eaae85323091f845759d8a63b800731766f30544a5a66b8dcfc322ffc47c73f311cc1fd572507ac8bc4fb95f35fb1c1f4665800d891407115329a57df5f8b39964dbd78542b54abafc6646c42247e23f89efa0dc017fcd02a604538d4e3136deea994ddb546c95a7b6694150dcce0f411a6d4afd7553fee9d38f555687eb29f3b6e083b2f", "8fce1f867f190525b16e5fa4aa594ab661bced66523d89c0f7649253b6d9fe356d853e6976b21fac5283452adad1cd5b91eef65f8c209e6f065031d224539280b173d1b6fb0ec163bd1ba593aa5dfaa1b543eb79411b2952e375c9ca6c8d495918edcd7813b0feea56ba4f7177f0d029654548e2054d3c5dfe516f14a886008e6168706c149b5aedb4da9f0dbac2ffe19fe83d8b9a431ae9829337aecf303eb813ff8b5f6dd227a77711f21363884b38fb21d9a8d15cfc6c0606fb74f679df9110ffa339dac2bab80f60fee3a31a95de3fbf1c742306d4bbce9c0267c053a25e4cbaac87f46d3c2c961a3056e253363f09a98eaeb7d83546c2f02dc16cf5dc44", "96a4b4252d21fad2a93f5313a58c4212a3a390f94b5e9511967af611426b7603d910c897d74e99fbba58f8a53012cef0b5ae088aecc90edf773a6c185d9dea6939996af191e41d40bc93fa0312177cd18362279425f61fa7af0ed1f41b5a73ad249255014653833af207a38b618c16dfd795a9cdf3ec9218804244cc948aeb3e24a4c7e39a77df12c5df8e7ee4dc4dbbb3132541c180f7e5b1688ec89f0f2b174eb4934877bfb901b31b927217adadf2eefe931f3cfde444b5a1cab508cc14874757d6184c00c55e04f60c49c41355137571e23cd7b7555f7a8bc82f78783240"],
];

// Expected sha256 proof fixtures using MockRng.
const EXPECTED_PROOFS_SHA256: [[&str; 6]; 7] = [
    ["a67738e20c24f27dff6227d666591b088f3d372ef463578b600051c5bfa3445dbc48551fc7a86627e2a57917d51de7388fb9661129728f2c1e7e8e1001738e70a6c75b8f6e6dac4353d80f1dac5e55e608eb39f10d04615337a75403435f4cf433c885cad11670459686260a3a0fb56661743c7bfc542fa42c7a64a4b525099866b4ae9b3eafd02eee61e3597d8e561a16de378bd791fef5debc38348bc2e66c5e6d4e43d5df56a19ed93069fe6b17688e1675719cf51b3f3752063f6102bcfc59692b554065b4c73983ca147cd6b3e0cbd7f826708788cc393420dc8ee7558107ba54f1d28839387b109e14db9a90800e89522630e353aa7b2ce6afc85c302d22ccdc6d361631da02c655b8ab5915b7e832230454e6983a0ca43f62396ca66141c071c2a4bcc6f421540b589fade212028396ac3fc3376bd1e73ad4098d5d6854f9b4e5ec849c49ee44cbeee5902994df94c583342a18a950c859d4269e65ce5c76f99f55772cf7b6e0124fd929434d0dcfa60c629e27f2063b8fc2443b5b82", "b23c3c9c5aa2bd43661731f6f6c9b9dd074b33fef862de44a1011c81dbb8f0faab8c994e76f40431953755ff077e0181a01408964b27d6ff089b6f45ea89574d487c301838622de1f2bd9fc1d5ff8d87fb84cef44c54efa38c18f4d84a8e18e7488e81b7cf41febcbc82586891de2b89209c6adc8c04964008352468f847487015dcba3eec4d4c4ef03464e8b646db513693a8d18b68d863b001fdff1098587947ac14554198d3327445e306479c11e6ea044d7d0b319e85a17a5ad69a626f8106c357dc212372ffca71d71051b7067aaf88ca3a7af20f9b3bc8338310a5ed68460deb29ae7d17f6a51f5c53cda8bfff94fc650a13208065e56db480a9fb8bd311855f6f136b94e9903cac54b64cd73172d6d59f18ae51689b47544d5ad6481421d3ecc851bff85b19bbcc06c5a1ec29fdf99b3864f152da74b98210c26f5fcc63f5c7b2f44630efa065356d6658e53eb5219ea21068dbbde3daf2c1179ab0a4", "ab7daaf8de72e9fde853d66ee3282198788c67afabbf8fa91d65b405481ebdb45d1871960ce05993a333dcbade2e187c979c79ad6311057bc640d52f2ad8eed495567eaf071e2c0d26646819567bfb2214e440522978b6faf5fde15b9e21cf915407b6bafbd1f927283f9d45670c967690c819c05b7da848ca646951b990ecba2d216dbb4a03658895aac7c5f1759a4d9dc4cfe8a2aa89195df11af95c716cbc7311418f36956f94731503fe171a5d43a185f0788158d862b36548f64da92962250ecf93d42b0ca8a03c8973a4cac258fc338977d037c713d6c1d351d083cc052bdbc1b14d2758d601edf385d5105ece1baffab39dc7cedc3f657e0b3863a0517289a33042fc2211f2071453c7d0467478049986564aac7d396a342221b115243f25641fa20e8c9d8f7d30b3271768c4e21783bec7be95a3ab0dd450eb583120", "988458de89993db536abaf800418023d3e2733b5c791dd7c40ac883f09464cbad4467a22d01037bf52437eb8e8fc7a6a81f84ea16bc62e06d92c25182174f5921ce474d16883e5aa431ec9d01fd90521af5dd7ec7d13bb6b1667b6b4dd010d5c06b644b678d52a183d9d26a2c678f041500ffa9f681eef8a1589434ae1b6e19e55b8a326f358430d01672bde56000573b0042222190381a28ff7f0e94427b2a81a2b5095c211f976e5c1574aabe072527aac93c5b594367f9c28f4680753c5a12251a7fb1c23944df789a99a8578b3fc47ae1d2a04acf5a6a52e5fe42c08783771eedb811c0b86cfa73d816edd6d497d088e64ecb513398c2ab4936edd3683af0f61c49c9cc7071501f46cb157fe4c251346fe4fc5f7d09b1682513ee8d8682a", "80a42653f5714563984b85d17012a22c4cc40f3b7e720442a80a1227ce14187fd3f33e5e3d744653bc6af42e8381ff5dab2d3bc696ab612562840aad5e078628dbebfbd65eafb690c756f31e270197fa46f8b65f1b01217e55476c7fbf9d48c50ec702dabf5139e36caf7480002e3225374d3bf6e544b308403d80edb1bc1e3724bdcccb4fb4373330f10916ac83ae3d290ad36cef02f022567fd1e3cb30df102f6cf8199a276ca9854fd634bf233ce34cc17b2825ade3694fbd9667ee82d5a50e63bcd0b50c704cdec74092a56b8004e237859a130e1871e6d81f3c992863aa04e92703ebb8cb852703cb3b1f51a8a957c9adf8e8b54aa99a789c5cb2afb058", "b7ab67227b9bfafe1190b856b47a613b3f1504d57c368182767147c5bb2ed2e3215a9b294f73c5245f562e2148dbfb7288006edec03271c7752dc56e5973bbafd620999eb2cdef740be63b2f3bb38339ca3c4d109928aa32a934c3e7c957084c59a0445b7e37fe2439d4f607d522b8802a5387bff862c48c405acfe43e2d6fef11bea69cd238278f6d68e99b4884e09dd1341299788b81d289a942bb9800d78e10c3df784519607339bda7bd5613c3422bf82ae0967924b2a40d3f0a7dce8b440df779f6cb53ba7cc4b0889a06d1acc27d7a0541721c64f10f4a78eb95615da7"],
    ["9295d4949b36da9f708c7e7fbe7067e656fec707827a63e8fec4df950bb94c4d7f046138afc2ee251d1b460d11784ca0b18cc018914725b69b3ae2a37308990bbe888bbc405c85183a2ed3ad75d623d2c826a6d2afd642a99b5d7abc8aca8eaf19869554fc44756d83dc204314419a40ca22652e025a8a13890d9c58be18287b32dbde6307ca6586de78a0ebf10f65ffd8e9f76cf5a8d903bbecce6ee7806dda50951ba4cca17d0ef225134346e48db266866a05c8689d14a4b1cd97faa0f1092cf0d46631f7e76671504da120ce87f3b20cb1c552d41a68645febbe3d454ac33a593a81115f34f10e12d40caf9f08d6c0393ce93efb8b9585b3f16de958743c51eb7c7e789ed4a8a18ffd72d708a0ce6777c5d3173feae7707d85b830ca63576775487fd8a6e7f9ad836a2e51afcd22280b477bc9786dd11472134d0a8366c63a9f143a5cd1d211d059301488952b934be55f781894a1e91db321770ad5798f1c23b335dd0f7586b989ae9624e63ded96e84e98b02041d399088156e4a07177", "928c273a8630724c80a75681c7bce0b4b4a0e4a78c4a5aba2dff68f6336103726e3908ae285f63d93f94c9e9ae79cb91a3069b7c9c33e4c950c98bbacb5e2d46e4b08f462c945c3aa59f272a3e5e60682bf1293f45804909287ec402a8f9418f05ff1ca53da9f75fb531460d6ce9d61d02a02ec1edb74267bffd607e9de2df96644d799f7c87072f6eff21bc773f4b7093c397f85a5a4a31742f84e4fc08071d70006d81530360e15d8eec16dcfc547d2541a6ed7d2cad13025561129c9d16c4173f5f30aec13e8f35654f656c54333020f825915ad11cffc6094a3ffd9358116ab2168a044b61104ec762bcac137373b22ff53eb1af99d74cfd9f45e90f59c91aa1b76dae6d2c196763faf9df66d3caf1ea05a59776c4866954951e459204d132d51e790ccc9ed25e1603901cdbd26ce8be542adf3c3bc5902d6499c74215bd4c2c8cfba51866a93aaaf66eb53c894cfca2a707ff084005fd97459de9d971e8", "8c6b1e430f9f0f4a7a46ddec05799b6e657843d799d719aec146ceb64eb7b355efed54de4f5b2f70b29fcf2ee4a5b2c9a408ed40afc4e791a07008dc58bff8b8d5cf4f57801b4e63044085337855c5b4719b007d38f01a9112c3d333fc12b7b858bfecd22b0abe7b1885b1a4b68d6d6bf063475652f3670f1684a2119b82281229162ff43f8c0f60d4b5f9d028f573dde518fc1451246353125a53f6804220160bce7405e212cebfb3413675324c41a11a745f0667ed14fecdfedb76c8b776f735e1113036b9476f57b90027ef593ea2ac4def09998d1071e39be434ee402fc30b82dbb6c0b12f04dc1259821a2c4f98a6773fa858cd0437cbff8c7f509021561b21a7cb7536e9788493cdacf5988449427bef4b16b14773120287f333d7d69c274b3af2b3d306224622288563190f64367473687a4bb463a7785b856ae8a4e8", "846f0ffbee7e5c4fdaf34473aa4681db30962da15256096a07088c1d3997d35c49a3ac98d858103b5f460109afea6c04a814ac123e8954ca577246768ae509f5c435214318f5a0be94ff8fd9e4ffefa2441b51f282ba0d49d01753423d1dc3f71d08cfe140a856b5ed29f6297f5278415af66c93bf72ef9dc14ca475f5452ed020de5d1fe5a7d3d7ce84ef4de9ad339898a5413076a828b4d29c34d3d2b3b5ae4453fdf48f04288cc1ba515346a2c31d36f788d7254dd1b7294c7dcc6615845f02de29a71a97eeae7cd1e96ea309961fb87e9862f1201a786d33ce84613c989444cf99d8ad36a50332b2c68863fd4d30c349368784c786b73429f5c406da1c363280be1d3250aebde383818669b954fa1c622050f124379c6b4c78aed30862ba", "8a4f598b71d2bb47518e680d88c6ee85a4de2ccc344db04121dcf95497a00dc9c056ffa2b8ed0f8d9656224ec4d72d15a20d744676fd17525985c92428bdea33d7d5a45b5af0da65a197ee8703985b3d45983bfd499608410496467d05e47b83246351e17d99fa66bd56dd75398b42df55cc30a1f5dcd5c701788005934cd89807f026f40279ecb67095b9a200082a6ba66434c87af9c643f53c40b9b02dc5b7709a01def47da1796826042b42865859fe9d6522e6f8c20e3f25da924195935c44f70c1308427906a5590d105682e00cf3e7dadfaab2bbc658c49e4e4068e5504d8eb0bcedece8e78880c225ee7382496293f35f52dcd2b703b479c9b8604bd2", "8e30200cf9d95c9f49cb3e1823ed18f076b845d73c49204b73519ea90b84f9e90d7d51625c66dbf4d049d037407e1212a4250be04d1dd18caf62f8e5ec4d569e69908459db315eb25854faca00fe8bcd69ca16eda6007f31e8ca7ee240829cb96ce5a9c7d35b78e89db441c31a492ec47bd6f9790a6640d658149e55b030929b6b05ed39d196663f0bba2ca34f97dadd954e820d581cc971b47ee1973cd689a408f1b60d5bd4a74891684e4dbca520224746b48f1a30f6b6f86ee2b4c1c4f58f4f932d687cf60bc43c4af2b8469dac7658f0434f1aa742d5ed21950fe5faf997"],
    ["8aee212952684b4c8f994f1d9faaa10d55987cc472cc1b848c58d1f34ee8985b5360be9e10994e8d4585b08fe733d2cfac236aaac977de63b71f8d8d661b8cba8847494eff45ac244abafd798e536c312e8accc3d66c76f3b64256e8104cb7e554a96c62dfe1cae321e8c6ad154d91f42644df51b69cd779609754c0b58eb883695500a1f73af4f9319a50e2128b0cdd808fda0f57002fa64bf2f0707200d4856e7d4386e3886ca9e47144729abff22470ed38792174c62a57029ef0949a629b2f7b51235a46c08b0149c2e614fe3b56221b8f91bb2659f80739683c185fe1076aedd9213ae3d0149fbd4a6045a619c709eb7494344b1098d077530c66e1a46d22aac1a59e03f97351898148ca837ec551d95670905d43aef8718b791b1f936b5e33d8d4604f055334ebf98ceec5d0f1ad6bbd1d3c8ff596d8621e0c18464bf26aa38b8d2d0b41c29f961e9d145c9c58ee2069ba6d0628470f2ac53a7dc5f2ef4c17a3ed0ab91b275d10a0574f9fed3604d72c431a21a2b547a0d01d1d61bee3", "8b899f0ea7528a61e4b933a888ad0c6c1f1f7dc5f5321bf4bd400f816ad2bd515cb74a4d9ca80df2b424ddaad372ad3db8677c5a1c24ce0f0ba3bb0afbd633072d6cff11cc919260b49ab17494a380f0f64fb05016cca5972ff83adc6cdb2e07006b1337f3ec9e28eff8963739fbb99312dab0b61bb3f465c5f12021e29b6df127d3f72171598deba040665039f9cdcdbbb556b4501640f8aee9fd45e52e322a135204b731b8dfff57369709b3155512d4da2c4097f62cc90761e95970737442005cb7dfc9a814348374e2b282c2b5b9bb951c9339e058ab16c73c4bbd274590152483c4685bcc9eedf65a39c59192fa521ef41314cef04fbd7e609c57219123347fc26e4498c20c5d6febe38bfcf3e7f003dc2612e85e457fa5cd3feeedb42161b331d54bad2aa4bfdc5e9069f00d921787fe235cb88ab3ce04e69482216fb55433aa7e9aa4c2f0d57c49d5e986bb2392a335e865696d2512740f0fe284a700", "b3ecdba4d0013ac91a5f880d3243e67dea6df773612adc6ee49152775a030dd82451e0fa288830e462dafbd5040f4d1e90606888cbf9076958a0da56fd4bbc0dd6b318930cf35bf5415ca95577604583786db26f93f41491640427071bbbbd5f366a4c6b86d92ade3d87ed7cada6f1bf500864ee0627bb80157e27efaa73027c152746e4bcb3cfe2c62b32abedac82c3896751bb75b289edc8ec43955091130031d67168094146aa0da1ab06f5bd0b6cc4bcc6f2f5dcf3dd70cc2e59d2740c4d28137d52278d10c7e2738891f8e70fda084a6bc2f894fb3f4989294ac3e73af15b20d10e3c4792b8abc3c1672aaee90c33a474600ad3b3f19651393e0654e7ad2a9014f05a93ebdfd4ed9aea268cc802a2a1887b7eab9cf5496291e938e0440516048f81f75cbfde76cdd9a7512233f946962ef1e937533ea02102b020d5cd05", "8a5a758abb95bc306a2f5a61e2402f1eb04b3562aff54609bb7233b455b25baa25c09abaa2888299791c4fb5fe5413b2a51871a6923d9aee28e9c389d27f6735f1945665e01907a367d0859f961c8772508baaa69a8eb1946fd7ac2a3ba650f06267c52d28c67d0a0738829b8498ab5e864fa7447ca23e4b91d8ce1ba2a07918221ca7a5cbb7b36c3dbc13f09f4dda846d4ee577fe39e6561b6648a0babecaa5251220cf0d6f07dd93c5a6e24daad1c4ce6913ced29a155cacf27c7fb2a08712172326515f4d88a963dcb96c5bb6b4a709bd65442463df34bed144181e540e5c03f6d2d385c0e0485d0a69863f7303e663ecfdc15015cadeca83006f2d0db42900b3f82c5a20684b87c06582766bafc9898f91228db5d9ab8597504b3e5eb72c", "b0edc8bf444f5262ebecfddd799008f48ddf8205af0793a8ce7255cfe21a0f330eb6d7e5b38a87f72befac7f9a232439a92911b368adbf7acbc3a7d61de7437d2fa88862593c67becb5baac0b67b4c2a04693100a6e8e0505d42cf359f2ce7a24f9660b44279573fa129fae7f98b8bf94be4b332dcb7cad0dbcb303e551635fc407036af73b1bc959ac5227e427f371320b10e63a739d7c9aea67b9d05e482750d85c88d8180b507f3bd3518b6f6b27b816831b75d2d52fa02d842ffd52ca648208b2333c9415728f7b4cb7c43ea5cd7c0f4782ec13819e7a20397048169dcad6f06af1a696216835f6d0abb2c51523131c2610dc01d43b8e03b15c0c2df2d22", "b769191fd65fdbb407bdcedd400b9faa11e4baf5087c71d968ebf602aa1be5c7b2280a4da4585ac5b914b914a2a0d9e6992f00dd51bf4062b54ee43b56af8476a9e4d16a135df9f54c269af4a7acdca251b9e5326e33e058c37c2c3240fbccb272d6e90b4b2d3f8ef446ec6f56d7a1ef0434152697a84ba8eb7d0b380d14f7d05a301fe2ca8832bcd62939a7523cb0f1507e4483613bec795e2eff864d22c38d454331d0cd26ce28a19a7f60eda75a7e5801597614d9eb1ae5990912340eb3d6465b584010e66cd4319f21e2f4025b7e138cfe6af94baae53819268a3d5209b7"],
    ["a8fb111f54e2991a3825d8f086ad6c88a76cf556dd26435558fec7c78c41e8ae34fdb7be71490c9459eb3709cd13eb2181ca8287c2325245415b5b5155a5ef7938ee4d2942f1dad42d2007e6c87bfbd254982a356bac63961f1ded4f3c5dbeb26e9def3f269cb0ff217ad70b138b0d6a20274c22fb71d906539ba627f2e333ab338f59f357b009ee6b0f951bb6b6b0ff11d4ab674d4129ac04563c56e6af85e00dce5eee928b13d176eac2197616d020e1b87243abc85b200d592bc0719140f5474cd9163199ce4ead1f7e64b6793d1d3d6fa2523d46ce548c4d78e4ba308c1a515bc42ad672b16f02ef0113f32e07b80bcf087cea074ca1ef01c6732df1363470a3a9b39437019835fae56db553be95f13917df06711076cb19149146cbe85d53990a120c459e7b85612cacbb3272c93b998f682f6c087726fcb47e006690c236adbd5adbb4531dd43a2b01871ad068384b3e52a084b220a575012ea1727fae14c8efa6ffe861b3e4a7d6acec1c9f235d172816c2247ceb339e02e1235d6a13", "829655a210a16a5f9185704787f05ee3923e67ab8f0411ed26f336ea6fa7261e78d681abc34b85b2629455085f7f91f385f319e7c3d610d6170b71ebd0d3a17321c81cf51a9babd0e2c276c6707a83877da58aafce711b8a010f79b0c80c5325351b34595c8894906813d082b43daef006693e535db6f024c64b3a8433964c956b7797062c5d552e252392fdfe7b42735deeae74c78a5487072a0018995498f619f20ef165d624304476b32152ee4957a1b17b9d5040e76c2b9d313f1a85757823e122121f07a03c692cbc52ad56e6291f6b8427604bb8c32335fb18f1c4bd835b886aa8739b7a7c777b8918d97e30f798b63b1c7fa80d183e8648c33a2814903f067c94668439b214d631d7229731a220c71e1c0275a5d1c877edd024ee10e50027997e66f0d15e05676dce889acb36ea447b6b48bb28c19e9b3948cbb1375e054cd53295475cbf3a193c1dbe311cee5080e4ff57740097bb38480790709bc8", "b6aac5061e63900252a8eb132b9d627021c95020bfad435986ed252566ce84c692a35b091ae6963fbd201a50fac9cdbe827d17f59cb95ca842c1880a54b0afa14ff8f30bc988e2198cc43b88a730b86dbfa15c59f9233736ca3bf0454047304911c3a96ee54a56e52de1a96f5098d60eaedcfdc0f1c70851fcfd3a4fe572f99357490a88b2f89dabc62fec1877eeec4fcb82123e988e41eb1cd4eb876b8de683184e33eccac2ab08743bd964705ceef83d2413db183ee2c0a49637ba91a67cc8091a2ef2583e129736ca959cb1e68c43296f7ff573b36f8a4a26a9a73c3d47b76bfb06098bd59f9c55f7a2a6d5c96916bbe271860cfeb3b0bf290bfce4b7c0cc3fcbe95867f902056c412220ca968eb2faf513c65be510665d6a04c44ebae00b70d0b67d0219f56dfbfcdb429e650cf383b834a60849db82d746b506edca06b3", "87ef40dec19ccb5ae3ab09ee21d11157a1e7d7076f11454f30b4bbf38b9a20a55c5d6c82fd8f3ef0cb50723bc524aea5a0addabf6469a1ea22fdcf0e3aecac491b049a11b9e50028aa503aef46a2c9f2cf9a5134d3ef2fa31bea797909afe9eb2de51ce2e55b77ba0a3b56a8ec65fd4967e16a97da65fc4ac66e1128458410ca5ef161d8252307e52b6aa0a5acad3d74de193e7b3b39abce9778c26c25a286096388737de1937bea6e49812486a59482a493daf8b1a3f15fc5783b8aafc76f4d3b99b6993539c3b5f71d5d583f23272dd316abb056bc0888836149a56409004001b2a0fffac756ace8dff19d1655f77bb34d0aae0c905fda27601e2fd09e28fa3e108cb952abd5995aab6afd79712618b2dbd12e7f87228fc69c9abb890f9105", "82f34fb77acc868f8a592d2974cbde18c242984284c95b00a35df91a40ad18899ccc973fc70c4b5aeab9cf001a019f13a542bba389c14b9b58b5446778fc64f64af70e3349392372d3cf2bea9fe7c1e05aa474d09b234b03360aabe1acef989f0ab511c72951019f2031b1e943e8e6ece4dfd3e0d86dff4e9b0de1582797040d5bab35bc812ce70b32c7fc7229204a4aa21fbf3db853784765d6792b5c0229942e002f111d91344655118af2de0d0c4bcc7bb3a97e1af82d5623e181e27baf7b612b9c9772f0393dc7e0d2a1a8f1d192596751a99d7d88e5a3319cc14be45fdc0a629ab9ac61edd2fd32fcea69f3d7b5384525708f2b658d608b1cc1bd645fb3", "80889ffdbe8e94bec4fc0eb088f8ca9b808d12d83d6651a7ade515efa96f4049abd78b743ecff07ec2e7a6c93f17c42792ed75ef25c08e34af098ce1096eb9a6a9c9003614ffb9511a6ab8b8b8a9997330bb3586fc0323e3bd501733aaaf4e4c0e92acc081fc5fa1a23df99a9f6db41e28b0cf0c5960bf97a5a7f44989b07d8b295a69b6ff959fe542d110d199c77ad4b923a881ebccb5523593d8016536877b3fda5fda1e1c51690c636f9c899207814908414c05a0300c0ecd53892bd3d46c24599b4fddc8f4bf0b18491fa24ba097898b43de9d3f13a8d3794e3dc0443504"],
    ["a5a21cfca36f76c5ff57ae60fff0beaa167c0e16034f9afcd94eb731799384807287825a879d1bebb62dd794c94e617ba6cc11ca98a1211ee42900bfd6fbe5e91a1cf2e2bd6408087d3085688c066e3177952b99e8560ce7d1cf55e74999c56c4d38d0ddd1de48de7dae9e74ab816d34179275256aaaa157833769b2e47bbb29141711bbf52d0861a28d6e613d31a7a32348d1f105f149f99b4aa0d6b80c3c841c709880d3f006451bc2c17d7287ba831d7957aa73156d47310850fea2375ee908f9f87d79f8cc1587470a7fc99b6a43fb347988eeaec635797a32e519a3e1c52905e1e2fe21ef88fa7a2bd492f20ec2506c9e61b3a778419d41cfdc47b618855362b86a3721c01472b58745b471be8da80abecc44dfe18716db758b27895c361ff4df256c2cc75d2dc3d6951f3d3987fd2dc257b6fd89c2fe5659ce821ad3b1256b3fdc6ecf35c008c1e4abea41b12a74df8238ad331c9dfa8f6a1bd429ee1e10837375ea0e22a7c438ae6e61a9e291c15b2b202d0a85ed44dd971664b3207e", "96f62e684c35548cac92a71371fafe88401f117503bbe05d14ce3b7f05df82eee75947ab68ded9c1e8c0fafa87811920aeda16a274e13a77b6c39ba75265d50a2dbe201bcd43f6b0ec2ff1ce618eed4eea0548c416d42fe2a2b1de9a584987155874cabc351c47ade365f74eeb02e2fb09be1eb91a4f7ef1d9d61b4f0eebed6b197a15e0c8d240477474092775a78c775c172ac8b7339af03d4b2f173e3f577a37b90093d981407606e46064ecc6d065fc88cece770fc5ed91b34486942c3b3d668826d348f4e86523a713823b6a8feef02e59a88ba3598f6455f3ec4a2775bf4e3c5ba10c7dfcc0ea236756ad38929877646a6f32fe9d98523a75e4c64873df15b4f52532d3be15ed04d6d1bcd0c4cb8df7bb56d6cbc2a076a993ac7b2a5a890d879267f2c4678ff06f4d91fd6a8a0dc6c3064800584a549d3dd7abcfaebc031da90db4b92f2bac9477c078446351d4396f41bee02af61a8644afa952d60a80", "8c6f0f73f3e68a3a6e00f32bc8b24aa9541f3ce0600a6351ee25fa4a83d013f4837857de04f286e2fd040e7c4318d16ca6a7e823bd5da8fc5115ee2dc2f9b94643b4f8d83655ff4175bb074dfab9b391b4f34cc16fbe05dad9921b343f05daef00dc644c481c289720608ed774662511ef91c2aa3f6989d3b72e44a1785faba130dfdd30ae1a99b736aad3a94f4d0e77c42a79ffcdee6766ca85e56fef6f9229720cda98ead4def8cbec58afa88134a321234b7b30fb3fd7b1f3a597e316e54d2b217ea81faa65c77ee9948c754ebb1db6f48ee7b9da24ee0185f4d4e9b9d692349af582a7bf93beffc075a404d41038161ee9d3b386e3dc4877ca5babd2d7f615b5ac62e1188fecf89ec7bd92f6a67c86e6d2ec280073d47ac625971b7ec0ab5fc2ad581060f93adca3cd402ff6e6aae6f3e478997aff53e2cde4ef57aa0dfe", "b71435c13f6a77e4c149fcb45be0fe6c6611d99cc5b746e7f0bea11e08cc827c29e7a9a23a2c6b28159d916ab59634fcb6f00034f7fb0cb1c78d9a51e1750fc01f76d262dd1c03de70455438463713b881904d9a5aeb6a9111ca25a2d541c73273085c24d260bd3c513ef2397b9b16b75fb0293f40315d727fcf0947112bdb2235123fd42944f89388932466ad8c2597c33e6d375e13b8bee256ba1fcdc1b0eb029def69f2805db00452686bdca8279220ad66424b787d92efc3dbc5a077b63364c6f6aa58059d6d7ebfbcf5c9dba1ca305a05f97de11891bbec472e42a63cad593e96b7c465bda75816e8f82a78b176b5bd9abeecd5af442c1c32a6980fa0ef40de0efbb2738526447331ba1b7927023a2d4078657ff7ac134fb0863c30d1db", "a312ea9491a6d60cefb6209d918e393dcbde47fe5a21a169f50457d56b2fe0dd92acb630f1ca9dfff1ce78107d339b768927d9636d6f47f9f12fd9fc8a5bc74de9b25c2f2e42eb8ab8d5c44ec4b6a2512411792ed965ce266763afc5047f59b74569eed1789b805937ef167d6ef9ab1ceb2848dae98779f212a9010ee6586a3370e97d95fb1693649bfa79cff884cdf4fe3f12bf7c3eebfc472a0298b772557f4312883092475f80cfc422a250935aab3a68cc2c569e179da5a496ee9749014e01f0804d43fa75ba04cdf61d1b2e362197a738178b6a99b8a1eaf8beed859bff190482e86ad326db341748a68af11188fd0cce495ecc9ff15073ccc12531ca3e", "874de94d9d1333f89ac414b035d6a3add23d23a6af52e3422801eff6aafc354842714915f1d5c9791e66f7af71a30054acdf7e35f1bf3efe92eb2916de0b7afd7fc64cdcf87051ac482579c88886e824040d31137501fdbfc277a3215162d72b307f8479310e7bd048261a5a4544ecd89de1495b945eb5b30f56e658b38f9e8614ec91921c87fd0e70e25ec589838fb7aedfee12e46380981467b85a73eb64c56a659a1efff76a90a713e4986547dfa0ad60d07a65c78b65b5b1e611ef01f5da6e52e77dade5b412e584b1c05461c7481ec2ee9d291b0878c096493459e5b176"],
    ["acb9f5a5dc13e43b2119fb2e1fad4bc87dc7d5492d3e185020fa9292f7aec12f92f4ab9f6bf6d9e6469982ef98e4acf4a5eadbde817e45c1f5ca42262f5fcd616a1ca7cefaaa909b19eb20b79989bb8aeae930b5e29e1761a005cc285fc32c2019925bdca63e023c6c99756f8052079e937c95c91e5bc09dc5c1efc1db52e6022e97fb6e5e87a17f56408a642c09e50a269189c1a33e9ebe3158a238114b10be120b5c69ff89d46ae5ae5bce394e149b8cb6bd79ebcc049e995aae4c4eefd8df00b431b89831eaa9a640f9ac51b9c723faa5ad4af26926963e21619064656c5a5ad53a9f3a412a60d6f6b7b92cc591083a493304a3fd0342e44579e1f57d3623416796d58104f61458a08afebc7d8b41b49c2032c40d9eaee8394138643c2b1c68ce2709363d5c288fbee7901416a1346404544f3d8cc5f325ba0dca4d7ca7313bda1f0ddb28328d1a2d68748f816e38675ba35a42bb5137b73bb2e78d5e94e1702f13215f2e4236d2ad16fad217a4532db8106131db51bb72f92dfb37642f35", "a27d87a3fdb325a4c7b390d3914ca555752eab12dee6c32a526bb6801481eca572bf229b404c0b19a5f4456593e940b7956641fff3e94ab382c53096b46e41e7c896ba73cefc61440943db732902f8c2d5afda472166604813da187a90bbe2602d160645cf77fedabbe5df2377761a7e45026ef1636b609485ef555e7926b6cc4b0609f16e65d100f700793539c0212a65ab6b0388de1bdca3b99c38e08e190d6a17aa7219e19d0ff0a3bcaad745863681699418cfc44731e6aaadf3210613b5294135f7912a3086a1bf5e98054cf3b5f9ac9dd9e85947bd7118460b62768a9f64a58f732d268cbb859d537c6316fd1c11db00d437f3e2008ce686d5bc1546d959a16ec8c612069b66dd27306dd6882979eb78d7b0d68aa382c245dd79bcce1637680255f27376fb6cee30e9c12cc9909a4efa89d5cc389d0858e89160c67d3b5786331851f96d9e68d9011011e176e3ab2f21bd1495c49583e48b3083912bcb", "99d476f31f55fc591d4fd4564a9b0da4b9bf64c7051fe91e9dfdfdd88eefbdd8edceaeb1af54884953c0d6d864266aaaa144c7e2ffcb4d31c467e3a4cbb20697529f987431604ad7d37aae4c07d9779ba121537b3660f6c6f2440d2565e25568060029e0ea696e8ed9d4f1a4e7eb3c3d74b9ccab4f6adc04636e5706cdf129ab0c9a48c1a65489b722b39f9c4d159be5637a7db8900e6a1827b4a985cb06f62f2ef0691339908a84212d4b827b2993f20fdf03494dc12d7e889f98892d1b5cd82ff811042f60b7aa6dde5ebe616ad5097227b19a3a016a1a29787e89f9d8770406b61537b7a57a65cff395522a34c09032b8f223f354cbf05c579df4fa9b8c8261a88c018e10d05d5fc3b6aafa6446cabb8cf6b91c9bb7b326b9d26203934bab58e0cdbf0a4d2b7bda6f974b58a805915ee0619111ddb5305fc2725d0944e76b", "b32259b13ede7d89f3c887321b0a228f215a1bbd345e3ef6a054ef4ccb7674be63d4c5ccd8a01f892d7e44a80424637c80689d18e5468a5fd4330f1ca7bdb6f28d0100a9e2ca4c4ffd78edc71659a6d32cdba4656eef14bff275b6093328625b60057b193180656f095e68f83fa73981677d8ba61cd4dc022449b336bee4288e5fb81ff27513f45d45c5b3f1e363dd0ab5c7ac011104addb9ef11906e617ce4f1da3deb22978502504c4d8f19e319e485b053a5c25826aa63d31ecbbb2274c2b6feb8602631f6b848f65c7325738829ce0a5f9932caf9099c0eb37e8c02926756fd7898520adc568cb4d69918cf6b611bb875a6619f2808a4d3c489f01b909066879c5db547c22918b3acbe6a69228fbe13f57befdfd7f05ed8ffb8329cc5f9d", "ab78209c37893e0a5ce02561f701041806a7fa3e486e878fcc17c2dc97fa51111883962b124f6df4cfdf5e0493c303fb8ddc04e3ca4638aa1adc07b2f3f20618f6c2801bc14d2a4b1d226e6d4c063e58e2da63079169e27c636cc1f77ecf8b26465514ad91aff80215096a7ac7eeae95ac20be58791524adff6d1437f9db119506dd33c7da3e3f8c487e4a1b468521ca181daf1cb0fd034a61aaabbdd9350f2a47b403bf2ba0667b8ded6cc7e9792d1ae1340295ccf39fc453cc0d4aac5ff659522fc3cea72276cb7e3b473c61a5e49e8476d787ae00ba8dc2c769ce8a85fe7235af473ccf25830e910f21c33a15f728f5753bb8e1b8c229110406a3935f1d11", "a92e3e230d019a045c072e0e8f0614b967cca0bc81f589113617651a3bc9456ac454e0b0dc0f51561fde3b7ae653d15ea874b04e1d3914bc844c6cf2ff90c3f2c5edd5493ed9ad3711b0854c00e17f734b2c9d5ecdffc5e415b2b4fdf8102e8b53c88b14a6aa1dca28e9b6aae6b656776eb49d855f578fb623729287b3faebd32318008334a1c266656d6968cb61fbb62c54524b6a051ade4b7cd23410bc80ac000ed5332f6014a5f2c6b31fe2cef1d7b9192e1d8826689b62ea29725b6e462928d7f61e847d0e8a774e96390538558a1790af233d92e2b4cfe40473c18bbe88"],
    ["aac5ab25e0996f32271275ba54ab6cc1fbd2806883992e05f25659f510428dccde9c4c98963daf7817ffbcc9a8f725b2aef13f60f38dd8a55f70e78894fd59e38ccfc45c66d06a147d4bfcdd693f5210f07f13b4faf5137c79994ee5824abf9232edc61a6b4dd13a2b641c9244be750bc184fe297e12a94626a2f9d2890234200ad73ffe8a515d619e64903e7df8be9b58fe50e2e11bd9af768a219f4a60e7f117abbe1425a5ea348be7be5ac2f0942c59189fcb5c7ed5d79bab235aa99c0d4b4a75ccba46ec706316c77e561bc32bfcc108a362d593ffadfbc0e21659abdd1c58e0f702fcefa51b7f0d27917b60a36bd7c2b4c7873b18de05bbc682b6bf57203816f4bfa93e2a0eae69c228c7d756417944541c877a0ab1c4f905e82ff579380158ea3e10ed232a182188a8940f7a20d260756c4edf4f482316d622e5ad31d60f170cb2ba1b47bee9e10015cb5f0c1221888953c8055b17a4f9681f795924033967ff0ef26b0a96591e974322d5f70523e88d46405e272f26e957e4d680a22e", "a98be12cfb44a6239f5a862317aecf42af98887ad7a9a780994084f02b951479f6112e9f98c4026fea81f1fd3d5a18c5b0547eec01fb3cef66bbb8e89387cbd6336ec72258e0de4edb8304c0af5f09d47987fb5bc52b519cab326d1e52400b3a694f40703f25583a0fb3ded96697be4f864deb6d0f336ef7f431990b3a52ac4d29e4a457e0bac733b0f6590e7defb2a541ae804a233580801b565b417ed5db991c00d70db9622fbc0eee6ecbe5bbb4d00f3262b56d32f2e8cf61da5e7184057049d55711610a34e46b3767971c5d226010d3e914286fb1b077fae9e599d6c64d2f26b85247dff6e83f5bd017ca15a10c72e79c9d3b96523ba9266b115564c26e4ddb1e2e09c7f235d56724a77b4f352e6e36fcb9ccd6f0a821a45fd920b546f81d4116a1043dc159e430ad1eb78dc3e5a5f001fb3f313d49d4fdc1daba91030420490421079aa23e2715634e059e97b7698f44a3bee2083df71c6341bcabf905", "aa5c682a198728424af59b36c9c4aae9ccdac86e7e6b542f775df28d315f40fe7dc1a206a6fd73854a265cd63d8d6411a6e1932d3fac4902ecdce31c1246b0cd318609e44513288f64270096f66e5e492e92ed1864d4343e9694581133ea74fa3e107234eb1189cfe12a16eabcad338f6b320be501a529e6b9b824105e63e29c28c86c62680f082e158e1f7ad551cfbec03bac4bb1e7d72e32ec4f12788efc1c21ba0aa11f100b398bc8817a3e256ae276358a355e8afe9d0140c8db1faa7c5748e2f239f9910e9cc38d6deddc5a434fed179d25e5cac854bfd870383dbfa2181f0fa9dd4dc261d3c3ca6777b067ef99811c91f148757044b1d956afd8e20969055d03fb310a27f22efade0cd677313b8758b918b18c38e96cb4079d4c64bf37228a410d089837bbce082624e55cf04600ace787c1991e32715ca11db6502662", "8ca05dc485720fc45bcfaba886f420d90f76fc54251a2f90f7684bd2e3459cfac7b7ece10cd6c4b109253ae75fa226b7950bd15773fbd6678fc5b8524b35fc98d2b212c7192d2a69553f009941b6e861669221a976ad7f73fd71350446b25e3b6495dcd982317fda2d5ce4138ef2323dc76f0d8bf638fa941455606abc8a841b2c02e51a4340a7fa8d580339ed2550fa5d84aa48efc9b60cedd84af964bb21eb0d2db4e9a57f1c21329d1c32668a0f39da4b00c4b85fd98ce4845f9ec4cd4cd414a62de723e22862d6200f9a78833758a85174e82deedd1634f7d8497535cac535ed5f68b0c2cf96bb9f54ee146560547ecc2400e4f2d11cf145c1c182f5ea0c3f142b687bc9d8e616b7d4221cd7842c7372c7a7be567ce889928b3e1b59233c", "845b3868c151edc09ee546602c4ddbc14457b8f6b0248002a1beee2cdadcb0c2a6bed381929aa52fb17aef8b8372b074a09fc965f759639e1cc66829a4ef9c5115c5258afacc02c05081e1bc862b6b45bbf09b99cd87d645a55d7e0e04f0cca7277da42027effc3141081a6e27048fb002e73617ab24c41e3d3f509ae771fd765de7d61b1ed9caaaed253c60bd37bd11aeded072c78e5ca2bd54edba37c14f0c3e5906de559c559f9f509a94b5534eca08898d9e1eb9f665a5e81e2af836fd2856698bd19887d9d927320e7b755bc986593fc7f0b39c1e4bd46c3439da22708b462c41aac0f2955e9eb4b5fb727d3d1b7993edeb9e90333de4ebd274819bf7a6", "b93738ead0f1afeb9101a777d8ec07b9c82a0711fa83bb93040c1b8427e8283ba3bc7601fc5581cd7403a6e82531df24a8a96be9c74f13b6ab4a85548921444570784e997a2f553a3767a0f4aa29d362cec74a95c9216bcf28889e79c94f97c4680e71cb5fa0601c553767ba17c63c911ba8c9b190806b7eb1f38d972619c7d45a18e293f3461ea0d6344585881620cc5aebecd9bdfbf3fd5d6bb8a860a979ab2e0e30bcbb75e0d29ee44aa5a5f721dd8c640b49920630d64745e4e426266ff629d5edf2c032a9d43a0935f1446f3372ee4f01649738c0962e74843c8eb10c42"],
];

// dst and seed for the mocked rng used for proof generation.
const MOCKED_RNG_SEED: &str = "3.141592653589793238462643383279";
const MOCKED_RNG_DST: &str = "MOCK_RANDOM_SCALARS_DST_";

macro_rules! proof_gen_verify_e2e_nominal {
    (
        $sign_fn:ident,
        $verify_fn:ident,
        $proof_gen_with_rng_fn:ident,
        $proof_verify_fn:ident,
        $ciphersuite_id:ident,
        $expander:ty,
        $expected_proofs:ident
    ) => {
        let header = TEST_HEADER.as_ref();
        let presentation_header = TEST_PRESENTATION_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        for i in 0..TEST_KEY_INFOS.len() {
            let (secret_key, public_key) =
                KeyPair::new(KEY_GEN_SEED, TEST_KEY_INFOS[i])
                    .map(|key_pair| {
                        (
                            key_pair.secret_key.to_bytes(),
                            key_pair.public_key.to_octets(),
                        )
                    })
                    .expect("key generation failed");

            let signature = $sign_fn(&BbsSignRequest {
                secret_key: &secret_key,
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
            })
            .expect("signature generation failed");

            assert_eq!(
                $verify_fn(&BbsVerifyRequest {
                    public_key: &public_key,
                    header: Some(header),
                    messages: Some(messages),
                    signature: &signature,
                })
                .expect("error during signature verification"),
                true
            );

            // Start with all hidden messages
            let mut proof_messages: Vec<BbsProofGenRevealMessageRequest<_>> =
                messages
                    .iter()
                    .map(|value| BbsProofGenRevealMessageRequest {
                        reveal: false,
                        value: value.clone(),
                    })
                    .collect();

            let mut proof_values: Vec<String> = Vec::new();
            // Reveal 1 message at a time
            for j in 0..proof_messages.len() {
                // mocked random scalars for deterministic proof gen
                let dst =
                    &[&$ciphersuite_id(), MOCKED_RNG_DST.as_bytes()].concat();
                // number of random scalars to return from the mockRng. Note
                // that, this value will affect the value of the
                // mocked random scalars
                let rand_scalars_no = proof_messages.len() - j + 3;
                // mocked rng computation
                let mocked_rng = MockRng::<'_, $expander>::new(
                    MOCKED_RNG_SEED.as_bytes(),
                    dst,
                    rand_scalars_no,
                    Some(BBS_BLS12381G1_EXPAND_LEN),
                );

                let proof = &$proof_gen_with_rng_fn(
                    &BbsProofGenRequest {
                        public_key: &public_key,
                        header: Some(header),
                        messages: Some(&proof_messages),
                        signature: &signature,
                        presentation_header: Some(presentation_header),
                        verify_signature: None,
                    },
                    mocked_rng,
                    None,
                )
                .expect("proof generation failed");
                proof_values.push(hex::encode(proof));
                assert_eq!(
                    proof.to_vec(),
                    hex::decode($expected_proofs[i][j])
                        .expect("hex decoding failed")
                );

                let mut revealed_msgs = Vec::new();
                for k in 0..j {
                    revealed_msgs.push((k as usize, TEST_CLAIMS[k]));
                }

                assert_eq!(
                    $proof_verify_fn(&BbsProofVerifyRequest {
                        public_key: &public_key,
                        header: Some(header),
                        presentation_header: Some(presentation_header),
                        proof: &proof,
                        messages: Some(revealed_msgs.as_slice()),
                    })
                    .expect("proof verification failed"),
                    true
                );
                proof_messages[j].reveal = true;
            }
            // println!("{:?},", proof_values);
        }
    };
}

#[test]
fn proof_gen_verify_e2e_nominal() {
    proof_gen_verify_e2e_nominal!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        bls12_381_g1_shake_256_proof_gen_with_rng,
        bls12_381_g1_shake_256_proof_verify,
        bls12_381_g1_shake_256_ciphersuite_id,
        ExpandMsgXof<Shake256>,
        EXPECTED_PROOFS_SHAKE256
    );

    println!("----------------------");

    proof_gen_verify_e2e_nominal!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        bls12_381_g1_sha_256_proof_gen_with_rng,
        bls12_381_g1_sha_256_proof_verify,
        bls12_381_g1_sha_256_ciphersuite_id,
        ExpandMsgXmd<Sha256>,
        EXPECTED_PROOFS_SHA256
    );
}

macro_rules! proof_gen_failure_message_modified {
    ($sign_fn:ident, $verify_fn:ident, $proof_gen_fn:ident) => {
        let num_disclosed_messages = 4;
        let header = TEST_HEADER.as_ref();
        let presentation_header = TEST_PRESENTATION_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        let (secret_key, public_key) = KeyPair::random(&mut OsRng, &[])
            .map(|key_pair| {
                (
                    key_pair.secret_key.to_bytes(),
                    key_pair.public_key.to_octets(),
                )
            })
            .expect("key generation failed");

        let signature = $sign_fn(&BbsSignRequest {
            secret_key: &secret_key,
            public_key: &public_key,
            header: Some(header),
            messages: Some(messages),
        })
        .expect("signature generation failed");

        assert_eq!(
            $verify_fn(&BbsVerifyRequest {
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
                signature: &signature,
            })
            .expect("error during signature verification"),
            true
        );

        // Start with all hidden messages
        let mut proof_messages: Vec<BbsProofGenRevealMessageRequest<_>> =
            messages
                .iter()
                .map(|value| BbsProofGenRevealMessageRequest {
                    reveal: false,
                    value: value.clone(),
                })
                .collect();

        let mut revealed_msgs = Vec::new();
        for i in 0..num_disclosed_messages {
            proof_messages[i].reveal = true;
            revealed_msgs.push((i as usize, TEST_CLAIMS[i].to_vec()));
        }

        // Modify one of the messages
        proof_messages[1].value = &[0xA; 50];

        // Proof-gen fails with tampered message when we pass `true` value for
        // `verify_signature`.
        let result = $proof_gen_fn(&BbsProofGenRequest {
            public_key: &public_key,
            header: Some(header),
            messages: Some(&proof_messages),
            signature: &signature,
            presentation_header: Some(presentation_header),
            verify_signature: Some(true),
        });
        assert_eq!(result, Err(Error::SignatureVerification));

        // Proof-gen succeeds with tampered message when we pass `false`value
        // for `verify_signature`.
        $proof_gen_fn(&BbsProofGenRequest {
            public_key: &public_key,
            header: Some(header),
            messages: Some(&proof_messages),
            signature: &signature,
            presentation_header: Some(presentation_header),
            verify_signature: Some(false),
        })
        .expect("proof should be generated for tampered messages");
    };
}

#[test]
fn proof_gen_failure_message_modified() {
    proof_gen_failure_message_modified!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        bls12_381_g1_shake_256_proof_gen
    );

    proof_gen_failure_message_modified!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        bls12_381_g1_sha_256_proof_gen
    );
}
