use bbs_fixtures_generator::mock_rng::MockRng;
use blstrs::hash_to_curve::{ExpandMsgXmd, ExpandMsgXof};
use pairing_crypto::{
    bbs::{
        ciphersuites::{
            bls12_381::{KeyPair, BBS_BLS12381G1_EXPAND_LEN},
            bls12_381_g1_sha_256::{
                ciphersuite_id as bls12_381_g1_sha_256_ciphersuite_id,
                proof_gen as bls12_381_g1_sha_256_proof_gen,
                proof_gen_with_rng as bls12_381_g1_sha_256_proof_gen_with_rng,
                proof_verify as bls12_381_g1_sha_256_proof_verify,
                sign as bls12_381_g1_sha_256_sign,
                verify as bls12_381_g1_sha_256_verify,
            },
            bls12_381_g1_shake_256::{
                ciphersuite_id as bls12_381_g1_shake_256_ciphersuite_id,
                proof_gen as bls12_381_g1_shake_256_proof_gen,
                proof_gen_with_rng as bls12_381_g1_shake_256_proof_gen_with_rng,
                proof_verify as bls12_381_g1_shake_256_proof_verify,
                sign as bls12_381_g1_shake_256_sign,
                verify as bls12_381_g1_shake_256_verify,
            },
        },
        BbsProofGenRequest,
        BbsProofGenRevealMessageRequest,
        BbsProofVerifyRequest,
        BbsSignRequest,
        BbsVerifyRequest,
    },
    Error,
};
use rand_core::OsRng;
use sha2::Sha256;
use sha3::Shake256;

const KEY_GEN_SEED: &[u8; 32] = b"not_A_random_seed_at_Allllllllll";

const TEST_KEY_INFOS: [&[u8]; 7] = [
    b"",
    b"abc",
    b"abcdefgh",
    b"abcdefghijklmnopqrstuvwxyz",
    b"qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",
    b"12345678901234567890123456789012345678901234567890",
    b"1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/",
];
const TEST_CLAIMS: [&[u8]; 6] = [
    b"first_name",
    b"surname",
    b"date_of_birth",
    b"father",
    b"mother",
    b"credential_id",
];

const TEST_PRESENTATION_HEADER: &[u8; 24] = b"test-presentation-header";

const EXPECTED_SIGNATURES_SHAKE_256: [&str; 7] = [
    "a1b022a17d9da20fe968adbde9177068b586745ddcab3bfcefdcf887edabd7ed1314cc490a68eacb1f64f8cf1c8d94d428d7444644c42743c5b4415a7efe3c0a60c5a400bf857be43e778732e54f0fc1",
    "9623f8326904b9800d6cc30511b746b1d911c5fcf70e0ad8f2c1ca3171ce684691ffb8a4400eabc941838c12bcbefacc25a95727cb945b040db78b7a221398c75a2ae7c78ba09d1fed508f7db4c8e3f1",
    "802a044807de7dce1c31ba91781588d7c5fa1da1899fbda61494455e48a443695d8fa481172bcd78682b6aaa01fa1e71456ca1df22f3c88032f14b21de83137c93d6b619650877474291bd34b1a5ab03",
    "b3987d33bcef36e1196fd32aa27663c9a69dacf2d7dfb6a0efb1387d8f779b50726095179d5e03c740caa27e5fed692b14d5190af073b43ef4918dc1f00c49739e733290b5e8d45c66ff598fc82cd3ad",
    "8946dba0b24223d74b8e23dd97429dec43c9abee8200e771c4d4c1d98d2d9b51faaeac2fbade639acac219935caf2ff240a1212dbb5ccf120a9726c70ef84f4a4eafca5a29a94593951cd1cc366592e2",
    "b844d0e9922660fea66cb4f74209ff7175459b85289a9f1277ba6a9b666d858abd31b32e3727811ce473f009c6b165f757f0106bda4eca30d225c2e9fb7c5b3bc8e8d70299ee625c037cecc476e82c46",
    "b6a5fb0e42d1b5289402666ee1295e161fd307641280ccfef50d04890e769181b09c065dafe3b9178687f96ce47246733e0f2ef1b6ca610e836d8d2a2aea170f51952e5cd8fa38ad407d12dcbfb63e40",
];

const EXPECTED_SIGNATURES_SHA_256: [&str; 7] = [
    "b811261f6fe1d96782242e783823335ecbe982f73bb20f3f883fdec8ed5f2ada9b42082addea2823636fd264e43856fa2ac1a07bf9b6f901c2d714c217ffc56efc97b6140f3e41efefe1b0ed929a8b3a",
    "872ab65780167a82b25fd250fe5f8ae8c4c78065a94d01e6b61356431eac8c1909096924f22fd6d850d007678e3874f44ec6cec4a97d2738ef1b9d099ccd225f3c725d361da56ce38e06403d4d97a4cc",
    "85e8e4be7f6ab4e46abf3ba935d089975ec59c04f3c8f6bc21cea0f1f77f03fcb18e9c270f5cafe86fbc4f52595807903d8b96432c7d19655e1d83e9bf141e7ca40bb53743d2362fa50b439dd6653928",
    "94ea5ebcb306ebfd18517aac9b6044f2860c96d8aed00c861a8e6cd287645e28f2c325d1db3be8aac41f1076565883d2499a1f96314e960a309592b2f8468da538e52f64c528e77fe960b8bf01edbb06",
    "8ca71f928074cfdaedd094da5a42e1cd657e14b95931e1a40e8fed70b09079cf7d3c69f9bb9b8bdea9f36de64c4f5cef1be1272a92fb9437d4741f5df4a2ffcee1289b19d231bb007845960f20133299",
    "b172b324d9c1116a6f894619e189decc2e28248bc40da0e69c5402f8113252d34d4eff78c8c02cdd3a98ddb96103bc3d4a52094bbe9eb92545a45ab626c41f23fbb30e15fd9c189c9ae8111e9a37a029",
    "b98b5f1ece45157538489d2bfe0f8209bfb96b6e462134c733fb2ebecd19856de47fb9f8779984363fe2b0d80370dab74517cf694f0053ca82b91bdef354566f4d79e97f235a5d8e81df961805079128",
];

const TEST_HEADER: &[u8; 16] = b"some_app_context";

macro_rules! sign_verify_e2e_nominal {
    ($sign_fn:ident, $verify_fn:ident, $signature_test_vector:ident) => {
        let header = TEST_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        for i in 0..TEST_KEY_INFOS.len() {
            let (secret_key, public_key) =
                KeyPair::new(KEY_GEN_SEED, TEST_KEY_INFOS[i])
                    .map(|key_pair| {
                        (
                            key_pair.secret_key.to_bytes(),
                            key_pair.public_key.to_octets(),
                        )
                    })
                    .expect("key generation failed");

            let signature = $sign_fn(&BbsSignRequest {
                secret_key: &secret_key,
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
            })
            .expect("signature generation failed");

            let expected_signature = hex::decode($signature_test_vector[i])
                .expect("hex decoding failed");
            assert_eq!(signature.to_vec(), expected_signature);
            // println!("{:?},", hex::encode(signature));

            assert_eq!(
                $verify_fn(&BbsVerifyRequest {
                    public_key: &public_key,
                    header: Some(header),
                    messages: Some(messages),
                    signature: &signature,
                })
                .expect("error during signature verification"),
                true
            );
        }
    };
}

#[test]
fn sign_verify_e2e_nominal() {
    sign_verify_e2e_nominal!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        EXPECTED_SIGNATURES_SHAKE_256
    );

    sign_verify_e2e_nominal!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        EXPECTED_SIGNATURES_SHA_256
    );
}

// Expected shake256 proof fixtures using MockRng.
const EXPECTED_PROOFS_SHAKE256: [[&str; 6]; 7] = [
    ["b4c581ec0462274b9b2dce352da2331f2f141b5ddc8e899f1a9a02e582e6feb3cb0e7d72b58354a90fd24955794c653c9661d46e0670f4124543a6110500045a19fe4f14a0caa2db493001abeb99f8584a207aa7829ea25293910dddd09d42b75059d0f353f63abff88aebfd137a6fca4ed6bf17444d6643277a535d972870bf2e1df4d43d52bbceb87583bd44a5095d82aa0dd32a5b695b919128543a4d87d53a6fefebbe75ab4043c5a975e80c9e04fad0fbcb816e68a50742c1aa8e9f8f0d0e84fad8f3c1c6c38065c8b3d8d2b42c0626835eadf2edef0086618eeb08000a38ebe3bc246bdbee029d2009cc7cdf7095d3f56bceb5382fbded91bd05547e987283514c38183a0ea49b87c25c630786939545a67efc73cda5800fbc72f804292aa2afd5c1e8924e9a53eeaab24e8413049e8ee09629a71fc840bd358d9f1ea748a621d27981f8a7de8bb228fce0cb56e129dfed734bfd87886ae80bd7508bf031c616115d6ac5bac7112d85af71c47dd42f17d2d5c26a06eacb542e37f91cee", "a2e25d661278c829cef3656dbf9f1d10b9cc806bbed8c29ade45fb7c473dc203a612ad8108e9f56926fe94fe991204d7951d7c714d2b5996a47536a0369b85a583404acd7f65c3e8e1c94801b37a9007bf8f249d35dad3daa3e7302264a9c1bc5a8450ae19ede03ca648d8735bd96afd07c5be3ffecf7b6112044244ba3a6e6b6e303b330bbd0be1d21451c078a6388fdc3c119330b98c6963c66a20c5470488163067c1b295a9a727b02188110ded25b5f63627d97326be286ecf32edb8798f064e76c2ec87457dd3b645f94a5170e17888df03ec1ebe8e3f45877f49639ad75f7d4abae087a6188b8181f68d29f38718b735c8f3398b8fe8754fd7754241ef57853a314e5bdefa2c7783872a14ce2a99403ed3f874534c7dc172fec77d886b4c2b3c31d2df64a8209cd832ee1f34d68300a7bde8fc28eb95e19242ace971e70aefa3335c70751e12dac88108906ce65d415a4c44b535bc1f775ee4bd31f504", "960d66b403ec4ce71faa6b6f89b160c50291a3cd37d71c0f6841af8d1d067a765dbf9b9dbe0510faced69374f2b10c00a15ee1793a6f2b27880870081e6fac915e7468b0d8e9f2f4a3d0a1870d05eeafca5d956a0bbc09dac71c665ed034a86d13b856dd6df7ff6bebd9d32cb420e3da8b7f27e66eb3e6257b3104232ca269ba33e4be8a5b0f47c16b54f593c6f52a5abfa6e8908a505e692321871b0c21009343789f97dd0e54a2ad4cb18c21483641cf76f0f8e839dd7fe627213bf0e95a6f51b9012b8305cf3c0a5ee411ec10472bd27c85a376c01b344c1e3c452c6bfe4a1f95776046af61e32e13adba72f925f009e2d6749cac1309b46db90e78e321c55e5758100e0f4d2b5df436ea648df9fbb8aca812804f0d9a34faf2cbddef9f814eaf01acafde78b859fac927a5221286bce577e104da75458c01037eb02f1e9e", "a28be6795126d6354b6988a2dd9f06f13ed3aceffc76472d23fde1f650e026a57050016f81982961fcbd16801a7d9233a4b065fcb09db43b6772587d7ca03d63952578be2a6ea8d3c24667f0a421cd925bd593fa977fd159f5ba4a213cac54bd40b2cdcf4c9054e027f9f9b81dc8b948a63410250cba2e358cea137823e8a24e23da91236d84770c78828bf10d9307508f36ec60116845c52632017d86c26f2937196bbd7f75a60805d45f3be9435aa25be9e44aae8bbbe5b314c6668ad6b8b8324c21aca631384374d521dfefa4d6bfb1bfb888ffdf7c806465e39260a7c8815ae0bcc7f92d883de8b85c479535da15a85bb1c982168769e1e9fd1a4bb19e1618c66746e08bb90a20a1e1bb482c2b0b343eb274c7492237f818810b83cb3633", "8cd6c401ebb370ba702f295a1e10384b902e95003884a4304f72bcd5b0f248ca0e5524139f96502e86f50bd2871b30a8b6e250d7c795e1d83e4d2b615e895b65dc0fed9db83edd27f425756a074c0f194ab80e5789c09516f0c53ad44d0784386f24427a85c69d90efd2771a4c3037fc052ef8416069ba55877e459a5af7e2841447397d60313d2ae75a79ea3d86fc8b4a228b69cf8126a1c7ecd6b92cf4181b44196886cc120e397386beeb0d424151aa34ed31cf78f8a64c78c492d2f890d13957938b534cf4636afd2c394708534da2db2abc40fec15218446d8020b5e7cb49414911a7ee05111d57eef61111d619485da346bc484725d6f9005e7363b9c7", "8ca593ebd77c442a1f134b68712a313ac65fb53341952a19bdd028adac2cb92ef3a5b92c177d32defc1ceb0e3eb676ac889e76a2afaf46352d5459b7dccf7cc55dd18ce0331264370c84557b9c6b86ebacdc3c7eb44cda23af814224dd37c5981e5721368fd75b45313b3dc8d9418cc5194cb1854c7ef113c6a108d8721f08082e391d652b196a542b085e9b20e0eddd349dea14dbc48efd226edb758bfa0c04276ab79708e841c66c096691a334b1bf7cf21212b6e4705c5060a5ca24ed66a90d501f95265ebc0a76aeb213e49c81f5cdf6a86c01b55a38a0a06561a038f2a5"],
    ["92f1d3bc3380a037301c8f93f3b19d6fd434547f6196f24b9898999e8d7fde35293f6f15c6d7d9f614fbe0c77a88d5198de902fc7a34c19f6965915268f68d8e049df0ec6ae49140379714a24193b9e57856f45345f10023423a5a1f4f2639c337370d04bd8a1980ca9c326b684d8b067d67f5711ada36ee5bfdfbcc16c352b8127ca3b6a5b46816e4410d2e55e3825daa507a6bc337ed18afe126ecf317600b4fc99aa97e7cb85a19f2ae14b7640f763bb90e57f7a9e892f362270f683f26b950a9a01faecbe7f3fdf4e7ddda8547d5e7e7d70290ee57c5e729cbcc05f9bb8649eed204363236a962ad1311ba6338d66cd19783950a88a6bab561889bc1b3163a89f14266d807d29fe0d55660533e1c400b77fe123fc10d459214b9846b2cec06e6932f4f27de57c3d954df72a18669e563b21e0bae9685ef28d4ac1646a621498e08029ad1d8fed356324004fb0d2d1d8415d72ab5b47f6b4f5a2fb11bbf596ba3eb67bffa8c86b0b3af856942d9ab43bfc73cc6974d2b2f27da0108e809c2", "ae6c3d2c73c82b455973644547683f289a36b3038469089d2a1b8862a3d175dd27ad83a4231c52eed506d48a49149fa68168319a8483552634ee92f78dc95e17c9917a195005e7849b5ba5bbfde0fb5cb4874b4b438a6d86e7210ade909fe404709b47efe0307cafb04725ec09c2386306d77e1ab33fc808c44d924a17b3d863355ac8bcf7a2cd6652d5000be8d40f7b89f762344f1794c4673f0e3a6aea05ee103aa4977e7a08f3b1f3bf50e934e537e2a472174453a5b1348bc8e8110e863e036cd1d085c3b98a8e79a9e3dc218c236bd02660184b7d422b8820222c03d62a073dc76795d15987b2d64d13a66e0a76eb23fe39b38974d9d2fd9f8d6d1cffb86f791bea8f9559f9cf5ac74afb81756764e4f320697612bc3e28ac6b3657d7f717d5138b0a6289a84a02648b45a00bedf24091710430f412dc008222c759a39c3407dcc991fd5aa93b96a9c691ff869e806931ea45dec52bebbbaab80def4284", "91daaf10271cfe617ab3ba1449854d78163eccc83f19695f451b4e09d1e6cd4358adaa110eb36429e34d94482c039dd2ac4d621a431bbc269b2c242c1b6166c27019b3e1ef1339e31c0e0ce51038632c65858197215bfab7883319dc15173eec5a2fb7ed9ae81c4a29b70d2d6f8ffdf035f8e2aaead640c78003176e6327278f3afa1c8d23f152d79769d68cdcee2d6133b924a6384b4c186c579e183517d62f6156527950e12f7296a20390a2f694cb3e0227c5e36d2cb45060ae55420add1241c13b6258af38e30669cd3d85b1515d629a3c64a38ef5beb51cf7b6f8ab1c60389a2e4a0693a23265ce528d3e85aad59d8b4de5b1f7367f4d4f889e3a9991e6699cc882074051885798cb40a541ba3a0b642f5dfdac58a9f060bd26bf6fd14e0cd3373232d90f011987b1279098ac827b0360fc030aa1140b3cb04c6c67a08c", "91138948300e20cda267524e19ab32aabbea61375e3e67667313164204e011ecbb39af84354fc1a2ffc8fc937b8a6b438076f3dd76be9613831e74453a8e885540af2ec8133c40b76b10ecc6933d4b82d8743f125385f2066811324d5a91e6ea6b49395aa36f02f51c6dcf8694916fe0ab715f325cff243f5dcf94fc59456ee32c6bb16c07f56b0e110fef810bccf371155146b50385c6a1e17d6c53332b191936d6c56db4cf5343e06a635e41a0b218d80e464f6b73d167b6e26c5c37327ad352238633447ef790502925b7fe81d42461d036bc1a3c0abe509012210fdfed90368be206c79d2a6ff1167e7e2c943248fabde83dbcb6255c739411a074dd2c10729fa34a06c8b550e62ad45120dadb8e912f29fa3f1bc9613e3002854a2364f9", "afe18534f28d5b4e4c5154acdf26dae1e97491ff35bf34ae25f013db10588449aff436076d4f7981552d444c4c989aed97d338c1bbc0d0343d27dd261ce1a56eec3ffff8c49164feb2184595982cf8b009fc6de00a558485603a5789d5d937a21e5e3b38983ea4236a2a30336ebd323bd7039d7c16a3f0532390395a1b7495201b9946d1237743f7051f9592b6eb6fe0215aa16fd612f1cb038d948e5641ac5544780b6687f40347ffdb78f10d603be6f4d10a1d3d59f6bfce3786d2a7741f295a8ca127989d5c46b0a0cb713ae4505b3936b69ef67ed5fad221c80551fba1e423e13ab43cde3e2a478a6c84a24fc0b6fffe3e1e533108c101ce4bb4c288cff4", "983eae3c158341576f2239e22f413329c421ccf1c7ab02904373d8b6f013d431aea054a3d1a6ef8ccb8998f9fc1e5baf82a882f7cb953aa02199b915777213ea23dd13b6529325a6ae03e470645528ee2af2865625d81a7ca4a6727fed9799e06dc7f44009f4103bb1c07491f9d37c99b2607d1911668d3ea77dbdcbeb0795ea5d669c26167d6040e81e66aac3773c699c68d858887c051d5a98e540a535e72452e61ce586eeefb88a8899185d0950059329446464e1fcd337cacd791f258dc744ea0e9f419cbd1085c993f7f34424f615ae1dccefe7eca3180f8fad2e7a1621"],
    ["82b7c8d3516a73e1c6fda7e488702d1e7e25f05d791640712925be1de40503dee2a5d0ee31a0f2e556818ac5202cacd7b80d52a3eedb31f0330d34200456f3d91047545f7ec8f3ae1c5991e75f76e1d3af222adfa0b9024ba0fc6ff252de8db63c2b0d0f0c2d2b2a3b20d012b3803aa51ec3e09b1a9980e6df6eab10d7c586b413c1dbf9cf967ab29c0ace52318cf713a4e6539744b030291ee3394a61659bfb3beea319b1d1c8abd23af3ced031763374b6e1cb9e45726b7d1171631b9526d04c296a03175cacc79260fe9414f3ba1e052572e50db13700cabe0c92e88f5b10039062b087f43da51b801a3aa6b12c33bc75edc836d994401fa5f6a7732c84726e68e378f3c9e8dae3337acafec51ce3084e71d52d09db8446d13c591e709f304dda81d2362ed8b89f0413a518173bdfeb1d230ccfbbbb0ae8ff56015cf91160281c8039a10711cb997cfb04c73e38a9b6347df51b3edef675701c3d35d412d3210e766aa411485589f3ceef14f7b1e23815f3e42f6b113a547fcb9b61cf970e", "8cd40dc212e7fcf08692e414126ad9d817083a87e3503f3b96d912a93816d722f0f0f88e3345cc1a7ffdf9767f2a6000ab81ff3d9b9c1011430892d8250b6f687ad6ef4d9bb64049b023ca4fb6bea0547e10c4986c985dd9e5f6fa576176c55b13644dd155372392e06a95fc0d897b664acde62f744ea3a20267085c5e9c5dbe0fbc50fd4bacacbe6d4fb9a4e4974c455ec9a6fcdfab00c50578009252b0cd55231f882308c6d252c24c7c536c4722a6c6088017d0345f045b37e71e1ea1a76f27f2eddd4f2447330f162bf3960c106666c6b7696db88e69786b5350a6c517cd63bba2a2ac3fcfe08fafe843488d61530b37b58241e44ef59c9c3a82dde157d95148eee58ba8ca0c143e800b5e4fc785194323d1d13e4ce5a7b5f1b4241dd5ab31b71df6241e907e8c4fc35515a2115aa28e9b59978a941ecb2649fed469970d416226dfae5607902d17b7b65135287d6114c18987547bb40015e9b92b8fec0b", "8acefbe3a886bc6f1ec1b4f17b34057d54687d582dafc393c163d34123c4bac513bf4a9e5fe00795fd8111dd3aabeaf0b08fc5ae67be0500ff8619c39f0217641d9967c2aad28a33d1ab393921b82af87ece672db8bd8ecbb25127d0f7854d77200e128bd4ee99313e9f965510cac31cdf124add11b225d176c3d34de7e8708b547bde2f68ab298393d621538f66ffe8d46cd3e719f1151f5e3078f36d4c6d5e56f2ba1d6628bc4f5a9a2ad814b9978fafe6882ad71afe25d4eddb5eca2eb2346a072fc70503b9b1c0fbc061a965c7f79e0166d48f8d55a67e8781a3846f2c866c601e99c1adfb1ed3b8608da0396227808ed714d370da7aa70abbb42723b4984b658850c87e3783a2dc70627a50b0a9f212bfe22a00b96d3966fd66e5955a730b7e071354384ba062b1de92a5b4d00abcd81dd58284ea166c06509538f861fc", "9740ca7c8c2c74a11d9dc9c549e37c2f988e3f0568799fa4b039b51fda93eff0de9ed0b2b99ab0599cd6bd9c58dce04f85c66e0d11201d510606f5a5959aba19331e56221c0ada6655a0971c58e3e68735dcaf8579b8dc1aac160c9a2145dfbc037095675a6411aeb85a1c5cc66b4d43e799f6c6917b43de3f7ff5f4fa2752e22fcd0fef594c2ae9fda3de69dbfa0ec0b1da6467cf7cadb04f512b78273ccaa3217cb2d4cc83a72a64fda31c0ee05341003db8d7b59d35901f75131c2f0515db676361a3e033d65cbd952463b8e25e818be5cc46203a31ef4a9c5333c5a7a2505fe731c2490c32e4161d8086c2b870ffa7c7c1a0a714ac76bddee575077cbb9b31983933ee2ef952a02196c0547d8c5ff584b8da7d4c377364ab90800cb236dd", "99c531c7fed91e5c6e9f54f0b0bff276e9608b50d0d75dde1e4d433e11643c7e604a18d87ddebc659cc759ec4f607043acf6e131564842de190f5c9cc9d446b085c7dc80ddf9eb6a997184e0fb5936c784c3bcbcb3e1e379c58656d3aadc1ee203cc2664efb27e1d772ec2d1991dce0c9d4bf4af07db433e67f710dd585ac89e383694e85aa13c9f1926aab217c687ca7ac8385edeca6211b01a21680964322617168825f52e98965223f5649f2ead3da82f34fe14b6bb46e30e8587a926fbcf0dd504b62cd6d9fc40d4d636577270932cf7124555d80d785cc1ef23bd0684da6761bc6ec47b1f7a1cf8e7e35734cfb8035ee13c30c40736b869a6c73404784c", "816a24a8b3274cffb80981de3f3659607ae68abab5703118f6293ef7526e1a1a5b63b492eeafaeffa289590fb1f883eb8e9c25553bbdc38d8cf7f8425de415998751c6c2eaa5fba70722c3186b016ff8f5325befccc54d9a3a0f352e3483f16b1242a1bc7a563188820d1feb381796b9d86d2d32435ca125aa13cc977c99a3cc4e5b383794860fae903627d8be5ee567b5a422e023d27db4657ce567af3be3c965f248101989927ec46769f3777ec2d1bff0685958d3594c05cdf311f65b18d029080f0b6514bd8549da91845e58f97f6839508d5d794104eafb92569c5c9e9a"],
    ["a86f85b801c80442ec4adafa96a36c0e8d2edf1a2cabb9204cc1fcc897aac33199083c77db7b7e909df23855a0cc765a89cecb3ab7d160bb58b4067ee5f8d9ebe8cbaae26ea09ed3e02bbd69c072ca8d3c8c2427dddcd611aca8dced8bdd2268523f8f476737269897bcce404cc79629fb398e3cda668d57f28e371db129739b385fbf85edd8b3ad0590d37f0c949f489a2aae35e16be59f15f25438739c663b19374af028f0a4b50060d907e0a9985f70e582d5a34bb34b078b482d9a46f08439888a2e178a1a7aff6891ca8dad43c33b1f3ee924c358d4baeac6f8f931966c26e586edee3ff08343dd6bb4620126d8a0a6ca79150067f6601198d5b3f5fd0f5e250cdf00d8fbb70c053ef15e8fd52cf73ac9ddde6674e2b1c329541ce86c90307595d34e3b68a0f40ecfbc99efcea82b7496bdee1c8b87fbc6b4cc3e200853105bb2a144a22f3d3e2f0a8dfe549a61e977061720c269bbec14d3fb4126d9234dcd6c76aabfa930da1aed3999e25795887036e3bb524cbae4447250a5b40283", "b363c2b5fc7dcf44a245fa2c799370e959436a0c16ce279d668edeec8b88e32e62075c88c99ecba380d931339d9de6ac83fad6f8d6fd6d773d8b0c4d5f4bd1bc610ee0fd35abeb569b93860b38d2144bf738db2ae2e2049708f18d3aa0ab6c821831456a328058461544cab25b2faba848df8a53c1acae3c05986a85f3b199b16904f6f85a123727b637d5e54c1f0c617f218c5b1549383fcba81a09f270efeb6f49e3c4e4874dacb5e09b094f82ce6fa52d4756c4a2f108cfb83a18ed9a0f542a9a0774aed6f3b1d2bde2b109a07415ab38c1452bb0e106d87fc2fdc96d576d09cf9ae14bb8d457bbb98d3263323b01dffdf4e7195d666fc4e302db7ca0bf3435b65c14daa1156589a8067926027c536057b266d0067836747d64481706c9e43d25c54d97cfeef12152bbb36a982b93669068df536de3124d23b79390abd4c752a478a5602aceb1efcd50618501df9c3d918c12fad116e980cc5be9b54c4d27", "828421f1cc9a13d95528d28cf4dbea238c81f1dfc8bd6342090e8cd3309a1e65c9393a2db76adc757fb1213b54b3b30599f350fc7dad32e779d77aff6ede1a0be1553249155b0ff838d5730ace68c8e13bf24f59312246299907618b934802cf16489eef70b31fa2a84c2165d091cd668e53b08fe826672afbe4c7a129409b31097b9476bb71ee8fcfc3c87866232ba150d5f63ca5f8912cd3f43f54b642807151a84b82f1887013a130fb8ff009c8cfc1812f7108599352625d9427415bffe462d6b1471642055086d3ee513353735500acda414dbbc4f78a4df9630e79dddb18d73de3faeee47e37d7f5081cadfc2fda133d92c43b9f0172d9e58f6a8a5789238d40a3f1a49ec6b11253ca9bf858b222bd3edadbc20bd3d7c7d3baf7ed048d6633642c348686df91deb233ed46b4e3c30dac8b784ba1aafeb0520da6dcbbd0", "b2c30aa04ff5b46a8b819a17fca4582f7c43381703d41c90bc20b2adb2cc34e60bbda5005c8aa6ff6fd3ba542f25851984421c5cf49df47859b8f759ce16199bf7bac97a07791302b7bf43365918015b10c7b4e41b34d42f6b188d5bce5361d263e0d4d2bed542e60724f2d44b483b9f27995244c0504f6ef1ac5ab944d85df4199f7639e45a7de39ae1f1b48eb5fa5725e12d4b89341283fe143d7acd3a1a1e4928546a519b385539bf84bfa0a200039b87cd27599afaea0338aee126d3c26422de6af7cb34443e68aaa50c9b4a781f487f1883cde1059e138df3c7b6c37eb6123b4d723c32c75b9d6470565b5010d2af003f3cd39a86acbbc90b825a8116e82a6015b7bc957a6972a39b173ac7fbd6891041b2ce8d8e754ee7ceeba79f339a", "a1ac9257bc54848b90580992ec16a7f4df0866637344fb5ae5be88a347401d6a8ef78e17ef08c4922688fcba28c309baa989a594f7f80302f8f5197ec41eccc96c44c50b34e18235a8228dcded5c68184c605c0eed395cf7b17e89d11dabdfd563536583219efc629abeadcd82e623e582a2f20b4b16c5c49f732bafba0097f7419f98df30654ca7622bbca207fbdfaba7fd33e16a455ba32262403dfbe9c52515dbecbe7875326ef39c3576b0d21cd893099549c5204dfc169081bc0ca4c79749166f285d30c75f50ad2515eae48534ceebf68de52f37acd3c3bfe53c5b00c3298a2c0d6e628004affc1fdad67a9d793f53a019c8236eaf0bfb3b4fb14f6b71", "9575d564b89435a78156e4cf1291cd8e7e3dfe340cce73b054782b2527bc7df49e59096f770e45f45f647e754ce7394db666e470c689b1df9dc35eb6da58cad14cc3feb756d9fc4c05104fc6a968615f41671f4963f68c135ef80e0fa917aeda3d10f6a65c282f52482c7b88b88fad39507d75766c57b2ed2ad0e2eacf89b024655d4eba81d8623e4087d9fd5d32bc497c70d45f85c3a40d463e752e0f6a0b2902306f96558631932753d144b8a541b8614e36a7792019aee076c01c679009271614c5b11f53cfecbd954d76bb423d9b3f7da1cf8925d931d2dcb69504644859"],
    ["95a9b27e7050dde3b133dbf6c1cf6e9b52205da38a545989e004195bfc3d81628651e8eb8d081a616dc01120f1a5d5ac8c941d34c461a16bc9bd5e25f3b19008b6dfcd8feb1ec0749709287e487972a9e1024750e33290b81fa11c86b135db3b12506cd37be2a93cc11a654e683749ccbab21fcf8d20f10b45ec38726c5119b16fcb0a30b97410d06ebe7c565bbfb0e5b047a25df03ba02d0dd3b591df8d816b59d6877fe98aeccdbe48ed4dd22a908a2784d0cdc60b0104c998600b4bf80fc754626fe5dbb8fa3195d982bd5e4e6f104acc14ba8a5141d4ed46b0a0c5367cf21c49e2ff8ac007f1922694b9ffc8b5ddbfd5d804183530773c95f4cadab57fc2692e83327fc666c5364e4bee0f7d01cedaa4e299cc901c406efd99458fa00dfe7203f612edcbaa390bdfbc5519d24193e571ae5ae2d9c6376dc5a78aa8141dcf080619b720cba44d3d19014c7f374b108179bb328a367ea3214f648c1f6e285d2fe819b41ca961ced6bcaea42e19c5ad960250aebd5d9d111aec32999171717e", "acbfc4fc15756a18a841d5d4999c87790808ea92767e94bcf4d0772b824920f51218f427b5253eaa85b96d237da755abb15c3a6f3a3af44af78cf489695aa86636a2a2df65cc7991859bd0aea2b922befd3df2f9087edc9e7ad6c3d128c51a2f41bd86ccf7b21cd6e272bcfac24e1cd15c879030991a9513e1fb395e0b114db850d6b013781f87096f4fae84b993341a71a0f9b6f116004afa940cc68b7f3b504ef20a5c82be0571e34e9d7113bba6d6f4366f45bbbc28f14e3259c85f3bbc3958ccb10a658c9595758ca2092daed480c76a2057be37ad63bf65ee7c09c3411518ead95770a5a926d3bf32d8d916b4f8a6f09ad9b4abddf8396ef2995aa1a7a958a26264175c6eb5fa70c221ebfeb7e611ba774ba4a62bcc9a00b49fdae50cb930e98018c89bfe37f8b688fa01524f45107fe03767344fdc55ce4c8eba9ddf81458722c0fada91a5d88a977c9c2f316cbbc762f7f2869a624b5bce97cfe7c171", "9252ed8409840788f22d214e25724a12a5eaf2a797f2547fc5e582b729db7d784091e27796522106f3bcb2b41c664ce2ab50638d7bcd45e1da61104ae7ad1a054cc0df0db25d8af1a8571827fad4078654af4a309ba71ca3f85829ab44d1a9a5316b83c3a9df78a5d1000b9bc7baef7aca88d578f708485218a6ba7ad5e045051dfaf3961285e71a1c9ef09e38d854185f66385364e85861eb7452e40c33af4e6be46b51c33582d8015764bf85145bd752f952ec6a78306bddba8d2a60004cef374d21d081030bb90d3f70957e1c781173430064b58ba67a0a45816b843cc89f385adc06077bedc749e1d24849d9c3d5be23b5d4e83294ab16db00904d677b7a46d014f13b85649c0e17a3449f6b35ffdb99c4036ede5727b98a3f07a29c3e786021373d3b7c7b2899811bdc26a7211d08fb4e7faacb1a46f64bd54e38ba6a64", "94a9df24997f3512ca54b9eebd179b23d34c77a7d8c0ac2f5352216d6b366099d292fa781ef62f108b0f669edb7efcd2895ce03b24d715e316cbd1c70466473d6b6069233edb7fb06d76f2b6ae980b30938af6a45ce52577b0d2bd03b337bb8f212449bd74f00a79abd4ba682aa1e3a008ba7289c7b96e27447014997072429628c5fa834a02fc1140019c8cc60a6fad282e0bc04c3efdfe240239c9e6ea9922302c84ef685394266d44a802b3de15c2aa3daf852f40d30f1f57df42f8a6953327e9bd3abd11656e33d48c32c3a373fb5ec1fb8f375a3c1a56a31eb0931c635d33b3fabb7240e162a941091c64f64ece83d62a1cb8d51fa305e65a7cce3f3b6839e6608cd488c16e3b4eaefc248cb8ef7be83d158c1f72405894ceb2a9e56916", "a85a7f14a665d34efc650342f440359549ad602dd329932a526999830b53f307ed0c59f1103ab6c4510ced67aec48dbb83f6eb9c9afe4ea9a4004399ec374da88d32c7a8957f52fe7df44d6340812e5b0f71612f80601bf1858080493524c9a36e47cd320f08b1407d59010442c50737262496a3c446864ac005fa53dbc8aee85c45fdf541aa042d1b9c58768609a5ec69a3bdd9aba50119342fb5fb7fbcc27e4eea25f7e455230108de0404a2ca811bf51936b0cefb7eeec3f904d688f538f54dbe37b50e253fe2e3ba36e00f450d88277f853f84f0d3c6d16f3e3da7ca1526156731123af78619d1a354245568ee8b54556f3f4d8c073565d2463e733e532c", "b75ad1490e376b0e1ac036b715be758d0bf9b70056213868c718d2be8ce0d8547cda1636a6b8ac5abe94c9caf3b5e184b0cf4f3f9b431e0160f1b72b33d03a92437f1849c2784f175e9c918f0956192800f932211519790ea965b3cba419d94d5dd63f1522a82f9d25067b87a73944e0ee1ca740fed361d0b7fb3b1febc1cdf807b17367848f5db473ca7851d648b8d5c3dbf25d439a6797f1772e5a9694197a25545c762f8ce717641e99e1d3b1ae23a194682401815328f6c49a3ef782e1dd45cceed56d0c2b03636145b80f70364d0119cf73ad71d94cc6bd7edb648058de"],
    ["a24a8485bf704fcf1be4395c97438ac1264c22f62c0458c47c3211877800b8358c1fd4e6f48b4e6662ec636e97727d528f7bea33dbdb866d20508bce4c15c0a20c6a994189323c4072e0cef5e6f1b055625628a4a3c9ab91db3e5bf1d540e8d03c5c2120da11b35d374a4b32c4f59765fa9f1f2a507001e05ab81d53c85e61ee265a06878ee75af5eecca54965967edd94079f500261c4b2fb1d514d58c6f59a20aa731c57e99efcb607bb809615a65bd5496ad5a3f7edf5d054141569461cb5577c13ff76c8db4bf48d72f3d6f1e0beb6693b0f11faa9c349968604548e1ca35060890dad9755d15cc51a591d16a0a2f834f9e0ec9109de0c17c8a2d2e17edf174d429d7b953229e09bcd3afc8c54f9011bc087da9b50a31966be88d325103759e05380c17a74c4374ca1e5921fd40f142d6cad5f5a34e0c109506c4eb4544b2ac7630b5e38d6eea71208196fe90f38aca0709abf81f19291c7cf615eb5b713168fef4d70757d608659bdf6a1fb998cda376703bf476e125c264411a024e8c4", "8117a38f6cdd1474459323f6da0b1cff558728f03c49c444b080dbc755e71ff19aa7f38394970b03b00983c989c257e78380bfa959bd28aa159e74fc23f62fc96847c52f5d869718c834faf7592ffff7c003881186344519666af06f29b0a2cd2f7397f6ec7ed15b82ee44f250dc9b90711e8c1c9e455987967ff82e004f5a0a374aed47d9b35e646b865ce62a83a0e35bad8ec072c3f3dbad4335a287e0ddb66a5ed6f3e021467287f4534f7b81df5874bbbe3e2760c158e39a6e6e435df32212bfa1b8d87487a1ed34069e0e2526eabb874f55769deaa34d9da2e71ce6be7a515709e265ed7e36cd2144ec9c42e8f083dc3b9a1ecb959a0b528470f4b433406282e832ac190d61d823e40343cfecc84c5f68fdfab83e0755d0fdcce47c68953aeba24ef8c2f07e522b4b3b7c6f012c7b3282f0ab4d1afd91a1f5f2440da2c65c242a7b4743cfcf463b9b9fa7c0a040dbd6896938f3a823972b3052ec81741e", "84f69294984fd6fe9119a3e8ddefc2cca05dcef9aa8c243263d1bc34781155fcb872b4595686cf5c8c279bdcde99b04bb9bcd6a40a1c3cda0c7b69c11c19d5c5fbb3c989c7e685ce00c06900e8ce333bdf79640dc149c9264a44ecf2d4953ae13d8dfe712222e724c3130095aa295f5c7abbe9ae620f15d3dcf28402b4af5ec4487d4052a6a5562cfc4ccfd16ec47d8755137501090b8cb36d0cee87b70d96da1c8845d6002c724e6682102d84cd8b918defad8447b617e356f9c4b858862e0264a467d53f50f80b2f2f227b83d9d7ee76697df24816933892443a9387c644d5664f21d015056266a6786db62dbea4ce49c9de20dce9844ce0c3049834e5b7494c9eb1eceb177cc5de8b4927e89c75078c158c12cbc68dcd4cc8a9716c49c19c494ce58c2e632bc916245f2e886282b89a69c5f3d783dc59256b01780de87263", "a4666a9efc0d0c916f3f2372387f0cbb90f07e81767e80c9155bf5236091d1640b8361bdd728f2302716b37b5d3178d299c17d4710cbb6bc00e6f23489589ef327284d65faa014205b5f5c400a3688dfbb221c53f515a50c3f49ad09e600811a423489879a413f852588cf53b4f20bcd9e8992ca21d6c69831df8dcf3711046a737c5865bcc1c5f7a54328b54628b139b1fe28cc37c04e45a92ef84e1df7dc3f1c0f3dcdbb1fadb10f16c275b12e782d6d2572a98c6fcd1b7cf49378122c6e680cb54e42716efa64c0def2e14e2280e0de2044710a8c39f3687b3223a0f2727d52f2ca5e1d78951baab34abacbe69785c39faf5b3fa752807019e331911f91c159bace809e952d8af05f733e571f908cd63c0e8557cab1147adeb9f5977ee727", "894c0817511f3077f2907ee6f5bf188e15f1fe988446c15b74b61ab0172d5c25259555757b851ddcedf2ffbc810b5e1e8ddd70f42e8f0ffd3f5bff06fabe9bb290580fb93541a2cb37ee67feb18f4bb9c6f9e4ebe4d30058754b0842152b9708320e9cabc81394e288ef80325b35baf69d4f450e8080c108bd0d5916fcb6c5e2271e42a4339af2e1b494e0f4bc501f3bd2a6973704fdbb4cad4564c966c2f07200205fc75977a21e2a241057eb584c0700bce02e7fb152b5f3738c4e8a0730b50d2ab454c617cb4da1b9496e9c7169ef6d5973cf247a4f2dfa92f5d5984d897633ee9354b70d38ab9cbc70906af02bbb290a7681fea3da14d028e6c784c7f3a2", "b1c014e3e4e034299c619b293f9a7a7dd0a81087cb11984c7dd4e6050794bf4e35efb65b8b5e1e11e31d9caa108366b7a375e10cc33f7edb406c6a9150a8616a254b08a694285e4097ff5f597a89066b811e20304fcbc26576073990eda40b8c4a9ca4b6b5adc53308ab274f97b9b1010f374400bac7281394f68409ee8edf7d070a2e6655d26a90161429603e5c80677ee5da8f08bed5236f86c7db8dd7e3e52675d2675cdd253b551d74994c945398b93012492155ec60a97927c7e2764aab194fbff166d4f5bb130865abdfe2119f20626ec61c9b066095b886a480da919a"],
    ["8fb3305a707d9e71029b2e632f3a56a1e942aa95c08eba0124a4af21a0c2324ad8ee51c839088e8e24e52ef7fcf804b6808bf70439b0f21c4826018c2e4d4a307799d7b05de819532633392fd30c7f840c611acf047f5a5f375ef43ff3fa4e844051444c7ad6cad5eb4c645325548a422e91001fdacd918319e37f37e9e79942372db40583087980998b23955a2361352eb68ed75d70b5f0aaf7ac45fc0ab7a75e9319c1f0bd3db4bb3d1edd6f56636b274feaf097c1b4e27ae5b2535da7e69a147ee5be0dba879840a0ac5c495481412e5e5b1f186eea0a3fab663fc3f7d89d4208417d3b9111c1e2596ad315e588629e7b61ded69f29638b4d617571b0f0fa35adaa3e671f168c46f0f3580875254b6e34507b2cc91cabfa1272c1894050377292571c6c34e14ae5ca3f8c242e5d6c5faa2480b07a182a0723f138f00b169972ca4af743e2e64debf9630b49416be8faab6fc0225e42eb879cb306ac70b03c3d8cd48252b9eac95c13ea989186596fd806c76357d8d9738e50acbc1a2822b0", "95f6319d884f4677ed3d0a2baa6fa4452e71942b8bd72596932e31f3ac8a0164073fef516ddc3199adc61594a2a0555fb3273607fed770ec124e17c27c5d79feb93eebaf7c3a0c9e8b35c01fa5a344adb98d379ac9c32a166cccce5b3a4cd8b84280e0e0752cbbbcb4295dc22c1cfc3314161a5633f9b178e0777bae4dfdebc35faac5c998b53fed2036a3cb5b2e4311fbb7c52cb39a7e8018f0d122811f76b2633f313f5292adc977c2f558390bf17741ab8ee3fe18a6d46d7a2beb9d58f2fb0b8d181a28312b14bdf660945156a542719882503a0e730d26fc789eaa51143f2c2c5b9a931d41363a22eea66127ad39764c692b89f7b9974d2d92c28edd631821077eb7541bd29c33d5e9195c4261c0dbd61f440c6591558a2de1094cc104b01413da9d21bfc2992f0ee33a0d2a2670c82ceb902a90c3057e084315b9096b11612d17b22f25a1c453f70c561be9706cd0ff6b929e52274c4a319ee5ffcfda8e", "96aadd67218ab67eca46d5a4542b39aadd97fb6b9313490b6752308a51a3a7ca1fc1cfe36fd54efe0164a6c4cdda7e81b7a8951fe37041244ca76e17ef519b936c879032cfb317bcb27bfdc1a20b8c37699a213f632db220efcbae6c898eee1f2ea4b6f25a0e74fbe02579c3b321ae0beefa12f57d1bc11fa93b9aa4eac18a801443936e224e7e8e2022bd84ceebba5d6aa8818bac0d7e1c02ad2eebc8590c2f1abe0123608a46b1e0595719a5dfd7baed99d70902613a7e1c1cf9f81959575367aec082404329ac5a14bc1688fb439dfe1133ffd38674bcddafd5a2522d884e42bc7b3a890ce571d132ac84a66f64bcea55eed4dc0f3f2917cb2bdb0250114b1fef6eaf9f6515ae3c4f69cb51044ba9d4795cc1b3b2164c415609bf0ec26473718fd827ed31f541f98ae3ad9b3d6ff650860f33fdbf0e8627881640609164be", "b1c122d24573e692eed8f83a2361116d1127559042507ebcf1bff34e2460c212dd48df0427b01103f6ca6de1297b6c10828f509dd59a11fb1ac6548016ce2f997eb083fcfe999b705ccb423488beb82fbe4be59a1d77c3877ffc3eb0efe8ebf2542d064fc78bb632da41885619ae6c7f328730457d1310e34e9f0e3898900c134378e626108426de69175098a2d6e8a3daaa19bc1d34451ecad5a9ced8e8ad61243a0f5ef4afe5a1fac54cf4ada127f851179e42f229a0f62d6e55ed93c1b9e44ac29bbea5e06286829dd64b0a55046d8556791504fa8e4e0009178dadc30110334a65039a024438c957579a348c7541b97e939c29225185847e866983ee3aae05b10a367759cc94e51ab9fa10977124d4efc376226c9500e4a87ac4c4266197", "b50ea7a5d31ef2e649e3afb748bf04ba78ee69d37a6ad04cade9e9a345aa2158482f21857cf5f502c948e81319fb533a8768c9c9feb30a3c3c02183021e82b32bcd0e288d12ab158af81cadf556cda366cd233a433b1489c7c3cde65f8e0c8d84df12a82ee177c6a948b718ec668f5714732fd2827483b8fdbe43dfa9d1250f14600e34525ca0b1af0ead0dddfc40a7284a5bad5392593551b214d77c8deab09724fe2663240ac22850b25fe6a719b6bb82bc4c7f3badbf982a7dee9b2c4e06c389e7edf5ef45a403b140f2e1ea09f8edfc0870c4415ea215abeb8f8fc98786d50fbd93f6a5ef777578cc8305d39f2c7de3cfd8dd9f5f8851e4e60e46b40d2a0", "884dde8b042b865404599cded5fd0fc41fc1aef97ba9673937732b7597f0e1ca7b509cf90554b58eacf3c3eb57687b6ba94500d4d723f75d6f0662a172255a9dbd9b8ed876dd40888bf509419634a33a11eea714f206fdc5b667047230f1d07532169b4db04370921acc3b9c2df651593b479aeeba7fb9f84a8923c953dfc6e0310b7d806ec0003702a46e716b2df0f656b0644c20bbf8da7662fc917a1331756de662443ae885ada897ae1830d0815a62105467d6245d6ee9881328fe3f81d723b27b4f1377e9f557faa981fcb8ce8818ed01638e1246e33a409550d423ef1e"],
];

// Expected sha256 proof fixtures using MockRng.
const EXPECTED_PROOFS_SHA256: [[&str; 6]; 7] = [
    ["8fe53b0a69f3c24ff19493126ec7d140b26022564a2904a22dba75c019877c7ed15c712961e1d6b4d699aca0005d0844955475bc7aa323cfa77802ddc31264e69dc2acf817204341b81c29c971c1ce8f3dc841583eb4321e47704e9e6702d957010701d3b503ad622511cac50868f324e1e9e7d89fb2b5d194ef7e3667d509d0137f8276815183f9b6febb1a75d454dba95b969da453c24e31ced6e7aa46de5c04d20e195399293ad888564d04f3a7f41ef1e3d731efd81835ece0ec7f03247017116d1ca44230d5b6324d81a2f752c8d03d254269b253e408f75f7993a398a72b9f9e4d0aa94ffffffc7da3c5be4cb9e3931bf21915e6e5550ff9130c7fdc7643685c7c09ac2546e1593864403b4655c9db4bd6047f510476cb58dafc4d97776a0bb68ff8450562cb2874e5ea4a3948caed8140334c5ff43f144724646d97fe00071e58ba86384685c149a4dbc115858cd12948931d5c696ac3cd091f23dd2e35c6cc9972368e5cf799e17b322e74df099c6c1075bff9d7cc967a8339c1b10b", "96476845ab27768b743906d8aa5209218740e35eb71c7b7c18b734e171b922de1fd01e0f51c63514828ef391dc0d15ddb11dd77b6c5050294f04da5cd0a92e059298f0ef42759c24b0bd76c23ed10d55ebbf750c021214e0309552b75aab367250d0b5e82f7677e34e46f1a834a5edc1273e2768088ff2684b5e2ae5e4c9e4454d085e2239a97baf4dd7136ea9d1a316d1afe9300b714817083cfc3844e458e115e64e5795f7b9c9c6bd967f5ed749b31b82372951bbb776e1087af02d691b1d2cba2731e6e64ded0800c5b16278f83a6dc33ca10c1b281af83caf0af7e347af3aa8816dabbb21769f4e75288201e7725672e6f2172f61320bd6dbc5684fd76a050cf6fe07ed60a34c631851aa88fc27dc70ba77eb2ace827ce52d813c1e898d60efd880e33a72a2d28189a2449ada02b88a4b59d4eb8fb103f51ce14dac36f0331626c2be4d9c17707d703be70388406d34b698821e178ea3249afb96a66f4f", "ae2ee62473f08962006e6151d2df2357623f6c8b9f56c72c9f9d6441436ff85be4c1fe10442e0ca27e50a2a63734da988bf85bdcc84e52fdff5e1a7c4f262d1f151a71bc53b005a9d98cf81a68790f4bdce35fac04a1ef0b8cb15723666bace13290a8f3fd5e2cb548303ed2b3f9a498dccd0a69992df196be14e7888b0a2973205eb76f7727130551e0e43989994bdb2f1172ee01cf719cfc9d8e2300019ade4d90af012f1b2739ff81d2fbbc348425dca880872160fede9d56b8a49569dd2d5dd5b172e10da85ed149e8ecb4615a7647e6ecf989c2b061951fb2e88b043ed45ce98537b21d21529f1fe57e16afb2b8a91b383aae22616364c831c03eb398134e21153342068a5812bac3b283deabbd8dc4dc36313a7a2acc4ef8752f27f8774c5c56cc474343f3d671d3b30250b1df06f2ab340c62952b698e5f6d10ef4950", "906570ffb313be5db481f8627c6d75a9391e0858838c3bcfda09de5b86c85ad8f77ab5351a406d8f50f9b7103d241b1dacf000fd8eac9579aa5dbd732701743de22b40d261f8049af96fe8bc0ee1e53d6b65b8c170ed5bcbc575134f8f3a0a4b4dfd8ed441d8248b59884e8c61dc3253f6cc8d7eed46405c000b1ec9edc390690530f715b20bb6caee535f067c0c00847e952ec454ff8796f1d2b0970f71c8d53b7265b846bf87d95df44503c18077e45462262eab37f07617e4cd252b4788635c81d3be4acfabd7c9e4fe40c36853f780b4d6363cc9b92e451c985a132b1d3b3366761cf719bc29d2794dd6897feb4c11d6c9c65b306fe59f384cda7ac315ca2291305f0251cf4f686f825e06a24b96565bc59defb4aa84b84b3c77eb8ac237", "a9aee8bce8422bb965087e34b966ddb2cc2587ec60a3271769284cd4212ad8a8387b273d7b39e632f03a6231ad3a7051affa0c7821f815e3711ece4b93321972b145e7909aa074220b2d55ca0943d933d3a4bd762bffc2bf69cb171b9cd8da6c4e1d5dea70faa328be03679e3b806f60d4493c6e1f6b1fa44f6483486d1feadb2eb328342c5e503f24f8a9bad31b79df65b45463e0da6b5449486dc28edc894b0464e3abaa649321d67fb159f0eda27cbf7d25b2bc2074e890f4fa110df9518e6d49703c7c2feafd4217725175a788dcc70bd66d7698fef5aeb6425312378f713ef017dca98f9d6e578dc362296aaca58725ab6d26709cfffc05d5891dedab6d", "8c264e8ec8ab45ab0b6102db6f7127052054ec59b15eaf240c5defdc5b888af45e45d1c9d580bc90e9df2b846303d32bb8664eebcfb3cc3500632194759490ea0842005b5ab4be0f3bfc5237bbef231710773f2519ddbe3e685bd2316245bfd244c02ff1cf351eff3567ebe594006a0cd50ac881aa2de9849b06fcd51300f19f3835102f67a77f4b6cb1310487ea4ebd3e91b3740aa12107675fbaf253cd919b3fe537bde6735a4dfb24f1e3eda1b45100abe6dc047c85c7a7e6620f1861f73456334af23e4255010f469351d1793b944587db6b593058e289b8f83e853125c0"],
    ["b5a3e2ffb3ba6eb20c3e2fc1fa505b48632eda99b9e890b3c6725fb08ee5927d2f6d0f3916118ebf100157443a5bd927a855ac3f45e46c497310ebb740a46e2b92b9a4f30bbcfa80cd6e9f626db80b32ab98efe288db85935bf1ab8ba14b4d346f59842c2d43d9bc3d972d36a25a286c812248d59bb811b26f943063605a08a756ad3ac87caccb81545ba64d88fb68703e4fa3636a230b5534766d50a1da758330277dd7a7bdd24ee55534637b7c30122aa8d170c0ec537dbde9b21572afaaf441815c3c6d099e5f176fe0deb8ed338c4d66eaab7c9002dbb80d68fa433066c268a41176d4d3e06bc3a2b50fe87445e121e9e50b602ca13e2739265150695b746c7decc78064f915c263e55fa3230529bdfb57a4a1c8ff23db0b2b345f1a7f55608dbb3bd53794dae4e8c8943e96146bc5f2aa0835c3981616b044787bba656943ef4346b6b90f0a1c88865d2f32f95319847f89c2cf0698ea61d5beeb6bcb47119e1c07d17e1a3b52db3e1bde711db9bfea9c57844ecba42b0d996a9c138149", "8767c69576fb6c1219554becfadb969bbf53843d3bd73168fc776faae439a811585a136a5f73ef0a342b16314270f011834afe561dc37ddc1d21ee0e0ad32bb3ddd75a525ec7aac42f2edd7c6ceb3bc98d563e17f8e17a7f0fe2ce50ddf50d2c660872e395b4ea7eba23e62544a882593e6a87611dc579e2b27a047327af95341cb7727e75e873eac6b5f3d4d829e4434c786bf92cea4f76ceebeb389340dc085c3043a7ea82c8bf33abb4602026051bcbd450d3d2090baf5c139d5e1f2006ef6c130b36cef24c9a3e7002f0ee45baac30339e2c88a4132a42102ffd0f978744532cff4be88097f8b912dd80e52c1465f82e8abaac9223c12bd359062a0c72320aa76fcf94abc6b75afdb3cd48f195232e5f5b0f58e94facf04d5aa15fe2d3034089c017fb59a76bcd6b5baa5cb0ad331407a7cab6dd3cfb2b2ca9074cb5e54b12e4eff5dff60643b0cac24eb2dd55ff43e191f6f42b8d47cccfc54b2272631e", "9458d0703e4ce7a107399fe1b92d206a13d3323e4af966974eadd5d6f8d66bed666688f9889bbc84e4724a66ec7dfa1c8711457216f1df67bfa3d932f398930b5c8345928f89674108b9ce5833bb33b8b8a68e11dd1851fa906a9583a31f34076cfb931b570d59da1ba02a8f77c0c0e783afc86678641a8d0218df2847a0ff3251abd77b4d52fc7d00b376f0d36b438cd84ee321438146d1b0f936723f3d7a0c69e2a7adfb94a1714994bdeeb197801fcb496791a23ca614651a36d3fc1bbc484d51afe6fd2e34029c81f49e0eeaadb261ad1f73165b2fa134ac5a2c7b399b8c3b500cdc121f797d5cf04af6245d48d099725cfceef818feab81320d15d65c3b59d5306979dee36aa026e17c287c77c27c2b39047f3a3b2f03a86355e27d41ec5c35201c0d8e69b5b5521e3c4addf524bd37e18bdbdf35de09a46a8d301b51d8", "87a250d7e056efbf6d88eabece49490c5865861fc8c23bb696c8a5a672700b526f5eb349b9a1309e63d5d06d16dd05aa9510c41b04c458ccba996a865378b9bd65fc2fd1faac56c61dd5003e2b3fc57853fc325aee8352621fc53810c535b6ba2706d05531739e88a2a9f7238c4e1b8af94e66a42a82430ceca74ac2d83a7c50595aa26f6896aa7cc2b6302084a1148e0bcad6584dd00ed0aebf4d32edcfa3b32883b06303aa7c1d0108a44c82ac4292e920ef976bca6eeb4d826a0a725883a24bdf63dd11e0a0498cbba62a4e88ea7cf059cf183e5582b41529d7519d84719150f53672b7eaebd19159bd3db253bf9744184c187943fc8565d881399a973a892a203a3925481f5acbd395041e0a25f2d9987d067781f6ec061ade98a8c0a9bd", "938a8293410b5892105d140ec4c23c6595a55ee1c83c44c4131b12874b8f52ab98ee8e1a4d02b66fe334bc1765c1edc59793787bcfcb0649d21d38da2aa0b71a6ce1acf38e161038fb1b9b20f32f70316b7a9c40fd853fda36b4a7ad1a1e22bf3374014f5c7d03930ee9edd2f1eaf0450e06e7dfad4a2e45bd8d9bb23690946f73c999e10b140e0f82ada1c5c25efff4c13315fa6947b230d49f1fb00b1531342bd779b6f74a7a9a2fb1782dec323f67ed589cb4df040b71c2a29ffc730d512e2ff85e75cca7e3015ccea2dc4fc5012eb49a38de6f6a4b53971147ad882c312b2721683515beb7cd400c1118d2315d6463c3754bf3c5a784caca33d9a0d4eb28", "ad1e7100dd5d68f2a7fd00cf4b6dda5cc75379fd629e43c6c05ad6c1bddb09df66fdb2692bf08bd586a08dd7cf15ac338b8339d780ec0321b4729185dcf96452794ce187512e64200308eafbb5b6770e41ee08efb346e8427ea06e4d5f8a4c52673f50136a94eb37b4b520f2f81213cbe51273f2528fe61b064d6df59847462622e846c3bd6c05f280a52d649ba3b990e179cd3ac3cdfcc3d232f325b5b13ba73fab73da2f5f3e23070ef948af27acbfb145acfea4ad935b7a02086d764a79f56c7a15d0b463a5a93b2f35fccbe70110bd39e39b0b24e3002a89849a650d5e5b"],
    ["af44e89646bb646208d200d8e85a18bb198eca10726c08cd082960b97b6794ca51bc393442d3c40efe55de84747233f6a131580743996f37ab8d77d455e8be686551f4002cdd8fd5f4e8604f0615a1c2a2df6996d075156a21c5ee6880d2d4b820cc3ae12eb8962ff932ae18e85da289b8c20ce3046c8be1b9a49b954f0d3e6b30f6c91417fcb3cc1c5b3a6a579ffffa627716d553167b26c3a1d17d2180778a6a55c1aa91c44e10940b48ce748bbfffd219fae8484c153b2417e0fab729a84845c9576caf3486b7c4d3877230b1d443253d0c570e0658465195e31f626c5b60551916d127cba3b3409222c5613dcc58474ef551fda9d0ce37a6d2788958d1c14d3206d45ba39118b4cf25ddfc5c86af80c561ccb1f153fd95b13958c9828b494645a31689e2ba7827c684c384ee5367fa878d3beed71acf6c5391819c9d36a20442ebcf4c796cb1c6255f0fbd2044965bdb34c3af9aae67db1349ff68d77f4e3551f238ef9ef01b410f1c39ce786aaa2f94233c0a3e42422274f97c36f1d2ac", "aed213302ee73dc0c9a8d125688de9014f0bcb6394c2d1045f1aa3dc5f3fab5438d85b0fc1e3d4d7351216cacf1c0c178bb7130659a5ffba9eff75263a044da77563cf9312b7a07cb53f9ae035fc08d6a3a907d44f1203315dd3af1082ea7fb60fe47c707852119a934c735412515b178300b00238a7821dde6ffaa1a5b412a506ad742029e40527bdff4cd5077231f9499e3260432d92d1865d4554985768396b7296af4ff310471fe7ade75ee2812a45213a5b1eef49329339bf6376096fb44089e914e601dfdedceb6eddc25faff4fefaaa962cc082fe97157831d858efef4171f1ad75714d03f5e49a0810e243383bd73e5e3701e8a438620b0ebfa9b27a6e8e4b5cb3aed51062e3acedf20f4b42132c13d275eff642e9c970eb37b3ac4227e611ba1bfb11b68fc0a42471bc33872eccf420ad854821d7a037a541e8618b3163b0472e48ba799a5dd69ad1d815bacf6a71ed1374ec836b69f3b6c536b8e7", "a31eb2953ae822f033b5b9b00be6ef45322c7d98d45da3d715a6fe8fcace1bdfbd60c82c9368058866b488303bc5bd3bb786aaf43b263f28022e4d258d2db61f21626da844d6d5bd326d4f1679ae203fb7cc976b33c15899825f1d720669c1e758eba3c31522c51458394ca6f8179f6905877b8aaf3b70ae2b52bfe924aa57cf254033d5cd2e7cf8110d475b4b081fa4e5184ea2bc2ac54ecb3efdc44591756124d5ee1951351a9ac77ee8aeae3a2dcfeb1b2d445649a0d761b6fdf4caef25b766e98c6de1c0ac0481e7ae8c239c3ce40c5ec9ca7852ac8286063eeb8ccf6df6497ae888f62508cbc9b25a10e68b2f3b0417b112a4be8508eba02241a4d4ddfd340edfd874d629386cacf4a385d4c1f118744e4ec7b9446622ccf1a8d62d299736f3067977f56ecdadd5aef49495323e68371db56f953c10ce488d695b26b087", "a0001b8e33b4b08eb3c0b8123f2c3f336e48afe56dcee3025ea9a47f9ccfd9ce7715434c3f60e25ed403b76ae982f59598fc126032d5e3149c2076e733b9e8f43f2ea2fae61e1f79471c701df08c792703acf0017dbfee5275a9e2adf451023e02027acc2e45ca84b4bbd4fcfce69e2c701c75cea81dc2447de43ff6ac016ae81dfe2281d8327da6d6188267fe709e76cbe00213b0105d74db505292d6d2af270459cda23a9c3967c36321442fcdbe94136762c5aeda0449e4d0a657dd388cc3209821d803574fe42b6013bf63718681f02001d14e6593088fe4edb03d0a936a1b28293f5ecdaf0b2bfa1820ea54eb7fe3343f9d6ab1f52e1ed91e4851cf29281052fb694c5670dd498e84d2fedfcc2ca0a0b13bb847e9c22137271dc7a96d8e", "9034b14050da61df9cec1e60fa5f6aa9e81e9d951c156280050a3259b6b14578273cd89e16dbe6dea0df296e35451cf2a103b7600b5dcd41237747956b4ab7eb4139203f4ef2ab80a017560bc5d25ea2173df930f7d4ed671c124780457257620a0bc6d399b884a0ea2fdc198cfbf0eb7598e8adfb47d42c68020c6c488e4f13208e2e9edbb83d03df49fe4ef6d89d08a1a0d7d0b686e4c85005c894c8191bf925bc4890581f9b7462fdbf2c9f872ff0e61a07be47ea77deed22bfc72d6d872e19f48506f5d94af41ca3c3891c2fb19fac37727f42d5fce35df580424b0d994903945a4996266db274c0ffede817bc37b1340dda45f868c58734d6798ef43173", "a690b2c0d4474434e5ee288d229c6f0f2848b9944aa9b9435218d5f58e03649116587cf4c61911f974ff9eb4d918594c9218a9b3c23f734100c8572ff78db0e4c4a1a759d0661c3d7bd09c2d7fb313e70b18e4154e825958768bd23eaba090aa14f8f0993fe694b370e7f69107b9363a2c7ad06a303aa63cc7c3dfbf83b9b27c2a794eb616d70a3e9f8c6c5d977b56216f391919fece3ab559f1f00ac50bba89007c9b80d5acb1b46be5f634faf6333cbc97ce64eaea4b1878dd62b57771150c218c312c9b0765944a33d49a38bf048ebd3a898c0ee6f638a002bb8e7ad154fc"],
    ["abf4c6b040af06d27a5d33f5fb51874f6b4e0bfb46094fa5037511f11a8786d305bd802eae4c69892977ce6e6afc1b11883f64f779c7445403c87f9720e620324c6bd1e4355dc7f056bb1b134a37d8ad55ca21e280e4aca47be5b86d79795dfc57b046666900f46b09b6ea4e56c61105b2cb8ace7db9e30db5b36963c870bcdc0476fba7cdb0b0953d23e6a9d43d5058448610a1c1dfdd27d20ad70c1ebe9c4a1af9694f11c3fdbe6b103d829053263d30ded71a5dc55d74df0be9831f7c385d2900d3b8c8706228b8b17adae73a925dac3b2fa8db09b725bee008e6759e6e7252b1bfc107640e4cfd3608a7612322da8a586bfcce2fb9db3ba9da26161805731ada9f19b723181b36f60a74da158236920075de3600af7912840587868230656e9c6863bd220c3db4879ff144f841a682e0bae3c2e35d431c0029b4ee37643f5b4e0ed0dd24d2f1ba2081dbbed5bc72e5ce54c829bbb3ed38d6d41189ef2cc511d34ff1a2b71ffef46622d59f85c84d1549bd5d14783c261a24579a45172801", "b53c7d2685df628dca10b851ac84dbf015c6fd46f4d31a4e44376918a3e20492abc49c27fa0cd3f0c1395a035641e416ad93a8c478a2920e71ae8692b289f121470309f4e138e860f277df44c76b157f59a4fb7ffe9ada571203096a4e323c4f5d89d8ab1883a6002d98523295ab443130fd744e2ccb089050510fbd1991fa27714b920a7004b79496931ea906922fabdd7d41c51529466c8473b60960500a494646764227aca3b979b34f5e1c70995af43f6f0a1ee4dc0f8a79439bf8ab42ce59aee936b0fef12f87d18823e7ad6a8b448568f96ec1f0a6e7f83e0af7bd7bbc2df018a3cce88af72625bd532089d92c1d16971140c4c4886dd58b1b5fc930e65a7065e6325e450df7a67ebd68df580aeabb9b1905bcdfe413ba046fc172f70b6b8340ab8b5f9c74b8dce4e1e7cc9e7aa0f6346ef7c73a2452c2729a07e32623608936acda3780fe76311438a3fd7b740c2c87a0fecc76252e1121294911bc5b", "88515b5ca43782b52a116765bc3521c5f335992c279bf6f9040e83688462a4c4028612c43156c308dcc1690433c90f2d80c02781ce77fbe9503acaee410678d72fa659f15c741118976231d0fd3102deb5b0ba6f4dd13a7a024b55cfc4521e7e2b07fff28084b16e868a3441f56279a7554f6cfe17f34f74029076d8401a0931577e7c328437419fa94bef3d8edc844464d0ee245e0ba61f70d0ab711918e5e51418e22e88f7551e226abc4f4880a3b2a10038f9e6ff4aa5e87dccccbd493d8926613a047da0f14f13d123dccda9c53d72a7d32c92c986a32a94e817668af63d3c76929f348d268af23693bfea7d8770cfe83645c767a06e3b5c8a7fb4fb7e1617f00baea1a55ace55593f48ea900998a8b95d964d6f751bf1e6e77bfc9c91a166a4ffb28c261319ec790a1bbb27333b566f1b53b213bdbdbd009099296b4007", "952fc97b4b6cc25f52fcccb5c483be919c46b30f609c48729b41dd63d4ab3d41448ed89febee06c539f26be007cf4d51963401284698417498ef9f408a7c09a218146dca1f61e10b62e42a7beca74b194afd2a97e50376277747bdb2a0772a0a6feb629420455b43dd5558bd756e21b73147255318b31c66d3ed1ce7998fa4a8517af6f414b8dc94aff717f9946365f38eefa13f01933100625749c428c1e6a85a3e2a1e894b14e9fa4ce66aae08695c3bb1afe9620113e62a4cdeb9976034986f0d2e620858bacaee979e24f11a4e01b154b5e52cc8ee5df8259e09ec4ead5841510211840414e49be84ad5a2df14a3559abc578120cfd68415d61e31a8c0f137f56ca5befce5767539e184187ce6aba035adbc084539ad8aad2d1ef0a3a64b", "803d5df7d3d32dddbe8658b49b975e7bbe6f98751a394a5efb7a7af150513139049175a3393eab33265b67ea4c1d6ef08698d56d782678a705e4be48d471852cae83be56ca86b59d4ed03e6623e02157c22513a1a0eb65a7e9693d52b24653ff5d02bff49cf00882baf6ddd806f1d37c2171b671c74d2aa5b1314f96eef14c2721d2b0c753bba4e0fe944e5a86e2de978e095b9a19207887e12418f94cc8d0ca3e62e677295a72a90238bac581987fad65ad312d3e397f19a5bff417fd8f9a920d359457f9f26bc1afd917de8b26805cb52792ff4f370de2ed2a777197a249e85f1a02b48bb39f5f5036e0f6538c2d07a6cfb4f716d57058d54ccdb499652703", "936578c3c30d62cd8ae06f352bd12393cd2dcc5c32ece9314bd4b88b52c7407b5c841716198efba63bc00a02b4b1ef3184063b4c75d64afdcbd7437f3e69b6fd830c7e87b89471ea7ceffed5b7074e39fd3f856704658c83fd0314c795a7e4c041272f9dae10c454cde4ae46bfbb92ae577ec86102ac9240df1c93f0400389835849c22c92e958c7a925d79a1915cddcb600c22162e84b3f4260f06be36ac5ab6a5ecf463956eeb1fdae58dd8d215a4a6f2e3d441b0b29286eaacbc0a180855c5d8c81c2aa926b9f08c760023139195536fcd4c6c505ef3db5c24112649d1c79"],
    ["b2e3c9c4d314303f24c0ca593f5af771a57ae762cf4d1a91d16576dc9b22a7a08a30d53964de472ddab80a40198cc8cb893d101c3ee6fbfaf3265a64a527f0378caed1450f12461c18b094a5b0b6703711a89adf60ab55a81aedf8c616e0812e498f0c8cdc71049e35f5afac1d8340b04a23b728dc5d6284db7d3350ce1c3f3543df847b47ae9c0a70c2a31ef2d96ac7c041fe5b067f3065c13814694fd68a2150e80013f56823c4abe645133ce3a515305f1b7d16efdc351d5e1971bec1cd063e2dd9f39c4c4cbd950d5fc4abf722f81766b63951c7b6838685a83b15e86e9f215967afa54b2463ebc650b87c7a67f18d077d1d15a31eb77ef33d4443c957b057b441bc9f8e6f5e8492b785a2056d948051f5f2034c5d2218423b3aed0c56c107a38d25c05f857a859ec6de4e9512f56051251ba90e2a2408886f03a4d8b2c31e683c308f09cb92422016dc5bbb1ad93faa57bc6f5b327755442cddff67856a09ccd5e0bbbf7a34ac6a707d49ccb037db0b1aa840e92a59431295e1eea7a14b", "836edf37cd2faa6af19c1bf3cbeae8100283115e35575c3a22387365f0b923364b4b3da9fe3332517587ec852fa8a3fe8a0fcfb36131d9855727539741e12362292dcdb6a3ecfcd428cd8005f7153fce97ab0e8ce4d58f28b26d1cdfe6ba583215a9fdf1593e70ae8d7b0f5b3a1cd39252af2ae0a53ada03f8abe264b42357a0081380687fd1465876653b0eac61fef828128578b9ffa4b7c399e6f7df2891fb29a48343d8d9fa4faf38e1dee6c98e262c26d72489832c50db4080dcc13922ed2505efcaab84d07836d5b1109da97ea5d6d85af7217da6bb917c47c6123212ec2a4585e803273fa97dfbf4220730850fdf977a4faa33f59d86234a1fa4e2e8832ebac0ee268d853a33100749a7c24d56506bd286c011401e7e93900d5f8c868940838ede554e3c0f7027432659817e9e80dcead840696f860f89de05c48705460de7e2b7cdd1e77e621a44901b170f37152ad88447ca93ff25104c6d46608627", "92073762804f95faaff899c2d7e62dd129b7d60690b3252c707f1cbee53415c8c642c09058668357673584e8cf6aa89fb32c82db28d02bc3b342218ac69c10354ea942c444166b7143d9f1a2353e7097e50632f1d9915882ab64b021be914bf72ddda960dd57403f55ff97506042cab96839496ee63e17e529596836977f37375e223fd481cbafb4f7c2f91b7eb4df1a13ca15995e557bd809a5a208a74cb417079fd3fd308576587c797581ce1c69e4a87c51fca9b22a3c87f1c2832fd6888549ca9ceb044bcc69af26367325c2b8f46ab0ea7faf973390ec498f922d29bad47007e0629a282b0be348344dd2b8e77e8e2d13aadcd0077022638498f84fd83e167e62f25349e0bf2924a6da3667cd91ff8bafd92ddb84eda1a7995eb760b6081331c103de039f68b2692cb49acad5ba086d36402ab5080600c8c53551cfb825", "8f397380bced02f528174cae433d38bf244112d1a6147dc0d7bd71156390a0f3869e76d80315670c79b80a8e09d1d77f8464f09f9b3dde995d7535bf666ae3a2515bea05d769c4e3d4bee40e376dce7e02262dc098954bfdb098fc05f8446f3c374bb74f2de443b0a8409cf707e6caedc142a8d1155e4fdaac48e08e0fbe4d5c26f9af1d7206eee44a771fd643bf1913f9b4d79e89421e5439ef88fa3f1bc6304fb5ed0de2a9f03babeeaae25bc0b32df1c18cef6b3e25f6a2ddb828a96996e64191f0f2ad30ce68720911f4b993303ad852c003a16ba50fb34e8d0af1c1fec34b9d41dcd3fce34b85d1b30cd5e3022f9f9c841f5ed4863cf0e1a3b2b3fd302b34113e502930a85c5da0c140648c1732096785a24c62961ccc9ba15e906d700f", "82f740a0dcc90295eaa0a54ac97d0b30cf43fb72ab05e5eb252a5f57f51c53e703f9911005384ccf8404d2721b31cb1397ed36a811beb5181a6e9ea42154747b31c48c62f25fc47c895aac98d709c2681fb318341403debb91d7c43ef5e917d41a10e7111c8c6be41b05cc1ec311a3827a16011bc5223a7bd4535d5bceed359f6770ad8319bd3add67cdb9c7de523b7b3809f9cff9126204d15b85691f3d71231b1e650852c37455c0cea3c5c00aaf03776dcf953e9a18596c0ae9b576a6166c0e3b033110fba156f5a09ca8c04d5c1bac0cfe3a2d52b64535ac809db9c9076f5846c20b6534ee78d2a853a1699f898b6948e2cb72cbe5beccdf00871d32204f", "83447728133c981835d96afe01e8b86e923fdbd83dd8b210db0b36f81182f5c678507995466f16d766711b9f5b3f033f96a3c1e55b1d8302e353171abfffeee74e3fcc5cffd0100b402194917fa57abc245d0cfa030a9358eadad4d745a68ed746deb215407d844e0149cd7dc5095c59ce022ebf0c56a246c208ca238493cc456fea301cab23a25abfd20d859f72e6318d2657cb700792284b9aec9967389106292bb53afa07a6d984332bc2efd4ac2f260ab2ccddf1c794bd490c1433f760163c8edda782e6ad308e1f47e36098f38290bcb2f640fdb0c212e9f0ac15b47d1f"],
    ["96319c2cc232074927ad12d16a8f34568dbb2abe1d8b8dabc366f9ef9bc32f329fbb7b30d4ab3ebb11e09f74f101812a99a435600d9d0c227e11f6bf273ccaeea7b6b00ae3ea42d2cfc7395aa7b6abd557749823537e04e2f5dae680e3bdeafa6891b14486fcd9fddbd89fd33379143e635e6c4e3ffc8579d6ad755bc02f693b0aa96f4cac0049d978aaf851aad0f0f4f29878a46e7ef02aa862283ca3f8698c325852b72d62efb7870f3be663a66bb6e9ab2e8b5ed47bcc1221eef86215f0b02b74e2cf9862b2777a7104fec1e7948062b8be8fda315e24e381bddc179f3bda36c207a3bd704f6817ed41492d0ec2a5b17270081b36a407efa03690d43175946dab63a1fbad4d67f629837aade205f4cb1ae02afeae295eec88bd9d46f7087b30ce84e9c178e61a53620a6318eb21ec019561606084c12cda457fb36c36b7683c5917e3f3494f0046a22eb6b9d46dcd1640892453098c2283d2935211453b563ceae65746a744283832efa65a681b045af1deb4ee9599517218a244276d7f94", "a4f6cfc9efec61d930e116d68be95d125d47190e3d84c679319cc478307f9c338697af76bd3690a68ac02a2e78eae9f090adc9443c1bdc2e5dc274f9a0d10109e3f886f8681e9d1c81944cf498a21bb24074a2f55df620e9b11dd850e57a0de0186eeb04ae5e73ed27baf0848a324a534cdf695d907d6e5c6dadbe973f457cce52e01d32f1d5739f09b9acdb6f1e30a03d322ace774cc609438c8cf238939bbf4eaa743fe04c4904644bccfa83a757c7af89951abc1534e11644bdb723afa5973a3fbbca4e239cf0e79a0db4e14ebfee305186c2f2d6927c429eeaa9afd3cb146f621795219afc97e2aeab3cd16c1582c9c44a10de8871d29e844816aa26a21b086393a56a7cde7b70f1f95a8001da177461f82c3e0372a2374ca0d44ea9cd7671a559163c6bb435776ca26dd82f1f6986c177c6e2bdb45f942a486ded15e8d50c0a6052d00e788c06f71b92247d4a29875e6b2d47691708a4eccf4a469d787b", "8e0bf78887d47b77cf971b18172d015189fd7fc98c0be03049df9b174e6f3522b5ec3d610df839d772e14c66908e89eb88e7e9d1281db27a8ac579c7ef2371a598a6ffec0ec3135467bad4c3eab0054e285dd0a8de64717d6caa03d1bae83f71404015e79ca99017b038d64bf8c9fdeb22e65bd8b0d5e24fe81e9c205e3cfe1c26e341fba7062bb4acacef1c1e1b69f27f050a908f2024a82c9e111095cbffde2a13afabf80a70973366b841cd4f5b1d94d93a1c25374b8645c8ea76899355b265b7adf68ff3e5822aa70aa69679f7c3866f0cd9d140d34595a41636d70fd96c070dc0838876b639ff942fd751c8ce90f1abe30d850c7391aac1efda39cb19c972156c954917413da825bcb06ab019b15860a76a6d7900cfe66ae5a05e9548de51ac01ada94ddc18cebc960ddedc0210f1d09343204564113b757c41fdeb48e5", "af44257361996299816e42099bc5833bf481060493b7ffbab8985f5ee3d0afc30c131cc07df1c119d51cd37163b3bdee84e33583fec81ea34cbfb498db892ef2d3cc7a0af35f8ea5c208ac77b8806bf8ab911a64918e89e03a990e879131c50c07b80d55f2f697bd418058615eb45d30a6e5a20b2112d358d2ca804c2ad9289f3e27182369d4d11be4e1d4ddea0993ec437d3d43e628afa53d8fbf1607a30ab86603f3ab102405aec7bd45bfe48291fd43b3ea4fc53d46da06268118984beaa42ac8ef6284feb3890c5520d424f0db852aa5af21e34bbd2ab0b2d2cbde3789b050cce79d665704b51fda2e49997ccdf1b7970a4d73f1d5984f96ab3ccaab14c9733be7a7425df6866ab65caab882e87f0ea6d04b46917c5188ef637b15fcd601", "8ec4f5c37c7337c0e1f131b9c16a946ed6a1d881a2d2a9e3b475830c2eb7bfbedb76f6767b7b98face4528c0b55dfb1e8b38573809efa9eb7a2064e97b8e96179792d573f24c32802e3f4a9954e9396aae5febd795b51693b6d886a92c0ff4a76587fb7cb6eada3073192bf54de10fa148e87472850d89d2fd6ea95310ed2d6636584e111249b248f27b833f1697538dd6b8721ff03c8e739364d000f6c6e4470ab975609cebde14edfce69295c378f86c0420f9d2ccbfb4b707f7e11ef3731b4be8817bc7b6d6586b6399059818e944f8e58f937552631b66ba72b5c441f9384336c1ea8816c52df6ede2b00b48881023c3e201e8b828cf0ab634fc2cede455", "8a038b2bb7bee70f5d24761cc0adfb95ef945207acca844d459381e0323787342ca978822dbf1a446fb83fa89f96b4b0a3f5ed499f374a9ae96d51945757ddb73f75ad90e049c06c50fbcf6611d610d7521c2beca65716bcaa4eebf696e2cc0d41b1c9de44befd8d93b748c434dae13d43cb7962f189e327b31d973ada49065773bae1912dec55d6ac1182aa62d665a2f7c36b02384c7d37b2f0d13fc1cc8d594dce516a75101b109e08d413e2079ed6091dcecea0633417b3bbe2f62d6521e600558594ea3e9fc2a5310e974f4fa256d9b5d1b29f9361c0ffa5ea8b3a44f3d9"],
    ["9209270b42448cc668d9698044f0d5b48d7a2e076b4e7d6ac1ced4fcf877b2d8bb66b3e94785fe5874b8dfb523e9720ba47905c7a5200a56d791459a7d1ac96b59a906682d1615729fce3bf106defef356235dc4ffa638c9af3b3530d611b854653ab930a4e0a98f7a25495326ae452c90fd0d7d7cdcff1969a3cf3e1c589cc4149ee5d8e2cf321a1d1d44113d2624b9b2b1abdfccb9ed3cc1a26fb320af18c12fecad61e1c762ff75c58bf3f8a5cfbc55960d06f2a6111756b6526e818d01381dc9681cf1ddb3bb6a8c966f28e5270d2e59860dd692fd8698c6dc83f093735409114272af304b3a23b9a58fe669acb8dd8358edb3e2ffa641b2300e288cb8ee6eb0744b7a9e096ddea7fd137cec9636763e0bb470f7a6aacb61b40f27c0f1f50a4057a0091eda9c3f6f23dd17b1501cff1421589d9e2d1e915f5dd97212dd03117e6b3a552a557682b5cd303d67155d23e1bc17283addb929149f663702d12625597737feac4d7f9bffc020be77c3687c52e14bed4b930463c6aec91c106ae6", "b695e031ac08c07d331c864b5896e599fd8b34d7295120fe70ad2ebc60200786f2e7e22c8fc34a40c1628e21ecee1ddca4870ab111eb4a0f58433cc6d499ce52bf848cd167debeec32cc891dba79ae0fce2c0c2484fea44776eeeb3c8e193976591620925910837919325a7f62df5cfd9b02bb3c29ddb3efdfb6feb02745f335620cdf42d8737808f3d93b08a48bbc885fa81e5008b74a14be79c0fb0512a9ea58c8e69ace8c72a1e4f64746a4e21f77cad8fe21665a20ed4ce9f1a56a4c83e0661dd49a17cbb0b1a29c77d0e19302a87b96614f2916771e9811e86586df5c205c5b56cb1745e87bc2306b34be5186cf897600db594be7da27d3f3a62dac66ee2074a4405a609e9366d22dbbbe97b94f4a471e29263ec42f69701a2366c770ab1238587c6e93d4f6bdb3acc5fc9106825846f18effd0a8f53573e2610999ef711a64aff8a1f2541ef6cf1ef22198c1d8c5f116d212e6df9358cd84cc407e3d76", "a321cca9be0d773e6b161130fdd937813ee2804bd4cd268d6db14ee759f20920fef9075c7c417ebcf11eb1437fa97fddabca7b12513c5b6df7f783df9ce7b5f47786edc84fc5e174bf1ef519490619083830824b9ae3a59759c58ed6d738624e566f056d5171b4257febc37a86a487218ade0001b26ad9da5198f16032dfdae6245ebfb4fc226cb6ff6b0de7438feabdb83dcea42730aa5076f5382054efbe5a58e9c154a8c35eacff42daa1703615fb9eb1531c470864e4eaf5ba3cb17990483dd4353944c1d21fdd514b4b1d488da813cb119680ac32dfa5108491ac4729a629a2e5c66f2da7fe632635464cfd8a1fd53ba5a849999ef5cd16b41777daa11f5016cd473feae009c028175c977ed13c5c445850d7524f90e76b748e5ca6c398514ea07e5122714753f5ba93dee4eadfd72cf8f5152506a707b9003fc321feac", "8b80095bb43c6d44fdc17e22d76b9bd98c5076cc053d6098e9c6c3ff2cb53775fe914f09d479a5e99729aee4f6814d78a7d2d7d4e3b1a0e19ff175b050bc3ffed795c3fde3efb3b4dd6bb7f846d39f00309b927c4698de181aaa567b65b488ca0e137b175898bf5e4c468677814b3949443ad6a65682d90bfb9a4bcd65145168378ea149c74de879ecdf2cc3c7492f43c25f7e551f831f8c6efb40f21bc0c0e9736bdbdb44b0d9d94e9203d2493874ce6a81323dd1901bf2770f17af2d1d582356796d0f455ec7d36f28a8746baeb9b792e907ce73aa5b76a0999f5da22c91d30a5e7f116f19e18bf3d24da1f8d0567ded3954290e998587431e5ac8ed6a79f43bee5901aeb1421b28e98cd3cfc3b0216787b0c9d410ca87cddaffa65b94128e", "8342b14523c118d4cca058906d4365422012d4ab0e3768030abe1401200a6bb3ac35104cd8ec845a0b066cf179604656b32acf780c950abb91f362bd80ebb5c1e77ce023f492546f03af9c5c47eebe40922dcb800ae3fccb620ceacf1159e59137f68247d9b816b824ec0d01a38edaa15a19ccb8747003652370b213234d71b71153f95ebc7cc5a59775650d46962e4d5c22fe3496edcf404819965db003acae2021790279b395bb0ba0f144a3aaf8d16c7093fdcc82adecc585c2f2281fa6c9199d56ad4905a6aa0ff9134ab3fc44c570689365585624c3db49cbbd258a8dc26d6bff87dde91e7d993c40e45bdbe97dd06e1ec4ec3dcdef9172f8e768adc9b5", "b9cd68a0073cc2eb9e4eea24d7874163e4ab6f0cd46436961548d99e7ad8492280c21e8c1f06a0a31a573ea89c41bdb9aabb4720a22fed7ad2b6a8c9cc4b960ddbe93572a1f6879ac9dfdfa39e9eff5f56aa89f68af86e3a742ac531d1f27ede673f7ea1a22f91ac27be6f02918eafb5833eea526f0e6ca69988543fac8b57c91c4f2db2f6603606b06b8bdd1daaeb835f0f2aa51d160ae210588019c994b47a6d22c0220f598698fb58909212ec5d4284d51dd3e05b04e2a53e7f189bba574e6ed84ba15d532fc8f4a9a7a2b3c8f6aadc615274ce54862eec20e31fc80839ab"],
];

// dst and seed for the mocked rng used for proof generation.
const MOCKED_RNG_SEED: &str = "3.141592653589793238462643383279";
const MOCKED_RNG_DST: &str = "MOCK_RANDOM_SCALARS_DST_";

macro_rules! proof_gen_verify_e2e_nominal {
    (
        $sign_fn:ident,
        $verify_fn:ident,
        $proof_gen_with_rng_fn:ident,
        $proof_verify_fn:ident,
        $ciphersuite_id:ident,
        $expander:ty,
        $expected_proofs:ident
    ) => {
        let header = TEST_HEADER.as_ref();
        let presentation_header = TEST_PRESENTATION_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        for i in 0..TEST_KEY_INFOS.len() {
            let (secret_key, public_key) =
                KeyPair::new(KEY_GEN_SEED, TEST_KEY_INFOS[i])
                    .map(|key_pair| {
                        (
                            key_pair.secret_key.to_bytes(),
                            key_pair.public_key.to_octets(),
                        )
                    })
                    .expect("key generation failed");

            let signature = $sign_fn(&BbsSignRequest {
                secret_key: &secret_key,
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
            })
            .expect("signature generation failed");

            assert_eq!(
                $verify_fn(&BbsVerifyRequest {
                    public_key: &public_key,
                    header: Some(header),
                    messages: Some(messages),
                    signature: &signature,
                })
                .expect("error during signature verification"),
                true
            );

            // Start with all hidden messages
            let mut proof_messages: Vec<BbsProofGenRevealMessageRequest<_>> =
                messages
                    .iter()
                    .map(|value| BbsProofGenRevealMessageRequest {
                        reveal: false,
                        value: value.clone(),
                    })
                    .collect();

            let mut proof_values: Vec<String> = Vec::new();
            // Reveal 1 message at a time
            for j in 0..proof_messages.len() {
                // mocked random scalars for deterministic proof gen
                let dst =
                    &[&$ciphersuite_id(), MOCKED_RNG_DST.as_bytes()].concat();
                // number of random scalars to return from the mockRng. Note
                // that, this value will affect the value of the
                // mocked random scalars
                let rand_scalars_no = proof_messages.len() - j + 3;
                // mocked rng computation
                let mocked_rng = MockRng::<'_, $expander>::new(
                    MOCKED_RNG_SEED.as_bytes(),
                    dst,
                    rand_scalars_no,
                    Some(BBS_BLS12381G1_EXPAND_LEN),
                );

                let proof = &$proof_gen_with_rng_fn(
                    &BbsProofGenRequest {
                        public_key: &public_key,
                        header: Some(header),
                        messages: Some(&proof_messages),
                        signature: &signature,
                        presentation_header: Some(presentation_header),
                        verify_signature: None,
                    },
                    mocked_rng,
                )
                .expect("proof generation failed");
                proof_values.push(hex::encode(proof));
                assert_eq!(
                    proof.to_vec(),
                    hex::decode($expected_proofs[i][j])
                        .expect("hex decoding failed")
                );

                let mut revealed_msgs = Vec::new();
                for k in 0..j {
                    revealed_msgs.push((k as usize, TEST_CLAIMS[k]));
                }

                assert_eq!(
                    $proof_verify_fn(&BbsProofVerifyRequest {
                        public_key: &public_key,
                        header: Some(header),
                        presentation_header: Some(presentation_header),
                        proof: &proof,
                        messages: Some(revealed_msgs.as_slice()),
                    })
                    .expect("proof verification failed"),
                    true
                );
                proof_messages[j].reveal = true;
            }
            // println!("{:?},", proof_values);
        }
    };
}

#[test]
fn proof_gen_verify_e2e_nominal() {
    proof_gen_verify_e2e_nominal!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        bls12_381_g1_shake_256_proof_gen_with_rng,
        bls12_381_g1_shake_256_proof_verify,
        bls12_381_g1_shake_256_ciphersuite_id,
        ExpandMsgXof<Shake256>,
        EXPECTED_PROOFS_SHAKE256
    );

    println!("----------------------");

    proof_gen_verify_e2e_nominal!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        bls12_381_g1_sha_256_proof_gen_with_rng,
        bls12_381_g1_sha_256_proof_verify,
        bls12_381_g1_sha_256_ciphersuite_id,
        ExpandMsgXmd<Sha256>,
        EXPECTED_PROOFS_SHA256
    );
}

macro_rules! proof_gen_failure_message_modified {
    ($sign_fn:ident, $verify_fn:ident, $proof_gen_fn:ident) => {
        let num_disclosed_messages = 4;
        let header = TEST_HEADER.as_ref();
        let presentation_header = TEST_PRESENTATION_HEADER.as_ref();
        let messages = &TEST_CLAIMS;

        let (secret_key, public_key) = KeyPair::random(&mut OsRng, &[])
            .map(|key_pair| {
                (
                    key_pair.secret_key.to_bytes(),
                    key_pair.public_key.to_octets(),
                )
            })
            .expect("key generation failed");

        let signature = $sign_fn(&BbsSignRequest {
            secret_key: &secret_key,
            public_key: &public_key,
            header: Some(header),
            messages: Some(messages),
        })
        .expect("signature generation failed");

        assert_eq!(
            $verify_fn(&BbsVerifyRequest {
                public_key: &public_key,
                header: Some(header),
                messages: Some(messages),
                signature: &signature,
            })
            .expect("error during signature verification"),
            true
        );

        // Start with all hidden messages
        let mut proof_messages: Vec<BbsProofGenRevealMessageRequest<_>> =
            messages
                .iter()
                .map(|value| BbsProofGenRevealMessageRequest {
                    reveal: false,
                    value: value.clone(),
                })
                .collect();

        let mut revealed_msgs = Vec::new();
        for i in 0..num_disclosed_messages {
            proof_messages[i].reveal = true;
            revealed_msgs.push((i as usize, TEST_CLAIMS[i].to_vec()));
        }

        // Modify one of the messages
        proof_messages[1].value = &[0xA; 50];

        // Proof-gen fails with tampered message when we pass `true` value for
        // `verify_signature`.
        let result = $proof_gen_fn(&BbsProofGenRequest {
            public_key: &public_key,
            header: Some(header),
            messages: Some(&proof_messages),
            signature: &signature,
            presentation_header: Some(presentation_header),
            verify_signature: Some(true),
        });
        assert_eq!(result, Err(Error::SignatureVerification));

        // Proof-gen succeeds with tampered message when we pass `false`value
        // for `verify_signature`.
        $proof_gen_fn(&BbsProofGenRequest {
            public_key: &public_key,
            header: Some(header),
            messages: Some(&proof_messages),
            signature: &signature,
            presentation_header: Some(presentation_header),
            verify_signature: Some(false),
        })
        .expect("proof should be generated for tampered messages");
    };
}

#[test]
fn proof_gen_failure_message_modified() {
    proof_gen_failure_message_modified!(
        bls12_381_g1_shake_256_sign,
        bls12_381_g1_shake_256_verify,
        bls12_381_g1_shake_256_proof_gen
    );

    proof_gen_failure_message_modified!(
        bls12_381_g1_sha_256_sign,
        bls12_381_g1_sha_256_verify,
        bls12_381_g1_sha_256_proof_gen
    );
}
